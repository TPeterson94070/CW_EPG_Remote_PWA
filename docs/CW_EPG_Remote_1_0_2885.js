var pas={$libimports:{}},rtl={version:30101,quiet:!1,debug_load_units:!1,debug_rtti:!1,$res:{},debug:function(){!rtl.quiet&&console&&console.log&&console.log(arguments)},error:function(t){throw rtl.debug("Error: ",t),t},warn:function(t){rtl.debug("Warn: ",t)},checkVersion:function(t){if(rtl.version!=t)throw"expected rtl version "+t+", but found "+rtl.version},hiInt:Math.pow(2,53),hasString:function(t){return rtl.isString(t)&&t.length>0},isArray:function(t){return Array.isArray(t)},isFunction:function(t){return"function"==typeof t},isModule:function(t){return rtl.isObject(t)&&rtl.hasString(t.$name)&&pas[t.$name]===t},isImplementation:function(t){return rtl.isObject(t)&&rtl.isModule(t.$module)&&t.$module.$impl===t},isNumber:function(t){return"number"==typeof t},isObject:function(t){return"object"==typeof t&&null!=t},isString:function(t){return"string"==typeof t},getNumber:function(t){return"number"==typeof t?t:NaN},getChar:function(t){return"string"==typeof t&&1===t.length?t:""},getObject:function(t){return"object"==typeof t||"function"==typeof t?t:null},isTRecord:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$new")&&"function"==typeof t.$new},isPasClass:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$classname")&&rtl.isObject(t.$module)},isPasClassInstance:function(t){return rtl.isObject(t)&&rtl.isPasClass(t.$class)},hexStr:function(t,e){return("000000000000000"+t.toString(16).toUpperCase()).slice(-e)},m_loading:0,m_loading_intf:1,m_intf_loaded:2,m_loading_impl:3,m_initializing:4,m_initialized:5,module:function(t,e,i,s){var n=pas[t];n?n.$intfcode=i:rtl.modulenew(t,e,i,s)},modulenew:function(t,e,i,s){rtl.debug_load_units&&rtl.debug('rtl.module name="'+t+'" intfuses='+e+" impluses="+s),rtl.hasString(t)||rtl.error('invalid module name "'+t+'"'),rtl.isArray(e)||rtl.error('invalid interface useslist of "'+t+'"'),rtl.isFunction(i)||rtl.error('invalid interface code of "'+t+'"'),null==s||rtl.isArray(s)||rtl.error('invalid implementation useslist of "'+t+'"'),pas[t]&&rtl.error('module "'+t+'" is already registered');var n=Object.create(rtl.tSectionRTTI),r=n.$module=pas[t]={$name:t,$intfuseslist:e,$impluseslist:s,$state:rtl.m_loading,$intfcode:i,$implcode:null,$impl:null,$rtti:n};s&&(r.$impl={$module:r,$rtti:n})},exitcode:0,run:function(t){try{rtl.hasString(t)||(t="program"),rtl.debug_load_units&&rtl.debug('rtl.run module="'+t+'"'),rtl.initRTTI();var e=pas[t];if(e||rtl.error('rtl.run module "'+t+'" missing'),rtl.loadintf(e),rtl.loadimpl(e),"program"==t||"library"==t){rtl.debug_load_units&&rtl.debug("running $main");var i=pas[t].$main();rtl.isNumber(i)&&(rtl.exitcode=i)}}catch(t){if(!rtl.showUncaughtExceptions)throw t;rtl.handleUncaughtException(t)||(rtl.showException(t),rtl.exitcode=216)}return rtl.exitcode},showException:function(t){var e=t.hasOwnProperty("stack")?t.stack:t,i=rtl.hasString(t.$classname)?t.$classname:"";i+=(i?": ":"")+(t.hasOwnProperty("fMessage")?t.fMessage:""),i="Uncaught Exception:\n"+(i+=(i?"\n":"")+e),console.log(i),alert(i)},handleUncaughtException:function(t){if(!rtl.onUncaughtException)return!1;try{return rtl.onUncaughtException(t),!0}catch(t){return!1}},loadintf:function(t){t.$state>rtl.m_loading_intf||(rtl.debug_load_units&&rtl.debug('loadintf: "'+t.$name+'"'),t.$state===rtl.m_loading_intf&&rtl.error('unit cycle detected "'+t.$name+'"'),t.$state=rtl.m_loading_intf,rtl.loaduseslist(t,t.$intfuseslist,rtl.loadintf),rtl.debug_load_units&&rtl.debug('loadintf: run intf of "'+t.$name+'"'),t.$intfcode(t.$intfuseslist),t.$state=rtl.m_intf_loaded)},loaduseslist:function(t,e,i){if(null!=e)for(var s=e.length,n=0;n<s;n++){var r=e[n];rtl.debug_load_units&&rtl.debug('loaduseslist of "'+t.$name+'" uses="'+r+'"'),null==pas[r]&&rtl.error('module "'+t.$name+'" misses "'+r+'"'),i(pas[r])}},loadimpl:function(t){t.$state>=rtl.m_loading_impl||(t.$state<rtl.m_intf_loaded&&rtl.error('loadimpl: interface not loaded of "'+t.$name+'"'),rtl.debug_load_units&&rtl.debug('loadimpl: load uses of "'+t.$name+'"'),t.$state=rtl.m_loading_impl,rtl.loaduseslist(t,t.$impluseslist,rtl.loadintf),rtl.loaduseslist(t,t.$intfuseslist,rtl.loadimpl),rtl.loaduseslist(t,t.$impluseslist,rtl.loadimpl),rtl.debug_load_units&&rtl.debug('loadimpl: run impl of "'+t.$name+'"'),rtl.isFunction(t.$implcode)&&t.$implcode(t.$impluseslist),rtl.debug_load_units&&rtl.debug('loadimpl: run init of "'+t.$name+'"'),t.$state=rtl.m_initializing,rtl.isFunction(t.$init)&&t.$init(),t.$state=rtl.m_initialized)},createCallback:function(t,e){var i;if("string"==typeof e){if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){return t[e].apply(t,arguments)}}else i=function(){return e.apply(t,arguments)};return i.scope=t,i.fn=e,i},createSafeCallback:function(t,e){var i;if("string"==typeof e){if(!t[e])return null;if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){try{return t[e].apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}}}else{if(!e)return null;i=function(){try{return e.apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}}}return i.scope=t,i.fn=e,i},eqCallback:function(t,e){return t===e||null!=t&&null!=e&&t.fn&&t.scope===e.scope&&t.fn===e.fn},initStruct:function(t,e,i){return e.$module&&e.$module.$impl===e&&(e=e.$module),t.$parent=e,rtl.isModule(e)?(t.$module=e,t.$name=i):(t.$module=e.$module,t.$name=e.$name+"."+i),e},initClass:function(t,e,i,s,n){e[i]=t,t.$class=t,t.$classname=n||i,e=rtl.initStruct(t,e,i),t.$fullname=e.$name+"."+i,rtl.debug_rtti&&rtl.debug("initClass "+t.$fullname);var r=t.$module.$rtti.$Class(t.$classname,{class:t});t.$rtti=r,rtl.isObject(t.$ancestor)&&(r.ancestor=t.$ancestor.$rtti),r.ancestor||(r.ancestor=null),s.call(t)},createClass:function(t,e,i,s,n){var r=t[e];if(r)return r;var o=null;null!=i?(o=Object.create(i)).$ancestor=i:((o={$ancestor:null}).$create=function(t,e){null==e&&(e=[]);var i=Object.create(this);i.$init();try{"string"==typeof t?i[t].apply(i,e):t.apply(i,e),i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final(),t}return i},o.$destroy=function(t){this.BeforeDestruction(),this[t]&&this[t](),this.$final()}),rtl.initClass(o,t,e,s,n)},createClassExt:function(t,e,i,s,n,r){var o=rtl.isFunction(i),a=null;if(o?((a=Object.create(i.prototype)).$ancestorfunc=i,a.$ancestor=null):i.$func?(o=!0,(a=Object.create(i)).$ancestor=i):(a=Object.create(i)).$ancestor=null,a.$create=function(t,e){null==e&&(e=[]);var i=null;(i=s.length>0?this[s](t,e):o?new this.$func(e):Object.create(a)).$init&&i.$init();try{"string"==typeof t?this[t].apply(i,e):t.apply(i,e),i.AfterConstruction&&i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final&&i.$final(),t}return i},a.$destroy=function(t){this.BeforeDestruction&&this.BeforeDestruction(),this[t]&&this[t](),this.$final&&this.$final()},rtl.initClass(a,t,e,n,r),o){function l(){}l.prototype=a,a.$func=l}},createHelper:function(t,e,i,s,n){var r=null;null!=i?(r=Object.create(i)).$ancestor=i:r={$ancestor:null},t[e]=r,r.$class=r,r.$classname=n||e,t=rtl.initStruct(r,t,e),r.$fullname=t.$name+"."+e;var o=r.$module.$rtti.$Helper(r.$classname,{helper:r});r.$rtti=o,rtl.isObject(i)&&(o.ancestor=i.$rtti),o.ancestor||(o.ancestor=null),s.call(r)},tObjectDestroy:"Destroy",free:function(t,e){if(null==t[e])return null;t[e].$destroy(rtl.tObjectDestroy),t[e]=null},freeLoc:function(t){return null==t||t.$destroy(rtl.tObjectDestroy),null},hideProp:function(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0}),arguments.length>2&&(t[e]=i)},recNewT:function(t,e,i,s){if(t){var n=t[e];if(n)return n}var r={};t&&(t[e]=r);var o=rtl.hideProp;return s&&(rtl.initStruct(r,t,e),r.$record=r,o(r,"$record"),o(r,"$name"),o(r,"$parent"),o(r,"$module"),o(r,"$initSpec")),i.call(r),r.$new||(r.$new=function(){return Object.create(r)}),r.$clone=function(t){return r.$new().$assign(t)},o(r,"$new"),o(r,"$clone"),o(r,"$eq"),o(r,"$assign"),r},is:function(t,e){return e.isPrototypeOf(t)||t===e},isExt:function(t,e,i){return null!=t&&(("object"==typeof e||"function"==typeof e)&&(t===e?1!==i&&(2!==i||rtl.isPasClass(t)):e.isPrototypeOf&&e.isPrototypeOf(t)?1===i?rtl.isPasClassInstance(t):2!==i||rtl.isPasClass(t):"function"==typeof e&&t instanceof e))},Exception:null,EInvalidCast:null,EAbstractError:null,ERangeError:null,EIntOverflow:null,EPropWriteOnly:null,raiseE:function(t){var e=rtl[t];if(null==e){var i=pas.SysUtils;i||(i=pas.sysutils),i||(i=pas["System.SysUtils"]),i&&((e=i[t])||(e=i[t.toLowerCase()]),e||(e=i.Exception),e||(e=i.exception))}if(e){if(e.Create)throw e.$create("Create");if(e.create)throw e.$create("create")}if("EInvalidCast"===t)throw"invalid type cast";if("EAbstractError"===t)throw"Abstract method called";if("ERangeError"===t)throw"range error";throw t},as:function(t,e){if(null===t||rtl.is(t,e))return t;rtl.raiseE("EInvalidCast")},asExt:function(t,e,i){if(null===t||rtl.isExt(t,e,i))return t;rtl.raiseE("EInvalidCast")},createInterface:function(t,e,i,s,n,r,o){var a=t[e];if(a)return a;var l=n?Object.create(n):{};if(t[e]=l,l.$module=t,l.$name=o||e,l.$fullname=t.$name+"."+l.$name,l.$guid=i,l.$guidr=null,l.$names=s||[],rtl.isFunction(r)){rtl.debug_rtti&&rtl.debug("createInterface "+l.$fullname);var h=l.$module.$rtti.$Interface(l.$name,{interface:l,module:t});l.$rtti=h,n&&(h.ancestor=n.$rtti),h.ancestor||(h.ancestor=null),r.call(l)}return l},strToGUIDR:function(t,e){var i=0;function s(e){var s=t.substr(i,e);return i+=e,parseInt(s,16)}i+=1,e.D1=s(8),i+=1,e.D2=s(4),i+=1,e.D3=s(4),i+=1,e.D4||(e.D4=[]),e.D4[0]=s(2),e.D4[1]=s(2),i+=1;for(var n=2;n<8;n++)e.D4[n]=s(2);return e},guidrToStr:function(t){if(t.$intf)return t.$intf.$guid;for(var e=rtl.hexStr,i="{"+e(t.D1,8)+"-"+e(t.D2,4)+"-"+e(t.D3,4)+"-"+e(t.D4[0],2)+e(t.D4[1],2)+"-",s=2;s<8;s++)i+=e(t.D4[s],2);return i+="}"},createTGUID:function(t){var e=pas.System?pas.System.TGuid:pas.system.tguid;return rtl.strToGUIDR(t,e.$new())},getIntfGUIDR:function(t){if(!t)return null;if(!t.$guidr){var e=rtl.createTGUID(t.$guid);t.hasOwnProperty("$guid")||(t=Object.getPrototypeOf(t)),e.$intf=t,t.$guidr=e}return t.$guidr},addIntf:function(t,e,i){function s(t){return"function"==typeof t?function(){return t.apply(this.$o,arguments)}:function(){rtl.raiseE("EAbstractError")}}i||(i={});var n=e,r=Object.create(n);t.hasOwnProperty("$intfmaps")||(t.$intfmaps={}),t.$intfmaps[e.$guid]=r;do{var o=n.$names;if(!o)break;for(var a=0;a<o.length;a++){var l=o[a],h=i[l];h||(h=l),r[l]=s(t[h])}n=Object.getPrototypeOf(n)}while(null!=n)},getIntfG:function(t,e,i){if(!t)return null;var s=t.$intfmaps;if(!s)return null;var n=s[e];if(!n)return null;if("function"==typeof n)return n.call(t);var r=null;if(t.$interfaces&&(r=t.$interfaces[e]),r||((r=Object.create(n)).$o=t,t.$interfaces||(t.$interfaces={}),t.$interfaces[e]=r),"object"==typeof i){var o=null;return 0===r.QueryInterface(rtl.getIntfGUIDR(i),{get:function(){return o},set:function(t){o=t}})?o:null}return 2===i&&"com"===r.$kind&&r._AddRef(),r},getIntfT:function(t,e){return rtl.getIntfG(t,e.$guid)},queryIntfT:function(t,e){return rtl.getIntfG(t,e.$guid,e)},queryIntfIsT:function(t,e){var i=rtl.getIntfG(t,e.$guid);return!!i&&("com"===i.$kind&&i._Release(),!0)},asIntfT:function(t,e){var i=rtl.getIntfG(t,e.$guid);if(null!==i)return i;rtl.raiseEInvalidCast()},intfIsIntfT:function(t,e){return null!==t&&rtl.queryIntfIsT(t.$o,e)},intfAsIntfT:function(t,e){if(!t)return null;var i=rtl.getIntfG(t.$o,e.$guid);if(i)return i;rtl.raiseEInvalidCast()},intfIsClass:function(t,e){return null!=t&&rtl.is(t.$o,e)},intfAsClass:function(t,e){return null==t?null:rtl.as(t.$o,e)},intfToClass:function(t,e){return null!==t&&rtl.is(t.$o,e)?t.$o:null},intfRefs:{ref:function(t,e){var i=this[t];return i&&(delete this[t],i._Release()),e&&(this[t]=e),e},free:function(){for(var t in this)if(this.hasOwnProperty(t)){var e=this[t];e&&e._Release()}}},createIntfRefs:function(){return Object.create(rtl.intfRefs)},setIntfP:function(t,e,i,s){var n=t[e];n!==i&&(null!==n&&(t[e]=null,n._Release()),null!==i&&(s||i._AddRef(),t[e]=i))},setIntfL:function(t,e,i){return t!==e?(null!==e&&(i||e._AddRef()),null!==t&&t._Release()):i&&null!==t&&t._Release(),e},_AddRef:function(t){return t&&t._AddRef(),t},_Release:function(t){return t&&t._Release(),t},_ReleaseArray:function(t,e){if(!t)return null;for(var i=0;i<t.length;i++)e<=1?t[i]&&t[i]._Release():rtl._ReleaseArray(t[i],e-1);return null},trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)},checkMethodCall:function(t,e){rtl.isObject(t)&&rtl.is(t,e)||rtl.raiseE("EInvalidCast")},oc:function(t){if(Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991)return t;rtl.raiseE("EIntOverflow")},rc:function(t,e,i){if(Math.floor(t)===t&&t>=e&&t<=i)return t;rtl.raiseE("ERangeError")},rcc:function(t,e,i){if("string"==typeof t&&1===t.length){var s=t.charCodeAt(0);if(s>=e&&s<=i)return t}rtl.raiseE("ERangeError")},rcSetCharAt:function(t,e,i){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),rtl.setCharAt(t,e,i)},rcCharAt:function(t,e){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),t.charAt(e)},rcArrR:function(t,e){if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length){if(arguments.length>2){t=t[e];for(var i=2;i<arguments.length;i++)t=rtl.rcArrR(t,arguments[i]);return t}return t[e]}rtl.raiseE("ERangeError")},rcArrW:function(t,e,i){for(var s=3;s<arguments.length;s++)t=rtl.rcArrR(t,e),e=arguments[s-1],i=arguments[s];if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length)return t[e]=i;rtl.raiseE("ERangeError")},length:function(t){return null==t?0:t.length},arrayRef:function(t){return null!=t&&rtl.hideProp(t,"$pas2jsrefcnt",1),t},arraySetLength:function(t,e,i){for(var s=[],n=9999,r=2;r<arguments.length;r++){var o=arguments[r];"s"===o?n=r-2:s.push({dim:o+0,a:null,i:0,src:null})}for(var a=s.length-1,l=0,h=0,u=null,d=null,F=t,c=0,p=0;;)if(l>0&&(F=(u=s[l-1]).src&&u.src.length>u.i?u.src[u.i]:null),F?F.$pas2jsrefcnt>0||l>=n?(d=[],p=c=F.length):(c=0,p=(d=F).length):(d=[],c=0,p=0),h=s[l].dim,d.length=h,!(l>0&&(u.a[u.i]=d,u.i++,0===h&&u.i<u.a.length))){if(h>0){if(l<a){(u=s[l]).a=d,u.i=0,u.src=F,l++;continue}if(c>h&&(c=h),rtl.isArray(e)){for(r=0;r<c;r++)d[r]=F[r];for(r=p;r<h;r++)d[r]=[]}else if(rtl.isObject(e))if(rtl.isTRecord(e)){for(r=0;r<c;r++)d[r]=e.$clone(F[r]);for(r=p;r<h;r++)d[r]=e.$new()}else{for(r=0;r<c;r++)d[r]=rtl.refSet(F[r]);for(r=p;r<h;r++)d[r]={}}else{for(r=0;r<c;r++)d[r]=F[r];for(r=p;r<h;r++)d[r]=e}}for(;l>0&&s[l-1].i>=s[l-1].dim;)l--;if(0===l)return 0===a?d:s[0].a}},arrayEq:function(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},arrayClone:function(t,e,i,s,n,r){if("refSet"===t)for(;i<s;i++)n[r++]=rtl.refSet(e[i]);else if("slice"===t)for(;i<s;i++)n[r++]=e[i].slice(0);else if("function"==typeof t)for(;i<s;i++)n[r++]=t(e[i]);else if(rtl.isTRecord(t))for(;i<s;i++)n[r++]=t.$clone(e[i]);else for(;i<s;i++)n[r++]=e[i]},arrayConcat:function(t){for(var e=[],i=0,s=1;s<arguments.length;s++){null!==(n=arguments[s])&&(i+=n.length)}e.length=i,i=0;for(s=1;s<arguments.length;s++){var n;null!==(n=arguments[s])&&(rtl.arrayClone(t,n,0,n.length,e,i),i+=n.length)}return e},arrayConcatN:function(){for(var t=null,e=0;e<arguments.length;e++){var i=arguments[e];if(null!==i)if(null===t)t=rtl.arrayRef(i);else if(t.$pas2jsrefcnt)t=t.concat(i);else for(e=0;e<i.length;e++)t.push(i[e])}return t},arrayPush:function(t,e){return null===e?e=[]:e.$pas2jsrefcnt&&(e=rtl.arrayCopy(t,e,0,e.length)),rtl.arrayClone(t,arguments,2,arguments.length,e,e.length),e},arrayPushN:function(t){null===t?t=[]:t.$pas2jsrefcnt&&(t=t.concat());for(var e=1;e<arguments.length;e++)t.push(arguments[e]);return t},arrayCopy:function(t,e,i,s){if(null===e)return[];i<0&&(i=0),void 0===s&&(s=e.length);var n=i+s;if(n>e.length&&(n=e.length),i>=n)return[];if(0===t)return e.slice(i,n);var r=[];return r.length=n-i,rtl.arrayClone(t,e,i,n,r,0),r},arrayInsert:function(t,e,i){return e?(e.splice(i,0,t),e):[t]},setCharAt:function(t,e,i){return t.substr(0,e)+i+t.substr(e+1)},getResStr:function(t,e){var i=t.$resourcestrings[e];return i.current?i.current:i.org},createSet:function(){for(var t={},e=0;e<arguments.length;e++)if(null!=arguments[e])t[arguments[e]]=!0;else for(var i=arguments[e+=1],s=arguments[e+=1],n=i;n<=s;n++)t[n]=!0;return t},cloneSet:function(t){var e={};for(var i in t)e[i]=!0;return e},refSet:function(t){return rtl.hideProp(t,"$shared",!0),t},includeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),t[e]=!0,t},excludeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),delete t[e],t},diffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);return i},unionSet:function(t,e){var i={};for(var s in t)i[s]=!0;for(var s in e)i[s]=!0;return i},intersectSet:function(t,e){var i={};for(var s in t)e[s]&&(i[s]=!0);return i},symDiffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);for(var s in e)t[s]||(i[s]=!0);return i},eqSet:function(t,e){for(var i in t)if(!e[i])return!1;for(var i in e)if(!t[i])return!1;return!0},neSet:function(t,e){return!rtl.eqSet(t,e)},leSet:function(t,e){for(var i in t)if(!e[i])return!1;return!0},geSet:function(t,e){for(var i in e)if(!t[i])return!1;return!0},strSetLength:function(t,e){var i=t.length;if(i>e)return t.substring(0,e);if(t.repeat)return t+" ".repeat(e-i);for(;i<e;)t+=" ",i++;return t},spaceLeft:function(t,e){var i=t.length;if(i>=e)return t;if(t.repeat)return" ".repeat(e-i)+t;for(;i<e;)t=" "+t,i++;return t},floatToStr:function(t,e,i){if(arguments.length>2)return rtl.spaceLeft(t.toFixed(i),e);var s="",n=Math.abs(t);n>1&&n<1e10||n>1e-10&&n<1?s="00":(n>1&&n<1e100||n<1e-10)&&(s="0"),arguments.length<2?e=24:e<9&&(e=9);i=e-8;var r=(t>0?" ":"")+t.toExponential(i);return r=r.replace(/e(.)/,"E$1"+s),rtl.spaceLeft(r,e)},valEnum:function(t,e,i){for(var s in t=t.toLowerCase(),e)if("string"==typeof s&&s.toLowerCase()===t)return i(0),e[s];return i(1),0},lw:function(t){return t<0?t+4294967296:t},and:function(t,e){var i=2147483648;return(t/i&e/i)*i+(2147483647&t&e)},or:function(t,e){var i=2147483648;return(t/i|e/i)*i+(2147483647&t|2147483647&e)},xor:function(t,e){var i=2147483648;return(t/i^e/i)*i+(2147483647&t^2147483647&e)},shr:function(t,e){return t<0&&(t+=rtl.hiInt),t<2147483648?t>>e:e<=0?t:e>54?0:Math.floor(t/Math.pow(2,e))},shl:function(t,e){if(t<0&&(t+=rtl.hiInt),e<=0)return t;if(e>54)return 0;var i=t*Math.pow(2,e);return i<=rtl.hiInt?i:i%rtl.hiInt},initRTTI:function(){function t(t,e,i){i||(i=rtl.tTypeInfo),rtl.debug_rtti&&rtl.debug('initRTTI.newBaseTI "'+t+'" '+e+' ("'+i.name+'")');var s=Object.create(i);return s.name=t,s.kind=e,rtl[t]=s,s}function e(e,i,s,n){var r=t(e,1,rtl.tTypeInfoInteger);return r.minvalue=i,r.maxvalue=s,r.ordtype=n,r}function i(t,e){var i=Object.create(rtl.tTypeMember);i.name=t,i.kind=e,rtl[t]=i}rtl.debug_rtti&&rtl.debug("initRTTI"),rtl.tTypeInfo={name:"tTypeInfo",kind:0,$module:null,attr:null},t("tTypeInfoInteger",1),e("shortint",-128,127,0),e("byte",0,255,1),e("smallint",-32768,32767,2),e("word",0,65535,3),e("longint",-2147483648,2147483647,4),e("longword",0,4294967295,5),e("nativeint",-4503599627370496,0xfffffffffffff,6),e("nativeuint",0,0xfffffffffffff,7),t("char",2),t("string",3),t("tTypeInfoEnum",4,rtl.tTypeInfoInteger),t("tTypeInfoSet",5),t("double",6),t("boolean",7),t("tTypeInfoProcVar",8),t("tTypeInfoMethodVar",9,rtl.tTypeInfoProcVar),t("tTypeInfoArray",10),t("tTypeInfoDynArray",11),t("tTypeInfoPointer",15),t("pointer",15,rtl.tTypeInfoPointer).reftype=null,t("jsvalue",16),t("tTypeInfoRefToProcVar",17,rtl.tTypeInfoProcVar),rtl.tTypeMember={attr:null},i("tTypeMemberField",1),i("tTypeMemberMethod",2),i("tTypeMemberProperty",3),rtl.tTypeMembers={};var s=t("tTypeInfoStruct",0);s.$addMember=function(t,e,i){if(rtl.debug_rtti){if(!rtl.hasString(t)||"$"===t.charAt())throw'invalid member "'+t+'", this="'+this.name+'"';if(!rtl.is(e,rtl.tTypeMember))throw'invalid ancestor "'+e+":"+e.name+'", "'+this.name+"."+t+'"';if(null!=i&&"object"!=typeof i)throw'invalid options "'+i+'", "'+this.name+"."+t+'"'}var s=Object.create(e);if(s.name=t,this.members[t]=s,this.names.push(t),rtl.isObject(i))for(var n in i)i.hasOwnProperty(n)&&(s[n]=i[n]);return s},s.addField=function(t,e,i){var s=this.$addMember(t,rtl.tTypeMemberField,i);if(rtl.debug_rtti&&!rtl.is(e,rtl.tTypeInfo))throw'invalid type "'+e+'", "'+this.name+"."+t+'"';return s.typeinfo=e,this.fields.push(t),s},s.addFields=function(){for(var t=0;t<arguments.length;){var e=arguments[t++],i=arguments[t++];t<arguments.length&&"object"==typeof arguments[t]?this.addField(e,i,arguments[t++]):this.addField(e,i)}},s.addMethod=function(t,e,i,s,n,r){var o=this.$addMember(t,rtl.tTypeMemberMethod,r);return o.methodkind=e,o.procsig=rtl.newTIProcSig(i,s,n),this.methods.push(t),o},s.addProperty=function(t,e,i,s,n,r){var o=this.$addMember(t,rtl.tTypeMemberProperty,r);return o.flags=e,o.typeinfo=i,o.getter=s,o.setter=n,o.params=rtl.isArray(o.params)?rtl.newTIParams(o.params):null,this.properties.push(t),rtl.isString(o.stored)||(o.stored=""),o},s.getField=function(t){return this.members[this.fields[t]]},s.getMethod=function(t){return this.members[this.methods[t]]},s.getProperty=function(t){return this.members[this.properties[t]]},t("tTypeInfoRecord",12,rtl.tTypeInfoStruct),t("tTypeInfoClass",13,rtl.tTypeInfoStruct),t("tTypeInfoClassRef",14),t("tTypeInfoInterface",18,rtl.tTypeInfoStruct),t("tTypeInfoHelper",19,rtl.tTypeInfoStruct),t("tTypeInfoExtClass",20,rtl.tTypeInfoClass)},tSectionRTTI:{$module:null,$inherited:function(t,e,i){rtl.debug_rtti&&rtl.debug('tSectionRTTI.newTI "'+(this.$module?this.$module.$name:"(no module)")+'"."'+t+'" ('+e.name+") "+(i?"init":"forward"));var s=this[t];if(s){if(!s.$forward)return s;if(!e.isPrototypeOf(s))throw'typeinfo ancestor mismatch "'+t+'" ancestor="'+e.name+'" t.name="'+s.name+'"'}else(s=Object.create(e)).name=t,s.$module=this.$module,this[t]=s;if(i)for(var n in delete s.$forward,i)i.hasOwnProperty(n)&&(s[n]=i[n]);else s.$forward=!0;return s},$Scope:function(t,e,i){var s=this.$inherited(t,e,i);return s.members||(s.members={}),s.names||(s.names=[]),s.fields||(s.fields=[]),s.methods||(s.methods=[]),s.properties||(s.properties=[]),s},$TI:function(t,e,i){var s=this.$inherited(t,rtl.tTypeInfo,i);return s.kind=e,s},$Int:function(t,e){return this.$inherited(t,rtl.tTypeInfoInteger,e)},$Enum:function(t,e){return this.$inherited(t,rtl.tTypeInfoEnum,e)},$Set:function(t,e){return this.$inherited(t,rtl.tTypeInfoSet,e)},$StaticArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoArray,e)},$DynArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoDynArray,e)},$ProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoProcVar,e)},$RefToProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoRefToProcVar,e)},$MethodVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoMethodVar,e)},$Record:function(t,e){return this.$Scope(t,rtl.tTypeInfoRecord,e)},$Class:function(t,e){return this.$Scope(t,rtl.tTypeInfoClass,e)},$ClassRef:function(t,e){return this.$inherited(t,rtl.tTypeInfoClassRef,e)},$Pointer:function(t,e){return this.$inherited(t,rtl.tTypeInfoPointer,e)},$Interface:function(t,e){return this.$Scope(t,rtl.tTypeInfoInterface,e)},$Helper:function(t,e){return this.$Scope(t,rtl.tTypeInfoHelper,e)},$ExtClass:function(t,e){return this.$Scope(t,rtl.tTypeInfoExtClass,e)}},newTIParam:function(t){return{name:t[0],typeinfo:t[1],flags:rtl.isNumber(t[2])?t[2]:0}},newTIParams:function(t){var e=[];if(rtl.isArray(t))for(var i=0;i<t.length;i++)e.push(rtl.newTIParam(t[i]));return e},newTIProcSig:function(t,e,i){return{params:rtl.newTIParams(t),resulttype:e||null,flags:i||0}},addResource:function(t){rtl.$res[t.name]=t},getResource:function(t){var e=rtl.$res[t];return void 0!==e?e:null},getResourceList:function(){return Object.keys(rtl.$res)}};rtl.module("System",[],(function(){"use strict";var t=this,e=t.$impl;this.LineEnding="\n",this.sLineBreak=this.LineEnding,this.MaxLongint=2147483647,this.Maxint=2147483647,this.$rtti.$inherited("TDateTime",rtl.double,{}),this.$rtti.$inherited("TTime",this.$rtti.TDateTime,{}),this.$rtti.$inherited("TDate",this.$rtti.TDateTime,{}),this.TTextLineBreakStyle={0:"tlbsLF",tlbsLF:0,1:"tlbsCRLF",tlbsCRLF:1,2:"tlbsCR",tlbsCR:2},rtl.recNewT(this,"TGuid",(function(){this.D1=0,this.D2=0,this.D3=0,this.$new=function(){var t=Object.create(this);return t.D4=rtl.arraySetLength(null,0,8),t},this.$eq=function(t){return this.D1===t.D1&&this.D2===t.D2&&this.D3===t.D3&&rtl.arrayEq(this.D4,t.D4)},this.$assign=function(t){return this.D1=t.D1,this.D2=t.D2,this.D3=t.D3,this.D4=t.D4.slice(0),this}})),rtl.recNewT(this,"TMethod",(function(){this.Code=null,this.Data=null,this.$eq=function(t){return this.Code===t.Code&&this.Data===t.Data},this.$assign=function(t){return this.Code=t.Code,this.Data=t.Data,this}})),rtl.createClass(this,"TObject",null,(function(){this.$init=function(){},this.$final=function(){},this.Create=function(){return this},this.Destroy=function(){},this.Free=function(){this.$destroy("Destroy")},this.ClassType=function(){return this},this.InheritsFrom=function(t){return null!=t&&(this==t||t.isPrototypeOf(this))},this.MethodAddress=function(t){var e=null;if(e=null,""===t)return e;var i,s=0,n=this.$rtti,r="";for(i=t.toLowerCase();""===r&&null!=n;){for(s=0;""===r&&s<n.methods.length;)n.getMethod(s).name.toLowerCase()===i&&(r=n.getMethod(s).name),s+=1;""===r&&(n=n.ancestor)}return""!==r&&(e=this[r]),e},this.FieldAddress=function(t){if(null,""===t)return null;for(var e=this.$class,i=null,s=t.toLowerCase(),n=null;null!==e;){for(var r=0,o=(i=e.$rtti).fields.length-1;r<=o;r++)if((n=i.getField(r)).name.toLowerCase()===s)return n;e=e.$ancestor?e.$ancestor:null}return null},this.ClassInfo=function(){return this.$rtti},this.AfterConstruction=function(){},this.BeforeDestruction=function(){},this.GetInterface=function(t,e){var i=t.$intf;return i&&(i=rtl.getIntfG(this,i.$guid,2))?(e.set(i),!0):this.GetInterfaceByStr(rtl.guidrToStr(t),e)},this.GetInterfaceByStr=function(e,i){if(!1,t.IObjectInstance.$str||(t.IObjectInstance.$str=rtl.guidrToStr(t.IObjectInstance)),e==t.IObjectInstance.$str)return i.set(this),!0;var s=rtl.getIntfG(this,e,2);return i.set(s),null!==s}})),rtl.createClass(this,"TCustomAttribute",this.TObject,(function(){})),this.S_OK=0,this.E_NOINTERFACE=-2147467262,rtl.createInterface(this,"IUnknown","{00000000-0000-0000-C000-000000000046}",["QueryInterface","_AddRef","_Release"],null,(function(){this.$kind="com"})),this.IObjectInstance=this.TGuid.$clone({D1:3642530548,D2:15507,D3:16911,D4:[163,3,191,91,168,43,253,35]}),this.TTypeKind={0:"tkUnknown",tkUnknown:0,1:"tkInteger",tkInteger:1,2:"tkChar",tkChar:2,3:"tkString",tkString:3,4:"tkEnumeration",tkEnumeration:4,5:"tkSet",tkSet:5,6:"tkDouble",tkDouble:6,7:"tkBool",tkBool:7,8:"tkProcVar",tkProcVar:8,9:"tkMethod",tkMethod:9,10:"tkArray",tkArray:10,11:"tkDynArray",tkDynArray:11,12:"tkRecord",tkRecord:12,13:"tkClass",tkClass:13,14:"tkClassRef",tkClassRef:14,15:"tkPointer",tkPointer:15,16:"tkJSValue",tkJSValue:16,17:"tkRefToProcVar",tkRefToProcVar:17,18:"tkInterface",tkInterface:18,19:"tkHelper",tkHelper:19,20:"tkExtClass",tkExtClass:20},this.vtInteger=0,this.vtExtended=3,this.vtWideChar=9,this.vtCurrency=12,this.vtUnicodeString=18,this.vtNativeInt=19,rtl.recNewT(this,"TVarRec",(function(){this.VType=0,this.VJSValue=void 0,this.$eq=function(t){return this.VType===t.VType&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue},this.$assign=function(t){return this.VType=t.VType,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this}})),this.VarRecs=function(){var e=[],i=0,s=null;for(e=[];i<arguments.length;)(s=t.TVarRec.$new()).VType=rtl.trunc(arguments[i]),i+=1,s.VJSValue=arguments[i],i+=1,e.push(t.TVarRec.$clone(s));return e},this.Frac=function(t){return t%1},this.Odd=function(t){return!0&t},this.Random=function(t){return Math.floor(Math.random()*t)},this.Sqr$1=function(t){return t*t},this.Trunc=function(e){return Math.trunc||(Math.trunc=function(t){return t=+t,isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}),t.Trunc=Math.trunc,Math.trunc(e)},this.DefaultTextLineBreakStyle=0,this.Int=function(e){return t.Trunc(e)},this.Copy=function(t,e,i){return e<1&&(e=1),i>0?t.substring(e-1,e+i-1):""},this.Copy$1=function(t,e){return e<1&&(e=1),t.substr(e-1)},this.Delete=function(e,i,s){var n;i<1||i>e.get().length||s<=0||(n=e.get(),e.set(t.Copy(n,1,i-1)+t.Copy$1(n,i+s)))},this.Pos=function(t,e){return e.indexOf(t)+1},this.Insert=function(e,i,s){var n;""!==e&&(n=i.get(),s<1?i.set(e+n):s>n.length?i.set(n+e):i.set(t.Copy(n,1,s-1)+e+t.Copy(n,s,n.length)))},this.upcase=function(t){return t.toUpperCase()},this.val=function(t,i,s){i.set(e.valint(t,-9007199254740991,9007199254740991,s))},this.val$5=function(t,i,s){i.set(e.valint(t,0,65535,s))},this.val$6=function(t,i,s){i.set(e.valint(t,-2147483648,2147483647,s))},this.val$8=function(t,e,i){var s;""!==t?(s=Number(t),isNaN(s)?i.set(1):(i.set(0),e.set(s))):i.set(1)},this.StringOfChar=function(t,e){var i="";if(e>0&&t.repeat)return t.repeat(e);i="";for(var s=1,n=e;s<=n;s++)s,i+=t;return i},this.Writeln=function(){var t=0,i=0,s="";if(i=arguments.length-1,null!=e.WriteCallBack)for(var n=0,r=i;n<=r;n++)t=n,e.WriteCallBack(arguments[t],t===i);else{s=e.WriteBuf;for(var o=0,a=i;o<=a;o++)s=s+""+arguments[t=o];console.log(s),e.WriteBuf=""}},this.Assigned=function(t){return null!=t&&null!=t&&(!rtl.isArray(t)||t.length>0)},t.$implcode=function(){e.WriteBuf="",e.WriteCallBack=null,e.valint=function(e,i,s,n){var r=0,o=0;if(""===e)return n.set(1),r;if(o=Number(e),isNaN(o)){var a=t.Copy(e,1,1);if("$"===a)o=Number("0x"+t.Copy$1(e,2));else if("&"===a)o=Number("0o"+t.Copy$1(e,2));else{if("%"!==a)return n.set(1),r;o=Number("0b"+t.Copy$1(e,2))}}return isNaN(o)||o!==t.Int(o)?n.set(1):o<i||o>s?n.set(2):(r=t.Trunc(o),n.set(0)),r}},t.$init=function(){rtl.exitcode=0}}),[]),rtl.module("RTLConsts",["System"],(function(){"use strict";this.$resourcestrings={SArgumentMissing:{org:'Missing argument in format "%s"'},SInvalidFormat:{org:'Invalid format specifier : "%s"'},SInvalidArgIndex:{org:'Invalid argument index in format: "%s"'},SListCapacityError:{org:"List capacity (%s) exceeded."},SListCountError:{org:"List count (%s) out of bounds."},SListIndexError:{org:"List index (%s) out of bounds"},SSortedListError:{org:"Operation not allowed on sorted list"},SDuplicateString:{org:"String list does not allow duplicates"},SErrFindNeedsSortedList:{org:"Cannot use find on unsorted list"},SInvalidName:{org:'Invalid component name: "%s"'},SInvalidBoolean:{org:'"%s" is not a valid boolean.'},SDuplicateName:{org:'Duplicate component name: "%s"'},SErrInvalidDate:{org:'Invalid date: "%s"'},SErrInvalidTimeFormat:{org:'Invalid time format: "%s"'},SInvalidDateFormat:{org:'Invalid date format: "%s"'},SCantReadPropertyS:{org:'Cannot read property "%s"'},SCantWritePropertyS:{org:'Cannot write property "%s"'},SErrPropertyNotFound:{org:'Unknown property: "%s"'},SIndexedPropertyNeedsParams:{org:'Indexed property "%s" needs parameters'},SErrInvalidInteger:{org:'Invalid integer value: "%s"'},SErrInvalidFloat:{org:'Invalid floating-point value: "%s"'},SInvalidCurrency:{org:"Invalid currency value: %s"},SErrInvalidTimeStamp:{org:'Invalid date/timestamp : "%s"'}}})),rtl.module("Types",["System"],(function(){"use strict";var t=this;this.TDirection={0:"FromBeginning",FromBeginning:0,1:"FromEnd",FromEnd:1},this.TDuplicates={0:"dupIgnore",dupIgnore:0,1:"dupAccept",dupAccept:1,2:"dupError",dupError:2},rtl.recNewT(this,"TPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TPoint",{});e.addField("x",rtl.longint),e.addField("y",rtl.longint)})),rtl.recNewT(this,"TRect",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this};var e=t.$rtti.$Record("TRect",{});e.addField("Left",rtl.longint),e.addField("Top",rtl.longint),e.addField("Right",rtl.longint),e.addField("Bottom",rtl.longint)})),this.Rect=function(e,i,s,n){var r=t.TRect.$new();return r.Left=e,r.Top=i,r.Right=s,r.Bottom=n,r},this.Point=function(e,i){var s=t.TPoint.$new();return s.x=e,s.y=i,s}})),rtl.module("JS",["System","Types"],(function(){"use strict";var t=this;rtl.createClass(this,"AsyncAttribute",pas.System.TCustomAttribute,(function(){})),this.$rtti.$ExtClass("TJSObject",{jsclass:"Object"}),this.JSDelete=function(t,e){return delete t[e]},this.isBoolean=function(t){return"boolean"==typeof t},this.isDate=function(t){return t instanceof Date},this.isInteger=function(t){return Math.floor(t)===t},this.isNull=function(t){return null===t},this.isUndefined=function(t){return null==t},this.toNumber=function(t){return t-0},this.toArray=function(t){return rtl.isArray(t)?t:null},this.toBoolean=function(e){return!!t.isBoolean(e)&&!(0==e)},this.ToString=function(t){return rtl.isString(t)?""+t:""},this.TJSValueType={0:"jvtNull",jvtNull:0,1:"jvtBoolean",jvtBoolean:1,2:"jvtInteger",jvtInteger:2,3:"jvtFloat",jvtFloat:3,4:"jvtString",jvtString:4,5:"jvtObject",jvtObject:5,6:"jvtArray",jvtArray:6},this.GetValueType=function(e){var i=0,s="";return t.isNull(e)?i=0:"string"===(s=typeof e)?i=4:"boolean"===s?i=1:"object"===s?i=rtl.isArray(e)?6:5:"number"===s&&(i=t.isInteger(e)?2:3),i}})),rtl.module("SysUtils",["System","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.FreeAndNil=function(t){var e=null;null!==(e=t.get())&&(t.set(null),e.$destroy("Destroy"))},this.FloatRecDigits=19,rtl.recNewT(this,"TFloatRec",(function(){this.Exponent=0,this.Negative=!1,this.$new=function(){var t=Object.create(this);return t.Digits=rtl.arraySetLength(null,"\0",19),t},this.$eq=function(t){return this.Exponent===t.Exponent&&this.Negative===t.Negative&&rtl.arrayEq(this.Digits,t.Digits)},this.$assign=function(t){return this.Exponent=t.Exponent,this.Negative=t.Negative,this.Digits=t.Digits.slice(0),this}})),this.$rtti.$DynArray("TBytes",{eltype:rtl.byte}),rtl.recNewT(this,"TFormatSettings",(function(){this.CurrencyDecimals=0,this.CurrencyFormat=0,this.CurrencyString="",this.DateSeparator="\0",this.DecimalSeparator="",this.LongDateFormat="",this.LongTimeFormat="",this.NegCurrFormat=0,this.ShortDateFormat="",this.ShortTimeFormat="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.TimeSeparator="\0",this.TwoDigitYearCenturyWindow=0,this.InitLocaleHandler=null,this.$new=function(){var t=Object.create(this);return t.DateTimeToStrFormat=rtl.arraySetLength(null,"",2),t.LongDayNames=rtl.arraySetLength(null,"",7),t.LongMonthNames=rtl.arraySetLength(null,"",12),t.ShortDayNames=rtl.arraySetLength(null,"",7),t.ShortMonthNames=rtl.arraySetLength(null,"",12),t},this.$eq=function(t){return this.CurrencyDecimals===t.CurrencyDecimals&&this.CurrencyFormat===t.CurrencyFormat&&this.CurrencyString===t.CurrencyString&&this.DateSeparator===t.DateSeparator&&rtl.arrayEq(this.DateTimeToStrFormat,t.DateTimeToStrFormat)&&this.DecimalSeparator===t.DecimalSeparator&&this.LongDateFormat===t.LongDateFormat&&rtl.arrayEq(this.LongDayNames,t.LongDayNames)&&rtl.arrayEq(this.LongMonthNames,t.LongMonthNames)&&this.LongTimeFormat===t.LongTimeFormat&&this.NegCurrFormat===t.NegCurrFormat&&this.ShortDateFormat===t.ShortDateFormat&&rtl.arrayEq(this.ShortDayNames,t.ShortDayNames)&&rtl.arrayEq(this.ShortMonthNames,t.ShortMonthNames)&&this.ShortTimeFormat===t.ShortTimeFormat&&this.ThousandSeparator===t.ThousandSeparator&&this.TimeAMString===t.TimeAMString&&this.TimePMString===t.TimePMString&&this.TimeSeparator===t.TimeSeparator&&this.TwoDigitYearCenturyWindow===t.TwoDigitYearCenturyWindow},this.$assign=function(t){return this.CurrencyDecimals=t.CurrencyDecimals,this.CurrencyFormat=t.CurrencyFormat,this.CurrencyString=t.CurrencyString,this.DateSeparator=t.DateSeparator,this.DateTimeToStrFormat=t.DateTimeToStrFormat.slice(0),this.DecimalSeparator=t.DecimalSeparator,this.LongDateFormat=t.LongDateFormat,this.LongDayNames=t.LongDayNames.slice(0),this.LongMonthNames=t.LongMonthNames.slice(0),this.LongTimeFormat=t.LongTimeFormat,this.NegCurrFormat=t.NegCurrFormat,this.ShortDateFormat=t.ShortDateFormat,this.ShortDayNames=t.ShortDayNames.slice(0),this.ShortMonthNames=t.ShortMonthNames.slice(0),this.ShortTimeFormat=t.ShortTimeFormat,this.ThousandSeparator=t.ThousandSeparator,this.TimeAMString=t.TimeAMString,this.TimePMString=t.TimePMString,this.TimeSeparator=t.TimeSeparator,this.TwoDigitYearCenturyWindow=t.TwoDigitYearCenturyWindow,this},this.GetJSLocale=function(){return Intl.DateTimeFormat().resolvedOptions().locale},this.GetLocaleDecimalSeparator=function(t){var e=1.1;return e=e.toLocaleString(t).substring(1,2)},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);return i.setDate(i.getDate()+t-1),i.toLocaleDateString(e,{weekday:"long"})},this.GetLocaleLongMonthName=function(t,e){return new Date(2017,t-1,1).toLocaleDateString(e,{month:"long"})},this.GetLocaleLongTimeFormat=function(e){var i="";return i="hh:nn:ss","EN-US"===t.UpperCase(e)&&(i="hh:nn:ss AMPM"),i};this.GetLocaleShortDateFormat=function(e){var i;t.TStringHelper.Empty,e=t.TStringHelper.ToLower.call({get:function(){return e},set:function(t){e=t}}),(i=t.TStringHelper.IndexOf.call({get:function(){return e},set:function(t){e=t}},"-"))>=0?e=t.TStringHelper.Substring$1.call({get:function(){return e},set:function(t){e=t}},0,i)+t.TStringHelper.ToUpper.call({a:t.TStringHelper.Substring.call({get:function(){return e},set:function(t){e=t}},i),get:function(){return this.a},set:function(t){this.a=t}}):2===t.TStringHelper.GetLength.call({get:function(){return e},set:function(t){e=t}})&&(e=e+"-"+t.TStringHelper.ToUpper.call({get:function(){return e},set:function(t){e=t}}));return{"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd.","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd.","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd-MM-yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"}[e]||"dd/MM/yyyy"},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleShortTimeFormat=function(e){var i="";return i="hh:nn","EN-US"===t.UpperCase(e)&&(i="h:nn AMPM"),i},this.Create=function(){var e=t.TFormatSettings.$new();return e.$assign(t.TFormatSettings.Create$1(t.TFormatSettings.GetJSLocale())),e};var i=["/",".","-"],s=[":",".","-"],n=[",","."],r=[".",","];this.Create$1=function(e){var o,a=t.TFormatSettings.$new(),l="",h=0;o=t.UpperCase(e),1===pas.System.Pos("DE",o)?(a.LongDayNames[0]="Sonntag",a.LongDayNames[1]="Montag",a.LongDayNames[2]="Dienstag",a.LongDayNames[3]="Mittwoch",a.LongDayNames[4]="Donnerstag",a.LongDayNames[5]="Freitag",a.LongDayNames[6]="Samstag",a.ShortDayNames[0]="Son",a.ShortDayNames[1]="Mon",a.ShortDayNames[2]="Die",a.ShortDayNames[3]="Mit",a.ShortDayNames[4]="Don",a.ShortDayNames[5]="Fre",a.ShortDayNames[6]="Sam",a.ShortMonthNames[0]="Jan",a.ShortMonthNames[1]="Feb",a.ShortMonthNames[2]="Mär",a.ShortMonthNames[3]="Apr",a.ShortMonthNames[4]="Mai",a.ShortMonthNames[5]="Jun",a.ShortMonthNames[6]="Jul",a.ShortMonthNames[7]="Aug",a.ShortMonthNames[8]="Sep",a.ShortMonthNames[9]="Okt",a.ShortMonthNames[10]="Nov",a.ShortMonthNames[11]="Dez",a.LongMonthNames[0]="Januar",a.LongMonthNames[1]="Februar",a.LongMonthNames[2]="März",a.LongMonthNames[3]="April",a.LongMonthNames[4]="Mai",a.LongMonthNames[5]="Juni",a.LongMonthNames[6]="Juli",a.LongMonthNames[7]="August",a.LongMonthNames[8]="September",a.LongMonthNames[9]="Oktober",a.LongMonthNames[10]="November",a.LongMonthNames[11]="Dezember"):1===pas.System.Pos("FR",t.UpperCase(e))?(a.LongDayNames[0]="Dimanche",a.LongDayNames[1]="Lundi",a.LongDayNames[2]="Mardi",a.LongDayNames[3]="Mecredi",a.LongDayNames[4]="Jeudi",a.LongDayNames[5]="Vendredi",a.LongDayNames[6]="Samedi",a.ShortDayNames[0]="Dim",a.ShortDayNames[1]="Lun",a.ShortDayNames[2]="Mar",a.ShortDayNames[3]="Mer",a.ShortDayNames[4]="Jeu",a.ShortDayNames[5]="Ven",a.ShortDayNames[6]="Sam",a.ShortMonthNames[0]="Jan",a.ShortMonthNames[1]="Fév",a.ShortMonthNames[2]="Mar",a.ShortMonthNames[3]="Avr",a.ShortMonthNames[4]="Mai",a.ShortMonthNames[5]="Jun",a.ShortMonthNames[6]="Jul",a.ShortMonthNames[7]="Aoû",a.ShortMonthNames[8]="Sep",a.ShortMonthNames[9]="Oct",a.ShortMonthNames[10]="Nov",a.ShortMonthNames[11]="Déc",a.LongMonthNames[0]="Janvier",a.LongMonthNames[1]="Février",a.LongMonthNames[2]="Mars",a.LongMonthNames[3]="Avril",a.LongMonthNames[4]="Mai",a.LongMonthNames[5]="Juin",a.LongMonthNames[6]="Juillet",a.LongMonthNames[7]="Août",a.LongMonthNames[8]="Septembre",a.LongMonthNames[9]="Octobre",a.LongMonthNames[10]="Novembre",a.LongMonthNames[11]="Décembre"):1===pas.System.Pos("ES",t.UpperCase(e))?(a.LongDayNames[0]="Domingo",a.LongDayNames[1]="Lunes",a.LongDayNames[2]="Martes",a.LongDayNames[3]="Miércoles",a.LongDayNames[4]="Jueves",a.LongDayNames[5]="Viernes",a.LongDayNames[6]="Sábado",a.ShortDayNames[0]="Dom",a.ShortDayNames[1]="Lun",a.ShortDayNames[2]="Mar",a.ShortDayNames[3]="Mié",a.ShortDayNames[4]="Jue",a.ShortDayNames[5]="Vie",a.ShortDayNames[6]="Sáb",a.ShortMonthNames[0]="Ene",a.ShortMonthNames[1]="Feb",a.ShortMonthNames[2]="Mar",a.ShortMonthNames[3]="Abr",a.ShortMonthNames[4]="May",a.ShortMonthNames[5]="Jun",a.ShortMonthNames[6]="Jul",a.ShortMonthNames[7]="Ago",a.ShortMonthNames[8]="Sep",a.ShortMonthNames[9]="Oct",a.ShortMonthNames[10]="Nov",a.ShortMonthNames[11]="Dic",a.LongMonthNames[0]="January",a.LongMonthNames[1]="Febrero",a.LongMonthNames[2]="Marzi",a.LongMonthNames[3]="Abril",a.LongMonthNames[4]="Mayo",a.LongMonthNames[5]="Junio",a.LongMonthNames[6]="Julio",a.LongMonthNames[7]="Agusto",a.LongMonthNames[8]="Septiembre",a.LongMonthNames[9]="Octubre",a.LongMonthNames[10]="Noviembre",a.LongMonthNames[11]="Diciembre"):(a.LongDayNames[0]="Sunday",a.LongDayNames[1]="Monday",a.LongDayNames[2]="Tuesday",a.LongDayNames[3]="Wednesday",a.LongDayNames[4]="Thursday",a.LongDayNames[5]="Friday",a.LongDayNames[6]="Saturday",a.ShortDayNames[0]="Sun",a.ShortDayNames[1]="Mon",a.ShortDayNames[2]="Tue",a.ShortDayNames[3]="Wed",a.ShortDayNames[4]="Thu",a.ShortDayNames[5]="Fri",a.ShortDayNames[6]="Sat",a.ShortMonthNames[0]="Jan",a.ShortMonthNames[1]="Feb",a.ShortMonthNames[2]="Mar",a.ShortMonthNames[3]="Apr",a.ShortMonthNames[4]="May",a.ShortMonthNames[5]="Jun",a.ShortMonthNames[6]="Jul",a.ShortMonthNames[7]="Aug",a.ShortMonthNames[8]="Sep",a.ShortMonthNames[9]="Oct",a.ShortMonthNames[10]="Nov",a.ShortMonthNames[11]="Dec",a.LongMonthNames[0]="January",a.LongMonthNames[1]="February",a.LongMonthNames[2]="March",a.LongMonthNames[3]="April",a.LongMonthNames[4]="May",a.LongMonthNames[5]="June",a.LongMonthNames[6]="July",a.LongMonthNames[7]="August",a.LongMonthNames[8]="September",a.LongMonthNames[9]="October",a.LongMonthNames[10]="November",a.LongMonthNames[11]="December"),a.DateTimeToStrFormat[0]="c",a.DateTimeToStrFormat[1]="f",a.DateSeparator="-",a.TimeSeparator=":",a.ShortDateFormat="yyyy-mm-dd",a.LongDateFormat="ddd, yyyy-mm-dd",a.DecimalSeparator=".",a.ThousandSeparator=",",a.TimeAMString="AM",a.TimePMString="PM",a.TwoDigitYearCenturyWindow=50,a.ShortTimeFormat=t.TFormatSettings.GetLocaleShortTimeFormat(e),a.LongTimeFormat=t.TFormatSettings.GetLocaleLongTimeFormat(e),a.ShortDateFormat=t.TFormatSettings.GetLocaleShortDateFormat(e);for(var u=0,d=rtl.length(i)-1;u<=d;u++)h=u,t.TStringHelper.IndexOf.call({p:a,get:function(){return this.p.ShortDateFormat},set:function(t){this.p.ShortDateFormat=t}},i[h])>=0&&(a.DateSeparator=i[h]);var F=new Date("Jan 1, 1980 06:07:08 GMT+00:00"),c="";c=""==e?navigator.language:e,l=F.toLocaleTimeString(c);for(var p=0,C=rtl.length(s)-1;p<=C;p++)h=p,t.TStringHelper.IndexOf.call({get:function(){return l},set:function(t){l=t}},s[h])>=0&&(a.TimeSeparator=s[h]);for(h=1;h<=7;h++)a.ShortDayNames[h-1]=t.TFormatSettings.GetLocaleShortDayName(h,e);for(h=1;h<=7;h++)a.LongDayNames[h-1]=t.TFormatSettings.GetLocaleLongDayName(h,e);for(h=1;h<=12;h++)a.ShortMonthNames[h-1]=t.TFormatSettings.GetLocaleShortMonthName(h,e);for(h=1;h<=12;h++)a.LongMonthNames[h-1]=t.TFormatSettings.GetLocaleLongMonthName(h,e);a.DecimalSeparator=t.TFormatSettings.GetLocaleDecimalSeparator(e);for(var S=0,m=rtl.length(n)-1;S<=m;S++)if(h=S,a.DecimalSeparator===n[h]){a.ThousandSeparator=r[h];break}return null!=t.TFormatSettings.InitLocaleHandler&&t.TFormatSettings.InitLocaleHandler(t.UpperCase(e),t.TFormatSettings.$clone(a)),a},this.Invariant=function(){var i=t.TFormatSettings.$new();return e.FInvariantCreated||(e.FInvariant.$assign(t.TFormatSettings.Create$1("EN-US")),e.FInvariant.CurrencyString="¤",e.FInvariant.CurrencyFormat=0,e.FInvariant.CurrencyDecimals=2,e.FInvariant.DateSeparator="/",e.FInvariant.TimeSeparator=":",e.FInvariant.ShortDateFormat="MM/dd/yyyy",e.FInvariant.LongDateFormat="dddd, dd MMMMM yyyy HH:mm:ss",e.FInvariant.TimeAMString="AM",e.FInvariant.TimePMString="PM",e.FInvariant.ShortTimeFormat="HH:mm",e.FInvariant.LongTimeFormat="HH:mm:ss",e.FInvariant.ShortMonthNames=e.DefaultShortMonthNames.slice(0),e.FInvariant.LongMonthNames=e.DefaultLongMonthNames.slice(0),e.FInvariant.ShortDayNames=e.DefaultShortDayNames.slice(0),e.FInvariant.LongDayNames=e.DefaultLongDayNames.slice(0),e.FInvariant.ThousandSeparator=",",e.FInvariant.DecimalSeparator=".",e.FInvariant.TwoDigitYearCenturyWindow=50,e.FInvariant.NegCurrFormat=0,e.FInvariantCreated=!0),i.$assign(e.FInvariant),i}}),!0),rtl.createClass(this,"Exception",pas.System.TObject,(function(){this.LogMessageOnCreate=!1,this.$init=function(){pas.System.TObject.$init.call(this),this.FMessage="",this.FJSError=null,this.FStack=void 0},this.$final=function(){this.FJSError=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMessage=t,this.FJSError=new Error(t),this.FStack=this.FJSError.stack,this.LogMessageOnCreate&&pas.System.Writeln("Created exception ",this.$classname," with message: ",t),this},this.CreateFmt=function(e,i){return this.Create$1(t.Format(e,i)),this}})),rtl.createClass(this,"EAbort",this.Exception,(function(){})),rtl.createClass(this,"EConvertError",this.Exception,(function(){})),rtl.createClass(this,"EVariantError",this.Exception,(function(){})),this.CharInSet=function(t,e){var i=!1,s=0;for(i=!1,s=rtl.length(e)-1;!i&&s>=0;)i=t===e[s],s-=1;return i},this.Trim=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"").replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,"")},this.TrimLeft=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"")},this.UpperCase=function(t){return t.toUpperCase()},this.LowerCase=function(t){return t.toLowerCase()},this.CompareStr=function(t,e){var i,s=t.length,n=e.length;return s<=n?t<(i=e.substr(0,s))?-1:t>i?1:s<n?-1:0:(i=t.substr(0,n))<e?-1:1},this.SameStr=function(t,e){return t==e},this.CompareText=function(t,e){var i=t.toLowerCase(),s=e.toLowerCase();return i>s?1:i<s?-1:0},this.SameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.AnsiSameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.Format=function(e,i){return t.Format$1(e,i,t.FormatSettings)},this.Format$1=function(i,s,n){var r="",o=0,a=0,l=0,h=0,u=0,d="",F="",c=0,p=0,C=0,S=!1,m=0;function f(){var t=0;function n(){var n=0,r=0;if(-1===t){for(a=o;o<=u&&i.charAt(o-1)<="9"&&i.charAt(o-1)>="0";)o+=1;if(o>u&&e.DoFormatError(1,i),"*"===i.charAt(o-1)){255===c?r=l:(r=c,c+=1),(o>a||r>rtl.length(s)-1)&&e.DoFormatError(1,i),l=r+1;var h=s[r].VType;0===h||19===h?t=s[r].VJSValue:e.DoFormatError(1,i),o+=1}else a<o?(pas.System.val(pas.System.Copy(i,a,o-a),{get:function(){return t},set:function(e){t=e}},{get:function(){return n},set:function(t){n=t}}),n>0&&e.DoFormatError(1,i)):t=-1}}return c=255,p=-1,C=-1,t=-1,o+=1,"%"===i.charAt(o-1)?"%":(":"!==i.charAt(o-1)?n():t=0,":"===i.charAt(o-1)&&(-1===t&&e.DoFormatError(2,i),c=t,t=-1,o+=1),"-"===i.charAt(o-1)?(S=!0,o+=1):S=!1,n(),-1!==t&&(p=t,t=-1),"."===i.charAt(o-1)&&(o+=1,n(),-1===t&&(t=0),C=t),pas.System.upcase(i.charAt(o-1)))}function y(t,n){var r=!1;return r=!1,l=(h=255===c?l:c)+1,h>rtl.length(s)-1||s[h].VType!==t?(n&&e.DoFormatError(3,i),l-=1,r):r=!0}for(r="",u=i.length,o=1,a=1,l=0;o<=u;){for(;o<=u&&"%"!==i.charAt(o-1);)o+=1;if(o>a&&(r+=pas.System.Copy(i,a,o-a)),o<u){var g=f();if("D"===g)(y(0,!1)||y(19,!0))&&(F=t.IntToStr(s[h].VJSValue)),p=Math.abs(p),c=C-F.length,"-"!==F.charAt(0)?F=pas.System.StringOfChar("0",c)+F:pas.System.Insert(pas.System.StringOfChar("0",c+1),{get:function(){return F},set:function(t){F=t}},2);else if("U"===g)y(0,!1)?F=t.IntToStr(s[h].VJSValue>>>0):y(19,!0)&&(F=t.IntToStr(s[h].VJSValue)),p=Math.abs(p),c=C-F.length,F=pas.System.StringOfChar("0",c)+F;else if("E"===g)y(12,!1)?F=t.FloatToStrF$1(s[h].VJSValue/1e4,2,3,C,n):y(3,!0)&&(F=t.FloatToStrF$1(s[h].VJSValue,2,3,C,n));else if("F"===g)y(12,!1)?F=t.FloatToStrF$1(s[h].VJSValue/1e4,0,9999,C,n):(y(0,!1)||y(3,!0))&&(F=t.FloatToStrF$1(s[h].VJSValue,0,9999,C,n));else if("G"===g)y(12,!1)?F=t.FloatToStrF$1(s[h].VJSValue/1e4,1,C,3,n):y(3,!0)&&(F=t.FloatToStrF$1(s[h].VJSValue,1,C,3,n));else if("N"===g)y(12,!1)?F=t.FloatToStrF$1(s[h].VJSValue/1e4,3,9999,C,n):y(3,!0)&&(F=t.FloatToStrF$1(s[h].VJSValue,3,9999,C,n));else if("M"===g)y(12,!1)?F=t.FloatToStrF$1(s[h].VJSValue/1e4,4,9999,C,n):y(3,!0)&&(F=t.FloatToStrF$1(s[h].VJSValue,4,9999,C,n));else if("S"===g)(y(18,!1)||y(9,!0))&&(d=s[h].VJSValue),c=d.length,-1!==C&&c>C&&(c=C),F=pas.System.Copy(d,1,c);else if("P"===g)y(0,!1)?F=t.IntToHex(s[h].VJSValue,8):y(0,!0)&&(F=t.IntToHex(s[h].VJSValue,16));else if("X"===g)if(y(0,!1)?(m=s[h].VJSValue,c=16):y(19,!0)&&(m=s[h].VJSValue,c=31),C>c)F=t.IntToHex(m,c);else{for(c=1;rtl.shl(1,4*c)<=m&&c<16;)c+=1;c>C&&(C=c),F=t.IntToHex(m,C)}else"%"===g&&(F="%");-1!==p&&F.length<p&&(S?F+=pas.System.StringOfChar(" ",p-F.length):F=pas.System.StringOfChar(" ",p-F.length)+F),r+=F}a=o+=1}return r},this.BytesOf=function(t){var e=[],i=0;e=rtl.arraySetLength(e,0,t.length);for(var s=0,n=t.length-1;s<=n;s++)e[i=s]=t.charCodeAt(i+1-1);return e},this.StringOf=function(t){var e="",i=0;e="";for(var s=0,n=rtl.length(t)-1;s<=n;s++)i=s,e+=String.fromCharCode(t[i]);return e};var i=rtl.createSet(null,65,90,null,97,122,95),s=rtl.unionSet(i,rtl.createSet(null,48,57));this.IsValidIdent=function(t,e,n){var r,o=!1,a=!1,l=0;if((r=t.length)<1)return!1;for(a=!0,o=!1,l=1;l<=r;){if(a){if(!(t.charCodeAt(l-1)in i))return o;a=!1}else if(e&&"."===t.charAt(l-1)){if(n){if(l>=r)return o;a=!0}}else if(!(t.charCodeAt(l-1)in s))return o;l+=1}return o=!0},this.TStringReplaceFlag={0:"rfReplaceAll",rfReplaceAll:0,1:"rfIgnoreCase",rfIgnoreCase:1},this.StringReplace=function(t,i,s,n){var r,o="";return o="",0 in n&&(o="g"),1 in n&&(o+="i"),r=i.replace(new RegExp(e.RESpecials,"g"),"\\$1"),t.replace(new RegExp(r,o),s)},this.QuoteString=function(e,i){return i+t.StringReplace(e,i,i+i,rtl.createSet(0))+i},this.QuotedStr=function(e,i){return t.QuoteString(e,i)},this.IntToStr=function(t){return""+t},this.TryStrToInt$2=function(i,s){return e.IntTryStrToInt(i,s,t.FormatSettings.DecimalSeparator)},this.TryStrToInt$3=function(t,i,s){return e.IntTryStrToInt(t,i,s.DecimalSeparator)},this.StrToIntDef=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToIntDef$1=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToInt=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.StrToInt64=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.TryStrToInt64=function(e,i){return t.TryStrToInt64$1(e,i,t.FormatSettings)},this.TryStrToInt64$1=function(e,i,s){var n,r=0;return(n=t.TryStrToInt$3(e,{get:function(){return r},set:function(t){r=t}},s))&&i.set(r),n},this.IntToHex=function(e,i){var s="";for(s="",e<0&&e<0&&(e=4294967295+e+1),s=e.toString(16),s=t.UpperCase(s);s.length<i;)s="0"+s;return s},this.TFloatFormat={0:"ffFixed",ffFixed:0,1:"ffGeneral",ffGeneral:1,2:"ffExponent",ffExponent:2,3:"ffNumber",ffNumber:3,4:"ffCurrency",ffCurrency:4};this.FloatToDecimal=function(e,i,s){var n=t.TFloatRec.$new(),r="",o="",a=0,l=0,h=0,u=0,d=0,F=!1,c=!1;for(n.Negative=!1,n.Exponent=0,d=0;d<=19;d++)n.Digits[d]="0";if(0===e)return n;for(h=1,u=(r=rtl.floatToStr(e,24)).length;" "===r.charAt(h-1);)h+=1;if(n.Negative="-"===r.charAt(h-1),(n.Negative||"+"===r.charAt(h-1))&&(h+=1),u>=h+2){if("Inf"===(o=pas.System.Copy(r,h,3)))return n.Digits[0]="\0",n.Exponent=32767,n;if("Nan"===o)return n.Digits[0]="\0",n.Exponent=-32768,n}for(a=0,n.Exponent=0,c=!0,F=!1;u>=h&&"E"!==r.charAt(h-1);)"."===r.charAt(h-1)?c=!1:(c?(n.Exponent+=1,n.Digits[a]=r.charAt(h-1),"0"!==r.charAt(h-1)&&(F=!0)):n.Digits[a]=r.charAt(h-1),a+=1),h+=1;for((h+=1)<=u&&(pas.System.val$6(pas.System.Copy(r,h,u-h+1),{get:function(){return d},set:function(t){d=t}},{get:function(){return l},set:function(t){l=t}}),n.Exponent+=d),h=a,u=19;h<u;)n.Digits[h]="0",h+=1;if((h=s+n.Exponent<i?s+n.Exponent:i)>=u&&(h=u-1),0===h)n.Digits[0]>="5"?(n.Digits[0]="1",n.Digits[1]="\0",n.Exponent+=1):n.Digits[0]="\0";else if(h>0)if(n.Digits[h]>="5"){do{n.Digits[h]="\0",h-=1,n.Digits[h]="123456789:".charAt(t.StrToInt(n.Digits[h])+1-1)}while(!(0===h||n.Digits[h]<":"));":"===n.Digits[0]&&(n.Digits[0]="1",n.Exponent+=1)}else for(n.Digits[h]="0";h>-1&&"0"===n.Digits[h];)n.Digits[h]="\0",h-=1;else n.Digits[0]="\0";return"\0"!==n.Digits[0]||F||(n.Exponent=0,n.Negative=!1),n},this.FloatToStr=function(e){return t.FloatToStr$1(e,t.FormatSettings)},this.FloatToStr$1=function(e,i){return t.FloatToStrF$1(e,1,15,0,i)},this.FloatToStrF=function(e,i,s,n){return t.FloatToStrF$1(e,i,s,n,t.FormatSettings)},this.FloatToStrF$1=function(t,i,s,n,r){var o,a,l="";a=r.DecimalSeparator,o=r.ThousandSeparator;var h=i;return 1===h?l=e.FormatGeneralFloat(t,s,a):2===h?l=e.FormatExponentFloat(t,s,n,a):0===h?l=e.FormatFixedFloat(t,n,a):3===h?l=e.FormatNumberFloat(t,n,a,o):4===h&&(l=e.FormatNumberCurrency(1e4*t,n,r)),4!==i&&l.length>1&&"-"===l.charAt(0)&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},a,o),l},this.TryStrToFloat$2=function(e,i){return t.TryStrToFloat$3(e,i,t.FormatSettings)};this.TryStrToFloat$3=function(e,i,s){var n,r,o=!1,a=0,l=0,h="",u=0;for(o=!1,h=e,""!==s.ThousandSeparator&&(h=t.StringReplace(h,s.ThousandSeparator,"",rtl.createSet(0))),"."!==s.DecimalSeparator&&(h=t.StringReplace(h,s.DecimalSeparator,".",{})),u=0,a=1,l=1,r=h.length;a<=r;){var d=h.charAt(a-1);if("+"===d||"-"===d){if(1===u)return o;if(0===u){if(a>l)return o}else if(2===u&&a>l+1)return o}else if(d>="0"&&d<="9");else if("."===d){if(0!==u)return o;u=1,l=a}else{if("E"!==d&&"e"!==d)return o;if(2===u)return o;u=2,l=a}a+=1}return n=parseFloat(h),(o=!isNaN(n))&&i.set(rtl.getNumber(n)),o},this.StrToFloatDef=function(e,i){var s=0;return t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},t.FormatSettings)||(s=i),s},this.StrToFloat=function(e){return t.StrToFloat$1(e,t.FormatSettings)},this.StrToFloat$1=function(e,i){var s=0;if(!t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},i))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidFloat"),pas.System.VarRecs(18,e)]);return s},this.FormatFloat=function(e,i){return t.FormatFloat$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))};this.FormatFloat$1=function(e,i,s){var n="",r=0,o=t.TFloatRec.$new(),a="",l=0,h=!1,u=!1,d=0,F=0,c=0,p=0,C=0,S=0,m=0,f=0,y=0;function g(t){n+=t}function T(t){n+=t}function E(t){"\0"!==t&&(-1===(y-=1)?(T(s.DecimalSeparator),g(t)):(g(t),h&&y%3==0&&y>1&&T(s.ThousandSeparator)))}function D(){var t="\0";return t="\0",m<=S?(t=o.Digits[m],m+=1):y<=c?y-=1:t="0",t}function b(){if(0===f)E(D());else if(f<0)f+=1,y<=F?E("0"):y-=1;else{for(;f>0;)E(D()),f-=1;E(D())}}function P(e,i){var s="";return s=t.IntToStr(i),s=pas.System.StringOfChar("0",C-s.length)+s,i<0?s="-"+s:i>0&&"+"===e&&(s=e+s),s}var L=0,v=0,B="\0",$="\0",G=[],A=!1;for(G=rtl.arraySetLength(G,0,4),n="",a="",l=0,h=!1,u=!1,d=0,F=2147483647,c=0,p=0,C=0,S=-1,v=(r=i)>0?1:r<0?2:3,G[0]=0,((L=function(i){var s,n=0,r=0,o="\0",a="\0",l=!1;for(n=1,i.get()[1]=-1,i.get()[2]=-1,i.get()[3]=-1,l=!1,a="\0",r=1,s=e.length;r<=s;){var h=o=e.charAt(r-1);if(";"===h){if(!l){if(n>3)throw t.Exception.$create("Create$1",["Invalid float format"]);i.get()[n]=r,n+=1}}else'"'!==h&&"'"!==h||(l?l=o!==a:(l=!0,a=o));r+=1}return-1===i.get()[n]&&(i.get()[n]=s+1),n}({get:function(){return G},set:function(t){G=t}}))<v||G[v]-G[v-1]==0)&&(v=1),l=G[v]-G[v-1]-1,a=pas.System.Copy(e,G[v-1]+1,l),a=rtl.strSetLength(a,l),function(){var t,e=0,i="\0",n="\0",r=!1;for(t=a.length,e=1,r=!1,i="\0";e<=t;){if((n=a.charAt(e-1)).charCodeAt()in rtl.createSet(34,39))r?r=n!==i:(r=!0,i=n);else if(!r){var o=n;if("."===o)0===d&&(d=p+1);else if(","===o)h="\0"!==s.ThousandSeparator;else if("e"===o||"E"===o){if((e+=1)<t){if(n=a.charAt(e-1),u=n.charCodeAt()in rtl.createSet(45,43))for(;e<t&&"0"===a.charAt(e+1-1);)C+=1,e+=1;C>4&&(C=4)}}else"#"===o?p+=1:"0"===o&&(p<F&&(F=p+1),c=(p+=1)+1)}e+=1}0===d&&(d=p+1),(c=d-c)>0&&(c=0),(F=d-F)<0&&(F=0)}(),function(){var e=0,s=0;for(u?(s=p,e=9999):(s=18,e=p-d+1),o.$assign(t.FloatToDecimal(i,s,e)),y=d-1,u?f=0:(f=o.Exponent-(d-1))>=0&&(y=o.Exponent),S=-1;S<18&&"\0"!==o.Digits[S+1];)S+=1}(),(0===l||o.Exponent>=18&&!u||2047===o.Exponent||2048===o.Exponent)&&(a=r.toPrecision(15),n=a),L=1,m=0,$=" ",A=!1,o.Negative&&1===v&&g("-");L<=l;){if((B=a.charAt(L-1)).charCodeAt()in rtl.createSet(34,39))A?A=B!==$:(A=!0,$=B);else if(A)g(B);else{var I=B;if("0"===I||"#"===I)b();else if("."===I||","===I);else if("e"===I||"E"===I){if(g(B),(L+=1)<=a.length&&(B=a.charAt(L-1)).charCodeAt()in rtl.createSet(43,45))for(T(P(B,o.Exponent-d+1));L<l&&"0"===a.charAt(L+1-1);)L+=1}else g(B)}L+=1}return n},this.TrueBoolStrs=[],this.FalseBoolStrs=[],this.StrToBool=function(e){var i=!1;if(!t.TryStrToBool(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidBoolean"),pas.System.VarRecs(18,e)]);return i},this.BoolToStr=function(i,s){var n="";return s?(e.CheckBoolStrs(),n=i?t.TrueBoolStrs[0]:t.FalseBoolStrs[0]):n=i?"-1":"0",n},this.StrToBoolDef=function(e,i){var s=!1;return t.TryStrToBool(e,{get:function(){return s},set:function(t){s=t}})||(s=i),s},this.TryStrToBool=function(i,s){var n,r=!1,o=0,a=0,l=0;if(n=t.UpperCase(i),pas.System.val$8(n,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),r=!0,0===l)s.set(0!==a);else{e.CheckBoolStrs();for(var h=0,u=rtl.length(t.TrueBoolStrs)-1;h<=u;h++)if(o=h,n===t.UpperCase(t.TrueBoolStrs[o]))return s.set(!0),r;for(var d=0,F=rtl.length(t.FalseBoolStrs)-1;d<=F;d++)if(o=d,n===t.UpperCase(t.FalseBoolStrs[o]))return s.set(!1),r;r=!1}return r},this.OnShowException=null,this.ShowException=function(i,s){var n="";n=rtl.getResStr(t,"SApplicationException")+i.$classname,t.Exception.isPrototypeOf(i)&&(n=n+" : "+i.FMessage),e.DoShowException(n)},this.Abort=function(){throw t.EAbort.$create("Create$1",[rtl.getResStr(t,"SAbortError")])},rtl.recNewT(this,"TTimeStamp",(function(){this.Time=0,this.Date=0,this.$eq=function(t){return this.Time===t.Time&&this.Date===t.Date},this.$assign=function(t){return this.Time=t.Time,this.Date=t.Date,this}})),this.TimeSeparator="\0",this.DateSeparator="\0",this.ShortDateFormat="",this.LongDateFormat="",this.ShortTimeFormat="",this.LongTimeFormat="",this.DecimalSeparator="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.HoursPerDay=24,this.MinsPerHour=60,this.SecsPerMin=60,this.MSecsPerSec=1e3,this.MinsPerDay=1440,this.SecsPerDay=86400,this.MSecsPerDay=864e5,this.MaxDateTime=2958465.99999999,this.JulianEpoch=-2415018.5,this.UnixEpoch=25569,this.DateDelta=693594,this.MonthDays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.MonthDays=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],this.ShortMonthNames=rtl.arraySetLength(null,"",12),this.LongMonthNames=rtl.arraySetLength(null,"",12),this.ShortDayNames=rtl.arraySetLength(null,"",7),this.LongDayNames=rtl.arraySetLength(null,"",7),this.FormatSettings=this.TFormatSettings.$new(),this.TwoDigitYearCenturyWindow=50,this.JSDateToDateTime=function(e){return t.EncodeDate(e.getFullYear(),e.getMonth()+1,e.getDate())+t.EncodeTime(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},this.DateTimeToTimeStamp=function(e){var i=t.TTimeStamp.$new(),s=0;return(s=864e5*e)<0?s-=.5:s+=.5,i.Time=pas.System.Trunc(Math.abs(pas.System.Trunc(s))%864e5),i.Date=693594+rtl.trunc(pas.System.Trunc(s)/864e5),i},this.TimeStampToDateTime=function(e){return t.ComposeDateTime(e.Date-693594,e.Time/864e5)},this.MSecsToTimeStamp=function(e){var i=t.TTimeStamp.$new();return i.Date=pas.System.Trunc(e/864e5),e-=864e5*i.Date,i.Time=Math.round(e),i},this.TimeStampToMSecs=function(t){return t.Time+864e5*t.Date},this.TryEncodeDate=function(e,i,s,n){var r,o=0,a=0;return(r=e>0&&e<1e4&&i>=1&&i<=12&&s>0&&s<=t.MonthDays[+t.IsLeapYear(e)][i-1])&&(i>2?i-=3:(i+=9,e-=1),a=e-100*(o=rtl.trunc(e/100)),n.set((146097*o>>>2)+(1461*a>>>2)+rtl.trunc((153*i+2)/5)+s),n.set(n.get()-693900)),r},this.TryEncodeTime=function(t,e,i,s,n){var r;return(r=t<24&&e<60&&i<60&&s<1e3)&&n.set((36e5*t+6e4*e+1e3*i+s)/864e5),r},this.EncodeDate=function(e,i,s){var n=0;if(!t.TryEncodeDate(e,i,s,{get:function(){return n},set:function(t){n=t}}))throw t.EConvertError.$create("CreateFmt",["%s-%s-%s is not a valid date specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s))]);return n},this.EncodeTime=function(e,i,s,n){var r=0;if(!t.TryEncodeTime(e,i,s,n,{get:function(){return r},set:function(t){r=t}}))throw t.EConvertError.$create("CreateFmt",["%s:%s:%s.%s is not a valid time specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s),18,t.IntToStr(n))]);return r},this.DecodeDate=function(e,i,s,n){var r=0,o=0,a=0,l=0;e<=-693594?(i.set(0),s.set(0),n.set(0)):(e>0?e+=1/1728e5:e-=1/1728e5,e>t.MaxDateTime&&(e=t.MaxDateTime),l=rtl.shl(pas.System.Trunc(e)+693900,2)-1,l-=146097*(r=rtl.trunc(l/146097)),o=rtl.lw(l>>>2),l=rtl.trunc((rtl.lw(o<<2)+3)/1461),o=rtl.lw(rtl.lw(o<<2)+7-1461*l>>>2),a=rtl.trunc((5*o-3)/153),o=rtl.trunc((5*o+2-153*a)/5),r=100*r+l,a<10?a+=3:(a-=9,r+=1),i.set(r),s.set(a),n.set(o))},this.DecodeTime=function(e,i,s,n,r){var o=0;o=t.DateTimeToTimeStamp(e).Time,i.set(rtl.trunc(o/36e5)),o%=36e5,s.set(rtl.trunc(o/6e4)),o%=6e4,n.set(rtl.trunc(o/1e3)),o%=1e3,r.set(o)},this.DecodeDateFully=function(e,i,s,n,r){return t.DecodeDate(e,i,s,n),r.set(t.DayOfWeek(e)),t.IsLeapYear(i.get())},this.ComposeDateTime=function(t,e){return t<0?pas.System.Trunc(t)-Math.abs(pas.System.Frac(e)):pas.System.Trunc(t)+Math.abs(pas.System.Frac(e))},this.Date=function(){return pas.System.Trunc(t.Now())},this.Time=function(){return t.Now()-t.Date()},this.Now=function(){return t.JSDateToDateTime(new Date)},this.DayOfWeek=function(t){var e=0;return(e=1+(pas.System.Trunc(t)-1)%7)<=0&&(e+=7),e},this.IsLeapYear=function(t){return t%4==0&&(t%100!=0||t%400==0)},this.DateToStr=function(e){return t.DateToStr$1(e,t.FormatSettings)},this.DateToStr$1=function(e,i){return t.FormatDateTime$1("ddddd",e,i)},this.StrToDate=function(e){return t.StrToDate$3(e,t.FormatSettings)},this.StrToDate$2=function(i,s,n){var r,o="";if(r=e.IntStrToDate({get:function(){return o},set:function(t){o=t}},i,s,n),""!==o)throw t.EConvertError.$create("Create$1",[o]);return r},this.StrToDate$3=function(e,i){return t.StrToDate$2(e,i.ShortDateFormat,i.DateSeparator)},this.TryStrToDate=function(e,i){return t.TryStrToDate$1(e,i,t.FormatSettings)},this.TryStrToDate$1=function(e,i,s){return t.TryStrToDate$3(e,i,s.ShortDateFormat,s.DateSeparator)},this.TryStrToDate$2=function(e,i,s){return t.TryStrToDate$3(e,i,t.FormatSettings.ShortDateFormat,s)},this.TryStrToDate$3=function(t,i,s,n){var r=!1,o="";return(r=0!==t.length)&&(i.set(e.IntStrToDate({get:function(){return o},set:function(t){o=t}},t,s,n)),r=""===o),r},this.StrToDateDef=function(e,i){return t.StrToDateDef$1(e,i,"\0")},this.StrToDateDef$1=function(e,i,s){var n=0;return t.TryStrToDate$2(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.TimeToStr=function(e){return t.TimeToStr$1(e,t.FormatSettings)},this.TimeToStr$1=function(e,i){return t.FormatDateTime$1("tt",e,i)},this.StrToTime=function(e){return t.StrToTime$2(e,t.FormatSettings)},this.StrToTime$2=function(i,s){var n,r="";if(n=e.IntStrToTime({get:function(){return r},set:function(t){r=t}},i,i.length,s),""!==r)throw t.EConvertError.$create("Create$1",[r]);return n},this.TryStrToTime$1=function(t,i,s){var n=!1,r="";return(n=0!==t.length)&&(i.set(e.IntStrToTime({get:function(){return r},set:function(t){r=t}},t,t.length,s)),n=""===r),n},this.TryStrToTime$2=function(e,i,s){var n=t.TFormatSettings.$new();return n.$assign(t.TFormatSettings.Create()),n.TimeSeparator=s,t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(n))},this.StrToTimeDef=function(e,i){return t.StrToTimeDef$1(e,i,"\0")},this.StrToTimeDef$1=function(e,i,s){var n=0;return t.TryStrToTime$2(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.DateTimeToStr=function(e,i){return t.DateTimeToStr$1(e,t.FormatSettings,i)},this.DateTimeToStr$1=function(i,s,n){return t.FormatDateTime$1(e.DateTimeToStrFormat[+n],i,s)},this.StrToDateTime=function(e){return t.StrToDateTime$1(e,t.FormatSettings)},this.StrToDateTime$1=function(i,s){var n=0,r="",o="",a=e.SplitDateTimeStr(i,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}},s);return 0===a?n=t.StrToDate(""):1===a?n=o.length>0?t.StrToDate$2(o,s.ShortDateFormat,s.DateSeparator):t.StrToTime(r):2===a&&(n=t.ComposeDateTime(t.StrToDate$2(o,s.ShortDateFormat,s.DateSeparator),t.StrToTime(r))),n},this.TryStrToDateTime=function(e,i){return t.TryStrToDateTime$1(e,i,t.FormatSettings)},this.TryStrToDateTime$1=function(e,i,s){var n=!1,r=0,o=0,a=0;if(n=!1,(r=pas.System.Pos(s.TimeSeparator,e))>0){for(;r>0&&" "!==e.charAt(r-1);)r-=1;if(r>0){if(!t.TryStrToDate$1(pas.System.Copy(e,1,r-1),{get:function(){return o},set:function(t){o=t}},s))return n;if(!t.TryStrToTime$1(pas.System.Copy(e,r+1,e.length-r),{get:function(){return a},set:function(t){a=t}},t.TFormatSettings.$clone(s)))return n;i.set(t.ComposeDateTime(o,a)),n=!0}else n=t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(s))}else n=t.TryStrToDate$1(e,i,s);return n},this.StrToDateTimeDef=function(e,i){return t.StrToDateTimeDef$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))},this.StrToDateTimeDef$1=function(e,i,s){var n=0;return t.TryStrToDateTime$1(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.FormatDateTime=function(e,i){return t.FormatDateTime$1(e,i,t.FormatSettings)},this.FormatDateTime$1=function(e,i,s){var n="";function r(t,e,i){n+=pas.System.Copy(t,e,i)}function o(t){n+=t}function a(e,i){var s="";for(s=t.IntToStr(e);s.length<i;)s="0"+s;o(s)}var l=0,h=0,u=0,d=0,F=0,c=0,p=0,C=0;function S(e,i,n){var m,f="\0",y="\0",g=0,T=!1,E=0,D=0,b=0;if(!(i>1)){for(b=1,m=e.length,T=!1,!1,D=1;D<=m;){var P=f=e.charAt(D-1);if("'"===P||'"'===P)for(D+=1;D<m&&e.charAt(D-1)!==f;)D+=1;else if(!("A"!==P&&"a"!==P||0!==t.CompareText(pas.System.Copy(e,D,3),"A/P")&&0!==t.CompareText(pas.System.Copy(e,D,4),"AMPM")&&0!==t.CompareText(pas.System.Copy(e,D,5),"AM/PM"))){T=!0;break}D+=1}for(f="ÿ",y=" ","H";b<=m;){g=1,D=b+1;var L=f=t.UpperCase(e.charAt(b-1)).charAt(0);if("'"===L||'"'===L){for(;D<m&&e.charAt(D-1)!==f;)D+=1;r(e,b+1,(g=(D+=1)-b)-2)}else if("A"===L)if(0===t.CompareText(pas.System.Copy(e,b,4),"AMPM"))g=4,o(F<12?s.TimeAMString:s.TimePMString);else if(0===t.CompareText(pas.System.Copy(e,b,5),"AM/PM"))g=5,r(e,F<12?b:b+3,2);else{if(0!==t.CompareText(pas.System.Copy(e,b,3),"A/P"))throw t.EConvertError.$create("Create$1",["Illegal character in format string"]);g=3,r(e,F<12?b:b+2,1)}else if("/"===L)o(s.DateSeparator);else if(":"===L)o(s.TimeSeparator);else if(" "===L||"C"===L||"D"===L||"H"===L||"M"===L||"N"===L||"S"===L||"T"===L||"Y"===L||"Z"===L||"F"===L){for(;D<=m&&t.UpperCase(e.charAt(D-1))===f;)D+=1;g=D-b;var v=f;if(" "===v)r(e,b,g);else if("Y"===v)g>2?a(l,4):a(l%100,2);else if("M"===v)if("H"===y||n)a(c,1===g?0:2);else{var B=g;1===B?a(h,0):2===B?a(h,2):o(3===B?s.ShortMonthNames[h-1]:s.LongMonthNames[h-1])}else if("D"===v){var $=g;1===$?a(u,0):2===$?a(u,2):3===$?o(s.ShortDayNames[d-1]):4===$?o(s.LongDayNames[d-1]):S(5===$?s.ShortDateFormat:s.LongDateFormat,i+1,!1)}else"H"===v?T?(0===(E=F%12)&&(E=12),a(E,1===g?0:2)):a(F,1===g?0:2):"N"===v?a(c,1===g?0:2):"S"===v?a(p,1===g?0:2):"Z"===v?a(C,1===g?0:3):"T"===v?S(1===g?s.ShortTimeFormat:s.LongTimeFormat,i+1,!0):"C"===v?(S(s.ShortDateFormat,i+1,!1),0===F&&0===c&&0===p||(o(" "),S(s.LongTimeFormat,i+1,!0))):"F"===v&&(S(s.ShortDateFormat,i+1,!1),o(" "),S(s.LongTimeFormat,i+1,!0));y,y=f}else o(f);b+=g}}}return t.DecodeDateFully(i,{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return d},set:function(t){d=t}}),t.DecodeTime(i,{get:function(){return F},set:function(t){F=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}}),S(""!==e?e:"C",0,!1),n},this.CurrencyFormat=0,this.NegCurrFormat=0,this.CurrencyDecimals=0,this.CurrencyString="",this.CurrToStr=function(e){return t.FloatToStrF$1(e/1e4,1,-1,0,t.FormatSettings)},this.StrToCurr=function(e){var i=0;if(!t.TryStrToCurr(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidCurrency"),pas.System.VarRecs(18,e)]);return i},this.TryStrToCurr=function(e,i){var s,n=0;return(s=t.TryStrToFloat$3(e,{get:function(){return n},set:function(t){n=t}},t.FormatSettings))&&i.set(rtl.trunc(1e4*n)),s},this.Supports$1=function(t,e,i){return null!==t&&0===t.QueryInterface(e,i)},this.TStringSplitOptions={0:"None",None:0,1:"ExcludeEmpty",ExcludeEmpty:1},rtl.createHelper(this,"TStringHelper",null,(function(){this.Empty="",this.GetLength=function(){return this.get().length},this.LowerCase=function(e){return t.LowerCase(e)},this.UpperCase=function(e){return t.UpperCase(e)},this.Contains=function(t){return""!==t&&pas.System.Pos(t,this.get())>0},this.IndexOf=function(e){return t.TStringHelper.IndexOf$4.call(this,e,0,t.TStringHelper.GetLength.call(this))},this.IndexOf$4=function(t,e,i){var s,n=0;return s=pas.System.Copy(this.get(),e+1,i),-1!==(n=pas.System.Pos(t,s)-1)&&(n+=e),n},this.IndexOf$5=function(t,e,i){var s,n=0;return s=pas.System.Copy(this.get(),e+1,i),-1!==(n=pas.System.Pos(t,s)-1)&&(n+=e),n},this.IndexOfUnQuoted=function(e,i,s,n){var r=0,o=0,a="";function l(t){var i=!1,s=0;s=1;do{i=a.charAt(t+s-1-1)===e.charAt(s-1),s+=1}while(i&&!(s>o));return i}var h=0,u=0,d=0;if(a=this.get(),r=-1,o=e.length,(u=t.TStringHelper.GetLength.call(this)-o+1)<0&&(u=0),h=n+1,d=0,i===s)for(;-1===r&&h<=u;)a.charAt(h-1)===i&&(d=1-d),0===d&&l(h)&&(r=h-1),h+=1;else for(;-1===r&&h<=u;)a.charAt(h-1)===i?d+=1:a.charAt(h-1)===s&&d>0&&(d-=1),0===d&&l(h)&&(r=h-1),h+=1;return r},this.IndexOfAny$3=function(e,i){return t.TStringHelper.IndexOfAny$5.call(this,e,i,t.TStringHelper.GetLength.call(this))},this.IndexOfAny$5=function(i,s,n){var r=0,o=0,a=0;for((a=(o=s+1)+n-1)>t.TStringHelper.GetLength.call(this)&&(a=t.TStringHelper.GetLength.call(this)),r=-1;-1===r&&o<=a;)e.HaveChar(this.get().charAt(o-1),i)&&(r=o-1),o+=1;return r},this.IndexOfAny$9=function(e,i,s,n){var r=0,o=0,a=0;r=-1;for(var l=0,h=rtl.length(e)-1;l<=h;l++)a=l,(o=t.TStringHelper.IndexOf$5.call(this,e[a],i,s))>=0&&(-1===r||o<r)&&(r=o,n.set(a));return r},this.IndexOfAnyUnquoted$1=function(e,i,s,n){return t.TStringHelper.IndexOfAnyUnquoted$2.call(this,e,i,s,n,t.TStringHelper.GetLength.call(this))},this.IndexOfAnyUnquoted$2=function(i,s,n,r,o){var a=0,l=0,h=0,u=0;if(a=-1,(h=r+o-1)>t.TStringHelper.GetLength.call(this)&&(h=t.TStringHelper.GetLength.call(this)),l=r+1,u=0,s===n)for(;-1===a&&l<=h;)this.get().charAt(l-1)===s&&(u=1-u),0===u&&e.HaveChar(this.get().charAt(l-1),i)&&(a=l-1),l+=1;else for(;-1===a&&l<=h;)this.get().charAt(l-1)===s?u+=1:this.get().charAt(l-1)===n&&u>0&&(u-=1),0===u&&e.HaveChar(this.get().charAt(l-1),i)&&(a=l-1),l+=1;return a},this.IndexOfAnyUnquoted$3=function(e,i,s,n,r){var o=0,a=0,l=0;o=-1;for(var h=0,u=rtl.length(e)-1;h<=u;h++)l=h,(a=t.TStringHelper.IndexOfUnQuoted.call(this,e[l],i,s,n))>=0&&(-1===o||a<o)&&(o=a,r.set(l));return o},this.Split$1=function(e){return t.TStringHelper.Split$21.call(this,e,"\0","\0",t.TStringHelper.GetLength.call(this)+1,0)},this.Split$5=function(e,i){return t.TStringHelper.Split$7.call(this,e,t.TStringHelper.GetLength.call(this)+1,i)},this.Split$7=function(e,i,s){return t.TStringHelper.Split$21.call(this,e,"\0","\0",i,s)},this.Split$8=function(e){return t.TStringHelper.Split$9.call(this,e,t.TStringHelper.GetLength.call(this)+1)},this.Split$9=function(e,i){return t.TStringHelper.Split$11.call(this,e,i,0)},this.Split$11=function(e,i,s){return t.TStringHelper.Split$26.call(this,e,"\0","\0",i,s)};this.Split$21=function(e,i,s,n,r){var o=[],a="";function l(n){return"\0"!==i?t.TStringHelper.IndexOfAnyUnquoted$1.call({get:function(){return a},set:function(t){a=t}},e,i,s,n):t.TStringHelper.IndexOfAny$3.call({get:function(){return a},set:function(t){a=t}},e,n)}function h(t){rtl.length(o)<=t&&(o=rtl.arraySetLength(o,"",rtl.length(o)+10))}var u=0,d=0,F=0,c="";for(a=this.get(),o=rtl.arraySetLength(o,"",10),F=0,d=0,u=l(0);-1!==u&&(0===n||F<n);)""===(c=t.TStringHelper.Substring$1.call(this,d,u-d))&&1===r||(h(F),o[F]=c,F+=1),u=l(d=u+1);return d<=t.TStringHelper.GetLength.call(this)&&(0===n||F<n)&&(""===(c=t.TStringHelper.Substring.call(this,d))&&1===r||(h(F),o[F]=c,F+=1)),o=rtl.arraySetLength(o,"",F)};this.Split$26=function(e,i,s,n,r){var o=this,a=[],l="";function h(n,r){return"\0"!==i?t.TStringHelper.IndexOfAnyUnquoted$3.call({get:function(){return l},set:function(t){l=t}},e,i,s,n,r):t.TStringHelper.IndexOfAny$9.call({get:function(){return l},set:function(t){l=t}},e,n,t.TStringHelper.GetLength.call(o),r)}function u(t){rtl.length(a)<=t&&(a=rtl.arraySetLength(a,"",rtl.length(a)+10))}var d=0,F=0,c=0,p=0,C="";for(l=o.get(),a=rtl.arraySetLength(a,"",10),c=0,F=0,d=h(0,{get:function(){return p},set:function(t){p=t}});-1!==d&&(0===n||c<n);)""===(C=t.TStringHelper.Substring$1.call(o,F,d-F))&&1===r||(u(c),a[c]=C,c+=1),d=h(F=d+e[p].length,{get:function(){return p},set:function(t){p=t}});return F<=t.TStringHelper.GetLength.call(o)&&(0===n||c<n)&&(""===(C=t.TStringHelper.Substring.call(o,F))&&1===r||(u(c),a[c]=C,c+=1)),a=rtl.arraySetLength(a,"",c)},this.StartsWith=function(e){return t.TStringHelper.StartsWith$1.call(this,e,!1)},this.StartsWith$1=function(e,i){var s,n=!1,r="";return(n=(s=e.length)<=0)||(n=(r=pas.System.Copy(this.get(),1,s)).length===s)&&(n=i?t.SameText(r,e):t.SameStr(r,e)),n},this.Substring=function(e){return t.TStringHelper.Substring$1.call(this,e,t.TStringHelper.GetLength.call(this)-e)},this.Substring$1=function(t,e){return pas.System.Copy(this.get(),t+1,e)},this.ToInteger$1=function(){return t.StrToInt(this.get())},this.ToLower=function(){return t.TStringHelper.LowerCase(this.get())},this.ToUpper=function(){return t.TStringHelper.UpperCase(this.get())},this.Trim=function(){return t.Trim(this.get())}})),rtl.createHelper(this,"TDoubleHelper",null,(function(){this.ToString$3=function(){return t.FloatToStr(this.get())}})),rtl.createHelper(this,"TIntegerHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),rtl.createHelper(this,"TNativeIntHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),t.$implcode=function(){e.DefaultShortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.DefaultLongMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],e.DefaultShortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.DefaultLongDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.FInvariant=t.TFormatSettings.$new(),e.FInvariantCreated=!1,e.DoShowException=function(e){null!=t.OnShowException?t.OnShowException(e):window.alert(e)},e.CheckBoolStrs=function(){0===rtl.length(t.TrueBoolStrs)&&(t.TrueBoolStrs=rtl.arraySetLength(t.TrueBoolStrs,"",1),t.TrueBoolStrs[0]="True"),0===rtl.length(t.FalseBoolStrs)&&(t.FalseBoolStrs=rtl.arraySetLength(t.FalseBoolStrs,"",1),t.FalseBoolStrs[0]="False")},e.feInvalidFormat=1,e.feMissingArgument=2,e.feInvalidArgIndex=3,e.DoFormatError=function(e,i){var s=e;if(1===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidFormat"),pas.System.VarRecs(18,i)]);if(2===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SArgumentMissing"),pas.System.VarRecs(18,i)]);if(3===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidArgIndex"),pas.System.VarRecs(18,i)])},e.maxdigits=15,e.ReplaceDecimalSep=function(t,e){var i;return(i=pas.System.Pos(".",t))>0?pas.System.Copy(t,1,i-1)+e+pas.System.Copy(t,i+1,t.length-i):t},e.FormatGeneralFloat=function(i,s,n){var r="",o=0,a=0,l=0,h=0;if((-1===s||s>15)&&(s=15),r=rtl.floatToStr(i,s+7),r=t.TrimLeft(r),0===(o=pas.System.Pos(".",r)))return r;if(0===(a=pas.System.Pos("E",r)))return r=e.ReplaceDecimalSep(r,n);for(l=a+2,h=0;l<=r.length;)h=10*h+r.charCodeAt(l-1)-48,l+=1;if("-"===r.charAt(a+1-1)&&(h=-h),o+h<a&&h>-6){if(r=rtl.strSetLength(r,a-1),h>=0){for(var u=0,d=h-1;u<=d;u++)l=u,r=rtl.setCharAt(r,o-1,r.charAt(o+1-1)),o+=1;for(r=rtl.setCharAt(r,o-1,"."),o=1,"-"===r.charAt(o-1)&&(o+=1);"0"===r.charAt(o-1)&&o<r.length&&pas.System.Copy(r,o+1,n.length)!==n;)pas.System.Delete({get:function(){return r},set:function(t){r=t}},o,1)}else pas.System.Insert(pas.System.Copy("00000",1,-h),{get:function(){return r},set:function(t){r=t}},o-1),r=rtl.setCharAt(r,o-h-1,r.charAt(o-h-1-1)),r=rtl.setCharAt(r,o-1,"."),-1!==h&&(r=rtl.setCharAt(r,o-h-1-1,"0"));for(l=r.length;l>0&&"0"===r.charAt(l-1);)l-=1;"."===r.charAt(l-1)&&(l-=1),r=0===l||1===l&&"-"===r.charAt(0)?"0":rtl.strSetLength(r,l)}else{for(;"0"===r.charAt(a-1-1);)pas.System.Delete({get:function(){return r},set:function(t){r=t}},a-1,1),a-=1;for(r.charAt(a-1-1)===n&&(pas.System.Delete({get:function(){return r},set:function(t){r=t}},a-1,1),a-=1),"+"===r.charAt(a+1-1)?pas.System.Delete({get:function(){return r},set:function(t){r=t}},a+1,1):a+=1;"0"===r.charAt(a+1-1);)pas.System.Delete({get:function(){return r},set:function(t){r=t}},a+1,1)}return r=e.ReplaceDecimalSep(r,n)},e.FormatExponentFloat=function(i,s,n,r){var o="",a=0;for(r=t.FormatSettings.DecimalSeparator,(-1===s||s>15)&&(s=15),o=rtl.floatToStr(i,s+7);" "===o.charAt(0);)pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,1);if(0===(a=pas.System.Pos("E",o)))return o=e.ReplaceDecimalSep(o,r);if(a+=2,n>4&&(n=4),(n=o.length-a-n+1)<0)pas.System.Insert(pas.System.Copy("0000",1,-n),{get:function(){return o},set:function(t){o=t}},a);else for(;n>0&&"0"===o.charAt(a-1);){if(pas.System.Delete({get:function(){return o},set:function(t){o=t}},a,1),a>o.length){pas.System.Delete({get:function(){return o},set:function(t){o=t}},a-2,2);break}n-=1}return o=e.ReplaceDecimalSep(o,r)},e.FormatFixedFloat=function(t,i,s){var n="";return-1===i?i=2:i>18&&(i=18),""!==(n=rtl.floatToStr(t,0,i))&&" "===n.charAt(0)&&pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,1),n=e.ReplaceDecimalSep(n,s)},e.FormatNumberFloat=function(t,i,s,n){var r="",o=0;if(-1===i?i=2:i>15&&(i=15),""!==(r=rtl.floatToStr(t,0,i))&&" "===r.charAt(0)&&pas.System.Delete({get:function(){return r},set:function(t){r=t}},1,1),(o=pas.System.Pos(".",r))<=0&&(o=r.length+1),r=e.ReplaceDecimalSep(r,s),o-=3,""!==n&&"\0"!==n)for(;o>1;)"-"!==r.charAt(o-1-1)&&pas.System.Insert(n,{get:function(){return r},set:function(t){r=t}},o),o-=3;return r},e.RemoveLeadingNegativeSign=function(t,e,i){var s,n=!1,r=0;n=!1,s=i;for(var o=2,a=t.get().length;o<=a&&(r=o,n=t.get().charCodeAt(r-1)in rtl.createSet(48,e.charCodeAt(),69,43)||t.get().charAt(r-1)===s);o++);return n&&"-"===t.get().charAt(0)&&pas.System.Delete(t,1,1),n},e.FormatNumberCurrency=function(t,i,s){var n,r,o,a,l="",h=0;if(o=s.DecimalSeparator,a=s.ThousandSeparator,r=s.CurrencyString,-1===i?i=s.CurrencyDecimals:i>18&&(i=18),(n="-"===(l=rtl.floatToStr(t/1e4,0,i)).charAt(0))&&pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,1),h=pas.System.Pos(".",l),""!==a)for(0!==h?l=e.ReplaceDecimalSep(l,o):h=l.length+1,h-=3;h>1;)pas.System.Insert(a,{get:function(){return l},set:function(t){l=t}},h),h-=3;if(n&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},o,a),n){var u=s.NegCurrFormat;0===u?l="("+r+l+")":1===u?l="-"+r+l:2===u?l=r+"-"+l:3===u?l=r+l+"-":4===u?l="("+l+r+")":5===u?l="-"+l+r:6===u?l=l+"-"+r:7===u?l=l+r+"-":8===u?l="-"+l+" "+r:9===u?l="-"+r+" "+l:10===u?l=l+" "+r+"-":11===u?l=r+" "+l+"-":12===u?l=r+" -"+l:13===u?l=l+"- "+r:14===u?l="("+r+" "+l+")":15===u&&(l="("+l+" "+r+")")}else{var d=s.CurrencyFormat;0===d?l=r+l:1===d?l+=r:2===d?l=r+" "+l:3===d&&(l=l+" "+r)}return l},e.RESpecials="([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])",e.DateTimeToStrFormat=["c","f"];e.IntStrToDate=function(e,i,s,n){var r=0;function o(i){e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SInvalidDateFormat"),pas.System.VarRecs(18,i)))}var a="",l=0,h=0,u=0,d=0,F=0,c=0,p=0,C=0,S=0,m=0,f=0,y=0,g=0,T=0,E="",D=[],b=!1;for(D=rtl.arraySetLength(D,0,4),r=0,S=i.length,e.set("");S>0&&pas.System.Pos(i.charAt(S-1)," \b\t\n\f\r")>0;)S-=1;if(0===S)return o(i),r;for(b=!1,"\0"===n&&(n="\0"!==t.FormatSettings.DateSeparator?t.FormatSettings.DateSeparator:"-"),a=t.UpperCase(s),g=0,y=0,f=0,T=0,C=0;C<a.length&&T<3;){C+=1;var P=a.charAt(C-1);"Y"===P?0===g&&(g=T+=1):"M"===P?0===y&&(y=T+=1):"D"===P&&0===f&&(f=T+=1)}for(C=1;C<=3;C++)D[C]=0;E="",p=0;for(var L=1,v=S;L<=v;L++)if(C=L,pas.System.Pos(i.charAt(C-1),"0123456789")>0&&(E+=i.charAt(C-1))," "===n||" "!==i.charAt(C-1))if(i.charAt(C-1)===n||C===S&&pas.System.Pos(i.charAt(C-1),"0123456789")>0){if((p+=1)>3)return o(i),r;if(p===g&&E.length>2&&(b=!0),pas.System.val$6(E,{a:p,p:D,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}},{get:function(){return m},set:function(t){m=t}}),0!==m)return o(i),r;E=""}else if(0===pas.System.Pos(i.charAt(C-1),"0123456789"))return o(i),r;return T<3&&p>T?(o(i),r):(t.DecodeDate(t.Date(),{get:function(){return d},set:function(t){d=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return F},set:function(t){F=t}}),3===p?(u=D[g],h=D[y],l=D[f]):(u=d,p<2?(l=D[1],h=c):f<y?(l=D[1],h=D[2]):(l=D[2],h=D[1])),u>=0&&u<100&&!b&&(d-=t.TwoDigitYearCenturyWindow,u+=100*rtl.trunc(d/100),t.TwoDigitYearCenturyWindow>0&&u<d&&(u+=100)),t.TryEncodeDate(u,h,l,{get:function(){return r},set:function(t){r=t}})||e.set(rtl.getResStr(pas.RTLConsts,"SErrInvalidDate")),r)};e.IntStrToTime=function(e,i,s,n){var r=0,o=0,a=[];return a=rtl.arraySetLength(a,0,4),o=0,function(e,r){var o=!1,a=0,l=0,h=0,u=0,d=0,F=0,c=0,p=!1,C=!1,S="",m="\0",f=0,y="";for(o=!1,r.set(0),C=!1,d=0,f=0;f<=3;f++)e.get()[f]=0;for(a=1;a<s&&" "===i.charAt(a-1);)a+=1;if(l=a,a>s-1||i.charAt(a-1)===n.TimeSeparator||i.charAt(a-1)===n.DecimalSeparator)return o;for(p=pas.System.Pos(i.charAt(a-1),"0123456789")>0;a<=s;){if(m=i.charAt(a-1),pas.System.Pos(m,"0123456789")>0){if(!p||d>3)return o;for(l=a,F="0"!==m?l:-1;a<s&&pas.System.Pos(i.charAt(a+1-1),"0123456789")>0;)-1===F&&"0"!==i.charAt(a-1)&&(F=a),a+=1;if(-1===F&&(F=a),!((h=1+a-F)<=2||h<=3&&3===d))return o;pas.System.val$6(pas.System.Copy(i,F,h),{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}}),e.get()[d]=c,d+=1,p=!1}else if(" "===m);else if(m===n.TimeSeparator){if(p||d>2)return o;p=!0,C=!1}else if(m===n.DecimalSeparator){if(p||C||3!==d)return o;p=!0,C=!0}else{if(0!==r.get()||p)return o;for(l=a,y=n.DecimalSeparator+" ","\0"!==n.TimeSeparator&&(y+=n.TimeSeparator);a<s&&0===pas.System.Pos(i.charAt(a+1-1),y)&&0===pas.System.Pos(i.charAt(a+1-1),"0123456789");)a+=1;if(h=1+a-l,S=pas.System.Copy(i,l,h),0===t.CompareText(S,n.TimeAMString))r.set(1);else if(0===t.CompareText(S,n.TimePMString))r.set(2);else if(0===t.CompareText(S,"AM"))r.set(1);else{if(0!==t.CompareText(S,"PM"))return o;r.set(2)}0===d?p=!0:(d=4,p=!1)}a+=1}return 0===d||0!==r.get()&&(e.get()[0]>12||0===e.get()[0])||p?o:o=!0}({get:function(){return a},set:function(t){a=t}},{get:function(){return o},set:function(t){o=t}})?(2===o&&12!==a[0]?a[0]+=12:1===o&&12===a[0]&&(a[0]=0),t.TryEncodeTime(a[0],a[1],a[2],a[3],{get:function(){return r},set:function(t){r=t}})||e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),r):(e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),r)};e.SplitDateTimeStr=function(e,i,s,n){var r=0,o=0,a=0;if(r=0,i.set(""),s.set(""),0===(e=t.Trim(e)).length)return r;if(" "===n.DateSeparator&&" "===n.TimeSeparator&&pas.System.Pos(" ",e)>0)return i.set(e),1;if(o=1," "!==n.DateSeparator)for(;o<e.length&&!(pas.System.Pos(e.charAt(o+1-1),"\t\n\r ")>0);)o+=1;else if(0!==(o=pas.System.Pos(n.TimeSeparator,e)))do{o-=1}while(!(0===o||pas.System.Pos(e.charAt(o-1),"\t\n\r ")>0));return 0===o&&(o=e.length),i.set(pas.System.Copy(e,1,o)),s.set(t.Trim(pas.System.Copy(e,o+1,100))),0!==s.get().length?r=2:(r=1,(n.DateSeparator!==n.TimeSeparator&&pas.System.Pos(n.TimeSeparator,i.get())>0||n.DateSeparator===n.TimeSeparator&&!t.TryStrToDate(i.get(),{get:function(){return a},set:function(t){a=t}}))&&(s.set(i.get()),i.set(""))),r},e.IntTryStrToInt=function(e,i,s){var n,r,o=10,a="";if(a=e,0!==pas.System.Pos(s,a)||0!==pas.System.Pos(".",a)||0!==pas.System.Pos(":",a)||pas.System.Pos("-",a)>1)return!1;var l=pas.System.Copy(a,1,1);return"$"===l?o=16:"&"===l?o=8:"%"===l&&(o=2),(16===o||0===pas.System.Pos("e",t.LowerCase(a)))&&(10!==o&&pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,1),r=parseInt(a,o),(n=!isNaN(r))&&i.set(rtl.trunc(r)),n)},e.InitGlobalFormatSettings=function(){t.FormatSettings.$assign(t.TFormatSettings.Create()),t.TimeSeparator=t.FormatSettings.TimeSeparator,t.DateSeparator=t.FormatSettings.DateSeparator,t.ShortDateFormat=t.FormatSettings.ShortDateFormat,t.LongDateFormat=t.FormatSettings.LongDateFormat,t.ShortTimeFormat=t.FormatSettings.ShortTimeFormat,t.LongTimeFormat=t.FormatSettings.LongTimeFormat,t.DecimalSeparator=t.FormatSettings.DecimalSeparator,t.ThousandSeparator=t.FormatSettings.ThousandSeparator,t.TimeAMString=t.FormatSettings.TimeAMString,t.TimePMString=t.FormatSettings.TimePMString,t.CurrencyFormat=t.FormatSettings.CurrencyFormat,t.NegCurrFormat=t.FormatSettings.NegCurrFormat,t.CurrencyDecimals=t.FormatSettings.CurrencyDecimals,t.CurrencyString=t.FormatSettings.CurrencyString},e.HaveChar=function(t,e){var i=!1,s=0;for(s=0,i=!1;!i&&s<rtl.length(e);)i=e[s]===t,s+=1;return i},t.$resourcestrings={SAbortError:{org:"Operation aborted"},SApplicationException:{org:"Application raised an exception: "}}},t.$init=function(){e.InitGlobalFormatSettings(),t.ShortMonthNames=e.DefaultShortMonthNames.slice(0),t.LongMonthNames=e.DefaultLongMonthNames.slice(0),t.ShortDayNames=e.DefaultShortDayNames.slice(0),t.LongDayNames=e.DefaultLongDayNames.slice(0)}}),[]),rtl.module("TypInfo",["System","SysUtils","Types","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.pfGetFunction=1,this.pfSetProcedure=2,this.pfHasIndex=16,rtl.createClass(this,"EPropertyError",pas.SysUtils.Exception,(function(){})),this.GetPropInfo=function(t,e){var i=null,s=null,n=0,r=null;for(r=t;null!==r;){if(s=r.members[e],rtl.isExt(s,rtl.tTypeMemberProperty))return s;if(!rtl.isExt(r,rtl.tTypeInfoClass))break;r=r.ancestor}i=null;do{for(var o=0,a=t.properties.length-1;o<=a;o++)if(n=o,0===pas.SysUtils.CompareText(e,t.properties[n]))return s=t.members[t.properties[n]],rtl.isExt(s,rtl.tTypeMemberProperty)&&(i=s),i;if(!rtl.isExt(t,rtl.tTypeInfoClass))break;t=t.ancestor}while(null!==t);return i},this.FindPropInfo=function(e,i){var s;if(null===(s=t.GetPropInfo(e.$rtti,i)))throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrPropertyNotFound"),pas.System.VarRecs(18,i)]);return s},this.GetJSValueProp$1=function(i,s){var n=void 0,r=e.GetPropGetterKind(s);if(0===r)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantReadPropertyS"),pas.System.VarRecs(18,s.name)]);if(1===r)n=i[s.getter];else if(2===r)n=(16&s.flags)>0?i[s.getter](s.index):i[s.getter]();else if(3===r)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)]);return n},this.GetJSValueProp$3=function(e,i){return t.GetJSValueProp$1(e,i)},this.SetJSValueProp$1=function(i,s,n){var r=e.GetPropSetterKind(s);if(0===r)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantWritePropertyS"),pas.System.VarRecs(18,s.name)]);if(1===r)i[s.setter]=n;else if(2===r)(16&s.flags)>0?i[s.setter](s.index,n):i[s.setter](n);else if(3===r)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)])},this.SetJSValueProp$3=function(e,i,s){t.SetJSValueProp$1(e,i,s)},this.GetOrdProp$1=function(e,i){var s=0,n="",r=0,o=void 0;if(5===i.typeinfo.kind)for(n in s=0,t.GetJSValueProp$3(e,i))(r=parseInt(n,10))<32&&(s+=1<<r);else 2===i.typeinfo.kind?(o=t.GetJSValueProp$3(e,i),s=rtl.isNumber(o)?rtl.trunc(o):""===(n=""+o)?0:n.charCodeAt(0)):s=rtl.trunc(t.GetJSValueProp$3(e,i));return s},this.GetEnumName=function(t,e){return t.enumtype[e]},this.SetMethodProp=function(e,i,s){var n,r=null;r=null===(n=s.Code)?null:rtl.isFunction(n)?n.scope===s.Data&&(rtl.isFunction(n.fn)||rtl.isString(n.fn))?n:rtl.isString(n.fn)?rtl.createCallback(s.Data,""+n.fn):rtl.createCallback(s.Data,n):rtl.createCallback(s.Data,n),t.SetJSValueProp$3(e,i,r)},this.SetMethodProp$1=function(e,i,s){t.SetMethodProp(e,t.FindPropInfo(e,i),s)},t.$implcode=function(){e.TGetterKind={0:"gkNone",gkNone:0,1:"gkField",gkField:1,2:"gkFunction",gkFunction:2,3:"gkFunctionWithParams",gkFunctionWithParams:3},e.GetPropGetterKind=function(t){return""===t.getter?0:(1&t.flags)>0?rtl.length(t.params)>0?3:2:1},e.TSetterKind={0:"skNone",skNone:0,1:"skField",skField:1,2:"skProcedure",skProcedure:2,3:"skProcedureWithParams",skProcedureWithParams:3},e.GetPropSetterKind=function(t){return""===t.setter?0:(2&t.flags)>0?rtl.length(t.params)>0?3:2:1}}}),[]),rtl.module("Web",["System","Types","JS"],(function(){"use strict";rtl.createClassExt(this,"TJSFocusEvent",Event,"",(function(){this.$init=function(){},this.$final=function(){}})),this.$rtti.$ExtClass("TJSHTMLElement",{ancestor:this.$rtti.TJSElement,jsclass:"HTMLElement"}),this.$rtti.$ExtClass("TJSXMLHttpRequest",{ancestor:this.$rtti.TJSXMLHttpRequestEventTarget,jsclass:"XMLHttpRequest"}),rtl.createClass(this,"TJSKeyNames",pas.System.TObject,(function(){this.Alt="Alt",this.CapsLock="CapsLock",this.Control="Control",this.Shift="Shift",this.Enter="Enter",this.Tab="Tab",this.ArrowDown="ArrowDown",this.ArrowLeft="ArrowLeft",this.ArrowRight="ArrowRight",this.ArrowUp="ArrowUp",this._End="End",this.Home="Home",this.PageDown="PageDown",this.PageUp="PageUp",this.BackSpace="Backspace",this.Delete="Delete",this.Insert="Insert",this.Escape="Escape",this.Pause="Pause",this.F1="F1",this.F2="F2",this.F3="F3",this.F4="F4",this.F5="F5",this.F6="F6",this.F7="F7",this.F8="F8",this.F9="F9",this.F10="F10",this.F11="F11",this.F12="F12",this.F13="F13",this.F14="F14",this.F15="F15",this.F16="F16",this.F17="F17",this.F18="F18",this.F19="F19",this.F20="F20"}))})),rtl.module("Classes",["System","RTLConsts","Types","SysUtils","JS","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),rtl.createClass(this,"EListError",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"EStringListError",this.EListError,(function(){})),rtl.createClass(this,"EComponentError",pas.SysUtils.Exception,(function(){})),this.TAlignment={0:"taLeftJustify",taLeftJustify:0,1:"taRightJustify",taRightJustify:1,2:"taCenter",taCenter:2},this.$rtti.$Enum("TAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TAlignment}),rtl.createClass(this,"TFPList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=[],this.FCount=0,this.FCapacity=0},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]},this.Put=function(t,e){(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]=e},this.SetCapacity=function(t){t<this.FCount&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),""+t),t!==this.FCapacity&&(this.FList=rtl.arraySetLength(this.FList,void 0,t),this.FCapacity=t)},this.SetCount=function(t){t<0&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCountError"),""+t),t>this.FCount&&t>this.FCapacity&&this.SetCapacity(t),this.FCount=t},this.RaiseIndexError=function(t){this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t)},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return this.FCount===this.FCapacity&&this.Expand(),this.FList[this.FCount]=t,e=this.FCount,this.FCount+=1,e},this.Clear=function(){rtl.length(this.FList)>0&&(this.SetCount(0),this.SetCapacity(0))},this.Delete=function(t){(t<0||t>=this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FCount=this.FCount-1,this.FList.splice(t,1),this.FCapacity-=1},this.Error=function(e,i){throw t.EListError.$create("CreateFmt",[e,pas.System.VarRecs(18,i)])},this.Expand=function(){var t=0;return this.FCount<this.FCapacity||(t=4,this.FCapacity>3&&(t+=4),this.FCapacity>8&&(t+=8),this.FCapacity>127&&(t+=this.FCapacity>>>2),this.SetCapacity(this.FCapacity+t),this),this},this.IndexOf=function(t){var e,i=0;for(i=0,e=this.FCount;i<e&&this.FList[i]!=t;)i+=1;return i>=e&&(i=-1),i},this.IndexOfItem=function(t,e){var i=0;if(0===e)i=this.IndexOf(t);else for(i=this.FCount-1;i>=0&&this.FList[i]!=t;)i-=1;return i},this.Insert=function(t,e){(t<0||t>this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FList.splice(t,0,e),this.FCapacity+=1,this.FCount+=1},this.Last=function(){return 0===this.FCount?null:this.Get(this.FCount-1)},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),this.TListNotification={0:"lnAdded",lnAdded:0,1:"lnExtracted",lnExtracted:1,2:"lnDeleted",lnDeleted:2},rtl.createClass(this,"TList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return this.FList.Get(t)},this.Put=function(t,e){var i;i=this.Get(t),this.FList.Put(t,e),pas.System.Assigned(i)&&this.Notify(i,2),pas.System.Assigned(e)&&this.Notify(e,0)},this.Notify=function(t,e){pas.System.Assigned(t)},this.GetCount=function(){return this.FList.FCount},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=t.TFPList.$create("Create"),this},this.Destroy=function(){null!=this.FList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FList},set:function(t){this.p.FList=t}})},this.Add=function(t){var e;return e=this.FList.Add(t),pas.System.Assigned(t)&&this.Notify(t,0),e},this.Clear=function(){for(;this.FList.FCount>0;)this.Delete(this.GetCount()-1)},this.Delete=function(t){var e;e=this.FList.Get(t),this.FList.Delete(t),pas.System.Assigned(e)&&this.Notify(e,2)},this.IndexOf=function(t){return this.FList.IndexOf(t)},this.Insert=function(t,e){this.FList.Insert(t,e),pas.System.Assigned(e)&&this.Notify(e,0)},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),rtl.createClass(this,"TPersistent",pas.System.TObject,(function(){this.AssignError=function(t){var e="";throw e=null!==t?t.$classname:"Nil",pas.SysUtils.EConvertError.$create("Create$1",["Cannot assign a "+e+" to a "+this.$classname+"."])},this.AssignTo=function(t){t.AssignError(this)},this.GetOwner=function(){return null,null},this.Assign=function(t){null!==t?t.AssignTo(this):this.AssignError(null)},this.SetEvent=function(t,e,i){this.SetEvent$1(this,t,e,i)},this.SetEvent$1=function(t,e,i,s){var n=pas.System.TMethod.$new();n.Code=e.$class.MethodAddress(s),null!=n.Code&&(n.Data=e,pas.TypInfo.SetMethodProp$1(t,i,n))}})),rtl.createClass(this,"TStrings",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FSpecialCharsInited=!1,this.FAlwaysQuote=!1,this.FQuoteChar="\0",this.FDelimiter="\0",this.FNameValueSeparator="\0",this.FUpdateCount=0,this.FLBS=0,this.FSkipLastLineBreak=!1,this.FStrictDelimiter=!1,this.FLineBreak=""},this.GetValue=function(t){var e,i="",s="";return i="",-1!==(e=this.IndexOfName(t))&&this.GetNameValue(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}}),i},this.SetDelimiter=function(t){this.CheckSpecialChars(),this.FDelimiter=t},this.DoSetTextStr=function(t,e){var i="",s=0;try{for(this.BeginUpdate(),e&&this.Clear(),s=1;this.GetNextLinebreak(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}});)this.Add(i)}finally{this.EndUpdate()}},this.GetNameValueSeparator=function(){return this.CheckSpecialChars(),this.FNameValueSeparator},this.SetLineBreak=function(t){this.CheckSpecialChars(),this.FLineBreak=t},this.GetSkipLastLineBreak=function(){return this.CheckSpecialChars(),this.FSkipLastLineBreak},this.SetSkipLastLineBreak=function(t){this.CheckSpecialChars(),this.FSkipLastLineBreak=t},this.Error=function(e,i){throw t.EStringListError.$create("CreateFmt",[e,pas.System.VarRecs(18,pas.SysUtils.IntToStr(i))])},this.GetCapacity=function(){return this.GetCount()},this.GetObject=function(t){return null,null},this.GetTextStr=function(){var t="",e=0,i="";if(this.CheckSpecialChars(),this.FLineBreak!==pas.System.sLineBreak)i=this.FLineBreak;else{var s=this.FLBS;0===s?i="\n":1===s?i="\r\n":2===s&&(i="\r")}t="";for(var n=0,r=this.GetCount()-1;n<=r;n++)e=n,t+=this.Get(e),(e<this.GetCount()-1||!this.GetSkipLastLineBreak())&&(t+=i);return t},this.Put=function(t,e){var i;i=this.GetObject(t),this.Delete(t),this.InsertObject(t,e,i)},this.PutObject=function(t,e){},this.SetTextStr=function(t){this.CheckSpecialChars(),this.DoSetTextStr(t,!0)},this.SetUpdateState=function(t){},this.DoCompareText=function(t,e){return pas.SysUtils.CompareText(t,e)},this.SetDelimitedText=function(t){var e=0,i=0,s=!1;this.CheckSpecialChars(),this.BeginUpdate(),e=1,i=1,s=!1;try{if(this.Clear(),this.FStrictDelimiter)for(;e<=t.length;){if(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1),e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");s=!0}else for(;e<=t.length;){for(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1);e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;if(e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charCodeAt(i-1)>32&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");for(;e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;s=!0}}finally{this.EndUpdate()}},this.CheckSpecialChars=function(){this.FSpecialCharsInited||(this.FQuoteChar='"',this.FDelimiter=",",this.FNameValueSeparator="=",this.FLBS=pas.System.DefaultTextLineBreakStyle,this.FSpecialCharsInited=!0,this.FLineBreak=pas.System.sLineBreak)},this.GetNextLinebreak=function(t,e,i){var s,n,r=!1,o=0,a=0;return e.set(""),r=!1,t.length-i.get()<0?r:(s=t.indexOf("\n",i.get()-1)+1,n=t.indexOf("\r",i.get()-1)+1,a=1,s>0&&n>0?(s-n==1&&(a=2),o=s<n?s:n):o=s>0&&n<1?s:n>0&&s<1?n:t.length+1,e.set(pas.System.Copy(t,i.get(),o-i.get())),i.set(o+a),r=!0)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FAlwaysQuote=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return e=this.GetCount(),this.Insert(this.GetCount(),t),e},this.AddObject=function(t,e){var i;return i=this.Add(t),this.PutObject(i,e),i},this.AddStrings=function(t){for(var e=0,i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.AddObject(t.Get(e),t.GetObject(e))},this.AddPair=function(t,e){return this.AddPair$1(t,e,null)},this.AddPair$1=function(t,e,i){return this,this.AddObject(t+this.GetNameValueSeparator()+e,i),this},this.Assign=function(e){var i=null;if(t.TStrings.isPrototypeOf(e)){i=e,this.BeginUpdate();try{this.Clear(),this.FSpecialCharsInited=i.FSpecialCharsInited,this.FQuoteChar=i.FQuoteChar,this.FDelimiter=i.FDelimiter,this.FNameValueSeparator=i.FNameValueSeparator,this.FLBS=i.FLBS,this.FLineBreak=i.FLineBreak,this.AddStrings(i)}finally{this.EndUpdate()}}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){0===this.FUpdateCount&&this.SetUpdateState(!0),this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.SetUpdateState(!1)},this.IndexOf=function(t){var e=0;for(e=0;e<this.GetCount()&&0!==this.DoCompareText(this.Get(e),t);)e+=1;return e===this.GetCount()&&(e=-1),e},this.IndexOfName=function(t){var e=0,i=0,s="";for(this.CheckSpecialChars(),e=0;e<this.GetCount();){if(s=this.Get(e),(i=pas.System.Pos(this.FNameValueSeparator,s)-1)>=0&&0===this.DoCompareText(t,pas.System.Copy(s,1,i)))return e;e+=1}return e=-1},this.InsertObject=function(t,e,i){this.Insert(t,e),this.PutObject(t,i)},this.GetNameValue=function(t,e,i){var s;this.CheckSpecialChars(),i.set(this.Get(t)),0!==(s=pas.System.Pos(this.FNameValueSeparator,i.get()))?(e.set(pas.System.Copy(i.get(),1,s-1)),i.set(pas.System.Copy(i.get(),s+1,i.get().length-s))):e.set("")},this.$rtti.addMethod("Create$1",2,[])})),rtl.recNewT(this,"TStringItem",(function(){this.FString="",this.FObject=null,this.$eq=function(t){return this.FString===t.FString&&this.FObject===t.FObject},this.$assign=function(t){return this.FString=t.FString,this.FObject=t.FObject,this}})),this.$rtti.$Class("TStringList"),this.TStringsSortStyle={0:"sslNone",sslNone:0,1:"sslUser",sslUser:1,2:"sslAuto",sslAuto:2},rtl.createClass(this,"TStringList",this.TStrings,(function(){this.$init=function(){t.TStrings.$init.call(this),this.FList=[],this.FCount=0,this.FOnChange=null,this.FOnChanging=null,this.FDuplicates=0,this.FCaseSensitive=!1,this.FForceSort=!1,this.FOwnsObjects=!1,this.FSortStyle=0},this.$final=function(){this.FList=void 0,this.FOnChange=void 0,this.FOnChanging=void 0,t.TStrings.$final.call(this)},this.ExchangeItemsInt=function(t,e){var i,s;i=this.FList[t].FString,s=this.FList[t].FObject,this.FList[t].FString=this.FList[e].FString,this.FList[t].FObject=this.FList[e].FObject,this.FList[e].FString=i,this.FList[e].FObject=s},this.GetSorted=function(){return this.FSortStyle in rtl.createSet(1,2)},this.Grow=function(){var t=0;(t=this.GetCapacity())>=256?t+=rtl.trunc(t/4):0===t?t=4:t*=4,this.SetCapacity(t)},this.InternalClear=function(t,e){var i=0;if(t<this.FCount){if(this.FOwnsObjects)for(var s=t,n=this.FCount-1;s<=n;s++)i=s,this.FList[i].FString="",pas.SysUtils.FreeAndNil({p:this.FList[i],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}});else for(var r=t,o=this.FCount-1;r<=o;r++)i=r,this.FList[i].FString="";this.FCount=t}e||this.SetCapacity(0)},this.QuickSort=function(t,e,i){var s=0,n=0,r=0;if(e-t<=1)t<e&&i(this,t,e)>0&&this.ExchangeItems(t,e);else{for(n=t,r=e,s=t+pas.System.Random(e-t);n<r;){for(;n<s&&i(this,n,s)<=0;)n+=1;for(;r>s&&i(this,r,s)>0;)r-=1;this.ExchangeItems(n,r),s===n?s=r:s===r&&(s=n)}s-1>=t&&this.QuickSort(t,s-1,i),s+1<=e&&this.QuickSort(s+1,e,i)}},this.SetSorted=function(t){t?this.SetSortStyle(2):this.SetSortStyle(0)},this.SetSortStyle=function(t){this.FSortStyle!==t&&(2===t&&this.Sort(),this.FSortStyle=t)},this.CheckIndex=function(t){(t<0||t>=this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t)},this.ExchangeItems=function(t,e){this.ExchangeItemsInt(t,e)},this.Changed=function(){0===this.FUpdateCount&&null!=this.FOnChange&&this.FOnChange(this)},this.Changing=function(){0===this.FUpdateCount&&null!=this.FOnChanging&&this.FOnChanging(this)},this.Get=function(t){return this.CheckIndex(t),this.FList[t].FString},this.GetCapacity=function(){return rtl.length(this.FList)},this.GetCount=function(){return this.FCount},this.GetObject=function(t){return this.CheckIndex(t),this.FList[t].FObject},this.Put=function(t,e){this.GetSorted()&&this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0),this.CheckIndex(t),this.Changing(),this.FList[t].FString=e,this.Changed()},this.PutObject=function(t,e){this.CheckIndex(t),this.Changing(),this.FList[t].FObject=e,this.Changed()},this.SetCapacity=function(e){e<0&&this.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),e),e!==this.GetCapacity()&&(this.FList=rtl.arraySetLength(this.FList,t.TStringItem,e))},this.SetUpdateState=function(t){t?this.Changing():this.Changed()},this.InsertItem=function(t,e){this.InsertItem$1(t,e,null)},this.InsertItem$1=function(e,i,s){var n=t.TStringItem.$new();this.Changing(),this.FCount===this.GetCapacity()&&this.Grow(),n.FString=i,n.FObject=s,this.FList.splice(e,0,n),this.FCount+=1,this.Changed()},this.DoCompareText=function(t,e){return this.CompareStrings(t,e)},this.CompareStrings=function(t,e){return this.FCaseSensitive?pas.SysUtils.CompareStr(t,e):pas.SysUtils.CompareText(t,e)},this.Destroy=function(){this.InternalClear(0,!1),t.TStrings.Destroy.call(this)},this.Add=function(t){var e=0;if(2!==this.FSortStyle)e=this.FCount;else if(this.Find(t,{get:function(){return e},set:function(t){e=t}})){var i=this.FDuplicates;if(0===i)return e;2===i&&this.Error(rtl.getResStr(pas.RTLConsts,"SDuplicateString"),0)}return this.InsertItem(e,t),e},this.Clear=function(){0!==this.FCount&&(this.Changing(),this.InternalClear(0,!1),this.Changed())},this.Delete=function(t){this.CheckIndex(t),this.Changing(),this.FOwnsObjects&&pas.SysUtils.FreeAndNil({p:this.FList[t],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}}),this.FList.splice(t,1),this.FList[this.GetCount()-1].FString="",this.FList[this.GetCount()-1].FObject=null,this.FCount-=1,this.Changed()},this.Find=function(e,i){var s=!1,n=0,r=0,o=0,a=0;if(s=!1,i.set(-1),!this.GetSorted())throw t.EListError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SErrFindNeedsSortedList")]);for(n=0,r=this.GetCount()-1;n<=r;)o=n+rtl.trunc((r-n)/2),(a=this.DoCompareText(e,this.FList[o].FString))>0?n=o+1:(r=o-1,0===a&&(s=!0,1!==this.FDuplicates&&(n=o)));return i.set(n),s},this.IndexOf=function(e){var i=0;return this.GetSorted()?this.Find(e,{get:function(){return i},set:function(t){i=t}})||(i=-1):i=t.TStrings.IndexOf.call(this,e),i},this.Insert=function(t,e){2===this.FSortStyle?this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0):((t<0||t>this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t),this.InsertItem(t,e))},this.Sort=function(){this.CustomSort(e.StringListAnsiCompare)},this.CustomSort=function(t){(this.FForceSort||2!==this.FSortStyle)&&this.FCount>1&&(this.Changing(),this.QuickSort(0,this.FCount-1,t),this.Changed())}})),rtl.createClass(this,"TCollectionItem",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FCollection=null,this.FID=0},this.$final=function(){this.FCollection=void 0,t.TPersistent.$final.call(this)},this.GetIndex=function(){return null!=this.FCollection?this.FCollection.FItems.IndexOf(this):-1},this.SetCollection=function(t){t!==this.FCollection&&(null!=this.FCollection&&this.FCollection.RemoveItem(this),null!=t&&t.InsertItem(this))},this.Changed=function(t){null!==this.FCollection&&0===this.FCollection.FUpdateCount&&(t?this.FCollection.Update(null):this.FCollection.Update(this))},this.GetOwner=function(){return this.FCollection},this.SetDisplayName=function(t){this.Changed(!1)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.SetCollection(t),this},this.Destroy=function(){this.SetCollection(null),pas.System.TObject.Destroy.call(this)},this.$rtti.addMethod("Create$1",2,[["ACollection",t.$rtti.TCollection]])})),this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnExtracting",cnExtracting:1,2:"cnDeleting",cnDeleting:2},rtl.createClass(this,"TCollection",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FItemClass=null,this.FItems=null,this.FUpdateCount=0,this.FNextID=0,this.FPropName=""},this.$final=function(){this.FItemClass=void 0,this.FItems=void 0,t.TPersistent.$final.call(this)},this.GetCount=function(){return this.FItems.FCount},this.InsertItem=function(t){this.FItemClass.isPrototypeOf(t)&&(this.FItems.Add(t),t.FCollection=this,t.FID=this.FNextID,this.FNextID+=1,this.SetItemName(t),this.Notify(t,0),this.Changed())},this.RemoveItem=function(t){var e;this.Notify(t,1),-1!==(e=this.FItems.IndexOfItem(t,1))&&this.FItems.Delete(e),t.FCollection=null,this.Changed()},this.DoClear=function(){for(var t=null;this.FItems.FCount>0;)null!=(t=rtl.getObject(this.FItems.Last()))&&t.$destroy("Destroy")},this.Changed=function(){0===this.FUpdateCount&&this.Update(null)},this.GetItem=function(t){return rtl.getObject(this.FItems.Get(t))},this.SetItemName=function(t){},this.Update=function(t){},this.Notify=function(t,e){},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FItemClass=e,this.FItems=t.TFPList.$create("Create"),this},this.Destroy=function(){this.FUpdateCount=1;try{this.DoClear()}finally{this.FUpdateCount=0}null!=this.FItems&&this.FItems.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Owner=function(){return this.GetOwner()},this.Add=function(){return this.FItemClass.$create("Create$1",[this])},this.Assign=function(e){var i=0;if(t.TCollection.isPrototypeOf(e)){this.Clear();for(var s=0,n=e.GetCount()-1;s<=n;s++)i=s,this.Add().Assign(e.GetItem(i))}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){this.FUpdateCount+=1},this.Clear=function(){if(0!==this.FItems.FCount){this.BeginUpdate();try{this.DoClear()}finally{this.EndUpdate()}}},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.Changed()},this.Delete=function(t){var e=null;e=rtl.getObject(this.FItems.Get(t)),this.Notify(e,2),null!=e&&e.$destroy("Destroy")},this.$rtti.addMethod("Create$1",2,[["AItemClass",t.$rtti.TCollectionItemClass]])})),rtl.createClass(this,"TOwnedCollection",this.TCollection,(function(){this.$init=function(){t.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,t.TCollection.$final.call(this)},this.GetOwner=function(){return this.FOwner},this.Create$2=function(e,i){return this.FOwner=e,t.TCollection.Create$1.call(this,i),this},this.$rtti.addMethod("Create$2",2,[["AOwner",t.$rtti.TPersistent],["AItemClass",t.$rtti.TCollectionItemClass]])})),this.$rtti.$Class("TComponent"),this.TOperation={0:"opInsert",opInsert:0,1:"opRemove",opRemove:1},this.TComponentStateItem={0:"csLoading",csLoading:0,1:"csReading",csReading:1,2:"csWriting",csWriting:2,3:"csDestroying",csDestroying:3,4:"csDesigning",csDesigning:4,5:"csAncestor",csAncestor:5,6:"csUpdating",csUpdating:6,7:"csFixups",csFixups:7,8:"csFreeNotification",csFreeNotification:8,9:"csInline",csInline:9,10:"csDesignInstance",csDesignInstance:10},this.TComponentStyleItem={0:"csInheritable",csInheritable:0,1:"csCheckPropAvail",csCheckPropAvail:1,2:"csSubComponent",csSubComponent:2,3:"csTransient",csTransient:3},this.$rtti.$inherited("TComponentName",rtl.string,{}),rtl.createClass(this,"TComponent",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FOwner=null,this.FName="",this.FTag=0,this.FComponents=null,this.FFreeNotifies=null,this.FComponentState={},this.FComponentStyle={},this.FLeft=0,this.FTop=0},this.$final=function(){this.FOwner=void 0,this.FComponents=void 0,this.FFreeNotifies=void 0,this.FComponentState=void 0,this.FComponentStyle=void 0,t.TPersistent.$final.call(this)},this.GetComponent=function(t){return null==this.FComponents?null:rtl.getObject(this.FComponents.Get(t))},this.GetComponentCount=function(){return null==this.FComponents?0:this.FComponents.FCount},this.Insert=function(e){null==this.FComponents&&(this.FComponents=t.TFPList.$create("Create")),this.FComponents.Add(e),e.FOwner=this},this.Remove=function(t){t.FOwner=null,null!=this.FComponents&&(this.FComponents.Remove(t),0===this.FComponents.FCount&&(this.FComponents.$destroy("Destroy"),this.FComponents=null))},this.RemoveNotification=function(t){null!==this.FFreeNotifies&&(this.FFreeNotifies.Remove(t),0===this.FFreeNotifies.FCount&&(this.FFreeNotifies.$destroy("Destroy"),this.FFreeNotifies=null,this.FComponentState=rtl.excludeSet(this.FComponentState,8)))},this.SetReference=function(t){var e=null,i=null,s=null;""!==this.FName&&null!=this.FOwner&&(s=this.FOwner,null!=(e=this.FOwner.$class.FieldAddress(this.FName))&&(i=t?this:null,s[""+e.name]=i))},this.ChangeName=function(t){this.FName=t},this.GetOwner=function(){return this.FOwner},this.Loaded=function(){this.FComponentState=rtl.excludeSet(this.FComponentState,0)},this.Loading=function(){this.FComponentState=rtl.includeSet(this.FComponentState,0)},this.Notification=function(t,e){var i=0;if(1===e&&this.RemoveFreeNotification(t),null!=this.FComponents)for(i=this.FComponents.FCount-1;i>=0;)rtl.getObject(this.FComponents.Get(i)).Notification(t,e),(i-=1)>=this.FComponents.FCount&&(i=this.FComponents.FCount-1)},this.SetDesigning=function(t,e){var i=0;if(this.FComponentState=t?rtl.includeSet(this.FComponentState,4):rtl.excludeSet(this.FComponentState,4),null!=this.FComponents&&e)for(var s=0,n=this.FComponents.FCount-1;s<=n;s++)i=s,rtl.getObject(this.FComponents.Get(i)).SetDesigning(t,!0)},this.SetName=function(e){if(this.FName!==e){if(""!==e&&!pas.SysUtils.IsValidIdent(e,!1,!1))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidName"),pas.System.VarRecs(18,e)]);null!=this.FOwner?this.FOwner.ValidateRename(this,this.FName,e):this.ValidateRename(null,this.FName,e),this.SetReference(!1),this.ChangeName(e),this.SetReference(!0)}},this.SetParentComponent=function(t){},this.ValidateRename=function(e,i,s){if(null!==e&&0!==pas.SysUtils.CompareText(i,s)&&e.FOwner===this&&null!==this.FindComponent(s))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SDuplicateName"),pas.System.VarRecs(18,s)]);4 in this.FComponentState&&null!==this.FOwner&&this.FOwner.ValidateRename(e,i,s)},this.ValidateContainer=function(t){t.ValidateInsert(this)},this.ValidateInsert=function(t){},this._AddRef=function(){return-1,-1},this.GetLeft=function(){return this.FLeft},this.GetTop=function(){return this.FTop},this.SetLeft=function(t){this.FLeft=t},this.SetTop=function(t){this.FTop=t},this._Release=function(){return-1,-1},this.Create$1=function(t){return this.FComponentStyle=rtl.createSet(0),null!=t&&t.InsertComponent(this),this},this.Destroy=function(){var t=0,e=null;if(this.Destroying(),null!=this.FFreeNotifies){for(t=this.FFreeNotifies.FCount-1;t>=0;)e=rtl.getObject(this.FFreeNotifies.Get(t)),this.FFreeNotifies.Delete(t),e.Notification(this,1),null===this.FFreeNotifies?t=0:t>this.FFreeNotifies.FCount&&(t=this.FFreeNotifies.FCount),t-=1;pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFreeNotifies},set:function(t){this.p.FFreeNotifies=t}})}this.DestroyComponents(),null!==this.FOwner&&this.FOwner.RemoveComponent(this),pas.System.TObject.Destroy.call(this)},this.BeforeDestruction=function(){3 in this.FComponentState||this.Destroying()},this.DestroyComponents=function(){for(var t=null;null!=this.FComponents;)t=rtl.getObject(this.FComponents.Last()),this.Remove(t),t.$destroy("Destroy")},this.Destroying=function(){var t=0;if(!(3 in this.FComponentState)&&(this.FComponentState=rtl.includeSet(this.FComponentState,3),null!=this.FComponents))for(var e=0,i=this.FComponents.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FComponents.Get(t)).Destroying()},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},this.AfterLoadDFMValues=function(){this.EndUpdate(),this.Loaded()},this.BeforeLoadDFMValues=function(){4 in this.FComponentState||this.Loading(),this.BeginUpdate()},this.BeginUpdate=function(){},this.EndUpdate=function(){},this.FindComponent=function(t){var e=null,i=0;if(e=null,""===t||null==this.FComponents)return e;for(var s=0,n=this.FComponents.FCount-1;s<=n;s++)if(i=s,0===pas.SysUtils.CompareText(rtl.getObject(this.FComponents.Get(i)).FName,t))return e=rtl.getObject(this.FComponents.Get(i));return e},this.FreeNotification=function(e){null!==this.FOwner&&e===this.FOwner||(null==this.FFreeNotifies&&(this.FFreeNotifies=t.TFPList.$create("Create")),-1===this.FFreeNotifies.IndexOf(e)&&(this.FFreeNotifies.Add(e),e.FreeNotification(this)))},this.RemoveFreeNotification=function(t){this.RemoveNotification(t),t.RemoveNotification(this)},this.InsertComponent=function(t){t.ValidateContainer(this),this.ValidateRename(t,"",t.FName),null!==t.FOwner&&t.FOwner.RemoveComponent(t),this.Insert(t),4 in this.FComponentState&&t.SetDesigning(!0,!0),this.Notification(t,0)},this.RemoveComponent=function(t){this.Notification(t,1),this.Remove(t),t.SetDesigning(!1,!0),this.ValidateRename(t,t.FName,"")},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",e]]),e.addProperty("Name",6,t.$rtti.TComponentName,"FName","SetName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TLoadHelper",pas.System.TObject,(function(){})),this.TShiftState$a={0:"ssShift",ssShift:0,1:"ssAlt",ssAlt:1,2:"ssCtrl",ssCtrl:2,3:"ssLeft",ssLeft:3,4:"ssRight",ssRight:4,5:"ssMIDdle",ssMIDdle:5,6:"ssDouble",ssDouble:6,7:"ssTouch",ssTouch:7,8:"ssPen",ssPen:8,9:"ssCommand",ssCommand:9},this.$rtti.$Enum("TShiftState$a",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.TShiftState$a}),this.$rtti.$Set("TShiftState",{comptype:this.$rtti.TShiftState$a}),this.GetClass=function(t){var i=null;return i=null,""===t?i:e.ClassList.hasOwnProperty(t)?i=rtl.getObject(e.ClassList[t]):i},this.SetLoadHelperClass=function(t){var i;return i=e.GlobalLoadHelper,e.GlobalLoadHelper=t,i},t.$implcode=function(){e.GlobalLoadHelper=null,e.StringListAnsiCompare=function(t,e,i){return t.DoCompareText(t.FList[e].FString,t.FList[i].FString)},e.ClassList=null},t.$init=function(){e.ClassList=new Object}}),["Web"]),rtl.module("UITypes",["System"],(function(){"use strict";this.$rtti.$inherited("TFontName",rtl.string,{})})),rtl.module("WEBLib.Consts",["System"],(function(){"use strict";this.$resourcestrings={SWarning:{org:"Warning"},SError:{org:"Error"},SInformation:{org:"Information"},SConfirm:{org:"Confirm"},SOK:{org:"OK"},SCancel:{org:"Cancel"},SYes:{org:"Yes"},SNo:{org:"No"},SAbort:{org:"Abort"},SRetry:{org:"Retry"},SIgnore:{org:"Ignore"},SHelp:{org:"Help"},SClose:{org:"Close"},SAll:{org:"All"},SYesToAll:{org:"Yes to all"},SNoToAll:{org:"No to all"},SWarningFR:{org:"Avertissement"},SErrorFR:{org:"Erreur"},SInformationFR:{org:"Information"},SConfirmFR:{org:"Confirmer"},SOKFR:{org:"OK"},SCancelFR:{org:"Annuler"},SYesFR:{org:"Oui"},SNoFR:{org:"Non"},SAbortFR:{org:"Interrompre"},SRetryFR:{org:"Réessayer"},SIgnoreFR:{org:"Ignorer"},SHelpFR:{org:"Aide"},SCloseFR:{org:"Fermer"},SAllFR:{org:"Tout"},SYesToAllFR:{org:"Oui à tout"},SNoToAllFR:{org:"Non à tout"},SWarningDE:{org:"Warnung"},SErrorDE:{org:"Fehler"},SInformationDE:{org:"Information"},SConfirmDE:{org:"Bestätigen"},SOKDE:{org:"OK"},SCancelDE:{org:"Abbrechen"},SYesDE:{org:"Ja"},SNoDE:{org:"Nein"},SAbortDE:{org:"Abbrechen"},SRetryDE:{org:"Wiederholen"},SIgnoreDE:{org:"Ignorieren"},SHelpDE:{org:"Hilfe"},SCloseDE:{org:"Schließen"},SAllDE:{org:"Alles"},SYesToAllDE:{org:"Ja auf Alles"},SNoToAllDE:{org:"Nein auf Alles"},SWarningES:{org:"Advertencia"},SErrorES:{org:"Error"},SInformationES:{org:"Información"},SConfirmES:{org:"Confirmado"},SOKES:{org:"OK"},SCancelES:{org:"Cancelar"},SYesES:{org:"Sí"},SNoES:{org:"No"},SAbortES:{org:"Abortar"},SRetryES:{org:"Rever"},SIgnoreES:{org:"Ignorar"},SHelpES:{org:"Ayudar"},SCloseES:{org:"Cerrar"},SAllES:{org:"Todos"},SYesToAllES:{org:"Sí a todo"},SNoToAllES:{org:"No a todo"},SWarningNL:{org:"Waarschuwing"},SErrorNL:{org:"Fout"},SInformationNL:{org:"Informatie"},SConfirmNL:{org:"Bevestiging"},SOKNL:{org:"OK"},SCancelNL:{org:"Afbreken"},SYesNL:{org:"Ja"},SNoNL:{org:"Nee"},SAbortNL:{org:"Afbreken"},SRetryNL:{org:"Opnieuw"},SIgnoreNL:{org:"Negeren"},SHelpNL:{org:"Hulp"},SCloseNL:{org:"Sluiten"},SAllNL:{org:"Alles"},SYesToAllNL:{org:"Ja op alles"},SNoToAllNL:{org:"Nee op alles"}}})),rtl.module("WEBLib.Dialogs",["System","Classes","WEBLib.Controls","Web","JS","SysUtils","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.TMsgDlgType={0:"mtWarning",mtWarning:0,1:"mtError",mtError:1,2:"mtInformation",mtInformation:2,3:"mtConfirmation",mtConfirmation:3,4:"mtCustom",mtCustom:4},this.$rtti.$Enum("TMsgDlgType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMsgDlgType}),this.TMsgDlgBtn={0:"mbYes",mbYes:0,1:"mbNo",mbNo:1,2:"mbOK",mbOK:2,3:"mbCancel",mbCancel:3,4:"mbAbort",mbAbort:4,5:"mbRetry",mbRetry:5,6:"mbIgnore",mbIgnore:6,7:"mbAll",mbAll:7,8:"mbNoToAll",mbNoToAll:8,9:"mbYesToAll",mbYesToAll:9,10:"mbHelp",mbHelp:10,11:"mbClose",mbClose:11},this.$rtti.$Enum("TMsgDlgBtn",{minvalue:0,maxvalue:11,ordtype:1,enumtype:this.TMsgDlgBtn}),this.$rtti.$Set("TMsgDlgButtons",{comptype:this.$rtti.TMsgDlgBtn}),rtl.createClass(this,"TCustomDialogButton",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCaption="",this.FTag=0,this.FElementClassName=""};var t=this.$rtti;t.addProperty("Caption",0,rtl.string,"FCaption","FCaption"),t.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),t.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TCustomDialogButtons",pas.Classes.TOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TMessageDlg",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FOpacity=0,this.FLayer$1=null,this.FDlg=null,this.FCancel=null,this.FMessage="",this.FTitle="",this.FMsgDlgType=0,this.FOnButtonClick=null,this.FOnClose=null,this.FButtons={},this.FDialogProc=null,this.FDialogResult=0,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FElementTitleClassName="",this.FElementButtonClassName="",this.FElementContentClassName="",this.FDialogText=null,this.FCustomButtons=null,this.FElementDialogClassName="",this.FAutoLanguage=!1,this.FUseMaterial=!1},this.$final=function(){this.FLayer$1=void 0,this.FDlg=void 0,this.FCancel=void 0,this.FOnButtonClick=void 0,this.FOnClose=void 0,this.FButtons=void 0,this.FDialogProc=void 0,this.FDialogText=void 0,this.FCustomButtons=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetDialogText=function(t){this.FDialogText.Assign(t)},this.SetCustomButtons=function(t){this.FCustomButtons.Assign(t)},this.CreateElement=function(){var t=null;return 4 in this.FComponentState?t=null:pas["WEBLib.Controls"].TCustomControl.CreateElement.call(this),t};this.GetDialogText=function(t){var e="",i="",s=0;if(e="Undefined",t<this.FDialogText.GetCount()&&(e=this.FDialogText.Get(t)),this.FAutoLanguage){i=pas["WEBLib.WebTools"].GetBrowserLocale(),s=0,1===pas.System.Pos("es",i)&&(s=3),1===pas.System.Pos("fr",i)&&(s=1),1===pas.System.Pos("de",i)&&(s=2),1===pas.System.Pos("nl",i)&&(s=4);var n=s;if(3===n){var r=t;0===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningES"):1===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorES"):2===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationES"):3===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmES"):5===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKES"):6===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelES"):7===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesES"):8===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoES"):9===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortES"):10===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryES"):11===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreES"):12===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllES"):13===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllES"):14===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllES"):15===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpES"):16===r&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseES"))}else if(1===n){var o=t;0===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningFR"):1===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorFR"):2===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationFR"):3===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmFR"):5===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKFR"):6===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelFR"):7===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesFR"):8===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoFR"):9===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortFR"):10===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryFR"):11===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreFR"):12===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllFR"):13===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllFR"):14===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllFR"):15===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpFR"):16===o&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseFR"))}else if(2===n){var a=t;0===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningDE"):1===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorDE"):2===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationDE"):3===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmDE"):5===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKDE"):6===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelDE"):7===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesDE"):8===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoDE"):9===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortDE"):10===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryDE"):11===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreDE"):12===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllDE"):13===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllDE"):14===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllDE"):15===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpDE"):16===a&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseDE"))}else if(4===n){var l=t;0===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningNL"):1===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorNL"):2===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationNL"):3===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmNL"):5===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKNL"):6===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelNL"):7===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesNL"):8===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoNL"):9===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortNL"):10===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryNL"):11===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreNL"):12===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllNL"):13===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllNL"):14===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllNL"):15===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpNL"):16===l&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseNL"))}}return e},this.BindEvents=function(){},this.SetDialogResult=function(t){this.FDialogResult=t,0!==this.FDialogResult&&this.Close()},this.CreateButton=function(t,e,i){var s=null;return(s=document.createElement("BUTTON")).innerHTML=t,1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(s.setAttribute("type","BUTTON"),s.setAttribute("class","btn "+i),s.setAttribute("data-dismiss","modal-dialog")):(s.style.setProperty("width","100px"),s.style.setProperty("margin-left","5px"),""!==this.FElementButtonClassName?s.setAttribute("class",this.FElementButtonClassName+" "+i):""!==pas["WEBLib.Forms"].Application.FThemeButtonClassName&&s.setAttribute("class",pas["WEBLib.Forms"].Application.FThemeButtonClassName+" "+i)),s.id=t,s.addEventListener("click",rtl.createSafeCallback(this,"HandleButtonClick")),s.addEventListener("keydown",rtl.createSafeCallback(this,"HandleKeyDown")),e.get()&&(setTimeout((function(){s.focus()}),1),e.set(!1)),s},this.HandleDocMouseMove=function(t){var e,i=0,s=0,n=null;return e=t,this.FDown&&(i=e.screenX-this.FMdx,s=e.screenY-this.FMdy,(n=this.FDlg).style.setProperty("transform",""),n.style.setProperty("position","absolute"),n.style.setProperty("left",pas.SysUtils.IntToStr(Math.round(this.FDlgX+i))+"px"),n.style.setProperty("top",pas.SysUtils.IntToStr(Math.round(this.FDlgY+s))+"px"),(n=this.FCancel).style.setProperty("position","absolute"),n.style.setProperty("top","0"),n.style.setProperty("right","0")),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown=!1,document.body.removeEventListener("mousemove",rtl.createSafeCallback(this,"HandleDocMouseMove")),document.body.removeEventListener("mouseup",rtl.createSafeCallback(this,"HandleDocMouseUp")),!0,!0},this.HandleMouseDown=function(t){var e,i;return i=t,this.FMdx=Math.round(i.screenX),this.FMdy=Math.round(i.screenY),e=this.FDlg.getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,document.body.addEventListener("mousemove",rtl.createSafeCallback(this,"HandleDocMouseMove")),document.body.addEventListener("mouseup",rtl.createSafeCallback(this,"HandleDocMouseUp"))),!0,!0},this.HandleButtonClick=function(t){var e,i=0;if(this.SetDialogResult(0),(e=t.target.getAttribute("id"))===this.GetDialogText(7)?this.SetDialogResult(6):e===this.GetDialogText(8)?this.SetDialogResult(7):e===this.GetDialogText(5)?this.SetDialogResult(1):e===this.GetDialogText(6)?this.SetDialogResult(2):e===this.GetDialogText(9)?this.SetDialogResult(3):e===this.GetDialogText(10)?this.SetDialogResult(4):e===this.GetDialogText(11)?this.SetDialogResult(5):e===this.GetDialogText(12)?this.SetDialogResult(12):e===this.GetDialogText(13)?this.SetDialogResult(13):e===this.GetDialogText(14)?this.SetDialogResult(14):e===this.GetDialogText(15)?this.SetDialogResult(9):e===this.GetDialogText(16)&&this.SetDialogResult(8),0===this.FDialogResult&&this.FCustomButtons.GetCount()>0)for(var s=0,n=this.FCustomButtons.GetCount()-1;s<=n;s++)if(i=s,e===this.FCustomButtons.GetItem$1(i).FCaption){this.SetDialogResult(100+i);break}return null!=this.FOnButtonClick&&this.FOnButtonClick(this),!0,!0},this.HandleKeyDown=function(t){var e,i,s=!1;return i=t,e=this.GetKeyCode(i.key,!0),pas.System.Assigned(e)?(27===e&&this.SetDialogResult(2),s=!0):s},this.InitBootstrapStyle=function(){this.FElementButtonClassName="btn",this.FElementContentClassName="text-body",this.FElementTitleClassName="text-body",this.FElementDialogClassName="shadow-lg p-3 mb-5 bg-white rounded"},this.InsertInputElement=function(t,e){},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FOpacity=.2,this.FMessage="",this.FAutoLanguage=!0,this.FMsgDlgType=2,this.FDialogText=pas.Classes.TStringList.$create("Create$1"),this.FDialogText.SetSkipLastLineBreak(!0),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SWarning")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SError")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SInformation")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SConfirm")),this.FDialogText.Add("Custom"),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SOK")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SCancel")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYes")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNo")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAbort")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SRetry")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SIgnore")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYesToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNoToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SHelp")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SClose")),this.FMsgDlgType=4,this.FUseMaterial=!0,this.FCustomButtons=t.TCustomDialogButtons.$create("Create$2",[this,t.TCustomDialogButton]),this.FCustomButtons.FPropName="CustomButtons"},this.Destroy=function(){rtl.free(this,"FDialogText"),rtl.free(this,"FCustomButtons"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Close=function(){pas["WEBLib.Forms"].Application.UnLockForm(pas["WEBLib.Forms"].Application.FMainForm),document.body.removeChild(this.FLayer$1),document.body.removeChild(this.FDlg),this.FDown=!1,this.FCaptured$1=!1,null!=this.FOnClose&&this.FOnClose(this),null!=this.FDialogProc&&this.FDialogProc(this.FDialogResult)},this.Show$1=function(){var t=null,i=null,s=null,n=null,r=null,o=null,a=null,l=null,h=null,u=null,d=null,F=null,c="",p="",C="",S="",m="",f="",y="",g=!1,T=0;if(null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm){this.FUseMaterial&&!pas["WEBLib.Forms"].Application.HasCSS(e.lMaterial)&&this.AddControlLink("material",e.lMaterial),pas["WEBLib.Forms"].Application.LockForm(pas["WEBLib.Forms"].Application.FMainForm),this.FLayer$1=document.createElement("SPAN"),document.body.appendChild(this.FLayer$1),this.FLayer$1.setAttribute("tabindex","0"),this.FLayer$1.addEventListener("keydown",rtl.createSafeCallback(this,"HandleKeyDown")),g=!0,this.FMessage=e.StringToHTML(this.FMessage);var E=this.FMsgDlgType;0===E?(c="warning",p="orange",C=this.GetDialogText(0)):1===E?(c="cancel",p="red",C=this.GetDialogText(1)):2===E?(c="info",p="blue",C=this.GetDialogText(2)):3===E?(c="help",p="blue",C=this.GetDialogText(3)):4===E&&(c="",p="",C=this.GetDialogText(4)),""!==this.FTitle&&(C=this.FTitle),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(this.FDlg=document.createElement("DIV"),this.FDlg.setAttribute("class","modal-dialog"),this.FDlg.setAttribute("role","document"),this.FDlg.style.setProperty("z-index","1999998"),(l=document.createElement("DIV")).style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index","1999997"),l.style.setProperty("display","block"),l.setAttribute("class","modal show fade"),document.body.appendChild(l),l.appendChild(this.FDlg),d=this.FDlg,(u=document.createElement("DIV")).setAttribute("class","modal-content "+this.FElementDialogClassName),d.appendChild(u),F=u,d=u,(u=document.createElement("DIV")).setAttribute("class","modal-header"),F.appendChild(u),d=u,(u=document.createElement("H5")).setAttribute("class","modal-title"),u.innerHTML=C,d.appendChild(u),3 in this.FButtons&&((u=document.createElement("BUTTON")).setAttribute("type","button"),u.setAttribute("class","close btn btn-danger"),u.setAttribute("data-dismiss","modal-dialog"),u.setAttribute("aria-label","Close"),u.setAttribute("id",this.GetDialogText(6)),u.addEventListener("click",rtl.createSafeCallback(this,"HandleButtonClick")),d.appendChild(u),d=u,(u=document.createElement("SPAN")).setAttribute("aria-hidden","true"),u.setAttribute("id",this.GetDialogText(6)),u.innerHTML="&times;",d.appendChild(u)),(u=document.createElement("DIV")).setAttribute("class","modal-body"),F.appendChild(u),d=u,4!==this.FMsgDlgType&&((s=document.createElement("SPAN")).innerHTML='<i class="material-icons" style="color:'+p+'!important;font-size:48px!important">'+c+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),d.appendChild(s)),(u=document.createElement("H6")).innerHTML=this.FMessage,d.appendChild(u),this.InsertInputElement(d,{get:function(){return g},set:function(t){g=t}}),(u=document.createElement("DIV")).setAttribute("class","modal-footer"),F.appendChild(u),o=d=u,this.FDlg=l):(y="5",f="26",m="#f1f1f1",S="#ababab",this.FDlg=document.createElement("DIV"),document.body.appendChild(this.FDlg),a=this.FDlg,""!==this.FElementDialogClassName?a.setAttribute("class",this.FElementDialogClassName):(a.style.setProperty("background-color","white"),a.style.setProperty("border","1px solid "+S),a.style.setProperty("font-family","Arial"),a.style.setProperty("font-size","10pt")),a.style.setProperty("cursor","default"),a.style.setProperty("position","fixed"),a.style.setProperty("min-width","300px"),a.style.setProperty("min-height","125px"),a.style.setProperty("max-width","100%"),a.style.setProperty("max-height","100%"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("transform","translate(-50%, -50%)"),a.style.setProperty("z-index","1999998"),a.style.setProperty("box-shadow","5px 5px 5px gray"),h=document.createElement("DIV"),this.FCancel=h,h.innerHTML='<i id="Cancel" class="material-icons" style="font-size:16px!important">clear</i>',h.id="Cancel",h.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor)),h.style.setProperty("position","fixed"),h.style.setProperty("top","0"),h.style.setProperty("right","0"),h.style.setProperty("padding",y+"px"),h.style.setProperty("height",f+"px"),h.style.setProperty("line-height",f+"px"),h.addEventListener("click",rtl.createSafeCallback(this,"HandleButtonClick")),a.appendChild(h),(t=document.createElement("DIV")).innerHTML=C,""!==this.FElementTitleClassName?t.setAttribute("class",this.FElementTitleClassName):(t.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeColor)),t.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor))),t.style.setProperty("cursor","move"),t.style.setProperty("padding-left",y+"px"),t.style.setProperty("height",f+"px"),t.style.setProperty("vertical-align","middle"),t.style.setProperty("line-height",f+"px"),t.style.setProperty("border-bottom","1px solid "+S),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-ms-user-select","none"),t.style.setProperty("user-select","none"),t.style.setProperty("-o-user-select","none"),t.addEventListener("mousedown",rtl.createSafeCallback(this,"HandleMouseDown")),a.appendChild(t),(i=document.createElement("DIV")).style.setProperty("padding",y+"px"),i.style.setProperty("height","auto"),i.style.setProperty("min-height","50px"),i.style.setProperty("border-bottom","1px solid "+S),4!==this.FMsgDlgType&&((s=document.createElement("DIV")).innerHTML='<i class="material-icons" style="color:'+p+'!important;font-size:48px!important">'+c+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),i.appendChild(s)),this.FMessage=pas.SysUtils.StringReplace(this.FMessage,pas.System.sLineBreak,"<BR>",rtl.createSet(0)),(r=document.createElement("DIV")).innerHTML=this.FMessage,r.style.setProperty("height","auto"),r.style.setProperty("min-height","50px"),r.style.setProperty("white-space","pre-wrap"),(n=document.createElement("LABEL")).innerHTML=this.FMessage,""!==this.FElementTitleClassName&&n.setAttribute("class",this.FElementContentClassName),r.appendChild(n),i.appendChild(n),this.InsertInputElement(i,{get:function(){return g},set:function(t){g=t}}),a.appendChild(i),(o=document.createElement("DIV")).style.setProperty("background-color",m),o.style.setProperty("padding",y+"px"),o.style.setProperty("min-height",f+"px"),o.style.setProperty("height","auto"),o.style.setProperty("line-height",f+"px"),o.style.setProperty("text-align","right"),a.appendChild(o)),rtl.eqSet(this.FButtons,{})&&0===this.FCustomButtons.GetCount()?o.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")):(0 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(7),{get:function(){return g},set:function(t){g=t}},"")),1 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(8),{get:function(){return g},set:function(t){g=t}},"")),2 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")),3 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(6),{get:function(){return g},set:function(t){g=t}},"")),4 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(9),{get:function(){return g},set:function(t){g=t}},"")),5 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(10),{get:function(){return g},set:function(t){g=t}},"")),6 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(11),{get:function(){return g},set:function(t){g=t}},"")),7 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(12),{get:function(){return g},set:function(t){g=t}},"")),9 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(13),{get:function(){return g},set:function(t){g=t}},"")),8 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(14),{get:function(){return g},set:function(t){g=t}},"")),10 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(15),{get:function(){return g},set:function(t){g=t}},"")),11 in this.FButtons&&o.appendChild(this.CreateButton(this.GetDialogText(16),{get:function(){return g},set:function(t){g=t}},"")));for(var D=0,b=this.FCustomButtons.GetCount()-1;D<=b;D++)T=D,o.appendChild(this.CreateButton(this.FCustomButtons.GetItem$1(T).FCaption,{get:function(){return g},set:function(t){g=t}},this.FCustomButtons.GetItem$1(T).FElementClassName));(l=this.FLayer$1).style.setProperty("background-color","black"),l.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(this.FOpacity)),l.style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index",pas["WEBLib.Forms"].Application.MaxZIndexStr()),l.style.setProperty("webkit-user-select","none"),l.style.setProperty("moz-user-select","none"),l.style.setProperty("khtml-user-select","none"),l.style.setProperty("ms-user-select","none"),l.style.setProperty("user-select","none"),l.style.setProperty("position","fixed")}},this.ShowDialog$1=function(t,e,i,s){return 0,this.FButtons=rtl.refSet(i),this.FMessage=t,this.FMsgDlgType=e,this.FDialogProc=s,this.SetDialogResult(0),this.Show$1(),0},this.ShowDialog$2=function(t,e,i){var s=this;return new Promise((function(n,r){s.ShowDialog$1(t,e,rtl.refSet(i),(function(t){n(t)}))}))},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AutoLanguage",0,rtl.boolean,"FAutoLanguage","FAutoLanguage",{Default:!0}),i.addProperty("Buttons",0,t.$rtti.TMsgDlgButtons,"FButtons","FButtons",{Default:{}}),i.addProperty("CustomButtons",2,t.$rtti.TCustomDialogButtons,"FCustomButtons","SetCustomButtons"),i.addProperty("DialogText",2,pas.Classes.$rtti.TStringList,"FDialogText","SetDialogText"),i.addProperty("DialogType",0,t.$rtti.TMsgDlgType,"FMsgDlgType","FMsgDlgType",{Default:t.TMsgDlgType.mtCustom}),i.addProperty("Message",0,rtl.string,"FMessage","FMessage"),i.addProperty("Opacity",0,rtl.double,"FOpacity","FOpacity"),i.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),i.addProperty("ElementDialogClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementDialogClassName","FElementDialogClassName"),i.addProperty("ElementTitleClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementTitleClassName","FElementTitleClassName"),i.addProperty("ElementContentClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementContentClassName","FElementContentClassName"),i.addProperty("Title",0,rtl.string,"FTitle","FTitle"),i.addProperty("UseMaterial",0,rtl.boolean,"FUseMaterial","FUseMaterial",{Default:!0}),i.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnButtonClick","FOnButtonClick"),i.addProperty("OnClose",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClose","FOnClose")})),this.MessageDlg=function(i,s,n,r){null==e.WebLibDlg&&(e.WebLibDlg=t.TMessageDlg.$create("Create$1",[null]),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary&&e.WebLibDlg.InitBootstrapStyle()),e.WebLibDlg.ShowDialog$1(i,s,rtl.refSet(n),r)},this.ShowMessage=function(e){null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm&&1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?t.MessageDlg(e,2,rtl.createSet(2),null):alert(e)},this.MessageDlgAsync=async function(i,s,n){return null==e.WebLibDlg&&(e.WebLibDlg=t.TMessageDlg.$create("Create$1",[null]),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary&&e.WebLibDlg.InitBootstrapStyle()),await e.WebLibDlg.ShowDialog$2(i,s,rtl.refSet(n))},t.$implcode=function(){e.lMaterial="https://fonts.googleapis.com/icon?family=Material+Icons",e.WebLibDlg=null,e.StringToHTML=function(t){var e="";return e=pas.SysUtils.StringReplace(t,"\r","<BR>",rtl.createSet(0)),e=pas.SysUtils.StringReplace(e,"\n","",rtl.createSet(0))}},t.$init=function(){e.WebLibDlg=null}}),["WEBLib.Forms","WEBLib.Consts","WEBLib.WebTools"]),rtl.module("Math",["System"],(function(){"use strict";var t=this.$impl;this.SameValue=function(t,e,i){return 0===i&&(i=Math.max(1e-12*Math.min(Math.abs(t),Math.abs(e)),1e-12)),t>e?t-e<=i:e-t<=i},this.IfThen=function(t,e,i){return t?e:i},this.$implcode=function(){t.DZeroResolution=1e-12}}),[]),rtl.module("WEBLib.JSON",["System","Classes","Web","JS","SysUtils"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TJSONAncestor",pas.System.TObject,(function(){this.SetStrValue=function(t){}})),rtl.createClass(this,"TJSONValue",this.TJSONAncestor,(function(){this.$init=function(){t.TJSONAncestor.$init.call(this),this.fjv=void 0,this.fjo=void 0},this.JSONValueFromJS=function(e){var i=null,s=0;return i=null,rtl.isArray(e)?(i=t.TJSONArray.$create("Create"),rtl.as(i,t.TJSONArray).fja=e):rtl.isObject(e)?(i=t.TJSONObject.$create("Create$2"),rtl.as(i,t.TJSONObject).fjo$1=e):rtl.isString(e)?(i=t.TJSONString.$create("Create"),rtl.as(i,t.TJSONString).SetStrValue(""+e)):rtl.isNumber(e)?(i=t.TJSONNumber.$create("Create"),rtl.as(i,t.TJSONNumber).SetStrValue(""+e),s=rtl.getNumber(e),rtl.as(i,t.TJSONNumber).FDouble=s,0===pas.System.Frac(s)&&(rtl.as(i,t.TJSONNumber).FInt=rtl.trunc(e))):pas.JS.isNull(e)?i=t.TJSONNull.$create("Create"):pas.JS.isBoolean(e)&&(i=pas.JS.toBoolean(e)?t.TJSONTrue.$create("Create$3"):t.TJSONFalse.$create("Create$3")),null==i&&(i=t.TJSONNull.$create("Create")),i.fjv=e,i},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.fjv=t,this},this.ToString=function(){return JSON.stringify(this.fjv)}})),rtl.createClass(this,"TJSONPair",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.fjo=void 0,this.fjv=null,this.fjs=null},this.$final=function(){this.fjv=void 0,this.fjs=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.fjs=t.TJSONString.$create("Create"),this},this.Destroy=function(){rtl.free(this,"fjs"),pas.System.TObject.Destroy.call(this)},this.ToString=function(){return t.TJSONObject.isPrototypeOf(this.fjv)?'"'+this.fjs.GetStrValue()+'":'+rtl.as(this.fjv,t.TJSONObject).ToJSON():null!==this.fjs&&null!==this.fjv?'"'+this.fjs.GetStrValue()+'":'+this.fjv.ToString():""}})),rtl.createClass(this,"TJSONPairList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TJSONObject",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.fjo$1=null,this.FMembers=null},this.$final=function(){this.fjo$1=void 0,this.FMembers=void 0,t.TJSONValue.$final.call(this)},this.GetCount=function(){return null!=this.fjo$1?rtl.length(Object.keys(this.fjo$1)):null!=this.FMembers?this.FMembers.GetCount():0},this.Create$2=function(){return pas.System.TObject.Create.call(this),this.FMembers=t.TJSONPairList.$create("Create$1"),this.fjo$1=null,this},this.Destroy=function(){rtl.free(this,"FMembers"),pas.System.TObject.Destroy.call(this)},this.ParseJSONValue=function(t){var e;return e=JSON.parse(t),this.JSONValueFromJS(e)},this.GetJSONValue=function(t){var i;return i=this.fjo$1[t],e.JSONObjectToString(i)},this.Get=function(e){var i=null,s=void 0,n=null,r=0,o=null;if(i=null,null!=this.fjo$1)null==(s=this.fjo$1[e])&&null!==s||(i=t.TJSONPair.$create("Create$1"),n=this.$class.JSONValueFromJS(s),i.fjo=this.fjo$1,i.fjs.SetStrValue(e),i.fjv=n);else for(var a=0,l=this.FMembers.GetCount()-1;a<=l;a++)r=a,(o=rtl.getObject(this.FMembers.Get(r))).fjs.ToString()==='"'+e+'"'&&(i=o);return i},this.Get$1=function(t){return this.Get(Object.keys(this.fjo$1)[t])},this.GetValue$1=function(t){var e,i=null;return i=null,null!=(e=this.Get(t))&&((i=e.fjv).fjo=e.fjo),i},this.ToJSON=function(){var t="",e=0,i=0,s=null;t="{",(e=null!=this.fjo$1?this.GetCount():this.FMembers.GetCount())>0&&(null!=this.fjo$1?null!=(s=this.Get$1(0))?t+=s.ToString():t=t+'"'+Object.keys(this.fjo$1)[0]+'":null':t+=rtl.getObject(this.FMembers.Get(0)).ToString());for(var n=1,r=e-1;n<=r;n++)i=n,t=null!=this.fjo$1?null!=(s=this.Get$1(i))?t+","+s.ToString():t+',"'+Object.keys(this.fjo$1)[i]+'":null':t+","+rtl.getObject(this.FMembers.Get(i)).ToString();return t+="}"},this.ToString=function(){return this.ToJSON()}})),rtl.createClass(this,"TJSONString",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.FValue=""},this.GetStrValue=function(){return this.FValue},this.SetStrValue=function(t){if(this.FValue=t,this.fjv=t,pas.System.Assigned(this.fjo)){var e=Object.keys(this.fjo)[0];this.fjo[e]=t}}})),rtl.createClass(this,"TJSONNumber",this.TJSONString,(function(){this.$init=function(){t.TJSONString.$init.call(this),this.FInt=0,this.FInt64=0,this.FDouble=0},this.GetStrValue=function(){return pas.SysUtils.FloatToStr$1(this.FDouble,pas.SysUtils.TFormatSettings.Invariant())},this.SetStrValue=function(t){this.FDouble=pas.SysUtils.StrToFloat$1(t,pas.SysUtils.TFormatSettings.Invariant()),0===pas.System.Frac(this.FDouble)?(pas.SysUtils.TryStrToInt64$1(t,{p:this,get:function(){return this.p.FInt64},set:function(t){this.p.FInt64=t}},pas.SysUtils.TFormatSettings.Invariant())||(this.FInt64=0),this.FInt=this.FInt64,this.fjv=this.FInt64):this.fjv=this.FDouble}})),rtl.createClass(this,"TJSONBool",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.FBool=!1},this.SetStrValue=function(t){var e;e=pas.SysUtils.UpperCase(t),this.FBool="TRUE"===e},this.Create$2=function(e){return t.TJSONValue.Create$1.call(this,e),this.FBool=e,this}})),rtl.createClass(this,"TJSONTrue",this.TJSONBool,(function(){this.GetStrValue=function(){return"true","true"},this.Create$3=function(){return t.TJSONBool.Create$2.call(this,!0),this},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONFalse",this.TJSONBool,(function(){this.GetStrValue=function(){return"false","false"},this.Create$3=function(){return t.TJSONBool.Create$2.call(this,!1),this},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONNull",this.TJSONValue,(function(){this.GetStrValue=function(){return"null","null"},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONArray",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.fja=null},this.$final=function(){this.fja=void 0,t.TJSONValue.$final.call(this)},this.GetItem=function(e){var i;return i=this.GetJA()[e],rtl.isExt(i,t.TJSONObject,1)||rtl.isExt(i,t.TJSONArray,1)?rtl.getObject(i):this.$class.JSONValueFromJS(i)},this.GetCount=function(){return this.GetJA().length},this.GetJA=function(){return null==this.fja&&(this.fja=new Array),this.fja},this.ToString=function(){var e="",i=0,s=null,n="";e="[",n="";for(var r=0,o=this.GetCount()-1;r<=o;r++)i=r,null!=(s=this.GetItem(i))&&(e=t.TJSONObject.isPrototypeOf(s)?e+n+rtl.as(s,t.TJSONObject).ToString():e+n+s.ToString(),n=",");return e+="]"}})),t.$implcode=function(){e.JSONObjectToString=function(t){return t+""}}}),["TypInfo"]),rtl.module("WEBLib.Storage",["System","Web","Classes"],(function(){"use strict";var t=this;this.$rtti.$MethodVar("TStorageChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AKey",rtl.string],["AOldValue",rtl.string],["ANewValue",rtl.string],["AURL",rtl.string]]),methodkind:0}),rtl.createClass(this,"TLocalStorage",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FChangePtr=null,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TComponent.$final.call(this)},this.SetValues=function(t,e){window.localStorage.setItem(t,e)},this.GetValues=function(t){var e;return e=window.localStorage.getItem(t),pas.System.Assigned(e)?e:""},this.StorageChanged=function(t){var e;e=t.storageArea+" ",null!=this.FOnChange&&pas.System.Pos("OBJECT",pas.SysUtils.UpperCase(e))>0&&this.FOnChange(this,t.key,t.oldValue,t.newValue,t.url)},this.Create$1=function(t){return this.FChangePtr=rtl.createCallback(this,"StorageChanged"),pas.Classes.TComponent.Create$1.apply(this,arguments),window.addEventListener("storage",this.FChangePtr),this},this.Destroy=function(){window.removeEventListener("storage",this.FChangePtr),pas.Classes.TComponent.Destroy.call(this)},this.Clear=function(){window.sessionStorage.clear()},this.SetValue=function(t,e){window.localStorage.setItem(t,e)},this.GetValue=function(t){var e;return e=window.localStorage.getItem(t),pas.System.Assigned(e)?e:""},this.RemoveKey=function(t){window.localStorage.removeItem(t)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("OnChange",0,t.$rtti.TStorageChangeEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TWebLocalStorage",this.TLocalStorage,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["SysUtils"]),rtl.module("WEBLib.REST",["System","Classes","Web","JS","SysUtils","WEBLib.Controls","WEBLib.JSON"],(function(){"use strict";var t=this;this.THTTPCommand={0:"httpGET",httpGET:0,1:"httpPOST",httpPOST:1,2:"httpPUT",httpPUT:2,3:"httpDELETE",httpDELETE:3,4:"httpHEAD",httpHEAD:4,5:"httpPATCH",httpPATCH:5,6:"httpCUSTOM",httpCUSTOM:6},this.$rtti.$Enum("THTTPCommand",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.THTTPCommand}),this.THTTPRequestResponseType={0:"rtDefault",rtDefault:0,1:"rtText",rtText:1,2:"rtBlob",rtBlob:2,3:"rtJSON",rtJSON:3,4:"rtDocument",rtDocument:4,5:"rtArrayBuffer",rtArrayBuffer:5},this.$rtti.$Enum("THTTPRequestResponseType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.THTTPRequestResponseType}),this.$rtti.$MethodVar("THTTPProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Position",rtl.nativeint],["Total",rtl.nativeint]]),methodkind:0}),rtl.createClass(this,"THttpRequest",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FURL="",this.FOnResponse=null,this.FOnAbort=null,this.FHeaders=null,this.FCommand=0,this.FCustomCommand="",this.FPostData="",this.FOnRequestResponse=null,this.FPassword="",this.FUser="",this.FTimeout=0,this.FOnTimeout=null,this.FOnError=null,this.FResponse=null,this.FResponseType=0,this.FOnProgress=null},this.$final=function(){this.FOnResponse=void 0,this.FOnAbort=void 0,this.FHeaders=void 0,this.FOnRequestResponse=void 0,this.FOnTimeout=void 0,this.FOnError=void 0,this.FResponse=void 0,this.FOnProgress=void 0,pas.Classes.TComponent.$final.call(this)},this.SetHeaders=function(t){this.FHeaders.Assign(t)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FHeaders=pas.Classes.TStringList.$create("Create$1"),this.FResponseType=0,this.FCommand=0,this.FTimeout=0,this.FResponse=null,this},this.Destroy=function(){rtl.free(this,"FHeaders"),pas.Classes.TComponent.Destroy.call(this)},this.Loaded=function(){var t=0,e=0,i="",s=!1;pas.Classes.TComponent.Loaded.call(this);for(var n=0,r=this.FHeaders.GetCount()-1;n<=r;n++){t=n,s=!1;for(var o=1,a=(i=this.FHeaders.Get(t)).length;o<=a;o++)e=o,":"!==i.charAt(e-1)||s?"="===i.charAt(e-1)&&s&&(i=rtl.setCharAt(i,e-1,":")):(i=rtl.setCharAt(i,e-1,"="),s=!0);this.FHeaders.Put(t,i)}},this.GetResponseType=function(t){var e="";e="";return 1===t?e="text":2===t?e="blob":4===t?e="document":3===t?e="json":5===t&&(e="arraybuffer"),e},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Command",0,t.$rtti.THTTPCommand,"FCommand","FCommand"),e.addProperty("CustomCommand",0,rtl.string,"FCustomCommand","FCustomCommand"),e.addProperty("Headers",2,pas.Classes.$rtti.TStringList,"FHeaders","SetHeaders"),e.addProperty("Password",0,rtl.string,"FPassword","FPassword"),e.addProperty("PostData",0,rtl.string,"FPostData","FPostData"),e.addProperty("ResponseType",0,t.$rtti.THTTPRequestResponseType,"FResponseType","FResponseType",{Default:t.THTTPRequestResponseType.rtDefault}),e.addProperty("Timeout",0,rtl.longint,"FTimeout","FTimeout",{Default:0}),e.addProperty("URL",0,rtl.string,"FURL","FURL"),e.addProperty("User",0,rtl.string,"FUser","FUser"),e.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti.THTTPErrorEvent,"FOnError","FOnError"),e.addProperty("OnAbort",0,pas["WEBLib.Controls"].$rtti.THTTPAbortEvent,"FOnAbort","FOnAbort"),e.addProperty("OnProgress",0,t.$rtti.THTTPProgressEvent,"FOnProgress","FOnProgress"),e.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti.THTTPRequestResponseEvent,"FOnRequestResponse","FOnRequestResponse"),e.addProperty("OnResponse",0,pas["WEBLib.Controls"].$rtti.THTTPResponseEvent,"FOnResponse","FOnResponse"),e.addProperty("OnTimeout",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTimeout","FOnTimeout")})),this.$rtti.$MethodVar("THttpResponse",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResponse",rtl.string]]),methodkind:0}),rtl.createClass(this,"TPersistTokens",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FEnabled=!1},this.Create$1=function(){return this.FEnabled=!1,this.FKey="",this},this.Assign=function(e){t.TPersistTokens.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TPersistTokens).FKey,this.FEnabled=rtl.as(e,t.TPersistTokens).FEnabled)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1})})),rtl.createClass(this,"TRESTApp",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FCallbackURL="",this.FSecret="",this.FAuthURL="",this.FClientID=""},this.Assign=function(e){t.TRESTApp.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TRESTApp).FKey,this.FClientID=rtl.as(e,t.TRESTApp).FClientID,this.FCallbackURL=rtl.as(e,t.TRESTApp).FCallbackURL,this.FSecret=rtl.as(e,t.TRESTApp).FSecret,this.FAuthURL=rtl.as(e,t.TRESTApp).FAuthURL)};var e=this.$rtti;e.addProperty("AuthURL",0,rtl.string,"FAuthURL","FAuthURL"),e.addProperty("ClientID",0,rtl.string,"FClientID","FClientID"),e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("CallbackURL",0,rtl.string,"FCallbackURL","FCallbackURL"),e.addProperty("Secret",0,rtl.string,"FSecret","FSecret")})),this.TAuthLocale={0:"lcDefault",lcDefault:0,1:"lcEnglish",lcEnglish:1,2:"lcDutch",lcDutch:2,3:"lcGerman",lcGerman:3,4:"lcFrench",lcFrench:4,5:"lcSpanish",lcSpanish:5,6:"lcItalian",lcItalian:6,7:"lcPortuguese",lcPortuguese:7,8:"lcGreek",lcGreek:8,9:"lcDanish",lcDanish:9,10:"lcRussian",lcRussian:10,11:"lcRomanian",lcRomanian:11,12:"lcSwedish",lcSwedish:12,13:"lcFinnish",lcFinnish:13,14:"lcTurkish",lcTurkish:14,15:"lcJapanese",lcJapanese:15},rtl.recNewT(this,"TCoreCloudHeader",(function(){this.header="",this.value="",this.$eq=function(t){return this.header===t.header&&this.value===t.value},this.$assign=function(t){return this.header=t.header,this.value=t.value,this}})),rtl.createClass(this,"TRESTClient",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAccessToken="",this.FRefreshToken="",this.FAccessExpiry=0,this.FRefreshExpiry=0,this.FOnAccessToken=null,this.FOnAuthFailed=null,this.FEventRegistered=!1,this.FOnResponse=null,this.FPersistTokens=null,this.FApp=null,this.FScopes=null,this.FLocale=0,this.FOnRequestResponse=null,this.FOnError=null,this.FResponseType=0,this.FLoginWidth=0,this.FLoginHeight=0,this.FHandleAccessTokenPtr=null,this.FHandleAuthClosePtr=null,this.FOpenResolver=null},this.$final=function(){this.FOnAccessToken=void 0,this.FOnAuthFailed=void 0,this.FOnResponse=void 0,this.FPersistTokens=void 0,this.FApp=void 0,this.FScopes=void 0,this.FOnRequestResponse=void 0,this.FOnError=void 0,this.FOpenResolver=void 0,pas.Classes.TComponent.$final.call(this)},this.SetPersistTokens=function(t){this.FPersistTokens.Assign(t)},this.SetApp=function(t){this.FApp.Assign(t)},this.SetScopes=function(t){this.FScopes.Assign(t)},this.AuthWinClosed=function(){this.FEventRegistered&&this.DoAuthFailed()},this.InstallCallback=function(){var t=document.createElement("script");t.innerHTML=' function processAuthData(access_token) {var event = new CustomEvent("oauthcallback", {\r            detail: {\r                 message: access_token\r            },\r  bubbles: true,\r  cancelable: true});\r  document.dispatchEvent(event);}',document.head.appendChild(t);var e=document.createElement("script");return e.async=!0,e.defer=!0,e.type="text/javascript",document.body.appendChild(e),!0,!0},this.RemoveOAuthHandler=function(){document.removeEventListener("oauthcallback",this.FHandleAccessTokenPtr),this.FEventRegistered=!1},this.DoAuthFailed=function(){null!=this.FOnAuthFailed&&this.FOnAuthFailed(this),null!=this.FOpenResolver&&(this.FOpenResolver(!1),this.FOpenResolver=null)},this.HandleAccessToken=function(t){var e;return this.RemoveOAuthHandler(),e=t.detail.message,this.FAccessToken=e,this.WriteTokens(),null!=this.FOnAccessToken&&this.FOnAccessToken(this),null!=this.FOpenResolver&&(this.FOpenResolver(!0),this.FOpenResolver=null),!0,!0},this.GetAuthURL=function(){return this.FApp.FAuthURL},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FPersistTokens=t.TPersistTokens.$create("Create$1"),this.FApp=t.TRESTApp.$create("Create"),this.FScopes=pas.Classes.TStringList.$create("Create$1"),this.FLocale=0,this.FResponseType=0,this.FLoginWidth=800,this.FLoginHeight=600,this.FHandleAccessTokenPtr=rtl.createCallback(this,"HandleAccessToken"),this},this.Destroy=function(){null!=this.FHandleAuthClosePtr&&(this.FHandleAuthClosePtr=null),rtl.free(this,"FApp"),rtl.free(this,"FScopes"),rtl.free(this,"FPersistTokens"),pas.Classes.TComponent.Destroy.call(this)},this.HttpRequest=function(e,i,s,n,r){var o=this;return new Promise((function(a,l){var h=0,u=null;if((u=new XMLHttpRequest).addEventListener("load",rtl.createSafeCallback(null,(function(t){return a(t.target),!1}))),u.addEventListener("error",rtl.createSafeCallback(null,(function(t){return l(t.target),!1}))),u.responseType=t.THttpRequest.GetResponseType(o.FResponseType),u.open(e,i,!0),""!==n&&u.setRequestHeader("Content-Type",n),""!==o.FAccessToken&&u.setRequestHeader("Authorization","Bearer "+o.FAccessToken),rtl.length(r)>0)for(var d=0,F=rtl.length(r)-1;d<=F;d++)h=d,u.setRequestHeader(r[h].header,r[h].value);""===s?u.send(null):u.send(s)}))},this.URLEncode=function(t){return encodeURIComponent(t)},this.IsoToDateTime=function(t){var e=0,i=0,s=0,n=0,r=0,o=0,a=0,l=0;return a=0,pas.System.val$5(pas.System.Copy(t,1,4),{get:function(){return s},set:function(t){s=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(pas.System.Copy(t,6,2),{get:function(){return i},set:function(t){i=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(pas.System.Copy(t,9,2),{get:function(){return e},set:function(t){e=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(pas.System.Copy(t,12,2),{get:function(){return n},set:function(t){n=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(pas.System.Copy(t,15,2),{get:function(){return r},set:function(t){r=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(pas.System.Copy(t,18,2),{get:function(){return o},set:function(t){o=t}},{get:function(){return l},set:function(t){l=t}}),t.length>=20&&"."===t.charAt(19)&&pas.System.val$5(pas.System.Copy(t,21,3),{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),s<1&&(s=1),i<1&&(i=1),e<1&&(e=1),pas.SysUtils.EncodeDate(s,i,e)+pas.SysUtils.EncodeTime(n,r,o,a)},this.IsIsoDateTime=function(t){var e=0,i=0,s=0,n=0,r=0,o=0,a=0;if(!0,pas.System.val$5(pas.System.Copy(t,1,4),{get:function(){return s},set:function(t){s=t}},{get:function(){return a},set:function(t){a=t}}),0!==a)return!1;if("-"!==pas.System.Copy(t,5,1))return!1;if(pas.System.val$5(pas.System.Copy(t,6,2),{get:function(){return i},set:function(t){i=t}},{get:function(){return a},set:function(t){a=t}}),0!==a)return!1;if("-"!==pas.System.Copy(t,8,1))return!1;if(pas.System.val$5(pas.System.Copy(t,9,2),{get:function(){return e},set:function(t){e=t}},{get:function(){return a},set:function(t){a=t}}),0!==a)return!1;if(pas.System.val$5(pas.System.Copy(t,12,2),{get:function(){return n},set:function(t){n=t}},{get:function(){return a},set:function(t){a=t}}),0===a){if(":"!==pas.System.Copy(t,14,1))return!1;if(pas.System.val$5(pas.System.Copy(t,15,2),{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),0!==a)return!1;if(":"!==pas.System.Copy(t,17,1))return!1;if(pas.System.val$5(pas.System.Copy(t,18,2),{get:function(){return o},set:function(t){o=t}},{get:function(){return a},set:function(t){a=t}}),0!==a)return!1}return!0},this.DoAuth=function(){var t,e;this.FEventRegistered||(document.addEventListener("oauthcallback",this.FHandleAccessTokenPtr),this.FEventRegistered=!0),t=this.GetAuthURL(),e="width="+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({p:this,get:function(){return this.p.FLoginWidth},set:function(t){this.p.FLoginWidth=t}})+",height="+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({p:this,get:function(){return this.p.FLoginHeight},set:function(t){this.p.FLoginHeight=t}})+",location=no,toolbar=no,menubar=no",this.FHandleAuthClosePtr=rtl.createCallback(this,"AuthWinClosed");var i=this.FHandleAuthClosePtr,s=window.open(t,"oauth",e),n=0;!function t(){s.closed?(clearTimeout(n),i()):n=setTimeout(t,1e3)}()},this.Authenticate=async function(){var t=this;return new Promise((function(e,i){var s=null;s=function(i){var n;return document.removeEventListener("oauthcallback",s),n=i.detail.message,t.FAccessToken=n,t.WriteTokens(),e(t.FAccessToken),!1},document.addEventListener("oauthcallback",s),t.DoAuth()}))},this.ReadTokens=function(){var t=null;this.FPersistTokens.FEnabled&&""!==this.FPersistTokens.FKey&&(t=pas["WEBLib.Storage"].TLocalStorage.$create("Create"),this.FAccessToken=t.GetValues(this.FPersistTokens.FKey),this.FRefreshToken=t.GetValues(this.FPersistTokens.FKey+"refresh"),this.FAccessExpiry=this.$class.IsoToDateTime(t.GetValues(this.FPersistTokens.FKey+"accessexpiry")),this.FRefreshExpiry=this.$class.IsoToDateTime(t.GetValues(this.FPersistTokens.FKey+"refreshexpiry")),t=rtl.freeLoc(t))},this.WriteTokens=function(){var t=null;this.FPersistTokens.FEnabled&&""!==this.FPersistTokens.FKey&&((t=pas["WEBLib.Storage"].TLocalStorage.$create("Create")).SetValues(this.FPersistTokens.FKey,this.FAccessToken),t.SetValues(this.FPersistTokens.FKey+"refresh",this.FRefreshToken),t.SetValues(this.FPersistTokens.FKey+"accessexpiry",pas["WEBLib.Utils"].TDateTimeHelper.ToIsoString.call({p:this,get:function(){return this.p.FAccessExpiry},set:function(t){this.p.FAccessExpiry=t}},!0,!1)),t.SetValues(this.FPersistTokens.FKey+"refreshexpiry",pas["WEBLib.Utils"].TDateTimeHelper.ToIsoString.call({p:this,get:function(){return this.p.FRefreshExpiry},set:function(t){this.p.FRefreshExpiry=t}},!0,!1)),t=rtl.freeLoc(t))},this.ClearTokens=function(){this.FAccessToken="",this.WriteTokens()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("App",2,t.$rtti.TRESTApp,"FApp","SetApp"),e.addProperty("LoginHeight",0,rtl.longint,"FLoginHeight","FLoginHeight",{Default:600}),e.addProperty("LoginWidth",0,rtl.longint,"FLoginWidth","FLoginWidth",{Default:800}),e.addProperty("PersistTokens",2,t.$rtti.TPersistTokens,"FPersistTokens","SetPersistTokens"),e.addProperty("ResponseType",0,t.$rtti.THTTPRequestResponseType,"FResponseType","FResponseType",{Default:t.THTTPRequestResponseType.rtDefault}),e.addProperty("Scopes",2,pas.Classes.$rtti.TStrings,"FScopes","SetScopes"),e.addProperty("OnAccessToken",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAccessToken","FOnAccessToken"),e.addProperty("OnAuthFailed",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAuthFailed","FOnAuthFailed"),e.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti.THTTPRequestResponseEvent,"FOnRequestResponse","FOnRequestResponse"),e.addProperty("OnResponse",0,t.$rtti.THttpResponse,"FOnResponse","FOnResponse"),e.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti.THTTPErrorEvent,"FOnError","FOnError")})),this.HTTPCommand=function(t,e){var i="";return 0===t?i="GET":1===t?i="POST":2===t?i="PUT":3===t?i="DELETE":4===t?i="HEAD":5===t?i="PATCH":6===t&&(i=e),i},t.$init=function(){t.TRESTClient.InstallCallback()}}),["WEBLib.Storage","WEBLib.Utils"]),rtl.module("WEBLib.Utils",["System","Types","Web","SysUtils","Math","Classes","JS"],(function(){"use strict";var t=this;rtl.createHelper(this,"TLongIntHelper",null,(function(){this.ToString=function(){return t.TLongIntHelper.ToString$1(this.get())},this.ToString$1=function(t){return t.toString()}})),rtl.createHelper(this,"TDateTimeHelper",null,(function(){this.ToIsoString=function(t,e){var i=0,s=0,n=0,r=0,o=0,a=0,l=0,h="",u="",d="";function F(t,e){var i="";for(i=pas.SysUtils.IntToStr(t);i.length<e;)i="0"+i;return i}return t&&(h="-",u=":"),pas.SysUtils.DecodeDate(this.get(),{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}}),pas.SysUtils.DecodeTime(this.get(),{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),e&&(d="."+F(l,3)+"Z"),F(n,4)+h+F(s,2)+h+F(i,2)+"T"+F(r,2)+u+F(o,2)+u+F(a,2)+d}})),this.FormatProp=function(t,e){return pas.SysUtils.Format$1(t,e,pas.SysUtils.TFormatSettings.Invariant())}}),["RTLConsts","WEBLib.Consts","WEBLib.REST"]),rtl.module("WEBLib.Controls",["System","Classes","WEBLib.Graphics","Types","SysUtils","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.VK_BACK=8,this.VK_TAB=9,this.VK_RETURN=13,this.VK_ESCAPE=27,this.VK_END=35,this.VK_HOME=36,this.VK_LEFT=37,this.VK_UP=38,this.VK_RIGHT=39,this.VK_DOWN=40,this.VK_DELETE=46,this.WHEEL_DELTA=120,this.$rtti.$inherited("TCursor",rtl.longint,{}),this.crDefault=0,this.crNone=1,this.crArrow=2,this.crCross=3,this.crIBeam=4,this.crSize=5,this.crSizeNESW=6,this.crSizeNS=7,this.crSizeNWSE=8,this.crSizeWE=9,this.crUpArrow=10,this.crHourGlass=11,this.crDrag=12,this.crNoDrop=13,this.crHSplit=14,this.crVSplit=15,this.crMultIDrag=16,this.crSQLWait=17,this.crNo=18,this.crAppStart=19,this.crHelp=20,this.crHandPoint=21,this.crSizeAll=22,this.CSSBackground="background-color",this.CSSZIndex="z-index",this.TCSSLibrary={0:"cssNone",cssNone:0,1:"cssBootstrap",cssBootstrap:1},this.$rtti.$Enum("TCSSLibrary",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TCSSLibrary}),this.TDragState={0:"dsDragEnter",dsDragEnter:0,1:"dsDragLeave",dsDragLeave:1,2:"dsDragMove",dsDragMove:2},this.$rtti.$Enum("TDragState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDragState}),this.TDragMode={0:"dmManual",dmManual:0,1:"dmAutomatic",dmAutomatic:1},this.$rtti.$Enum("TDragMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragMode}),this.TDragKind={0:"dkDrag",dkDrag:0,1:"dkDock",dkDock:1},this.$rtti.$Enum("TDragKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragKind}),rtl.createClass(this,"TDragObject",pas.System.TObject,(function(){})),this.TAlign={0:"alNone",alNone:0,1:"alTop",alTop:1,2:"alBottom",alBottom:2,3:"alLeft",alLeft:3,4:"alRight",alRight:4,5:"alClient",alClient:5,6:"alCustom",alCustom:6},this.$rtti.$Enum("TAlign",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TAlign}),this.TMouseButton={0:"mbLeft",mbLeft:0,1:"mbRight",mbRight:1,2:"mbMiddle",mbMiddle:2},this.$rtti.$Enum("TMouseButton",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMouseButton}),this.TBorderStyle={0:"bsNone",bsNone:0,1:"bsSingle",bsSingle:1},this.$rtti.$Enum("TBorderStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TBorderStyle}),this.TSizeStyle={0:"ssPercent",ssPercent:0,1:"ssAbsolute",ssAbsolute:1,2:"ssAuto",ssAuto:2},this.$rtti.$Enum("TSizeStyle",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TSizeStyle}),this.TScrollStyle={0:"ssNone",ssNone:0,1:"ssHorizontal",ssHorizontal:1,2:"ssVertical",ssVertical:2,3:"ssBoth",ssBoth:3},this.$rtti.$Enum("TScrollStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TScrollStyle}),this.TStyleElements$a={0:"seFont",seFont:0,1:"seClient",seClient:1,2:"seBorder",seBorder:2},this.$rtti.$Enum("TStyleElements$a",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TStyleElements$a}),this.$rtti.$Set("TStyleElements",{comptype:this.$rtti.TStyleElements$a}),this.TAnchorKind={0:"akLeft",akLeft:0,1:"akTop",akTop:1,2:"akRight",akRight:2,3:"akBottom",akBottom:3},this.$rtti.$Enum("TAnchorKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TAnchorKind}),this.$rtti.$Set("TAnchors",{comptype:this.$rtti.TAnchorKind}),this.$rtti.$inherited("TElementClassName",rtl.string,{}),this.$rtti.$inherited("TElementID",rtl.string,{}),this.TElementFont={0:"efProperty",efProperty:0,1:"efCSS",efCSS:1},this.$rtti.$Enum("TElementFont",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TElementFont}),this.TElementPosition={0:"epAbsolute",epAbsolute:0,1:"epRelative",epRelative:1,2:"epIgnore",epIgnore:2},this.$rtti.$Enum("TElementPosition",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TElementPosition}),this.TElementEvent={0:"eeClick",eeClick:0,1:"eeMouseDown",eeMouseDown:1,2:"eeMouseUp",eeMouseUp:2,3:"eeMouseMove",eeMouseMove:3,4:"eeDblClick",eeDblClick:4,5:"eeKeyPress",eeKeyPress:5,6:"eeKeyDown",eeKeyDown:6,7:"eeKeyUp",eeKeyUp:7},this.TTextDirection={0:"tdDefault",tdDefault:0,1:"tdLeftToRight",tdLeftToRight:1,2:"tdRightToLeft",tdRightToLeft:2,3:"tdInherit",tdInherit:3},this.$rtti.$Enum("TTextDirection",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTextDirection}),rtl.recNewT(this,"TJSXMLHttpRequestRecord",(function(){this.req=null,this.$eq=function(t){return this.req===t.req},this.$assign=function(t){return this.req=t.req,this},t.$rtti.$Record("TJSXMLHttpRequestRecord",{}).addField("req",pas.Web.$rtti.TJSXMLHttpRequest)})),rtl.recNewT(this,"TJSEventRecord",(function(){this.event=null,this.$eq=function(t){return this.event===t.event},this.$assign=function(t){return this.event=t.event,this},t.$rtti.$Record("TJSEventRecord",{}).addField("event",pas.Web.$rtti.TJSEvent)})),this.$rtti.$MethodVar("THTTPResponseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResponse",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("THTTPRequestResponseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("THTTPAbortEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("THTTPErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["Event",this.$rtti.TJSEventRecord],["Handled",rtl.boolean,1]]),methodkind:0}),rtl.recNewT(this,"TJSHTMLElementRecord",(function(){this.element=null,this.$eq=function(t){return this.element===t.element},this.$assign=function(t){return this.element=t.element,this},t.$rtti.$Record("TJSHTMLElementRecord",{}).addField("element",pas.Web.$rtti.TJSHTMLElement)})),rtl.recNewT(this,"TJSObjectRecord",(function(){this.jsobject=null,this.$eq=function(t){return this.jsobject===t.jsobject},this.$assign=function(t){return this.jsobject=t.jsobject,this},t.$rtti.$Record("TJSObjectRecord",{}).addField("jsobject",pas.JS.$rtti.TJSObject)})),this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TMouseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",this.$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["WheelDelta",rtl.longint],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseMoveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TKeyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AKey",rtl.word,1],["Shift",pas.Classes.$rtti.TShiftState]]),methodkind:0}),this.$rtti.$MethodVar("TKeyPressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AChar",rtl.char,1]]),methodkind:0}),this.$rtti.$MethodVar("TTouchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TBiDiMode={0:"bdLeftToRight",bdLeftToRight:0,1:"bdRightToLeft",bdRightToLeft:1,2:"bdRightToLeftNoAlign",bdRightToLeftNoAlign:2,3:"bdRightToLeftReadingOnly",bdRightToLeftReadingOnly:3},this.$rtti.$Enum("TBiDiMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBiDiMode}),this.$rtti.$MethodVar("TDragOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint],["State",this.$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDragDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TStartDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TEndDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Target",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TControlStyleValue={0:"csAcceptsControls",csAcceptsControls:0,1:"csSetCaption",csSetCaption:1},rtl.createClass(this,"TMargins",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){t!==this.FLeft&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){t!==this.FTop&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){t!==this.FRight&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){t!==this.FBottom&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FLeft=3,this.FTop=3,this.FBottom=3,this.FRight=3,this},this.Assign=function(e){t.TMargins.isPrototypeOf(e)?(this.FLeft=rtl.as(e,t.TMargins).FLeft,this.FTop=rtl.as(e,t.TMargins).FTop,this.FBottom=rtl.as(e,t.TMargins).FBottom,this.FRight=rtl.as(e,t.TMargins).FRight):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:3}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:3}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:3}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:3})})),rtl.createClass(this,"TCenter",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FHorizontal=!1,this.FVertical=!1,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHorizontal=function(t){this.FHorizontal!==t&&(this.FHorizontal=t,this.DoChange())},this.SetVertical=function(t){this.FVertical!==t&&(this.FVertical=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TCenter.isPrototypeOf(e)&&(this.FHorizontal=rtl.as(e,t.TCenter).FHorizontal,this.FVertical=rtl.as(e,t.TCenter).FVertical)};var e=this.$rtti;e.addProperty("Horizontal",2,rtl.boolean,"FHorizontal","SetHorizontal",{Default:!1}),e.addProperty("Vertical",2,rtl.boolean,"FVertical","SetVertical",{Default:!1})})),rtl.createClass(this,"TPadding",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){this.FRight!==t&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){this.FBottom!==t&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0,this},this.Assign=function(e){t.TPadding.isPrototypeOf(e)&&(this.FLeft=rtl.as(e,t.TPadding).FLeft,this.FRight=rtl.as(e,t.TPadding).FRight,this.FTop=rtl.as(e,t.TPadding).FTop,this.FBottom=rtl.as(e,t.TPadding).FBottom)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:0}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:0}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:0}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:0})})),rtl.createInterface(this,"IControl","{6325F220-F2E4-384C-B7C4-A6C697D13DCF}",["EnterChildren","ExitChildren"],pas.System.IUnknown),rtl.createClass(this,"TControl",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FGotFocus=!1,this.FAcceptDrag=!1,this.FCaptureDown=!1,this.FMouseInsideLayer=!1,this.FLayer=null,this.FCaptured=!1,this.FControlCreated=!1,this.FUpdateCount=0,this.FBlockUpdateElement=!1,this.FElement=null,this.FID="",this.FNew=!1,this.FContainer=null,this.FElementEvent=null,this.FLastElementEvent=null,this.FElementClassName="",this.FFont=null,this.FParent=null,this.FPrevParent=null,this.FControls=[],this.FOnDragOver=null,this.FOnDragDrop=null,this.FOnStartDrag=null,this.FonEndDrag=null,this.FOnClick=null,this.FOnDblClick=null,this.FOnMouseDown=null,this.FOnMouseUp=null,this.FOnMouseMove=null,this.FOnKeyDown=null,this.FOnKeyUp=null,this.FOnKeyPress=null,this.FOnEnter=null,this.FOnExit=null,this.FEnabled=!1,this.FHint="",this.FRole="",this.FShowHint=!1,this.FTabOrder=0,this.FTabStop=!1,this.FVisible=!1,this.FWidth=0,this.FHeight=0,this.FTag$1=0,this.FAlign=0,this.FAnchors={},this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FOnMouseEnter=null,this.FOnMouseLeave=null,this.FCursor=0,this.FDoubleBuffered=!1,this.FControlStyle={},this.FMargins=null,this.FCenter=null,this.FOnMouseWheel=null,this.FParentDoubleBuffered=!1,this.FParentColor=!1,this.FParentFont=!1,this.FParentBiDiMode=!1,this.FOnTouchMove=null,this.FOnTouchStart=null,this.FOnTouchEnd=null,this.FOnTouchCancel=null,this.FLinkTouchEvents=!1,this.FWidthStyle=0,this.FHeightStyle=0,this.FWidthPercent=0,this.FHeightPercent=0,this.FOrigRect=pas.Types.TRect.$new(),this.FOrigParentRect=pas.Types.TRect.$new(),this.FIsResizing=!1,this.FShowFocus=!1,this.FBorderWidth=0,this.FOrigTop=0,this.FOrigLeft=0,this.FUpdateTopLeft=!1,this.FEnablePropagation=!1,this.FParentShowHint=!1,this.FScriptLoaded=!1,this.FControlScriptCountLoaded=0,this.FRequiredScripts=null,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FClipChildren=!1,this.FTextDirection=0,this.FEventStopPropagation={},this.FOnResize=null,this.FMouseMovePtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseEnterPtr=null,this.FMouseLeavePtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FContextMenuPtr=null,this.FExitPtr=null,this.FEnterPtr=null,this.FWheelPtr=null,this.FLayerMouseEnterPtr=null,this.FLayerMouseLeavePtr=null,this.FScriptLoadedPtr=null,this.FDragStartPtr=null,this.FDragOverPtr=null,this.FDragEnterPtr=null,this.FDragLeavePtr=null,this.FDragEndPtr=null,this.FDragDropPtr=null,this.FChildOrder=0,this.FAllowTouch=!1,this.FWheelAccumulator=0,this.FWheelMousePos=pas.Types.TPoint.$new(),this.FBiDiMode=0,this.FOnMouseWheelDown=null,this.FOnMouseWheelUp=null,this.FNoUserSelect=!1,this.FEventsBound=!1,this.FDragMode=0,this.FToolTip=void 0,this.FDesignTime=!1,this.FColor=0},this.$final=function(){this.FLayer=void 0,this.FElement=void 0,this.FContainer=void 0,this.FElementEvent=void 0,this.FLastElementEvent=void 0,this.FFont=void 0,this.FParent=void 0,this.FPrevParent=void 0,this.FControls=void 0,this.FOnDragOver=void 0,this.FOnDragDrop=void 0,this.FOnStartDrag=void 0,this.FonEndDrag=void 0,this.FOnClick=void 0,this.FOnDblClick=void 0,this.FOnMouseDown=void 0,this.FOnMouseUp=void 0,this.FOnMouseMove=void 0,this.FOnKeyDown=void 0,this.FOnKeyUp=void 0,this.FOnKeyPress=void 0,this.FOnEnter=void 0,this.FOnExit=void 0,this.FAnchors=void 0,this.FOnMouseEnter=void 0,this.FOnMouseLeave=void 0,this.FControlStyle=void 0,this.FMargins=void 0,this.FCenter=void 0,this.FOnMouseWheel=void 0,this.FOnTouchMove=void 0,this.FOnTouchStart=void 0,this.FOnTouchEnd=void 0,this.FOnTouchCancel=void 0,this.FOrigRect=void 0,this.FOrigParentRect=void 0,this.FRequiredScripts=void 0,this.FParentElement=void 0,this.FEventStopPropagation=void 0,this.FOnResize=void 0,this.FWheelMousePos=void 0,this.FOnMouseWheelDown=void 0,this.FOnMouseWheelUp=void 0,pas.Classes.TComponent.$final.call(this)},this.GetControlsCount=function(){return rtl.length(this.FControls)},this.GetControls=function(t){return this.FControls[t]},this.SetVisible=function(t){this.FVisible!==t&&(this.VisibleChanging(),this.FVisible=t,this.UpdateElement(),this.DoRealign(),this.AlignControl(this),this.VisibleChanged())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.UpdateElement())},this.SetShowHint=function(t){this.FShowHint!==t&&(this.FShowHint=t,this.UpdateElement())},this.SetTabOrder=function(t){this.FTabOrder!==t&&(this.FTabOrder=t,this.UpdateElement())},this.SetTabStop=function(t){this.FTabStop!==t&&(this.FTabStop=t,this.UpdateElement())},this.SetAlign=function(t){this.FAlign!==t&&(this.FAlign=t,this.DoRealign())},this.SetAlignWithMargins=function(t){this.FAlignWithMargins!==t&&(this.FAlignWithMargins=t,this.DoRealign())},this.GetBoundsRect=function(){var t=pas.Types.TRect.$new();return t.Left=this.GetLeft(),t.Top=this.GetTop(),t.Right=this.GetLeft()+this.GetWidth(),t.Bottom=this.GetTop()+this.GetHeight(),t},this.SetID=function(t){var e=null,i=null,s=null,n=null,r=0,o=0,a=0,l=0;if(this.FNew&&this.FID!==t&&null!=(e=document.getElementById(t)))return r=this.FLeft,o=this.FTop,a=this.FWidth,l=this.FHeight,i=null,this.UnbindEvents(),null!=this.FContainer&&(this.FParentElement=this.FContainer.parentElement,i=document.createElement("SPAN"),this.$class.MoveElements(this.FContainer,i)),n=this.FParent,this.SetParent(null),this.CreateWithID(t),this.SetParentComponent(n),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),4 in this.FComponentState&&(this.FLeft=r,this.FTop=o),void(null!=i&&(this.GetElementHandle().textContent="",this.MoveElementsAndFree(i,this.GetElementHandle())));if(!this.FNew&&this.FID!==t){if(a=this.FWidth,l=this.FHeight,null!=(e=document.getElementById(this.FID))&&(i=document.createElement("SPAN"),this.$class.MoveElements(e,i),this.UnbindEvents()),""!==t&&null!=(e=document.getElementById(t)))return this.CreateWithID(t),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),void this.MoveElementsAndFree(i,this.FContainer);this.FNew=!0,this.FElement=null,this.CreateControl(),""===t&&(this.CreateInitialize(),this.FWidth=a,this.FHeight=l),null!=this.FParentElement?this.FParentElement.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&(this.SetParent(s),this.SetElementPosition(0),this.SetLeft(0),this.SetTop(0)),null!=i&&this.MoveElementsAndFree(i,this.FContainer),this.UpdateElement(),this.UpdateElementSize()}this.FID=t,null!=this.FContainer&&this.FContainer.setAttribute("id",t)},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetAnchors=function(t){rtl.neSet(this.FAnchors,t)&&(this.FAnchors=rtl.refSet(t),0 in this.FComponentState||this.UpdateAnchoring())},this.GetElementEvent=function(){return this.FElementEvent},this.GetIsLinked=function(){return!this.FNew},this.SetElementFont=function(t){this.FElementFont!==t&&(this.FElementFont=t,this.UpdateElementVisual())},this.SetElementPosition=function(t){this.FElementPosition!==t&&(this.FElementPosition=t,null!=this.GetElementHandle()&&(this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize()))},this.SetClipChildren=function(t){this.FClipChildren=t,this.UpdateElement()},this.SetChildOrderEx=function(t){this.FChildOrder=t},this.GetRole=function(){var t="";return t=this.FRole,null!=this.GetElementHandle()&&(t=this.GetElementHandle().getAttribute("role")),t},this.SetRole=function(t){this.FRole=t,null!=this.GetElementHandle()&&(""===t?this.GetElementHandle().removeAttribute("role"):this.GetElementHandle().setAttribute("role",t))},this.GetContainer=function(){return this.FContainer},this.GetChildContainer=function(){return this.FContainer},this.SetParentFont=function(t){t!==this.FParentFont&&t&&null!=this.FParent&&(this.BeginUpdate(),this.FFont.Assign(this.FParent.FFont),this.EndUpdate(),this.UpdateElement()),this.FParentFont=t},this.SetParentColor=function(t){this.FParentColor!==t&&t&&null!=this.FParent&&this.SetColor(this.FParent.FColor),this.FParentColor=t},this.SetDragMode=function(t){this.FDragMode=t,1===t?this.BeginDrag():this.DisableDrag()},this.GetClientHeight=function(){return this.GetHeight()},this.GetClientWidth=function(){return this.GetWidth()},this.SetHeightStyle=function(t){this.FHeightStyle!==t&&(this.FHeightStyle=t,2!==this.FHeightStyle||null==this.GetElementHandle()||this.GetIsLinked()||this.GetElementStyle().removeProperty("height"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthStyle=function(t){this.FWidthStyle!==t&&(this.FWidthStyle=t,2!==this.FWidthStyle||null==this.GetElementHandle()||this.GetIsLinked()||this.GetElementStyle().removeProperty("width"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetHeightPercent=function(t){this.FHeightPercent!==t&&(this.FHeightPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthPercent=function(t){this.FWidthPercent!==t&&(this.FWidthPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.UpdateElement())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.ResetAnchoring(),this.DoBoundsChange(),!this.GetIsLinked()||1!==this.FWidthStyle||0 in this.FComponentState||this.IsUpdating()||null==this.GetElementHandle()||(t>=0?this.GetElementStyle().setProperty("width",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("width")))},this.SetHeight=function(t){var e=null;this.FHeight!==t&&(this.FAlign in rtl.createSet(3,4,5)&&null!=this.GetElementHandle()&&(e=this.GetElementHandle().getBoundingClientRect()).top+t>=pas["WEBLib.Forms"].WinHeight()&&(t=Math.round(pas["WEBLib.Forms"].WinHeight()-e.top)),this.FHeight=t,this.ResetAnchoring(),this.DoBoundsChange(),!this.GetIsLinked()||1!==this.FHeightStyle||0 in this.FComponentState||this.IsUpdating()||null==this.GetElementHandle()||(t>=0?this.GetElementStyle().setProperty("height",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("height")))},this.SetWidthInt=function(t){this.FWidth=t},this.SetHeightInt=function(t){this.FHeight=t},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateElementData())},this.RecreateCanvas=function(){},this.VisibleChanging=function(){},this.VisibleChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).VisibleChanged()},this.ColorChanging=function(){},this.FocusedControlEntered=function(){var e=null,i=null,s=rtl.createIntfRefs();try{for(e=this.FParent;!(null===e||pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(e,pas.System.IUnknown)),rtl.getIntfGUIDR(t.IControl),{get:function(){return i},set:function(t){i=t}})&&i.EnterChildren(s.ref(2,rtl.queryIntfT(this,t.IControl))));)e=e.FParent}finally{s.free(),rtl._Release(i)}},this.FocusedControlExited=function(){var e=null,i=null,s=rtl.createIntfRefs();try{for(e=this.FParent;!(null===e||pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(e,pas.System.IUnknown)),rtl.getIntfGUIDR(t.IControl),{get:function(){return i},set:function(t){i=t}})&&i.ExitChildren(s.ref(2,rtl.queryIntfT(this,t.IControl))));)e=e.FParent}finally{s.free(),rtl._Release(i)}},this.EnterChildren=function(t){return!1,!1},this.ExitChildren=function(t){return!1,!1},this.GetWidth=function(){var t=0,e=null;return t=this.FWidth,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetWidth))),1!==this.FWidthStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.right-e.left)))),t},this.GetHeight=function(){var t=0,e=null;return t=this.FHeight,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetHeight))),1!==this.FHeightStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.bottom-e.top)))),t},this.GetOuterWidth=function(){return this.FWidth-this.FBorderWidth},this.GetOuterHeight=function(){return this.FHeight-this.FBorderWidth},this.GetDesignWidth=function(){return this.FWidth},this.GetDesignHeight=function(){return this.FHeight},this.GetDesignLeft=function(){return this.FLeft},this.GetDesignTop=function(){return this.FTop},this.GetLeft=function(){var t=0;return-1!==(t=this.FLeft)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetLeft)),t},this.GetTop=function(){var t=0;return-1!==(t=this.FTop)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetTop)),t},this.HandleAllocated=function(){return!0,!0},this.CreateElement=function(){return null,null},this.CreateChildElements=function(t){},this.ContainerElement=function(){return document.body},this.IsStructuralElement=function(){return!1,!1},this.IsEnabled=function(){return this.FEnabled},this.GetNewName=function(){var e,i="",s="";return i=this.$classname,pas.System.Delete({get:function(){return i},set:function(t){i=t}},1,1),s="",null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&(s=e.$classname),s+"_"+t.FindUniqueName(i)},this.IsInputControl=function(){return!1,!1},this.UseCSSFont=function(){return!(""===this.FElementClassName&&0===this.FElementFont&&!this.GetIsLinked())},this.UseCSSFontColor=function(){return!(pas["WEBLib.Forms"].Application.FThemed&&pas["WEBLib.Graphics"].ColorToRGB(this.FFont.FColor)===pas["WEBLib.Graphics"].RGB(0,0,0))},this.RecreateElement=function(){null!=this.GetContainer()&&(this.UnbindEvents(),this.GetContainer().parentNode.removeChild(this.GetContainer()),this.FElement=null,this.CreateControl(),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer()))},this.BindElement=function(){},this.CreateInitialize=function(){var t=null;this.FDesignTime=4 in this.FComponentState&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState),this.FRequiredScripts=pas.Classes.TStringList.$create("Create$1"),this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.FClipChildren=!0,this.FDesignTime&&null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&pas["WEBLib.Forms"].TForm.isPrototypeOf(t)&&0!==rtl.as(t,pas["WEBLib.Forms"].TForm).FCSSLibrary&&this.InitCSSLibrary(rtl.as(t,pas["WEBLib.Forms"].TForm).FCSSLibrary)},this.DestroyControls=function(){for(var t=0,e=null,i=this.GetControlsCount()-1;i>=0;i--)t=i,e=this.GetControls(t),e=rtl.freeLoc(e)},this.ClearControls=function(){this.FControls=rtl.arraySetLength(this.FControls,null,0)},this.GetElementStyle=function(){return this.GetElementHandle().style},this.InitCSSLibrary=function(t){},this.SetControlCursor=function(t){this.FCursor=t,""===this.FElementClassName&&null!=this.GetElementHandle()&&this.SetElementPointer(this.GetElementHandle(),t)},this.SetBiDiMode=function(t){null!=this.GetElementHandle()&&(0===t?this.GetElementHandle().removeAttribute("dir"):this.GetElementHandle().setAttribute("dir","rtl"))},this.GetMouseEventButton=function(t){var e=0;e=0;var i=t.button;return 0===i?e=0:1===i?e=2:2===i&&(e=1),e},this.GetMouseEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),1==(1&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(3))),2==(2&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(4))),4==(4&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(5))),e},this.GetKeyBoardEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetMouseWheelEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetTouchEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.HandleDoClick=function(t){return this.FElementEvent=t,0 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.Click(),!0,this.FElementEvent=null,!0},this.HandleDoWheel=function(t){var e,i=!1,s=0,n=0;return this.FElementEvent=t,this.StopPropagation(),this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),this.FWheelMousePos.x=Math.round(s),this.FWheelMousePos.y=Math.round(n),e=rtl.refSet(this.GetMouseWheelEventShiftState(t)),i=!1,this.MouseWheel(rtl.refSet(e),pas.System.Trunc(-t.deltaY),{get:function(){return i},set:function(t){i=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDblClick=function(t){return this.FCaptureDown=!1,this.FElementEvent=t,4 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.DblClick(),!0,this.FElementEvent=null,!0},this.HandleDoMouseDown=function(i){var s,n,r,o=!1,a=0,l=0;return r=i,this.FElementEvent=r,1 in this.FEventStopPropagation&&this.StopPropagation(),this.CanFocus()||this.PreventDefault(),e.FMouseX=Math.round(r.clientX),e.FMouseY=Math.round(r.clientY),this.XYToClient(r.clientX,r.clientY,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),this.HasVertScrollBar()&&a>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&l>this.GetHeight()-t.GetScrollBarHeight()||(s=rtl.refSet(this.GetMouseEventShiftState(r)),n=this.GetMouseEventButton(r),this.MouseDown(n,rtl.refSet(s),pas.System.Trunc(a),pas.System.Trunc(l)),o=!0,this.FElementEvent=null),o},this.HandleDoMouseUp=function(e){var i,s,n,r=!1,o=0,a=0;return n=e,this.FElementEvent=n,2 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(n.clientX,n.clientY,{get:function(){return o},set:function(t){o=t}},{get:function(){return a},set:function(t){a=t}}),this.HasVertScrollBar()&&o>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&a>this.GetHeight()-t.GetScrollBarHeight()?(this.FElementEvent=null,r):(i=rtl.refSet(this.GetMouseEventShiftState(n)),s=this.GetMouseEventButton(n),0===this.FDragMode&&this.DisableDrag(),this.MouseUp(s,rtl.refSet(i),pas.System.Trunc(o),pas.System.Trunc(a)),r=!0,this.FElementEvent=null,r)},this.HandleDoMouseMove=function(t){var i,s,n=0,r=0;return s=t,this.FElementEvent=s,e.FCursorX=Math.round(s.clientX),e.FCursorY=Math.round(s.clientY),3 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(s.clientX,s.clientY,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i=rtl.refSet(this.GetMouseEventShiftState(s)),this.MouseMove(rtl.refSet(i),pas.System.Trunc(n),pas.System.Trunc(r)),!0,this.FElementEvent=null,!0},this.HandleDoMouseLeave=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseLeave(),e=!0)},this.HandleDoContextMenu=function(t){return!0,!0},this.LayerHandleDoMouseEnter=function(t){return 0===t.buttons&&this.Captured()&&!this.FMouseInsideLayer&&(this.ReleaseCapture(),this.HandleDoMouseUp(t),this.HandleDoMouseLeave(t)),this.FMouseInsideLayer=!0,!0,!0},this.LayerHandleDoMouseLeave=function(t){return this.FMouseInsideLayer=!1,!0,!0},this.HandleDoMouseEnter=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseEnter(),e=!0)},this.HandleDoKeyDown=function(t){var e,i=0,s={};return e=t,this.FElementEvent=e,6 in this.FEventStopPropagation&&this.StopPropagation(),null==e.key||(i=this.GetKeyCode(e.key,!0),s=rtl.refSet(this.GetKeyBoardEventShiftState(e)),this.KeyDown({get:function(){return i},set:function(t){i=t}},rtl.refSet(s)),i in rtl.createSet(13,27,9)&&this.KeyPreview({get:function(){return i},set:function(t){i=t}},rtl.refSet(s))),!0,0===i&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyUp=function(t){var e,i=0,s={},n="\0";return e=t,this.FElementEvent=e,7 in this.FEventStopPropagation&&this.StopPropagation(),null==e.key||(i=this.GetKeyCode(e.key,!0),s=rtl.refSet(this.GetKeyBoardEventShiftState(e)),27===i&&(n="",this.KeyPress({get:function(){return n},set:function(t){n=t}})),this.KeyUp({get:function(){return i},set:function(t){i=t}},rtl.refSet(s))),!0,0===i&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyPress=function(t){var e,i="\0";return e=t,this.FElementEvent=e,5 in this.FEventStopPropagation&&this.StopPropagation(),this.IsKeyCharacter(e.key)&&(i=this.GetKeyChar(e.key),this.KeyPress({get:function(){return i},set:function(t){i=t}})),!0,"\0"===i&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoInput=function(e){var i=!1,s="\0",n="";return t.IsAndroid()&&(this.FElementEvent=e,5 in this.FEventStopPropagation&&this.StopPropagation(),s="\0",""!==e.data&&(n=e.data,s=pas.System.Assigned(n)?n.charAt(n.length-1):"\b",this.KeyPress({get:function(){return s},set:function(t){s=t}})),i=!0,"\0"===s&&this.PreventDefault(),this.FElementEvent=null),i},this.HandleDoExit=function(t){return this.DoExit(),!0,this.FocusedControlExited(),!0},this.HandleDoEnter=function(t){return this.FElementEvent=t,this.StopPropagation(),this.DoEnter(),!0,this.FElementEvent=null,this.FGotFocus=!0,this.FocusedControlEntered(),!0},this.HandleDoTouchStart=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseDown(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchStart(pas.System.Trunc(e),pas.System.Trunc(i))),!0,this.FElementEvent=null,!0},this.HandleDoTouchMove=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),this.Captured()&&this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseMove(rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchMove(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchEnd=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FAllowTouch||this.PreventDefault(),this.ReleaseCapture(),this.StopPropagation(),null!=this.FLastElementEvent&&this.FLastElementEvent.touches.length>0&&(s=this.FLastElementEvent.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&(this.MouseUp(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.FEnabled&&!this.FAllowTouch&&this.Click()),this.TouchEnd(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchCancel=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.ReleaseCapture(),this.StopPropagation(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseUp(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchCancel(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoDragStart=function(t){var i=null;return this.FElementEvent=t,t.stopPropagation(),i=null,this.DoStartDrag({get:function(){return i},set:function(t){i=t}}),e.DragObject=null!=i?i:this,!0,!0},this.HandleDoDragOver=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,2,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!this.FAcceptDrag||this.IsInputControl()&&0!==t.dataTransfer.items.length||t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandleDoDragEnter=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag=this.IsInputControl(),this.DragOver(e.DragObject,t.clientX,t.clientY,0,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),this.FAcceptDrag&&t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandledoDragLeave=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,1,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDragEnd=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DoEndDrag(e.DragObject,t.clientX,t.clientY),!0,0===this.FDragMode&&this.DisableDrag(),this.FElementEvent=null,!0},this.HandleDoDragDrop=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag?(this.IsInputControl()||t.preventDefault(),this.DragDrop(e.DragObject,t.clientX,t.clientY)):t.preventDefault(),i=this.FAcceptDrag,this.FElementEvent=null,i},this.HandleKeyPreview=function(t){},this.HandleFontChanged=function(t){0===this.FUpdateCount&&(this.SetParentFont(!1),this.ParentFontChanged()),this.FontChanged()},this.ParentFontChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FParentFont&&(this.GetControls(t).FFont.Assign(this.FFont),this.GetControls(t).FontChanged(),this.GetControls(t).FParentFont=!0,this.GetControls(t).ParentFontChanged())},this.DoExit=function(){null!=this.FOnExit&&this.FOnExit(this)},this.DoEnter=function(){null!=this.FOnEnter&&this.FOnEnter(this)},this.Click=function(){null!=this.FOnClick&&this.IsEnabled()&&this.FOnClick(this)},this.UpdateElement=function(){this.FBlockUpdateElement||this.FUpdateCount>0||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement()||this.IsUpdating()||(this.UpdateElementData(),this.GetIsLinked()||this.UpdateElementVisual())},this.UpdateElementSize=function(){var t=null,e=0,i=0,s=0,n=null,r=null;if(!(this.FBlockUpdateElement||this.FUpdateCount>0||this.GetIsLinked()||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement())){for(t=this.GetElementStyle(),e=0,i=0,n=this.FParent;null!=n&&0===this.FElementPosition&&0!==n.FElementPosition&&!pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n);){if(n.GetIsLinked()&&null!=n.GetElementHandle()&&"absolute"!==n.GetElementHandle().style.getPropertyValue("position")){r=n.GetElementHandle().getBoundingClientRect(),e=Math.round(r.left),i=Math.round(r.top),null!=n.FParent&&null!=n.FParent.GetElementHandle()&&"absolute"===n.FParent.GetElementHandle().style.getPropertyValue("position")&&(r=n.FParent.GetElementHandle().getBoundingClientRect(),e-=Math.round(r.left),i-=Math.round(r.top));break}n=n.FParent}null!=this.FParent&&this.FParent.IsStructuralElement()&&(e=this.FParent.GetLeft(),i=this.FParent.GetTop()),0===this.FElementPosition?(-1!==this.FTop?t.setProperty("top",pas.SysUtils.IntToStr(this.FTop+i)+"px"):t.setProperty("top",""),-1!==this.FLeft?t.setProperty("left",pas.SysUtils.IntToStr(this.FLeft+e)+"px"):t.setProperty("left","")):(t.removeProperty("top"),t.removeProperty("left")),1===this.FWidthStyle&&(s=this.GetOuterWidth(),-1!==this.FWidth?t.setProperty("width",pas.SysUtils.IntToStr(s)+"px"):t.removeProperty("width")),2===this.FWidthStyle&&t.removeProperty("width"),1===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas.SysUtils.IntToStr(this.GetOuterHeight())+"px"):t.removeProperty("height")),2===this.FHeightStyle&&t.removeProperty("height"),0===this.FWidthStyle&&(-1!==this.FWidth?t.setProperty("width",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FWidthPercent))):t.removeProperty("width")),0===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FHeightPercent))):t.removeProperty("height")),0===this.FElementPosition?t.setProperty("position","absolute"):1===this.FElementPosition?t.setProperty("position","relative"):t.removeProperty("position"),t.setProperty("box-sizing","border-box")}},this.UpdateElementVisual=function(){var e,i,s=null;if(null!=(e=this.GetElementHandle())&&!this.IsUpdating()){s=this.GetElementStyle(),this.FParentFont&&null!=this.FParent&&(this.FFont.FOnChange=null,this.FFont.Assign(this.FParent.FFont),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged")),""===this.FElementClassName&&(this.GetIsLinked()||(this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?s.setProperty("overflow","hidden"):s.setProperty("overflow","")),this.SetElementPointer(e,this.FCursor)),this.Captured()&&this.FLayer.style.setProperty("cursor",s.getPropertyValue("cursor")),""!==this.FElementClassName||this.CanShowFocus()?s.setProperty("outline",""):s.setProperty("outline","none"),this.UpdateElementSize();var n=this.FTextDirection;0===n?s.removeProperty("direction"):2===n?s.setProperty("direction","rtl"):1===n?s.setProperty("direction","ltr"):3===n&&s.setProperty("direction","inherit"),""===this.FElementClassName&&this.FNoUserSelect&&(s.setProperty("webkit-user-select","none"),s.setProperty("moz-user-select","none"),s.setProperty("khtml-user-select","none"),s.setProperty("ms-user-select","none"),s.setProperty("user-select","none"),s.setProperty("-webkit-tap-highlight-color","transparent")),this.SetElementColor(e,this.FColor),i=this.UseCSSFont(),this.GetIsLinked()||t.SetHTMLElementFont(e,this.FFont,i),i?s.removeProperty("color"):this.IsEnabled()&&this.UseCSSFontColor()&&s.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))}},this.UpdateElementData=function(){var t=null,e=null,i="",s="",n="",r=0,o=0,a=void 0,l=!1;if(null!=this.GetElementHandle()){if(4 in this.FComponentState||(this.FVisible?this.GetElementStyle().setProperty("display",""):this.GetElementStyle().setProperty("display","none")),this.EnableTab(),null!=this.FContainer&&(this.IsEnabled()?(this.FContainer.removeAttribute("disabled"),this.FContainer.style.removeProperty("pointer-events")):(this.FContainer.setAttribute("disabled",""),this.FContainer.style.setProperty("pointer-events","none"))),this.GetIsLinked()&&""===this.FHint)return;if(null!=this.FContainer&&""!==this.GetRole()&&this.FContainer.setAttribute("role",this.FRole),(l=null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&1===t.FCSSLibrary)&&this.FShowHint&&""!==this.FHint){e=this.GetElementHandle(),i=this.FHint;var h=pas["WEBLib.Forms"].Application.FHintPosition;0===h?n="left":2===h?n="right":1===h?n="top":3===h&&(n="bottom"),s=pas["WEBLib.Forms"].Application.FHintClassName,r=pas["WEBLib.Forms"].Application.FHintPause,o=pas["WEBLib.Forms"].Application.FHintHidePause,(a=this.FToolTip)&&a.dispose(),e.setAttribute("title",i),a=new bootstrap.Tooltip(e,{title:i,trigger:"hover",placement:n,customClass:s,delay:{show:r,hide:o}}),this.FToolTip=a}else null!=this.FContainer&&(this.FShowHint&&""!==this.FHint?l?this.FContainer.setAttribute("data-title",this.FHint):this.FContainer.setAttribute("title",this.FHint):l?this.FContainer.removeAttribute("data-title"):this.FContainer.removeAttribute("title"));this.IsEnabled()&&1!==this.FElementFont?this.UseCSSFontColor()&&this.GetElementStyle().setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetElementStyle().removeProperty("color")}},this.UpdateParent=function(){this.InternalUpdateParent(),this.UpdateChildren(this.FPrevParent),this.UpdateChildren(this.FParent)},this.UpdateControlSize=function(t,e){this.FWidth=t,this.FHeight=e},this.InternalUpdateParent=function(){var t=null;t=this.FPrevParent,this.FNew&&(this.CreateControl(),null!=this.GetContainer()&&(null!=this.FParent&&null==this.FParent.GetContainer()&&this.FParent.CreateControl(),this.FParent!==t&&null!=t&&null!=t.GetContainer()&&this.GetContainer().parentNode===t.GetChildContainer()&&t.GetChildContainer().removeChild(this.GetContainer()),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer())))},this.UpdateChildren=function(e){var i=0,s=null;if(null!=e&&!(3 in this.FComponentState)){0!==e.FAlign&&e.DoRealign(),t.TCustomControl.isPrototypeOf(e)&&(rtl.as(e,t.TCustomControl).RecreateCanvas(),rtl.as(e,t.TCustomControl).Invalidate());for(var n=0,r=e.GetControlsCount()-1;n<=r;n++)i=n,s=e.GetControls(i),this.UpdateChildren(s)}},this.DisableTab=function(){var t=0;this.FTabStop&&this.CanFocus()||null!=this.GetContainer()&&this.GetContainer().setAttribute("tabindex","-1");for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).DisableTab()},this.EnableTab=function(){var t=0;null==this.FContainer||this.GetIsLinked()||(this.FTabStop&&this.CanFocus()?this.FContainer.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder+1)):this.FContainer.setAttribute("tabindex","-1"));for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).EnableTab()},this.SetElementClassName=function(t){this.FElementClassName!==t&&(this.FElementClassName=t,null!=this.FContainer&&this.FContainer.setAttribute("class",t),this.UpdateElement())},this.SetColor=function(t){this.FColor=t,this.UpdateElementVisual(),this.ColorChanging()},this.SetFont=function(t){this.FFont.SetName(t.FName),this.FFont.SetSize(t.FSize),this.FFont.SetStyle(rtl.refSet(t.FStyle)),this.FFont.SetColor(t.FColor)},this.SetParent=function(t){var e;null!=t&&(t=t.CanAcceptChild(this)),e=this.FNew,this.FParent!==t&&(null!=this.FParent&&this.FParent.UnRegisterParent(this),this.FPrevParent=this.FParent,this.FParent=t,this.FGotFocus=!1,this.UpdateParent(),3 in this.FComponentState||(e||this.UpdateElement(),this.InitScript()),null!=this.FParent&&this.FParent.RegisterParent(this),0 in this.FComponentState&&null!=this.FParent&&!(0 in this.FParent.FComponentState)&&this.Loaded(),null==t||null==this.FParent||this.FParent.IsUpdating()||(0!==this.FAlign?this.DoRealign():this.Realign()),3 in this.FComponentState||this.Invalidate())},this.RegisterParent=function(t){this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)+1),this.FControls[rtl.length(this.FControls)-1]=t},this.UnRegisterParent=function(t){var e=0,i=!1;i=!1;for(var s=0,n=rtl.length(this.FControls)-1;s<=n;s++)e=s,this.FControls[e]===t&&(i=!0),i&&e<rtl.length(this.FControls)-1&&(this.FControls[e]=this.FControls[e+1]);i&&(this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)-1))},this.CanAcceptChild=function(t){return this,this},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigLeft=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigTop=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.MouseUp=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseUp&&this.FOnMouseUp(this,t,rtl.refSet(e),i,s)},this.MouseDown=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseDown&&this.FOnMouseDown(this,t,rtl.refSet(e),i,s)},this.MouseMove=function(t,e,i){this.FEnabled&&null!=this.FOnMouseMove&&this.FOnMouseMove(this,rtl.refSet(t),e,i)},this.TouchStart=function(t,e){null!=this.FOnTouchStart&&this.FOnTouchStart(this,t,e)},this.TouchMove=function(t,e){null!=this.FOnTouchMove&&this.FOnTouchMove(this,t,e)},this.TouchEnd=function(t,e){null!=this.FOnTouchEnd&&this.FOnTouchEnd(this,t,e)},this.TouchCancel=function(t,e){null!=this.FOnTouchCancel&&this.FOnTouchCancel(this,t,e)},this.DoMouseEnter=function(){null!=this.FOnMouseEnter&&this.FOnMouseEnter(this)},this.DoMouseLeave=function(){null!=this.FOnMouseLeave&&this.FOnMouseLeave(this)},this.MouseWheel=function(t,e,i){var s=!1;for(null!=this.FOnMouseWheel&&this.FOnMouseWheel(this,rtl.refSet(t),e,pas.Types.TPoint.$clone(pas.Types.Point(0,0)),i),this.FWheelAccumulator+=e;Math.abs(this.FWheelAccumulator)>=120;)s=this.FWheelAccumulator<0,this.FWheelAccumulator=Math.abs(this.FWheelAccumulator)-120,s?(0!==this.FWheelAccumulator&&(this.FWheelAccumulator=-this.FWheelAccumulator),this.DoMouseWheelDown(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))):this.DoMouseWheelUp(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))},this.DoMouseWheelDown=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelDown&&this.FOnMouseWheelDown(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DoMouseWheelUp=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelUp&&this.FOnMouseWheelUp(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DblClick=function(){null!=this.FOnDblClick&&this.FOnDblClick(this)},this.KeyDown=function(t,e){null!=this.FOnKeyDown&&this.FOnKeyDown(this,t,rtl.refSet(e))},this.KeyPreview=function(e,i){null!=this.FOwner&&t.TControl.isPrototypeOf(this.FOwner)&&rtl.as(this.FOwner,t.TControl).KeyPreview(e,rtl.refSet(i))},this.KeyPress=function(t){null!=this.FOnKeyPress&&this.FOnKeyPress(this,t)},this.KeyUp=function(t,e){null!=this.FOnKeyUp&&this.FOnKeyUp(this,t,rtl.refSet(e))},this.SetFocus=function(){var t=null;this.CanFocus()&&null!=this.GetElementHandle()&&(t=this.GetElementHandle(),this.FGotFocus?t.focus():setTimeout((function(){t.focus()}),1))},this.DoMarginsChanged=function(t){this.DoRealign()},this.DoCenterChanged=function(t){this.DoRealign()},this.DoRealign=function(){null==this.FParent||this.FParent.IsUpdating()||this.FParent.AlignControl(this.FParent)},this.DoBoundsChange=function(){var t,e=!1;this.UpdateElementSize(),this.RecreateCanvas(),this.FIsResizing||(this.FIsResizing=!0,this.InternalResize(),this.DoRealign(),e=!1,null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&(e=(e=t.FIsResizing$1)||t.FUpdateCount>0),(e=(e=e||this.FUpdateCount>0)||this.FIsAligning)||this.UpdateChildAnchoring(),this.FIsResizing=!1)},this.DoEndDrag=function(t,e,i){null!=this.FonEndDrag&&this.FonEndDrag(this,t,e,i)},this.DoStartDrag=function(t){null!=this.FOnStartDrag&&this.FOnStartDrag(this,t)},this.DragOver=function(t,e,i,s,n){null!=this.FOnDragOver&&this.FOnDragOver(this,t,e,i,s,n)},this.Focused=function(){return this.FContainer===document.activeElement},this.GetID=function(){return this.FID},this.GetElementHandle=function(){var t=null;return t=null,null!=this.FContainer&&this.FControlCreated&&(t=this.FContainer),t},this.GetElementBindHandle=function(){return this.GetElementHandle()},this.GetKeyCode=function(t,e){var i=0;i=-1;var s=t;return"Up"===s?i=38:"Down"===s?i=40:"Left"===s?i=37:"Right"===s?i=39:"!"===s?i=56:'"'===s||"#"===s?i=51:"$"===s?i=186:"%"===s?i=192:"'"===s?i=52:"("===s?i=53:")"===s?i=219:"*"===s?i=106:"+"===s?i=107:"-"===s?i=109:","===s?i=44:"."===s?i=46:"/"===s?i=111:"\\"===s?i=226:"="===s?i=187:"<"===s||">"===s?i=226:s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:pas.System.Assigned(t)&&t.length>0&&(i=t.charCodeAt(0),e&&i>=97&&i<=122?i&=223:i>=65&&i<=90?i|=64:i>122&&(i|=128)),i},this.GetKeyChar=function(t){var e="\0",i=0;i=-1,e="\0";var s=t;return s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:e=t.charAt(0),-1!==i&&(e=String.fromCharCode(i)),e},this.IsKeyCharacter=function(t){var e=t;return"Up"!==e&&"Down"!==e&&"Left"!==e&&"Right"!==e&&e!==pas.Web.TJSKeyNames.Shift&&e!==pas.Web.TJSKeyNames.Control&&e!==pas.Web.TJSKeyNames.Alt&&e!==pas.Web.TJSKeyNames.Pause&&e!==pas.Web.TJSKeyNames.CapsLock&&e!==pas.Web.TJSKeyNames.PageUp&&e!==pas.Web.TJSKeyNames.PageDown&&e!==pas.Web.TJSKeyNames._End&&e!==pas.Web.TJSKeyNames.Home&&e!==pas.Web.TJSKeyNames.ArrowLeft&&e!==pas.Web.TJSKeyNames.ArrowUp&&e!==pas.Web.TJSKeyNames.ArrowRight&&e!==pas.Web.TJSKeyNames.ArrowDown&&e!==pas.Web.TJSKeyNames.Insert&&e!==pas.Web.TJSKeyNames.Delete&&e!==pas.Web.TJSKeyNames.F1&&e!==pas.Web.TJSKeyNames.F2&&e!==pas.Web.TJSKeyNames.F3&&e!==pas.Web.TJSKeyNames.F4&&e!==pas.Web.TJSKeyNames.F5&&e!==pas.Web.TJSKeyNames.F6&&e!==pas.Web.TJSKeyNames.F7&&e!==pas.Web.TJSKeyNames.F8&&e!==pas.Web.TJSKeyNames.F9&&e!==pas.Web.TJSKeyNames.F10&&e!==pas.Web.TJSKeyNames.F11&&e!==pas.Web.TJSKeyNames.F12&&e!==pas.Web.TJSKeyNames.F13&&e!==pas.Web.TJSKeyNames.F14&&e!==pas.Web.TJSKeyNames.F15&&e!==pas.Web.TJSKeyNames.F16&&e!==pas.Web.TJSKeyNames.F17&&e!==pas.Web.TJSKeyNames.F18&&e!==pas.Web.TJSKeyNames.F19&&e!==pas.Web.TJSKeyNames.F20},this.GetClientRect=function(){var t=pas.Types.TRect.$new(),e="",i=0,s=0;return e=pas.SysUtils.UpperCase(this.GetStyle("border-width")),s=0,(i=pas.System.Pos("PX",e))>0&&(pas.System.Delete({get:function(){return e},set:function(t){e=t}},i,2),pas.System.val$6(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}})),t.$assign(pas.Types.Rect(0,0,this.GetWidth()-2*s,this.GetHeight()-2*s)),t},this.CreateControl=function(){null==this.FElement&&(this.FElement=this.CreateElement(),null!=this.FElement&&(this.FControlCreated=!0,this.FContainer=this.FElement,"body"!==this.GetID()&&this.GetContainer().setAttribute("id",this.GetID()),this.GetContainer().setAttribute("zindex","0"),""!==this.FElementClassName&&this.GetContainer().setAttribute("class",this.FElementClassName),this.CreateChildElements(this.FElement),this.BindEvents(),this.UpdateElement()))},this.ClearMethodPointers=function(){this.FWheelPtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseMovePtr=null,this.FMouseLeavePtr=null,this.FMouseEnterPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FEnterPtr=null,this.FExitPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FLayerMouseLeavePtr=null,this.FLayerMouseEnterPtr=null,this.FScriptLoadedPtr=null,this.FContextMenuPtr=null},this.GetMethodPointers=function(){null===this.FWheelPtr&&(this.FWheelPtr=rtl.createCallback(this,"HandleDoWheel"),this.FClickPtr=rtl.createCallback(this,"HandleDoClick"),this.FDblClickPtr=rtl.createCallback(this,"HandleDoDblClick"),this.FMouseDownPtr=rtl.createCallback(this,"HandleDoMouseDown"),this.FMouseUpPtr=rtl.createCallback(this,"HandleDoMouseUp"),this.FMouseMovePtr=rtl.createCallback(this,"HandleDoMouseMove"),this.FMouseLeavePtr=rtl.createCallback(this,"HandleDoMouseLeave"),this.FMouseEnterPtr=rtl.createCallback(this,"HandleDoMouseEnter"),this.FKeyDownPtr=rtl.createCallback(this,"HandleDoKeyDown"),this.FKeyUpPtr=rtl.createCallback(this,"HandleDoKeyUp"),this.FKeyPressPtr=rtl.createCallback(this,"HandleDoKeyPress"),this.FInputPtr=rtl.createCallback(this,"HandleDoInput"),this.FEnterPtr=rtl.createCallback(this,"HandleDoEnter"),this.FExitPtr=rtl.createCallback(this,"HandleDoExit"),this.FTouchStartPtr=rtl.createCallback(this,"HandleDoTouchStart"),this.FTouchEndPtr=rtl.createCallback(this,"HandleDoTouchEnd"),this.FTouchMovePtr=rtl.createCallback(this,"HandleDoTouchMove"),this.FTouchCancelPtr=rtl.createCallback(this,"HandleDoTouchCancel"),this.FLayerMouseLeavePtr=rtl.createCallback(this,"LayerHandleDoMouseLeave"),this.FLayerMouseEnterPtr=rtl.createCallback(this,"LayerHandleDoMouseEnter"),this.FScriptLoadedPtr=rtl.createCallback(this,"RequiredScriptLoaded"),this.FDragStartPtr=rtl.createCallback(this,"HandleDoDragStart"),this.FDragOverPtr=rtl.createCallback(this,"HandleDoDragOver"),this.FDragEnterPtr=rtl.createCallback(this,"HandleDoDragEnter"),this.FDragLeavePtr=rtl.createCallback(this,"HandledoDragLeave"),this.FDragEndPtr=rtl.createCallback(this,"HandleDoDragEnd"),this.FDragDropPtr=rtl.createCallback(this,"HandleDoDragDrop"),this.FContextMenuPtr=rtl.createCallback(this,"HandleDoContextMenu"))},this.EventsBound=function(){return this.FEventsBound},this.BindEvents=function(){var t=null,e=null;null!=this.GetElementBindHandle()&&(this.GetMethodPointers(),this.FEventsBound=!0,t=this.GetElementBindHandle(),e=this.FWheelPtr,t.addEventListener("wheel",e,{passive:!0}),t.addEventListener("click",this.FClickPtr),t.addEventListener("dblclick",this.FDblClickPtr),t.addEventListener("mousedown",this.FMouseDownPtr),t.addEventListener("mouseup",this.FMouseUpPtr),t.addEventListener("mousemove",this.FMouseMovePtr),t.addEventListener("mouseleave",this.FMouseLeavePtr),t.addEventListener("mouseenter",this.FMouseEnterPtr),t.addEventListener("keydown",this.FKeyDownPtr),t.addEventListener("keyup",this.FKeyUpPtr),t.addEventListener("keypress",this.FKeyPressPtr),t.addEventListener("input",this.FInputPtr),t.addEventListener("focus",this.FEnterPtr),t.addEventListener("blur",this.FExitPtr),e=this.FTouchStartPtr,t.addEventListener("touchstart",e,{passive:!0}),e=this.FTouchMovePtr,t.addEventListener("touchmove",e,{passive:!0}),t.addEventListener("touchend",this.FTouchEndPtr),t.addEventListener("touchcancel",this.FTouchCancelPtr),t.addEventListener("contextmenu",this.FContextMenuPtr),t.addEventListener("dragstart",this.FDragStartPtr),t.addEventListener("dragover",this.FDragOverPtr),t.addEventListener("dragenter",this.FDragEnterPtr),t.addEventListener("dragleave",this.FDragLeavePtr),t.addEventListener("dragend",this.FDragEndPtr),t.addEventListener("drop",this.FDragDropPtr))},this.UnbindEvents=function(){var t=null;this.ReleaseCapture(),null!=this.GetElementBindHandle()&&((t=this.GetElementBindHandle()).removeEventListener("wheel",this.FWheelPtr),t.removeEventListener("click",this.FClickPtr),t.removeEventListener("dblclick",this.FDblClickPtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("mouseleave",this.FMouseLeavePtr),t.removeEventListener("mouseenter",this.FMouseEnterPtr),t.removeEventListener("keydown",this.FKeyDownPtr),t.removeEventListener("keyup",this.FKeyUpPtr),t.removeEventListener("keypress",this.FKeyPressPtr),t.removeEventListener("focus",this.FEnterPtr),t.removeEventListener("blur",this.FExitPtr),t.removeEventListener("input",this.FInputPtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),t.removeEventListener("contextmenu",this.FContextMenuPtr))},this.UpdatePadding=function(t){},this.AlignControls=function(t,e){var i=this,s=0;function n(t,s){var n=0,r=0,o=0,a=0;t.AnchoringInitialized()||i.InitAnchoring(),t.FUpdateTopLeft=!0,t.FAlignWithMargins?(n=t.FMargins.FLeft,r=t.FMargins.FTop,a=t.FMargins.FBottom,o=t.FMargins.FRight):(n=0,r=0,a=0,o=0);var l=s;1===l?(t.SetBoundsInt(e.Left+n,e.Top+r,e.Right-e.Left-n-o,t.GetHeight()),e.Top=e.Top+t.GetHeight()+r+a):2===l?(t.SetBoundsInt(e.Left+n,e.Bottom-t.GetHeight()-a-1,e.Right-e.Left-n-o-1,t.GetHeight()),e.Bottom=e.Bottom-t.GetHeight()-r-a):3===l?(t.SetBoundsInt(e.Left+n,e.Top+r,t.GetWidth(),e.Bottom-e.Top-r-a),e.Left=e.Left+t.GetWidth()+n+o):4===l?(t.SetBoundsInt(e.Right-t.GetWidth()-o,e.Top+r,t.GetWidth(),e.Bottom-e.Top-a-r),e.Right=e.Right-t.GetWidth()-o-n):5===l?t.SetBoundsInt(e.Left+n,e.Top+r,e.Right-e.Left-n-o,e.Bottom-e.Top-a-r):6===l&&(n=t.GetLeft(),r=t.GetTop(),o=0,a=0,(t.FCenter.FVertical||t.FCenter.FHorizontal)&&(t.FCenter.FHorizontal&&(n=e.Left,o=rtl.trunc((e.Right-e.Left-t.GetWidth())/2)),t.FCenter.FVertical&&(r=e.Top,a=rtl.trunc((e.Bottom-e.Top-t.GetHeight())/2)),t.SetBoundsInt(n+o,r+a,t.GetWidth(),t.GetHeight()))),t.FUpdateTopLeft=!1}function r(t){var e=0,s=0,r=0,o=null;o=pas.Classes.TList.$create("Create$1");for(var a=0,l=i.GetControlsCount()-1;a<=l;a++)if(e=a,(i.GetControls(e).FCenter.FVertical||i.GetControls(e).FCenter.FHorizontal)&&6===t||i.GetControls(e).FAlign===t&&(i.GetControls(e).FVisible||4 in i.FComponentState)){r=o.GetCount();for(var h=o.GetCount()-1;h>=0;h--){s=h;var u=t;1===u?i.GetControls(e).FOrigTop<rtl.getObject(o.Get(s)).FOrigTop&&(r=s):3===u?i.GetControls(e).FOrigLeft<rtl.getObject(o.Get(s)).FOrigLeft&&(r=s):4===u?i.GetControls(e).FOrigLeft+i.GetControls(e).GetWidth()>rtl.getObject(o.Get(s)).FOrigLeft+rtl.getObject(o.Get(s)).GetWidth()&&(r=s):2===u&&i.GetControls(e).FOrigTop+i.GetControls(e).GetHeight()>rtl.getObject(o.Get(s)).FOrigTop+rtl.getObject(o.Get(s)).GetHeight()&&(r=s)}o.Insert(r,i.GetControls(e))}for(var d=0,F=o.GetCount()-1;d<=F;d++)e=d,n(rtl.getObject(o.Get(e)),t);o=rtl.freeLoc(o)}this.UpdatePadding(e),r(1),r(2),r(3),r(4),r(5),r(6);for(var o=0,a=this.GetControlsCount()-1;o<=a;o++)s=o,this.GetControls(s).AlignControl(this.GetControls(s))},this.AlignControl=function(t){var e,i=pas.Types.TRect.$new(),s=null,n="",r="",o="",a=null,l=null,h=0,u=0,d=0;this.FIsAligning||this.IsUpdating()||0 in this.FComponentState||(null==this.FParent||this.FParent.FVisible)&&(null!=(l=pas["WEBLib.Forms"].GetParentForm(this))&&l.IsUpdating()||(h=0,null!=l&&""!==l.FFormContainer&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null!=(a=document.getElementById(l.FFormContainer))&&(s=a.getBoundingClientRect(),h=Math.round(s.top+1)),this.FIsAligning=!0,null!=t&&(null!=(e=t.GetElementHandle())&&(n=t.GetElementStyle().getPropertyValue("overflow"),r=t.GetElementStyle().getPropertyValue("overflow-x"),o=t.GetElementStyle().getPropertyValue("overflow-y"),this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?t.GetElementStyle().setProperty("overflow","hidden"):t.GetElementStyle().setProperty("overflow","")),i.$assign(this.GetClientRect()),i.Bottom=i.Bottom-h,this.GetIsLinked()&&(s=this.GetElementHandle().getBoundingClientRect(),i.$assign(pas.Types.Rect(0,0,Math.round(s.right-s.left),Math.round(s.bottom-s.top)))),i.Bottom+h>pas["WEBLib.Forms"].WinHeight()&&1!==this.FHeightStyle&&0!==this.FElementPosition&&!this.GetIsLinked()&&null==pas["WEBLib.Forms"].VSIDE&&(null!=this.FParent&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)||pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this))&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()-h),null!=e&&"BODY"===e.tagName&&(u=0,document.body.scrollHeight>document.body.clientHeight&&!(4 in this.FComponentState)&&(u=16),""!==l.FFormContainer?(i.Bottom=Math.round(Math.min(i.Bottom,pas["WEBLib.Forms"].WinHeight())),i.Right=Math.round(Math.min(i.Right-u,pas["WEBLib.Forms"].WinWidth()))):(i.Bottom=l.GetHeight(),i.Right=l.GetWidth())),pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null==pas["WEBLib.Forms"].VSIDE&&(i.Bottom>pas["WEBLib.Forms"].WinHeight()&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()),i.Right>pas["WEBLib.Forms"].WinWidth()&&(i.Right=pas["WEBLib.Forms"].WinWidth())),t.IsStructuralElement()&&i.$assign(this.FParent.GetClientRect()),pas["WEBLib.Forms"].Application.CalcScrollBarWidth()<16&&!pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null!=t.FParent&&null!=t.GetElementHandle()&&t.GetElementHandle().scrollHeight>t.GetElementHandle().clientHeight&&(0===(d=pas["WEBLib.Forms"].Application.CalcScrollBarWidth())&&(d=16),i.Right=i.Right+(17-d)),this.AlignControls(t,i),null!=e&&(t.GetElementStyle().setProperty("overflow",n),t.GetElementStyle().setProperty("overflow-x",r),t.GetElementStyle().setProperty("overflow-y",o)),this.FIsAligning=!1)))},this.InitAnchoring=function(){var t=0,e=0,i=0;function s(e,i,s){var n;i.set(0),s.set(0),null!=(n=pas.TypInfo.GetPropInfo(e.$class.ClassInfo(),"BorderStyle"))&&((t=pas.TypInfo.GetOrdProp$1(e,n))in rtl.createSet(1,4,5)&&(i.set(4),s.set(4)),t in rtl.createSet(2,3)&&(i.set(16),s.set(16)))}if(!this.AnchoringInitialized()){e=0,i=0,pas["WEBLib.Forms"].TForm.isPrototypeOf(this)?(rtl.as(this,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigRect.$assign(pas.Types.Rect(0,0,this.GetDesignWidth()-e,this.GetDesignHeight()-i))):this.FOrigRect.$assign(pas.Types.Rect(this.GetDesignLeft(),this.GetDesignTop(),this.GetDesignLeft()+this.GetDesignWidth(),this.GetDesignTop()+this.GetDesignHeight())),null!=this.FParent&&(pas["WEBLib.Forms"].TForm.isPrototypeOf(this.FParent)?(rtl.as(this.FParent,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this.FParent,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigParentRect.$assign(pas.Types.Rect(0,0,this.FParent.GetDesignWidth()-e,this.FParent.GetDesignHeight()-i))):(this.FParent.AnchoringInitialized()||this.FParent.InitAnchoring(),this.FOrigParentRect.$assign(pas.Types.Rect(this.FParent.GetDesignLeft(),this.FParent.GetDesignTop(),this.FParent.GetDesignLeft()+this.FParent.GetDesignWidth(),this.FParent.GetDesignTop()+this.FParent.GetDesignHeight()))));for(var n=0,r=this.GetControlsCount()-1;n<=r;n++)t=n,this.GetControls(t).InitAnchoring()}},this.AnchoringInitialized=function(){return-1!==this.FOrigRect.Left||-1!==this.FOrigRect.Top},this.InitScript=function(){},this.Realign=function(){this.AlignControl(this)},this.Loaded=function(){var t=0;if(0 in this.FComponentState){pas.Classes.TComponent.Loaded.call(this);for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FElementPosition in rtl.createSet(1,2)&&!this.GetControls(t).GetIsLinked()&&this.GetControls(t).FChildOrder>=0&&this.GetControls(t).FChildOrder<this.GetChildContainer().childNodes.length&&this.GetChildContainer().insertBefore(this.GetControls(t).GetContainer(),this.GetChildContainer().childNodes.item(this.GetControls(t).FChildOrder)),this.GetControls(t).Loaded();for(var s=0,n=this.GetComponentCount()-1;s<=n;s++)t=s,0 in this.GetComponent(t).FComponentState&&this.GetComponent(t).Loaded();5===this.FAlign&&null!=this.FParent&&this.SetBoundsInt(0,0,this.FParent.FWidth,this.FParent.FHeight),this.Resize(),this.UpdateElement()}},this.InternalResize=function(){0 in this.FComponentState||this.Resize()},this.FontChanged=function(){this.UpdateElementVisual()},this.SetElementColor=function(e,i){var s;s=!(pas["WEBLib.Forms"].Application.FThemed||""!==this.FElementClassName),this.GetIsLinked()||t.SetHTMLElementColor(e,i,!s)},this.MoveElements=function(t,e){if(t&&e)for(;t.childNodes.length;)e.appendChild(t.firstChild)},this.MoveElementsAndFree=function(t,e){if(t&&e){for(;t.childNodes.length;)e.appendChild(t.firstChild);t.remove()}},this.CreateWithID=function(e){var i;this.ClearMethodPointers(),this.FUpdateCount=0,this.FControlCreated=!1,this.FLinkTouchEvents=!0,this.FIsResizing=!1,(null!=this.FOwner&&0 in this.FOwner.FComponentState||null==this.FOwner)&&(null!=this.FOwner&&4 in this.FOwner.FComponentState||this.Loading()),this.FElementPosition=0,this.FWidthStyle=1,this.FHeightStyle=1,i=document.getElementById(e),this.FNew=!(null!=i),this.FFont=pas["WEBLib.Graphics"].TFont.$create("Create$1"),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged"),this.FNew?this.FContainer=null:(this.FContainer=i,this.FControlCreated=!0,this.FElementPosition=1,this.CreateChildElements(i),this.BindElement(),this.BindEvents()),this.FID=e,this.FEnabled=!0,this.FVisible=!0,this.FLeft=0,this.FTop=0,this.FAlign=0,this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FParentFont=!0,this.FParentBiDiMode=!0,this.FParentColor=!1,this.FAnchors=rtl.createSet(0,1),this.FShowFocus=!1,this.FBorderWidth=0,this.FEnablePropagation=!1,this.FToolTip=null,this.FColor=16711422,this.FMargins=t.TMargins.$create("Create$1"),this.FMargins.FOnChange=rtl.createCallback(this,"DoMarginsChanged"),this.FCenter=t.TCenter.$create("Create"),this.FCenter.FOnChange=rtl.createCallback(this,"DoCenterChanged"),this.FParent=null,this.FPrevParent=null,0 in this.FControlStyle||this.ClearControls(),this.CreateInitialize()},this.AddInstanceStyle$1=function(t,e){var i,s,n;i=t,s=e,(n=document.getElementById(i))?n.innerHTML=s:((n=document.createElement("style")).type="text/css",n.id=i,n.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(n))},this.AddControlStyle=function(t){var e,i,s,n;e=this.$classname,i=e,s=t,(n=document.getElementById(i))?n.innerHTML=s:((n=document.createElement("style")).type="text/css",n.id=i,n.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(n))},this.AddControlLink=function(t,e){var i,s,n;i=t,s=e,(n=document.getElementById(i))||((n=document.createElement("link")).id=i,n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",s),document.getElementsByTagName("head")[0].appendChild(n))},this.AddControlScriptSource=function(t){var e,i=null;e=this.$classname+"SRC",null==document.getElementById(e)&&((i=document.createElement("script")).id=e,i.innerHTML=t,i.type="text/javascript",document.head.appendChild(i))},this.ResetAnchoring=function(){this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.InitAnchoring()},this.UpdateSize=function(){var t=0;this.UpdateElementSize();for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateSize()},this.UpdateAnchoring=function(){var t=0,e=0,i=0,s=0,n=0,r=0,o=pas.Types.TRect.$new(),a=pas.Types.TRect.$new();0 in this.FComponentState||this.FControlCreated&&(-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring(),(null==this.FParent||this.FParent.AnchoringInitialized())&&(5!==this.FAlign&&(null==this.FParent||pas["WEBLib.Forms"].TForm.isPrototypeOf(this)||(a.$assign(this.FParent.GetBoundsRect()),t=a.Right-a.Left-(this.FOrigParentRect.Right-this.FOrigParentRect.Left),e=a.Bottom-a.Top-(this.FOrigParentRect.Bottom-this.FOrigParentRect.Top),o.$assign(this.FOrigRect),i=0,s=0,n=0,r=0,2 in this.FAnchors&&(0 in this.FAnchors?n=t:i=t),3 in this.FAnchors&&(1 in this.FAnchors?r=e:s=e),(3 in this.FAnchors||2 in this.FAnchors)&&this.SetBoundsInt(o.Left+i,o.Top+s,o.Right-o.Left+n,o.Bottom-o.Top+r))),this.UpdateChildAnchoring()))},this.UpdateChildAnchoring=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateAnchoring()},this.SetElementPointer=function(e,i){0!==i?e.style.setProperty("cursor",t.GetHTMLCursorName(i)):e.style.removeProperty("cursor")},this.IsUpdating=function(){return this.FUpdateCount>0},this.CanShowFocus=function(){return this.FShowFocus},this.RequiredScriptLoaded=function(t){rtl.asExt(t.target,HTMLScriptElement).title="tmswebloaded",this.FControlScriptCountLoaded+=1},this.GetStyle=function(t){var e,i="",s="";return s="",null==(e=this.GetElementHandle())?i:(window.getComputedStyle&&(s=getComputedStyle(e,"")[t]),e.currentStyle&&(s=e.currentStyle[t]),i=s)},this.SetBoundsInt=function(t,e,i,s){(t!==this.GetLeft()||e!==this.GetTop()||i!==this.GetWidth()&&1===this.FWidthStyle||s!==this.GetHeight()&&1===this.FHeightStyle||null!=this.FParent&&this.FParent.GetIsLinked())&&(this.FBlockUpdateElement=!0,this.FLeft=t,this.FTop=e,this.FWidth=i,this.FHeight=s,this.FBlockUpdateElement=!1,this.UpdateElementSize(),0!==this.FAlign?this.DoRealign():this.Realign(),this.RecreateCanvas(),this.DoBoundsChange(),this.Invalidate(),this.UpdateChildAnchoring())},this.MoveLast=function(t){var e=0,i=!1;i=!1;for(var s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,this.FControls[e]===t&&(i=!0),i&&(e<this.GetControlsCount()-1?this.FControls[e]=this.FControls[e+1]:this.FControls[e]=t)},this.EnableDrag=function(){null!=this.GetContainer()&&this.GetContainer().setAttribute("draggable","true")},this.DisableDrag=function(){null!=this.GetContainer()&&"true"===this.GetContainer().getAttribute("draggable")&&this.GetContainer().setAttribute("draggable","false")},this.Create$2=function(t){return this.FGotFocus=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.CreateWithID(t),this},this.Create$1=function(t){var e,i,s=!1;return this.FGotFocus=!1,this.FEventsBound=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.FNoUserSelect=!0,this.ClearMethodPointers(),pas.Classes.TComponent.Create$1.call(this,t),this.FEventStopPropagation=rtl.createSet(0,4,2,3,1,5,6,7),this.FScriptLoaded=!1,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FTextDirection=0,s=!1,null!=(i=pas["WEBLib.Forms"].GetParentForm(this))&&(s=4 in i.FComponentState),e=this.GetNewName(),s?this.CreateWithID(""):this.CreateWithID(e),null==t||4 in t.FComponentState||this.SetName(e),this},this.Destroy=function(){this.UnbindEvents(),this.DestroyControls(),null!=this.GetContainer()&&null!=this.FParent&&null!=this.FParent.GetChildContainer()&&(this.FParent.GetChildContainer()===this.GetContainer().parentNode&&this.FParent.GetChildContainer().removeChild(this.GetContainer()),this.FContainer=null,this.SetParent(null),this.FControlCreated=!1),rtl.free(this,"FRequiredScripts"),rtl.free(this,"FMargins"),rtl.free(this,"FCenter"),rtl.free(this,"FFont"),pas.System.Assigned(this.FToolTip)&&(this.FToolTip.dispose(),this.FToolTip=null),pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(t){},this.DragDrop=function(t,e,i){null!=this.FOnDragDrop&&this.FOnDragDrop(this,t,e,i)},this.Resize=function(){null!=this.FOnResize&&this.FOnResize(this)},this.ReleaseCapture=function(){var t=null;this.FCaptureDown=!1,this.FCaptured&&null!=this.FLayer&&((t=this.FLayer).removeEventListener("mouseenter",this.FLayerMouseEnterPtr),t.removeEventListener("mouseleave",this.FLayerMouseLeavePtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),document.body.removeChild(t),this.FCaptured=!1,this.FLayer=null,this.UpdateElement())},this.BringToFront=function(){if(null!=this.GetElementHandle()&&null!=this.GetElementHandle().parentElement)try{this.GetElementHandle().parentElement.appendChild(this.GetElementHandle()),null!=this.FParent&&this.FParent.MoveLast(this)}catch(t){}},this.Show=function(){this.SetVisible(!0)},this.Hide=function(){this.SetVisible(!1)},this.PreventDefault=function(){null!=this.GetElementEvent()&&this.GetElementEvent().preventDefault()},this.StopPropagation=function(){null==this.GetElementEvent()||this.FEnablePropagation||this.GetElementEvent().stopPropagation()},this.BeginDrag=function(){this.EnableDrag()},this.BeginUpdate=function(){this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1,0===this.FUpdateCount&&this.UpdateElement())},this.Invalidate=function(){},this.SetParentComponent=function(e){this.FParent!==e&&t.TControl.isPrototypeOf(e)&&this.SetParent(e)},this.XYToClient=function(t,e,i,s){var n=null,r=null,o=null,a=0,l=0,h=!1,u=!1,d=pas.Types.TRect.$new(),F=null,c=0,p=0,C=0,S=0;if(h=!0,u=!1,C=0,S=0,0!==this.FElementPosition)return h=!1,a=t-(r=this.GetElementHandle().getBoundingClientRect()).left,l=e-r.top,i.set(a),void s.set(l);for(C=document.body.scrollLeft+document.documentElement.scrollLeft,S=document.body.scrollTop+document.documentElement.scrollTop,a=t-this.GetLeft(),l=e-this.GetTop(),i.set(a),s.set(l),n=this.FParent,pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this)&&null==n&&null!=this.GetContainer()&&(r=this.GetContainer().getBoundingClientRect(),i.set(i.get()-r.left),s.set(s.get()-r.top));null!=n;){if(n.GetIsLinked()){r=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n)?n.GetContainer().getBoundingClientRect():n.GetElementHandle().getBoundingClientRect(),i.set(i.get()-r.left),s.set(s.get()-r.top),i.set(i.get()+n.GetElementHandle().scrollLeft),s.set(s.get()+n.GetElementHandle().scrollTop),C=0,S=0;break}if(pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n))""!==rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&null!=(o=document.getElementById(rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer))&&(u=!0,r=o.getBoundingClientRect(),i.set(i.get()-r.left),s.set(s.get()-r.top)),null!=rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetContainer()&&""===rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FPopup&&(r=rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetContainer().getBoundingClientRect(),i.set(i.get()-r.left),s.set(s.get()-r.top),d.$assign(rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetClientRect()),s.set(s.get()+d.Top),C=0,S=0);else if(n.FElementPosition in rtl.createSet(1,2)){if(null!=n.GetElementHandle()){r=n.GetElementHandle().getBoundingClientRect(),i.set(a-r.left),s.set(l-r.top),C=0,S=0,h&&(F=window.getComputedStyle(document.documentElement),c=parseInt(F.marginLeft,10),p=parseInt(F.marginTop,10),i.set(i.get()+c),s.set(s.get()+p)),h=!1;break}}else 0===n.FElementPosition&&h&&(i.set(i.get()-n.GetLeft()),s.set(s.get()-n.GetTop()),null!=n.GetElementHandle()&&(i.set(i.get()+n.GetElementHandle().scrollLeft),s.set(s.get()+n.GetElementHandle().scrollTop)),a=i.get(),l=s.get());n=n.FParent}0!==this.FElementPosition||u||(i.set(i.get()+C),s.set(s.get()+S))},this.Captured=function(){return this.FCaptured&&null!=this.FLayer},this.CanFocus=function(){return!0,!0},this.HasHorzScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientWidth<this.GetElementHandle().scrollWidth),t},this.HasVertScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientHeight<this.GetElementHandle().scrollHeight),t},rtl.addIntf(this,t.IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$2",2,[["ID",rtl.string]]),i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TWinControl",this.TControl,(function(){rtl.addIntf(this,t.IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Cursor",2,t.$rtti.TCursor,"FCursor","SetControlCursor",{Default:0}),e.addProperty("ElementClassName",2,t.$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Tag",0,rtl.longint,"FTag$1","FTag$1",{Default:0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("OnMouseDown",0,t.$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,t.$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,t.$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseEnter",0,t.$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,t.$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnKeyUp",0,t.$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnKeyDown",0,t.$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,t.$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnEnter",0,t.$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,t.$rtti.TNotifyEvent,"FOnExit","FOnExit")})),rtl.createClass(this,"TCustomControl",this.TWinControl,(function(){this.$init=function(){t.TWinControl.$init.call(this),this.FCaption="",this.FPixelRatio=0,this.FPainting=!1,this.FCanvas=null,this.FElementCanvas=null,this.FBorderStyle=0,this.FBorderColor=0,this.FCustomBorder=!1},this.$final=function(){this.FCanvas=void 0,this.FElementCanvas=void 0,t.TWinControl.$final.call(this)},this.RenderDesigning=function(t,e,i,s,n){var r,o=null,a=null,l=null;if(r=null!=(a=(o=e).firstChild)&&"DIV"===a.tagName&&"1"===a.getAttribute("data-design"),4 in i.FComponentState&&s&&""===this.FElementClassName){if(o.style.setProperty("border","1px solid gray"),""===n?o.style.setProperty("background-color","#F0F0F0"):o.style.setProperty("background-color","white"),r)return;o.innerHTML="",""!==n&&((l=document.createElement("DIV")).style.setProperty("background-color","white"),l.style.setProperty("background-repeat","no-repeat"),l.style.setProperty("background-position-y","center"),l.style.setProperty("background-image","url("+n+")"),l.style.setProperty("background-position-x","center"),l.style.setProperty("background-size","128px"),l.style.setProperty("top","50%"),l.style.setProperty("left","50%"),l.style.setProperty("height","70%"),o.appendChild(l)),(a=document.createElement("DIV")).setAttribute("data-design","1"),a.innerHTML=t,a.style.setProperty("position","relative"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("display","inline-block"),a.style.setProperty("transform","translateX(-50%)"),this.FCustomBorder=!0,o.appendChild(a)}else if(r){for(;null!=o.firstChild;)o.removeChild(o.firstChild);o.style.removeProperty("border"),o.style.removeProperty("background-color")}},this.GetPixelRatio=function(){var t=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},this.RecreateCanvas=function(){var t=0,e=null,i=0,s=0;null!=this.FElementCanvas&&(this.FPainting||(null!=(e=this.GetIsLinked()?this.GetElementHandle():document.getElementById(this.GetID()+"_Canvas"))&&(this.FElementCanvas=e,rtl.free(this,"FCanvas"),this.FCanvas=null),t=this.GetPixelRatio(),i=Math.min(16383,this.GetHeight()-this.GetCanvasHeightOffset()),s=Math.min(16383,this.GetWidth()-this.GetCanvasWidthOffset()),1===this.FElementPosition?this.FElementCanvas.style.setProperty("position","relative"):this.FElementCanvas.style.setProperty("position","absolute"),this.FElementCanvas.style.setProperty("height",pas.SysUtils.IntToStr(i)+"px"),this.FElementCanvas.style.setProperty("width",pas.SysUtils.IntToStr(s)+"px"),this.FElementCanvas.height=Math.round(i*t),this.FElementCanvas.width=Math.round(s*t)),null==this.FCanvas&&(this.FCanvas=pas["WEBLib.Graphics"].TCanvas.$create("Create$1",[this.FElementCanvas])),this.FCanvas.FApplyPixelRatio=!0,this.FCanvas.SetTransform(1,0,0,1,0,0))},this.SetBorderStyle=function(t){this.FBorderStyle!==t&&(this.FBorderStyle=t,this.UpdateElement())},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.UpdateElement())},this.SetName=function(e){var i={},s="";if(s="",null!=pas["WEBLib.Forms"].VSIDE&&4 in this.FComponentState||pas["WEBLib.Forms"].TFrame.isPrototypeOf(this)&&(s="F"+t.FindUniqueName(this.FName)+"_"),pas.Classes.TComponent.SetName.call(this,s+e),1 in this.FControlStyle&&4 in this.FComponentState&&!(0 in this.FComponentState)){if(null!=this.FOwner&&0 in this.FOwner.FComponentState)return;i=rtl.refSet(this.FControlStyle),this.SetCaption(e),this.FControlStyle=rtl.refSet(i)}},this.SetCaption=function(t){this.FCaption=t,this.FControlStyle=rtl.diffSet(this.FControlStyle,rtl.createSet(1))},this.CreateControl=function(){t.TControl.CreateControl.call(this),this.RecreateCanvas()},this.Loaded=function(){t.TControl.Loaded.call(this),this.Invalidate()},this.UpdateElementVisual=function(){t.TControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||""!==this.FElementClassName||(1===this.FBorderStyle?this.FCustomBorder?(this.GetElementStyle().setProperty("border-style","solid"),this.GetElementStyle().setProperty("border-width","1px"),this.GetElementStyle().setProperty("border-color",pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor))):this.GetElementStyle().setProperty("border-style",""):this.GetElementStyle().setProperty("border-style","none")),""!==this.FElementClassName&&(this.GetElementStyle().removeProperty("border-style"),this.GetElementStyle().removeProperty("border-width"),this.GetElementStyle().removeProperty("border-color")))},this.CreateElement=function(){var t=null;return this.FElementCanvas=document.createElement("CANVAS"),0 in this.FControlStyle?((t=document.createElement("SPAN")).appendChild(this.FElementCanvas),""!==this.GetID()&&this.FElementCanvas.setAttribute("id",this.GetID()+"_Canvas"),this.FElementCanvas.setAttribute("zindex","-1")):t=this.FElementCanvas,t},this.GetCanvasHeightOffset=function(){return 0,0},this.GetCanvasWidthOffset=function(){return 0,0},this.BindElement=function(){"CANVAS"===this.GetContainer().tagName||this.FControlCreated||(this.FElementCanvas=document.createElement("CANVAS"),this.GetContainer().appendChild(this.FElementCanvas))},this.BindEvents=function(){t.TControl.BindEvents.call(this)},this.Paint=function(){},this.CreateInitialize=function(){t.TControl.CreateInitialize.call(this),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(1)),this.FBorderStyle=1,this.FBorderColor=12632256,this.FPainting=!1,this.FWidth=100,this.FHeight=25,this.FWidthPercent=100,this.FHeightPercent=100,this.FCustomBorder=!1},this.Destroy=function(){null!=this.FCanvas&&rtl.free(this,"FCanvas"),t.TControl.Destroy.call(this)},this.Resize=function(){t.TControl.Resize.call(this),this.Invalidate()},this.Invalidate=function(){var e=null;t.TControl.Invalidate.call(this),null===this.FParent||3 in this.FComponentState||this.FVisible&&(this.FUpdateCount>0||null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&e.IsUpdating()||(this.GetPixelRatio()!==this.FPixelRatio&&this.RecreateCanvas(),this.FPixelRatio=this.GetPixelRatio(),this.FPainting=!0,null!=this.FCanvas&&this.FCanvas.Clear(),this.Paint(),this.FPainting=!1))},this.SetFocus=function(){t.TControl.SetFocus.call(this)},this.Focused=function(){return t.TControl.Focused.call(this)},this.EndUpdate=function(){t.TControl.EndUpdate.call(this),0===this.FUpdateCount&&this.Invalidate()},rtl.addIntf(this,t.IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomHTMLDiv",this.TCustomControl,(function(){this.CreateElement=function(){return document.createElement("DIV")},rtl.addIntf(this,t.IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FInstanceCount=0},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FInstanceCount=0,this},this.GetInstanceNumber=function(){return this.FInstanceCount+=1,this.FInstanceCount},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),this.FindUniqueName=function(t){return t+pas.SysUtils.IntToStr(e.ControlManager.GetInstanceNumber())},this.GetScrollBarHeight=function(){var t=0;if(0===(t=e.ScrollBH)){var i=document.createElement("div");i.style.visibility="hidden",i.style.height="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetHeight;i.style.overflow="scroll";var n=document.createElement("div");n.style.height="100%",i.appendChild(n);var r=n.offsetHeight;i.parentNode.removeChild(i),t=s-r,e.ScrollBH=t}return t},this.GetScrollBarWidth=function(){var t=0;if(0===(t=e.ScrollBW)){var i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetWidth;i.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",i.appendChild(n);var r=n.offsetWidth;i.parentNode.removeChild(i),t=s-r,e.ScrollBW=t}return t},this.SetHTMLElementFont=function(t,e,i){var s="";i?(t.style.removeProperty("font-family"),t.style.removeProperty("font-style"),t.style.removeProperty("font-weight"),t.style.removeProperty("font-size"),t.style.removeProperty("text-decoration")):(t.style.setProperty("font-family",e.FName),t.style.setProperty("font-style","normal"),0 in e.FStyle?t.style.setProperty("font-weight","bold"):t.style.setProperty("font-weight",""),1 in e.FStyle&&t.style.setProperty("font-style","italic"),s="",3 in e.FStyle&&(s="underline"),2 in e.FStyle&&(""!==s&&(s+=" "),s+="line-through"),""!==s?t.style.setProperty("text-decoration",s):t.style.removeProperty("text-decoration"),0!==e.FSize&&t.style.setProperty("font-size",pas.SysUtils.IntToStr(e.FSize)+"pt"))},this.SetHTMLElementColor=function(t,i,s){s||-1===i||16711422===i?t.style.removeProperty(e.cStyleBkgColor):t.style.setProperty(e.cStyleBkgColor,pas["WEBLib.Graphics"].ColorToHTML(i))},this.GetHTMLCursorName=function(t){var e="";e="default";return 0===t?e="default":2===t?e="auto":1===t?e="none":3===t?e="crosshair":4===t?e="text":6===t?e="nesw-resize":7===t?e="ns-resize":8===t?e="nwse-resize":9===t?e="ew-resize":10===t?e="n-resize":11===t?e="wait":12===t?e="copy":13===t?e="no-drop":14===t?e="col-resize":15===t?e="row-resize":16===t?e="copy":17===t?e="progress":18===t?e="not-allowed":19===t?e="progress":20===t?e="help":21===t?e="pointer":22!==t&&5!==t||(e="move"),e},this.GetHTMLElementAbsoluteRect=function(t){var e=pas.Types.TRect.$new(),i="";function s(t){var e=0,i=0;return t=pas.SysUtils.StringReplace(t,"px","",rtl.createSet(0)),pas.System.val$6(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e}return i=t.style.getPropertyValue("left"),e.Left=s(i),i=t.style.getPropertyValue("top"),e.Top=s(i),i=t.style.getPropertyValue("width"),e.Right=e.Left+s(i),i=t.style.getPropertyValue("height"),e.Bottom=e.Top+s(i),e},this.IsAndroid=function(){var t;return t=navigator.userAgent,pas.System.Pos("Android",t)>0},t.$implcode=function(){e.ControlManager=null,e.FMouseX=0,e.FMouseY=0,e.FCursorX=0,e.FCursorY=0,e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.cStyleBkgColor="background-color"},t.$init=function(){e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.ControlManager=t.TControlManager.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.Forms","Math","TypInfo","WEBLib.WebTools","WEBLib.Utils"]),rtl.module("WEBLib.WebTools",["System","Classes","Web","JS","WEBLib.Controls","WEBLib.Graphics"],(function(){"use strict";var t=this;this.cBodyTag="body",this.cHTMLExt=".html",this.DoubleToHTML=function(t){return pas.SysUtils.Format$1("%g",pas.System.VarRecs(3,t),pas.SysUtils.TFormatSettings.Invariant())},this.MessageBeep=function(t){new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=").play()},this.GetLocaleShortDateFormat=function(t){return pas.SysUtils.TFormatSettings.Create$1(t).ShortDateFormat},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"long"})},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleLongMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"long"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleDecimalSeparator=function(t){var e=1.1,i="";return i=""==t?navigator.language:t,e=e.toLocaleString(i).substring(1,2)},this.GetBrowserLocale=function(){return navigator.language},this.ProcessAccelerator=function(t,e){var i,s=0,n="";for(i=t.length,e.set(""),n="",s=1;s<=i;)"&"===t.charAt(s-1)?(s+1<=i&&"&"!==t.charAt(s+1-1)?(n=n+"<u>"+t.charAt(s+1-1)+"</u>",e.set(t.charAt(s+1-1))):s+1<=i&&"&"===t.charAt(s+1-1)&&(n+="&"),s+=2):(n+=t.charAt(s-1),s+=1);return n},this.NumAttribute=function(t){var e;return e=pas.SysUtils.TDoubleHelper.ToString$3.call({get:function(){return t},set:function(e){t=e}}),pas.SysUtils.StringReplace(e,",",".",rtl.createSet(0))},this.PickerDateToDate=function(t){var e,i,s,n=0,r=0,o=0,a=0,l=0;return n=0,e=pas.System.Copy(t,1,4),i=pas.System.Copy(t,6,2),s=pas.System.Copy(t,9,2),pas.System.val$5(e,{get:function(){return r},set:function(t){r=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(i,{get:function(){return o},set:function(t){o=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(s,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),0!==r&&0!==o&&0!==a&&(n=pas.SysUtils.EncodeDate(r,o,a)),n},this.PickerTimeToTime=function(t){var e,i,s,n=0,r=0,o=0,a=0,l=0;return n=0,e=pas.System.Copy(t,1,2),i=pas.System.Copy(t,4,2),s=pas.System.Copy(t,7,2),pas.System.val$5(e,{get:function(){return r},set:function(t){r=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(i,{get:function(){return o},set:function(t){o=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(s,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),r>=0&&o>=0&&a>=0&&(n=pas.SysUtils.EncodeTime(r,o,a,0)),n},this.HTMLToString=function(t){return t=pas.SysUtils.StringReplace(t,"<","&lt;",rtl.createSet(0)),pas.SysUtils.StringReplace(t,">","&gt;",rtl.createSet(0))},this.ElementVisible=function(e){var i=!1,s=null;for(i=!1,s=e;null!=s;)pas.SysUtils.LowerCase(s.tagName)===t.cBodyTag&&(i=!0),s=s.parentElement;if(!i)return i;for(;null!=e;){if("none"===e.style.getPropertyValue("display"))return i=!1;if(s=e.parentElement,!rtl.isExt(s,HTMLElement))return i;e=s}return i}}),["SysUtils","WEBLib.Utils"]),rtl.module("contnrs",["System","SysUtils","Classes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TFPObjectList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FFreeObjects=!1,this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.GetCount=function(){return this.FList.FCount},this.GetItem=function(t){return rtl.getObject(this.FList.Get(t))},this.SetItem=function(t,e){var i=null;this.FFreeObjects?(i=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,e),i=rtl.freeLoc(i)):this.FList.Put(t,e)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=pas.Classes.TFPList.$create("Create"),this.FFreeObjects=!0,this},this.Create$2=function(t){return this.Create$1(),this.FFreeObjects=t,this},this.Destroy=function(){null!==this.FList&&(this.Clear(),this.FList.$destroy("Destroy")),pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=0,e=null;if(this.FFreeObjects)for(var i=this.FList.FCount-1;i>=0;i--)t=i,e=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,null),e=rtl.freeLoc(e);this.FList.Clear()},this.Add=function(t){return this.FList.Add(t)}})),rtl.createClass(this,"TObjectList",pas.Classes.TList,(function(){this.$init=function(){pas.Classes.TList.$init.call(this),this.FFreeObjects=!1},this.Notify=function(t,e){var i=null;this.FFreeObjects&&2===e&&(i=rtl.getObject(t),i=rtl.freeLoc(i)),pas.Classes.TList.Notify.call(this,t,e)},this.Create$2=function(){return pas.Classes.TList.Create$1.call(this),this.FFreeObjects=!0,this}})),rtl.createClass(this,"THTCustomNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FKey=""},this.CreateWith=function(t){return pas.System.TObject.Create.call(this),this.FKey=t,this}})),rtl.createClass(this,"TFPCustomHashTable",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FHashTable=null,this.FHashFunction=null,this.FCount=0,this.FHashTableSize=0},this.$final=function(){this.FHashTable=void 0,this.FHashFunction=void 0,pas.System.TObject.$final.call(this)},this.SetHashTableSize=function(t){var i=0,s=0;if(t!==this.FHashTableSize){for(i=0;e.PRIMELIST[i]<t&&i<27;)i+=1;s=e.PRIMELIST[i],0===this.FCount?(this.FHashTableSize=s,this.InitializeHashTable()):this.ChangeTableSize(s)}},this.InitializeHashTable=function(){if(this.FHashTableSize>0)for(var t=0,e=this.FHashTableSize-1;t<=e;t++)t,this.FHashTable.Add(null);this.FCount=0},this.Chain=function(t){return this.FHashTable.GetItem(t)},this.FindChainForAdd=function(e){var i,s=null,n=0;if(i=this.FHashFunction(e,this.FHashTableSize),null!=(s=this.Chain(i))){if(s.GetCount()>0)for(var r=0,o=s.GetCount()-1;r<=o;r++)if(n=r,s.GetItem(n).FKey===e)throw t.EDuplicate.$create("CreateFmt",[rtl.getResStr(t,"DuplicateMsg"),pas.System.VarRecs(18,e)])}else this.FHashTable.SetItem(i,t.TFPObjectList.$create("Create$2",[!0])),s=this.Chain(i);return this.FCount+=1,s},this.Create$1=function(){return this.CreateWith(196613,t.RSHash),this},this.CreateWith=function(e,i){return pas.System.TObject.Create.call(this),this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.SetHashTableSize(e),this.FHashFunction=i,this},this.Destroy=function(){rtl.free(this,"FHashTable"),pas.System.TObject.Destroy.call(this)},this.ChangeTableSize=function(e){var i,s=null,n=null,r=0,o=0,a=null;if(s=this.FHashTable,i=this.FHashTableSize,this.FHashTableSize=e,this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.InitializeHashTable(),i>0)for(var l=0,h=i-1;l<=h;l++)if(r=l,null!=(n=s.GetItem(r)))for(var u=0,d=n.GetCount()-1;u<=d;u++)o=u,a=n.GetItem(o),this.AddNode(a);s=rtl.freeLoc(s)},this.Clear=function(){var t=0;if(this.FHashTableSize>0)for(var e=0,i=this.FHashTableSize-1;e<=i;e++)t=e,null!=this.Chain(t)&&this.Chain(t).Clear();this.FCount=0},this.Find=function(t){var e,i=null,s=0;if(e=this.FHashFunction(t,this.FHashTableSize),null!=(i=this.Chain(e))&&i.GetCount()>0)for(var n=0,r=i.GetCount()-1;n<=r;n++)if(s=n,i.GetItem(s).FKey===t)return i.GetItem(s);return null,null}})),rtl.createClass(this,"THTObjectNode",this.THTCustomNode,(function(){this.$init=function(){t.THTCustomNode.$init.call(this),this.FData=null},this.$final=function(){this.FData=void 0,t.THTCustomNode.$final.call(this)}})),rtl.createClass(this,"THTOwnedObjectNode",this.THTObjectNode,(function(){this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FData},set:function(t){this.p.FData=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TFPObjectHashTable",this.TFPCustomHashTable,(function(){this.$init=function(){t.TFPCustomHashTable.$init.call(this),this.FOwnsObjects=!1},this.CreateNewNode=function(e){return this.FOwnsObjects?t.THTOwnedObjectNode.$create("CreateWith",[e]):t.THTObjectNode.$create("CreateWith",[e])},this.AddNode=function(t){this.Add(t.FKey,t.FData)},this.GetData=function(t){var e;return null!=(e=this.Find(t))?e.FData:null},this.Create$2=function(e){return t.TFPCustomHashTable.Create$1.call(this),this.FOwnsObjects=e,this},this.Add=function(t,e){var i=null,s=null;i=this.FindChainForAdd(t),(s=this.CreateNewNode(t)).FData=e,i.Add(s)}})),rtl.createClass(this,"EDuplicate",pas.SysUtils.Exception,(function(){}));this.RSHash=function(t,e){var i=0,s=0,n=0;if(s=63689,i=0,t.length>0)for(var r=1,o=t.length;r<=o;r++)n=r,i=i*s+t.charCodeAt(n-1),s*=378551;return i=rtl.lw(2147483647&i)%e},t.$implcode=function(){e.NPRIMES=28,e.PRIMELIST=[53,97,193,389,769,1543,3079,6151,12289,24593,49157,98317,196613,393241,786433,1572869,3145739,6291469,12582917,25165843,50331653,100663319,201326611,402653189,805306457,1610612741,3221225473,4294967291],t.$resourcestrings={DuplicateMsg:{org:"An item with key %0:s already exists"}}}}),["JS"]),rtl.module("WEBLib.Graphics",["System","Classes","Types","UITypes","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.WEBDEFAULTFONT="Arial",this.clNone=-1,this.clBlack=0,this.clNavy=8388608,this.clTeal=8421376,this.clGray=8421504,this.clSilver=12632256,this.clRed=255,this.clYellow=65535,this.clAqua=16776960,this.clLtGray=12698049,this.clWhite=16777215,this.clBtnFace=15790320,this.clWindowText=65793,this.clWindow=16711422,this.clHighlight=14120960,this.clHighlightText=197379,this.clBurlywood=8894686,this.clDarkgreen=25600,this.clDarkolivegreen=3107669,this.clDarkseagreen=9419919,this.clHoneydew=15794160,this.ANSI_CHARSET=0,this.DEFAULT_CHARSET=1,this.$rtti.$inherited("TColor",rtl.nativeint,{}),this.TPenStyle={0:"psSolid",psSolid:0,1:"psDash",psDash:1,2:"psDot",psDot:2,3:"psDashDot",psDashDot:3,4:"psDashDotDot",psDashDotDot:4,5:"psClear",psClear:5,6:"psInsideFrame",psInsideFrame:6,7:"psUserStyle",psUserStyle:7,8:"psAlternate",psAlternate:8},this.$rtti.$Enum("TPenStyle",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TPenStyle}),this.TPenMode={0:"pmBlack",pmBlack:0,1:"pmWhite",pmWhite:1,2:"pmNop",pmNop:2,3:"pmNot",pmNot:3,4:"pmCopy",pmCopy:4,5:"pmNotCopy",pmNotCopy:5,6:"pmMergePenNot",pmMergePenNot:6,7:"pmMaskPenNot",pmMaskPenNot:7,8:"pmMergeNotPen",pmMergeNotPen:8,9:"pmMaskNotPen",pmMaskNotPen:9,10:"pmMerge",pmMerge:10,11:"pmNotMerge",pmNotMerge:11,12:"pmMask",pmMask:12,13:"pmNotMask",pmNotMask:13,14:"pmXor",pmXor:14,15:"pmNotXor",pmNotXor:15},this.$rtti.$Enum("TPenMode",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TPenMode}),this.TBrushStyle={0:"bsSolid",bsSolid:0,1:"bsClear",bsClear:1,2:"bsHorizontal",bsHorizontal:2,3:"bsVertical",bsVertical:3,4:"bsFDiagonal",bsFDiagonal:4,5:"bsBDiagonal",bsBDiagonal:5,6:"bsCross",bsCross:6,7:"bsDiagCross",bsDiagCross:7},this.$rtti.$Enum("TBrushStyle",{minvalue:0,maxvalue:7,ordtype:1,enumtype:this.TBrushStyle}),this.TBrushGradient={0:"bgNone",bgNone:0,1:"bgLinearVert",bgLinearVert:1,2:"bgLinearHorz",bgLinearHorz:2,3:"bgRadial",bgRadial:3},this.$rtti.$Enum("TBrushGradient",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBrushGradient}),this.TFontStyle={0:"fsBold",fsBold:0,1:"fsItalic",fsItalic:1,2:"fsStrikeOut",fsStrikeOut:2,3:"fsUnderline",fsUnderline:3},this.$rtti.$Enum("TFontStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFontStyle}),this.$rtti.$Set("TFontStyles",{comptype:this.$rtti.TFontStyle}),this.$rtti.$Int("TFontCharset",{minvalue:0,maxvalue:255,ordtype:3}),rtl.createClass(this,"TPen",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FWidth=0,this.FColor=0,this.FStyle=0,this.FMode=0},this.SetColor=function(t){this.FColor=t},this.Create$1=function(){return this.FColor=0,this.FWidth=1,this.FStyle=0,this.FMode=4,this},this.Assign=function(e){t.TPen.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TPen).FColor,this.FStyle=rtl.as(e,t.TPen).FStyle,this.FWidth=rtl.as(e,t.TPen).FWidth):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Mode",0,t.$rtti.TPenMode,"FMode","FMode",{Default:t.TPenMode.pmCopy}),e.addProperty("Width",0,rtl.longint,"FWidth","FWidth",{Default:1}),e.addProperty("Style",0,t.$rtti.TPenStyle,"FStyle","FStyle",{Default:t.TPenStyle.psSolid})})),rtl.createClass(this,"TBrush",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColor=0,this.FStyle=0,this.FGradientColors=null,this.FGradient=0},this.$final=function(){this.FGradientColors=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return this.FColor=16777215,this.FStyle=0,this.FGradient=0,this.FGradientColors=pas.Classes.TList.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FGradientColors"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TBrush.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TBrush).FColor,this.FStyle=rtl.as(e,t.TBrush).FStyle):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Gradient",0,t.$rtti.TBrushGradient,"FGradient","FGradient"),e.addProperty("Color",0,t.$rtti.TColor,"FColor","FColor"),e.addProperty("Style",0,t.$rtti.TBrushStyle,"FStyle","FStyle")})),rtl.createClass(this,"TFont",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FName="",this.FSize=0,this.FColor=0,this.FStyle={},this.FOnChange=null,this.FHeight=0,this.FCharset=0},this.$final=function(){this.FStyle=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHeight=function(t){var e;e=72*-t/96,this.FSize=Math.round(e),this.FHeight!==t&&(this.FHeight=t,this.DoChange())},this.SetName=function(t){this.FName!==t&&(this.FName=t,this.DoChange())},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.DoChange())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.DoChange())},this.SetStyle=function(t){rtl.neSet(this.FStyle,t)&&(this.FStyle=rtl.refSet(t),this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TFont.isPrototypeOf(e)?(this.FName=rtl.as(e,t.TFont).FName,this.FColor=rtl.as(e,t.TFont).FColor,this.FSize=rtl.as(e,t.TFont).FSize,this.FStyle=rtl.refSet(rtl.as(e,t.TFont).FStyle),this.DoChange()):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FName=t.WEBDEFAULTFONT,this.FSize=8,this.FHeight=-11,this.FStyle={},this.FColor=0,this};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Charset",0,t.$rtti.TFontCharset,"FCharset","FCharset"),e.addProperty("Name",2,pas.UITypes.$rtti.TFontName,"FName","SetName"),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight"),e.addProperty("Style",2,t.$rtti.TFontStyles,"FStyle","SetStyle"),e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize")})),rtl.recNewT(this,"TMatrix",(function(){this.m11=0,this.m12=0,this.m13=0,this.m21=0,this.m22=0,this.m23=0,this.m31=0,this.m32=0,this.m33=0,this.$eq=function(t){return this.m11===t.m11&&this.m12===t.m12&&this.m13===t.m13&&this.m21===t.m21&&this.m22===t.m22&&this.m23===t.m23&&this.m31===t.m31&&this.m32===t.m32&&this.m33===t.m33},this.$assign=function(t){return this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}})),rtl.createClass(this,"TCanvas",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FElementCanvas=null,this.FContext=null,this.FPen=null,this.FBrush=null,this.FFont=null,this.FPathOpen=!1,this.FApplyPixelRatio=!1},this.$final=function(){this.FElementCanvas=void 0,this.FContext=void 0,this.FPen=void 0,this.FBrush=void 0,this.FFont=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(e){return this.FElementCanvas=e,-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")?this.FContext=e.getContext("2d"):this.FContext=e.getContext("2d",{willReadFrequently:!0}),this.FPen=t.TPen.$create("Create$1"),this.FBrush=t.TBrush.$create("Create$1"),this.FPathOpen=!1,this.FFont=t.TFont.$create("Create$1"),this.FApplyPixelRatio=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.SetTransform=function(i,s,n,r,o,a){var l=t.TMatrix.$new(),h=0;null!=this.FContext&&(l.$assign(e.MatrixIdentity()),l.m11=i,l.m12=s,l.m21=n,l.m22=r,l.m31=o,l.m32=a,this.FApplyPixelRatio&&(h=e.GetPixelRatio(this),l.$assign(e.MatrixMultiply(l,e.MatrixCreateScaling(h,h)))),this.FContext.setTransform(l.m11,l.m12,l.m21,l.m22,l.m31,l.m32))},this.Clear=function(){null!=this.FContext&&null!=this.FElementCanvas&&this.FContext.clearRect(0,0,this.FElementCanvas.width,this.FElementCanvas.height)}})),this.ColorToRGB=function(t){return t},this.ColorToHex=function(t){var e="";for(e=t.toString(16);e.length<6;)e="0"+e;return pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2)+pas.System.Copy(e,1,2)},this.ColorToHTML=function(e){return-1==(4294967295&e)?"#00000000":0!=(4278190080&e)?"#"+t.ColorToHex(16777215&e)+pas.SysUtils.IntToHex(255&Math.floor((4278190080&e)/16777216),2):"#"+t.ColorToHex(e)},this.RGB=function(t,e,i){return t|e<<8|i<<16},this.CSSFont=function(t){var e="",i="";return e="font-family:"+t.FName+";",e+="font-style: normal;",0 in t.FStyle&&(e+="font-weight: bold;"),1 in t.FStyle&&(e+="font-style: italic;"),i="",3 in t.FStyle&&(i+=" underline"),2 in t.FStyle&&(i+=" line-through"),""!==i&&(e=e+"text-decoration:"+i+";"),e=e+"font-size:"+pas.SysUtils.IntToStr(t.FSize)+"pt;"},t.$implcode=function(){rtl.createClass(e,"TGraphicCacheList",pas.contnrs.TObjectList,(function(){})),e.FCache=null,e.FQueue=null,e.MatrixIdentity=function(){var e=t.TMatrix.$new();return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=1,e.m23=0,e.m31=0,e.m32=0,e.m33=1,e},e.GetPixelRatio=function(t){var e=t.FContext;return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},e.MatrixCreateScaling=function(i,s){var n=t.TMatrix.$new();return n.$assign(e.MatrixIdentity()),n.m11=i,n.m22=s,n},e.MatrixMultiply=function(e,i){var s=t.TMatrix.$new();return s.m11=e.m11*i.m11+e.m12*i.m21+e.m13*i.m31,s.m12=e.m11*i.m12+e.m12*i.m22+e.m13*i.m32,s.m13=e.m11*i.m13+e.m12*i.m23+e.m13*i.m33,s.m21=e.m21*i.m11+e.m22*i.m21+e.m23*i.m31,s.m22=e.m21*i.m12+e.m22*i.m22+e.m23*i.m32,s.m23=e.m21*i.m13+e.m22*i.m23+e.m23*i.m33,s.m31=e.m31*i.m11+e.m32*i.m21+e.m33*i.m31,s.m32=e.m31*i.m12+e.m32*i.m22+e.m33*i.m32,s.m33=e.m31*i.m13+e.m32*i.m23+e.m33*i.m33,s}},t.$init=function(){e.FCache=e.TGraphicCacheList.$create("Create$2"),e.FQueue=pas.Classes.TStringList.$create("Create$1")}}),["WEBLib.Forms","WEBLib.WebTools","Math","SysUtils","contnrs"]),rtl.module("WEBLib.Lang",["System"],(function(){"use strict";this.TUILanguage={0:"lNone",lNone:0,1:"lAfar",lAfar:1,2:"lAbkhazian",lAbkhazian:2,3:"lAvestan",lAvestan:3,4:"lAfrikaans",lAfrikaans:4,5:"lAkan",lAkan:5,6:"lAmharic",lAmharic:6,7:"lAragonese",lAragonese:7,8:"lArabic",lArabic:8,9:"lAssamese",lAssamese:9,10:"lAvaric",lAvaric:10,11:"lAymara",lAymara:11,12:"lAzerbaijani",lAzerbaijani:12,13:"lBashkir",lBashkir:13,14:"lBelarusian",lBelarusian:14,15:"lBulgarian",lBulgarian:15,16:"lBihari",lBihari:16,17:"lBislama",lBislama:17,18:"lBambara",lBambara:18,19:"lBengali",lBengali:19,20:"lTibetan",lTibetan:20,21:"lBreton",lBreton:21,22:"lBosnian",lBosnian:22,23:"lCatalan",lCatalan:23,24:"lChechen",lChechen:24,25:"lChamorro",lChamorro:25,26:"lCorsican",lCorsican:26,27:"lCree",lCree:27,28:"lCzech",lCzech:28,29:"lOldSlavic",lOldSlavic:29,30:"lChuvash",lChuvash:30,31:"lWelsh",lWelsh:31,32:"lDanish",lDanish:32,33:"lGerman",lGerman:33,34:"lDivehi",lDivehi:34,35:"lDzongkha",lDzongkha:35,36:"lEwe",lEwe:36,37:"lEnglish",lEnglish:37,38:"lEsperanto",lEsperanto:38,39:"lSpanish",lSpanish:39,40:"lEstonian",lEstonian:40,41:"lBasque",lBasque:41,42:"lPersian",lPersian:42,43:"lFulah",lFulah:43,44:"lFinnish",lFinnish:44,45:"lFijian",lFijian:45,46:"lFaroese",lFaroese:46,47:"lFrench",lFrench:47,48:"lWesternFrisian",lWesternFrisian:48,49:"lIrish",lIrish:49,50:"lGaelic",lGaelic:50,51:"lGalician",lGalician:51,52:"lGuarani",lGuarani:52,53:"lGujarati",lGujarati:53,54:"lManx",lManx:54,55:"lHausa",lHausa:55,56:"lHebrew",lHebrew:56,57:"lHindi",lHindi:57,58:"lHiriMotu",lHiriMotu:58,59:"lCroatian",lCroatian:59,60:"lHaitian",lHaitian:60,61:"lHungarian",lHungarian:61,62:"lArmenian",lArmenian:62,63:"lHerero",lHerero:63,64:"lInterlingua",lInterlingua:64,65:"lIndonesian",lIndonesian:65,66:"lInterlingue",lInterlingue:66,67:"lIgbo",lIgbo:67,68:"lSichuanYi",lSichuanYi:68,69:"lInupiaq",lInupiaq:69,70:"lIdo",lIdo:70,71:"lIcelandic",lIcelandic:71,72:"lItalian",lItalian:72,73:"lInuktitut",lInuktitut:73,74:"lJapanese",lJapanese:74,75:"lJavanese",lJavanese:75,76:"lGeorgian",lGeorgian:76,77:"lKongo",lKongo:77,78:"lKikuyu",lKikuyu:78,79:"lKuanyama",lKuanyama:79,80:"lKazakh",lKazakh:80,81:"lKalaallisut",lKalaallisut:81,82:"lCentralKhmer",lCentralKhmer:82,83:"lKannada",lKannada:83,84:"lKorean",lKorean:84,85:"lKanuri",lKanuri:85,86:"lKashmiri",lKashmiri:86,87:"lKurdish",lKurdish:87,88:"lKomi",lKomi:88,89:"lCornish",lCornish:89,90:"lKirghiz",lKirghiz:90,91:"lLatin",lLatin:91,92:"lLuxembourgish",lLuxembourgish:92,93:"lGanda",lGanda:93,94:"lLimburgan",lLimburgan:94,95:"lLingala",lLingala:95,96:"lLao",lLao:96,97:"lLithuanian",lLithuanian:97,98:"lLubaKatanga",lLubaKatanga:98,99:"lLatvian",lLatvian:99,100:"lMalagasy",lMalagasy:100,101:"lMarshallese",lMarshallese:101,102:"lMaori",lMaori:102,103:"lMacedonian",lMacedonian:103,104:"lMalayalam",lMalayalam:104,105:"lMongolian",lMongolian:105,106:"lMarathi",lMarathi:106,107:"lMalay",lMalay:107,108:"lMaltese",lMaltese:108,109:"lBurmese",lBurmese:109,110:"lNauru",lNauru:110,111:"lNdebele",lNdebele:111,112:"lNepali",lNepali:112,113:"lNdonga",lNdonga:113,114:"lDutch",lDutch:114,115:"lNorwegian",lNorwegian:115,116:"lNavajo",lNavajo:116,117:"lChichewa",lChichewa:117,118:"lOccitan",lOccitan:118,119:"lOjibwa",lOjibwa:119,120:"lOromo",lOromo:120,121:"lOriya",lOriya:121,122:"lOssetian",lOssetian:122,123:"lPanjabi",lPanjabi:123,124:"lPali",lPali:124,125:"lPolish",lPolish:125,126:"lPushto",lPushto:126,127:"lPortuguese",lPortuguese:127,128:"lQuechua",lQuechua:128,129:"lRomansh",lRomansh:129,130:"lRundi",lRundi:130,131:"lRomanian",lRomanian:131,132:"lRussian",lRussian:132,133:"lKinyarwanda",lKinyarwanda:133,134:"lSanskrit",lSanskrit:134,135:"lSardinian",lSardinian:135,136:"lSindhi",lSindhi:136,137:"lNorthernSami",lNorthernSami:137,138:"lSango",lSango:138,139:"lSinhala",lSinhala:139,140:"lSlovak",lSlovak:140,141:"lSlovenian",lSlovenian:141,142:"lSamoan",lSamoan:142,143:"lShona",lShona:143,144:"lSomali",lSomali:144,145:"lAlbanian",lAlbanian:145,146:"lSerbian",lSerbian:146,147:"lSwati",lSwati:147,148:"lSotho",lSotho:148,149:"lSundanese",lSundanese:149,150:"lSwedish",lSwedish:150,151:"lSwahili",lSwahili:151,152:"lTamil",lTamil:152,153:"lTelugu",lTelugu:153,154:"lTajik",lTajik:154,155:"lThai",lThai:155,156:"lTigrinya",lTigrinya:156,157:"lTurkmen",lTurkmen:157,158:"lTagalog",lTagalog:158,159:"lTswana",lTswana:159,160:"lTonga",lTonga:160,161:"lTurkish",lTurkish:161,162:"lTsonga",lTsonga:162,163:"lTatar",lTatar:163,164:"lTwi",lTwi:164,165:"lTahitian",lTahitian:165,166:"lUighur",lUighur:166,167:"lUkrainian",lUkrainian:167,168:"lUrdu",lUrdu:168,169:"lUzbek",lUzbek:169,170:"lVenda",lVenda:170,171:"lVietnamese",lVietnamese:171,172:"lWalloon",lWalloon:172,173:"lWolof",lWolof:173,174:"lXhosa",lXhosa:174,175:"lYiddish",lYiddish:175,176:"lYoruba",lYoruba:176,177:"lZhuang",lZhuang:177,178:"lChinese",lChinese:178,179:"lZulu",lZulu:179},this.GetLanguageISO639_1Code=function(t){var e="";return 0===t?e="":1===t?e="aa":2===t?e="ab":3===t?e="ae":4===t?e="af":5===t?e="ak":6===t?e="am":7===t?e="an":8===t?e="ar":9===t?e="as":10===t?e="av":11===t?e="ay":12===t?e="az":13===t?e="ba":14===t?e="be":15===t?e="bg":16===t?e="bh":17===t?e="bi":18===t?e="bm":19===t?e="bn":20===t?e="bo":21===t?e="br":22===t?e="bd":23===t?e="ca":24===t?e="ce":25===t?e="ch":26===t?e="co":27===t?e="cr":28===t?e="cs":29===t?e="cu":30===t?e="cv":31===t?e="cy":32===t?e="da":33===t?e="de":34===t?e="dv":35===t?e="dz":36===t?e="ee":37===t?e="en":38===t?e="eo":39===t?e="es":40===t?e="et":41===t?e="eu":42===t?e="fa":43===t?e="ff":44===t?e="fi":45===t?e="fj":46===t?e="fo":47===t?e="fr":48===t?e="fy":49===t?e="ga":50===t?e="gd":51===t?e="gl":52===t?e="gn":53===t?e="gu":54===t?e="gv":55===t?e="ha":56===t?e="he":57===t?e="hi":58===t?e="ho":59===t?e="hr":60===t?e="ht":61===t?e="hu":62===t?e="hy":63===t?e="hz":64===t?e="ia":65===t?e="id":66===t?e="ie":67===t?e="ig":68===t?e="ii":69===t?e="ik":70===t?e="id":71===t?e="is":72===t?e="it":73===t?e="iu":74===t?e="ja":75===t?e="jv":76===t?e="ka":77===t?e="kg":78===t?e="ki":79===t?e="kj":80===t?e="kk":81===t?e="kl":82===t?e="km":83===t?e="kn":84===t?e="ko":85===t?e="kr":86===t?e="ks":87===t?e="ku":88===t?e="kv":89===t?e="kw":90===t?e="ky":91===t?e="la":92===t?e="lb":93===t?e="lg":94===t?e="li":95===t?e="ln":96===t?e="lo":97===t?e="lt":98===t?e="lu":99===t?e="lv":100===t?e="mg":101===t?e="mh":102===t?e="mi":103===t?e="mk":104===t?e="ml":105===t?e="mn":106===t?e="mr":107===t?e="ms":108===t?e="mt":109===t?e="my":110===t?e="na":111===t?e="nb":112===t?e="nd":113===t?e="ng":114===t?e="nl":115===t?e="no":116===t?e="nv":117===t?e="ny":118===t?e="oc":119===t?e="oj":120===t?e="om":121===t?e="or":122===t?e="os":123===t?e="pa":124===t?e="pi":125===t?e="pl":126===t?e="ps":127===t?e="pt":128===t?e="qu":129===t?e="rm":130===t?e="rn":131===t?e="ro":132===t?e="ru":133===t?e="rw":134===t?e="sa":135===t?e="sc":136===t?e="sd":137===t?e="se":138===t?e="sg":139===t?e="si":140===t?e="sk":141===t?e="sl":142===t?e="sm":143===t?e="sn":144===t?e="so":145===t?e="sq":146===t?e="sr":147===t?e="ss":148===t?e="st":149===t?e="su":150===t?e="sv":151===t?e="sw":152===t?e="ta":153===t?e="te":154===t?e="tg":155===t?e="th":156===t?e="ti":157===t?e="tk":158===t?e="tl":159===t?e="tn":160===t?e="to":161===t?e="tr":162===t?e="ts":163===t?e="tt":164===t?e="tw":165===t?e="ty":166===t?e="ug":167===t?e="uk":168===t?e="ur":169===t?e="uz":170===t?e="ve":171===t?e="vi":172===t?e="wa":173===t?e="wo":174===t?e="xh":175===t?e="yi":176===t?e="yo":177===t?e="za":178===t?e="zh":179===t&&(e="zu"),e}})),rtl.module("WEBLib.Menus",["System","Classes","SysUtils","WEBLib.Controls","WEBLib.Graphics","Web"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$Class("TMainMenu"),this.$rtti.$Class("TMenuItem"),this.$rtti.$Class("TCustomMainMenu"),this.TMenuItemAutoFlag={0:"maAutomatic",maAutomatic:0,1:"maManual",maManual:1,2:"maParent",maParent:2},this.$rtti.$Enum("TMenuItemAutoFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuItemAutoFlag}),this.TMenuBreak={0:"mbNone",mbNone:0,1:"mbBreak",mbBreak:1,2:"mbBarBreak",mbBarBreak:2},this.$rtti.$Enum("TMenuBreak",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuBreak}),this.$rtti.$Int("THelpContext",{minvalue:-2147483647,maxvalue:2147483647,ordtype:4}),this.$rtti.$inherited("TShortCut",rtl.word,{}),this.TMainMenuHamburgerMenuVisible={0:"hmAlways",hmAlways:0,1:"hmNever",hmNever:1,2:"hmResponsive",hmResponsive:2},this.$rtti.$Enum("TMainMenuHamburgerMenuVisible",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMainMenuHamburgerMenuVisible}),this.$rtti.$MethodVar("TMainMenuChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TMenuItem],["Rebuild",rtl.boolean]]),methodkind:0}),rtl.createClass(this,"TMenuItemList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TMenuItem",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FOwner$1=null,this.FCaption="",this.FItems=null,this.FParentItem=null,this.FOnClick=null,this.FChecked=!1,this.FEnabled=!1,this.FDefault=!1,this.FAutoCheck=!1,this.FHint="",this.FAutoHotkeys=0,this.FRadioItem=!1,this.FGroupIndex=0,this.FVisible=!1,this.FShortCut=0,this.FBreak=0,this.FImageIndex=0,this.FAutoLineReduction=0,this.FHelpContext=0,this.FElementClassName="",this.FParentMenu=null},this.$final=function(){this.FOwner$1=void 0,this.FItems=void 0,this.FParentItem=void 0,this.FOnClick=void 0,this.FParentMenu=void 0,pas.Classes.TComponent.$final.call(this)},this.SetChecked=function(e){var i=null,s=null,n=null,r=null,o=0;if(this.FChecked!==e){if(this.FChecked=e,null!=(r=this.FParentMenu)){if(t.TMenuItem.isPrototypeOf(r)&&e)for(var a=0,l=(s=r).FItems.GetCount()-1;a<=l;a++)o=a,(n=s.FItems.GetItem(o)).FRadioItem&&n!==this&&n.SetChecked(!1);for(;!t.TCustomMainMenu.isPrototypeOf(r)&&null!=r;)r=r.FOwner}null!=(i=this.GetParentMenu())&&i.UpdateElement()}},this.SetCaption=function(t){var e=null;this.FCaption=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetImageIndex=function(t){var e=null;this.FImageIndex=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.GetParentMenu().UpdateElement())},this.GetCount=function(){return null===this.FItems?0:this.FItems.GetCount()},this.Create$1=function(e){return this.FParentMenu=null,t.TMainMenu.isPrototypeOf(e)&&(this.FParentMenu=e),pas.Classes.TComponent.Create$1.call(this,e),this.FAutoHotkeys=2,this.FAutoLineReduction=2,this.FImageIndex=-1,this.FHint="",this.FCaption="MenuItem",this.FChecked=!1,this.FEnabled=!0,this.FDefault=!1,this.FRadioItem=!1,this.FVisible=!0,this.FOwner$1=e,this},this.Destroy=function(){var t=0,e=null,i=null;if(e=this.GetParentMenu(),null!=this.FParentItem&&null!=e){e.BeginUpdate();for(var s=this.FParentItem.FItems.GetCount()-1;s>=0;s--)t=s,this.FParentItem.FItems.GetItem(t)===this&&this.FParentItem.FItems.Delete(t);e.EndUpdate()}if(null!=this.FItems)for(var n=this.FItems.GetCount()-1;n>=0;n--)t=n,(i=this.FItems.GetItem(t)).FParentItem=null,i=rtl.freeLoc(i),this.FItems.Delete(t);pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(e){var i=0,s=null,n=null,r=null;if(t.TMenuItem.isPrototypeOf(e)&&(s=rtl.as(e,t.TMenuItem),this.FAutoCheck=s.FAutoCheck,this.FAutoHotkeys=s.FAutoHotkeys,this.FAutoLineReduction=s.FAutoLineReduction,this.FBreak=s.FBreak,this.FCaption=s.FCaption,this.FChecked=s.FChecked,this.FDefault=s.FDefault,this.FEnabled=s.FEnabled,this.FGroupIndex=s.FGroupIndex,this.FHelpContext=s.FHelpContext,this.FHint=s.FHint,this.FImageIndex=s.FImageIndex,this.FRadioItem=s.FRadioItem,this.FShortCut=s.FShortCut,this.FVisible=s.FVisible,this.FElementClassName=s.FElementClassName,r=this.GetParentMenu(),null!=this.FParentItem&&this.SetName(r.GetUniqueName(s.FCaption)),null!=s.FItems)){if(null!=this.FItems){for(var o=this.FItems.GetCount()-1;o>=0;o--)i=o,this.RemoveItem(this.GetParentMenu().FParent,this.FItems.GetItem(i));this.FItems.Clear()}else this.FItems=t.TMenuItemList.$create("Create$1");for(var a=0,l=s.FItems.GetCount()-1;a<=l;a++)i=a,(n=t.TMenuItem.$create("Create$1",[r.FOwner])).FParentMenu=r,n.FParentItem=this,n.Assign(s.FItems.GetItem(i)),this.FItems.Add(n)}},this.SetParentComponent=function(e){pas.Classes.TComponent.SetParentComponent.apply(this,arguments),this.FParentMenu=e,null!==e&&(t.TCustomMainMenu.isPrototypeOf(e)?e.FItems.IsChild(this)||e.FItems.Add(this):t.TMenuItem.isPrototypeOf(e)&&(e.IsChild(this)||e.Add(this)))},this.Add=function(t){this.Insert$1(this.GetCount(),t)},this.Insert$1=function(e,i){null===this.FItems&&(this.FItems=t.TMenuItemList.$create("Create$1")),this.FItems.Insert(e,i),i.FParentItem=this,null!=i.GetParentMenu()&&i.GetParentMenu().UpdateElement()},this.IsChild=function(t){var e=!1,i=0;if(e=!1,null==this.FItems)return e;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)i=s,this.FItems.GetItem(i)===t&&(e=!0);return e},this.GetOwner=function(){return this.FOwner$1},this.GetParentMenu=function(){var e=null,i=null;for(e=null,i=this.FParentMenu;null!=i&&t.TMenuItem.isPrototypeOf(i);)i=i.FParentMenu;return null!=i&&(e=i),e},this.RemoveItem=function(t,e){var i=0;if(null!=e.FItems)for(var s=e.FItems.GetCount()-1;s>=0;s--)i=s,this.RemoveItem(t,e.FItems.GetItem(i));t.RemoveComponent(e)},this.Click=function(){null!=this.FOnClick&&this.FOnClick(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("AutoCheck",0,rtl.boolean,"FAutoCheck","FAutoCheck",{Default:!1}),e.addProperty("AutoHotkeys",0,t.$rtti.TMenuItemAutoFlag,"FAutoHotkeys","FAutoHotkeys",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("AutoLineReduction",0,t.$rtti.TMenuItemAutoFlag,"FAutoLineReduction","FAutoLineReduction",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("Break",0,t.$rtti.TMenuBreak,"FBreak","FBreak",{Default:t.TMenuBreak.mbNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("Default",0,rtl.boolean,"FDefault","FDefault",{Default:!1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("GroupIndex",0,rtl.byte,"FGroupIndex","FGroupIndex",{Default:0}),e.addProperty("HelpContext",0,t.$rtti.THelpContext,"FHelpContext","FHelpContext",{Default:0}),e.addProperty("Hint",0,rtl.string,"FHint","FHint"),e.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default:-1}),e.addProperty("RadioItem",0,rtl.boolean,"FRadioItem","FRadioItem",{Default:!1}),e.addProperty("ShortCut",0,t.$rtti.TShortCut,"FShortCut","FShortCut",{Default:0}),e.addProperty("Visible",0,rtl.boolean,"FVisible","FVisible",{Default:!0}),e.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick")})),this.$rtti.$Class("TMainMenuAppearance"),rtl.createClass(this,"THamburgerMenu",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FVisible=0,this.FCaption="",this.FBackgroundColor=0,this.FCaptionColor=0,this.FResponsiveMaxWidth=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.FOwner.FOwner.UpdateElement())},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.FOwner.UpdateElement())},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.FOwner.FOwner.UpdateElement())},this.SetCaptionColor=function(t){this.FCaptionColor!==t&&(this.FCaptionColor=t,this.FOwner.FOwner.UpdateElement())},this.SetResponsiveMaxWidth=function(t){this.FResponsiveMaxWidth!==t&&(this.FResponsiveMaxWidth=t,this.FOwner.FOwner.UpdateElement())},this.Create$1=function(t){return this.FBackgroundColor=12632256,this.FCaption="Menu",this.FCaptionColor=16777215,this.FVisible=2,this.FResponsiveMaxWidth=768,this.FOwner=t,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.THamburgerMenu.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.THamburgerMenu).FBackgroundColor,this.FCaption=rtl.as(e,t.THamburgerMenu).FCaption,this.FCaptionColor=rtl.as(e,t.THamburgerMenu).FCaptionColor,this.FVisible=rtl.as(e,t.THamburgerMenu).FVisible,this.FResponsiveMaxWidth=rtl.as(e,t.THamburgerMenu).FResponsiveMaxWidth)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",t.$rtti.TMainMenuAppearance]]),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("CaptionColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FCaptionColor","SetCaptionColor",{Default:16777215}),e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:12632256}),e.addProperty("Visible",2,t.$rtti.TMainMenuHamburgerMenuVisible,"FVisible","SetVisible",{Default:t.TMainMenuHamburgerMenuVisible.hmResponsive}),e.addProperty("ResponsiveMaxWidth",2,rtl.longint,"FResponsiveMaxWidth","SetResponsiveMaxWidth",{Default:768})})),rtl.createClass(this,"TMainMenuAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FBackgroundColor=0,this.FHoverFontColor=0,this.FHoverColor=0,this.FImageURLs=null,this.FHamburgerMenu=null,this.FImageSize=0,this.FSubmenuIndicator=""},this.$final=function(){this.FOwner=void 0,this.FImageURLs=void 0,this.FHamburgerMenu=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.UpdateElement())},this.SetHoverColor=function(t){this.FHoverColor!==t&&(this.FHoverColor=t,this.FOwner.UpdateElement())},this.SetHoverFontColor=function(t){this.FHoverFontColor!==t&&(this.FHoverFontColor=t,this.FOwner.UpdateElement())},this.SetImageURLs=function(t){this.FImageURLs.Assign(t)},this.SetImageSize=function(t){this.FImageSize!==t&&(this.FImageSize=t,this.FOwner.UpdateElement())},this.SetSubmenuIndicator=function(t){this.FSubmenuIndicator!==t&&(this.FSubmenuIndicator=t,this.FOwner.UpdateElement())},this.HandleImageURLsChanged=function(t){this.FOwner.UpdateElement()},this.Create$1=function(e){return this.FBackgroundColor=15790320,this.FHoverColor=14120960,this.FHoverFontColor=197379,this.FHamburgerMenu=t.THamburgerMenu.$create("Create$1",[this]),this.FImageURLs=pas.Classes.TStringList.$create("Create$1"),this.FImageURLs.SetSkipLastLineBreak(!0),this.FImageURLs.FOnChange=rtl.createCallback(this,"HandleImageURLsChanged"),this.FImageSize=16,this.FSubmenuIndicator="&#9658;",this.FOwner=e,this},this.Destroy=function(){rtl.free(this,"FHamburgerMenu"),rtl.free(this,"FImageURLs"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.TMainMenuAppearance.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.TMainMenuAppearance).FBackgroundColor,this.FHoverColor=rtl.as(e,t.TMainMenuAppearance).FHoverColor,this.FHoverFontColor=rtl.as(e,t.TMainMenuAppearance).FHoverFontColor,this.FHamburgerMenu.Assign(rtl.as(e,t.TMainMenuAppearance).FHamburgerMenu),this.FImageURLs.Assign(rtl.as(e,t.TMainMenuAppearance).FImageURLs),this.FImageSize=rtl.as(e,t.TMainMenuAppearance).FImageSize,this.FSubmenuIndicator=rtl.as(e,t.TMainMenuAppearance).FSubmenuIndicator)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",t.$rtti.TMainMenu]]),e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:15790320}),e.addProperty("HamburgerMenu",0,t.$rtti.THamburgerMenu,"FHamburgerMenu","FHamburgerMenu"),e.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverColor","SetHoverColor",{Default:14120960}),e.addProperty("HoverFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverFontColor","SetHoverFontColor",{Default:197379}),e.addProperty("ImageURLs",2,pas.Classes.$rtti.TStringList,"FImageURLs","SetImageURLs"),e.addProperty("ImageSize",2,rtl.longint,"FImageSize","SetImageSize",{Default:16}),e.addProperty("SubmenuIndicator",2,rtl.string,"FSubmenuIndicator","SetSubmenuIndicator")})),rtl.createClass(this,"TCustomMainMenu",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FItems=null,this.FOnChange=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.IsUpdating()||null!=this.GetElementHandle()&&this.UpdateElement()},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()},this.GetUniqueName=function(t){var i="",s=0,n=0,r=!1;n=1,""===t&&(t=this.FName+"item"),t=e.MakeValidName(t);do{i=t+pas.SysUtils.IntToStr(n),r=!0;for(var o=0,a=this.FOwner.GetComponentCount()-1;o<=a;o++)if(s=o,this.FOwner.GetComponent(s).FName===i){r=!1,n+=1;break}}while(!r);return i},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.IsUpdating()||0 in this.FComponentState||this.UpdateElement()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=t.TMenuItem.$create("Create$1",[this]),this.FItems.FParentMenu=this,this.SetWidthStyle(2),this.SetHeight(30)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Items",0,t.$rtti.TMenuItem,"FItems",""),i.addProperty("OnChange",0,t.$rtti.TMainMenuChangeEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TMainMenu",this.TCustomMainMenu,(function(){this.$init=function(){t.TCustomMainMenu.$init.call(this),this.FMenu=null,this.FMainMenu=!1,this.FMenuIndex=0,this.FAppearance=null,this.FContainer$1=null,this.FIsPopupMenu=!1,this.FShowPopup=!1,this.FZIndex="",this.FElementItemClassName=""},this.$final=function(){this.FMenu=void 0,this.FAppearance=void 0,this.FContainer$1=void 0,t.TCustomMainMenu.$final.call(this)},this.HandleChange=function(t){var e=null,i=null;return!0,this.FIsPopupMenu&&(this.FShowPopup=!1,this.UpdateElement()),(e=t.target).hasAttribute("id")||(e=e.parentElement),null!=(i=this.GetItemByName(this.FItems,e.id))&&(i.FAutoCheck&&i.SetChecked(!i.FChecked),null!=this.FOnChange&&this.FOnChange(this,i,!1),i.Click()),!0},this.Loaded=function(){t.TCustomMainMenu.Loaded.call(this),this.IsUpdating()||(null==this.FContainer$1&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,pas["WEBLib.Forms"].TCustomForm).FMenu===this&&(this.FContainer$1=this.FParent),null!=this.GetElementHandle()&&this.UpdateElement())},this.UpdateElement=function(){var e,i="",s="",n="",r="",o="",a=null,l=null,h=null,u=null,d=null,F=null,c=null;t.TCustomMainMenu.UpdateElement.call(this),this.IsUpdating()||null==this.GetElementHandle()&&null==this.FContainer$1||(null!=this.FContainer$1?(a=this.FContainer$1.GetElementHandle(),this.SetVisible(!1)):((a=this.GetElementHandle()).style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"),a.style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),4 in this.FComponentState&&null==this.FContainer$1&&this.GetElementHandle().style.setProperty("background-color","silver")),this.FMenu=a.firstChild,null!=this.FMenu&&this.FMenu.parentElement.removeChild(this.FMenu),3 in this.FComponentState||(this.FMenu=document.createElement("NAV"),this.FMenu.setAttribute("id",this.GetID()+"menu"),this.FMenu.innerHTML="",null!=this.FContainer$1&&(this.FMenu.style.setProperty("top","0"),this.FMenu.style.setProperty("left","0"),this.FMenu.style.setProperty("position","absolute"),this.FMenu.style.setProperty("width","100%"),this.FMenu.style.setProperty("z-index",this.FZIndex)),a.style.setProperty("overflow","visible"),0!==this.FAppearance.FHamburgerMenu.FVisible&&(o=this.FShowPopup?"block":"none",n="  #"+this.GetID()+"menu .main-menu {\r    display: block;\r  }\r  #"+this.GetID()+"menu #toggle-menu {\r    display: none;\r  }\r  #"+this.GetID()+"menu ul span.drop-label {\r    display: inline-block;\r  }\r  #"+this.GetID()+"menu li {\r    float: left;\r    border-width: 0 1px 0 0;\r  }\r  #"+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    float: none;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    top: 0;\r  }\r  #"+this.GetID()+"menu .popup-menu, \r  #"+this.GetID()+"menu .sub-menu {\r    border-width: 0;\r    margin: 0;\r    position: absolute;\r    left: 0;\r    min-width: 12em;\r    z-index: 9999999;\r\t   white-space: nowrap;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    display: "+o+";\r  }\r  #"+this.GetID()+"menu .sub-menu,\r  #"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r  #'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r    display: none;\r  }\r  #'+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    border-width: 1px;\r  }\r  #"+this.GetID()+"menu .popup-menu .sub-menu, \r  #"+this.GetID()+"menu .sub-menu .sub-menu {\r    top: 0;\r    left: 100%;\r  }\r  #"+this.GetID()+'menu li:hover > input[type="checkbox"] + .popup-menu, \r  #'+this.GetID()+'menu li:hover > input[type="checkbox"] + .sub-menu {\r    display: block;\r  }\r',2===this.FAppearance.FHamburgerMenu.FVisible&&(n="@media only screen and (min-width: "+pas.SysUtils.IntToStr(this.FAppearance.FHamburgerMenu.FResponsiveMaxWidth)+"px) {\r"+n+"}")),this.FAppearance.FImageSize>0&&(r="  width: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r  height: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r"),i="#"+this.GetID()+"menu ul {\r  margin: 0;\r  padding: 0;\r}\r#"+this.GetID()+"menu .main-menu {\r  display: none;\r}\r#"+this.GetID()+"menu .popup-menu {\r  display: block;\r}\r#"+this.GetID()+"menu label img.icon,#"+this.GetID()+"menu label span.checked {\r"+r+"  margin-right: 10px;\r  pointer-events: none;\r}\r#"+this.GetID()+"tm:checked + .main-menu {\r  display: block;\r}\r#"+this.GetID()+'menu input[type="checkbox"],\r#'+this.GetID()+"menu ul span.drop-label {\r  display: none;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px;\r  border-style: solid;\r  border-color: rgba(0, 0, 0, .05);\r  border-bottom: 0px;\r  border-top: 0px;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu {\r  border-width: 0 0 3px;\r}\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px 1px 0;\r  margin: 0 1em;\r}\r#"+this.GetID()+"menu .popup-menu li:first-child,\r#"+this.GetID()+"menu .sub-menu li:first-child {\r  border-top: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu li:last-child,\r#"+this.GetID()+"menu .sub-menu li:last-child {\r  border-bottom: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r  position: relative;\r  display: block;\r}\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label { \r  padding: 0.75em 1.5em;\r  text-decoration: none;\r}\r#"+this.GetID()+"menu li span.menu-separator { \r  display: block;\r  width: 100%;\r  height: 1px;\r  background-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  display: none;\r}\r#"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r#'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r  display: block;\r  z-index: 3000;\r}\r#'+this.GetID()+"menu span.drop-icon {\r  margin-left: 10px;}\r#"+this.GetID()+"menu span.hamburger-icon {\r  float: right;\r  padding: 0;\r  margin: 0;\r  font-weight: 900;\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r  #"+this.GetID()+"menu li {\r    width: auto;\r  }\r  #"+this.GetID()+"menu .sub-menu li {\r    width: auto;\r  }\r}\r",s="",""===this.FElementClassName&&(s="#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r}\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r}\r#"+this.GetID()+"menu #toggle-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FCaptionColor)+";\r}\r#"+this.GetID()+"menu .main-menu li label {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r#"+this.GetID()+"menu li label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r#"+this.GetID()+"menu .popup-menu label:hover, \r#"+this.GetID()+"menu .sub-menu label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r"),i=i+s+n,this.FMainMenu=!0,this.FMenuIndex=0,(F=document.createElement("STYLE")).innerHTML=i,(c=document.createElement("SCRIPT")).innerHTML="function "+this.GetID()+'MenuClick(ctrl){  el = ctrl.parentElement.parentElement;  el.style.display = "none";  setTimeout(function(){el.style.removeProperty("display")}, 25);}function '+this.GetID()+'MenuOut(ctrl){  menuel = document.getElementById("'+this.GetID()+'");  if(menuel) {     popupel = menuel.getElementsByClassName("popup-menu");    if(popupel)       setTimeout(function(){popupel[0].style.display = "none"}, 25);  }}',(l=document.createElement("LABEL")).setAttribute("for",this.GetID()+"tm"),l.setAttribute("id","toggle-menu"),l.innerHTML=this.FAppearance.FHamburgerMenu.FCaption,h=document.createElement("SPAN"),""!==this.FElementItemClassName?h.setAttribute("class",this.FElementItemClassName):h.setAttribute("class","drop-label"),l.appendChild(h),(u=document.createElement("SPAN")).setAttribute("class","hamburger-icon"),u.innerHTML="&#9776;",h.appendChild(u),(d=document.createElement("INPUT")).setAttribute("type","checkbox"),d.setAttribute("id",this.GetID()+"tm"),this.FMenu.appendChild(F),this.FMenu.appendChild(c),this.FMenu.appendChild(l),this.FMenu.appendChild(d),null!==(e=this.GetMenuSource(this.FItems))&&this.FMenu.appendChild(e),a.appendChild(this.FMenu)))},this.GetMenuSource=function(t){var i=null,s=0,n=null,r="",o=null,a=null,l=null,h=null,u=0,d="";if(i=null,null!=t.FItems&&t.FItems.GetCount()>0){i=document.createElement("UL"),this.FMainMenu?(this.FMainMenu=!1,r=this.FIsPopupMenu?"popup-menu":"main-menu"):r="sub-menu",this.FMenuIndex=this.FMenuIndex+1,i.setAttribute("class",r);for(var F=0,c=t.FItems.GetCount()-1;F<=c;F++)s=F,u+=1,""===(n=t.FItems.GetItem(s)).FName&&(d=pas.SysUtils.StringReplace(n.FCaption," ","",rtl.createSet(0)),""===(d=e.MakeValidName(d))&&(d="MenuItem"+pas.SysUtils.IntToStr(u)),n.SetName(d+pas.SysUtils.IntToStr(u))),n.FVisible&&(o=document.createElement("LI"),"-"!==n.FCaption?(a=document.createElement("LABEL"),""!==this.FElementItemClassName?a.setAttribute("class",this.FElementItemClassName):a.setAttribute("class","drop-label"),a.setAttribute("title",n.FHint),n.FImageIndex>=0&&this.FAppearance.FImageURLs.GetCount()>n.FImageIndex?a.innerHTML='<img class="icon" src="'+this.FAppearance.FImageURLs.Get(n.FImageIndex)+'">':n.FChecked&&(n.FRadioItem?a.innerHTML='<span class="checked">&#9679;</span>':a.innerHTML='<span class="checked">&#10004;</span>'),a.innerHTML=a.innerHTML+n.FCaption):((a=document.createElement("SPAN")).setAttribute("class","menu-separator"),a.innerHTML=""),null!=n.FItems&&n.FItems.GetCount()>0?((h=document.createElement("SPAN")).setAttribute("class","drop-icon"),h.innerHTML=this.FAppearance.FSubmenuIndicator,a.setAttribute("for","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),a.appendChild(h),n.FEnabled||a.style.setProperty("color","gray"),(l=document.createElement("INPUT")).setAttribute("type","checkbox"),l.setAttribute("id","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),o.appendChild(a),o.appendChild(l),n.FEnabled&&o.appendChild(this.GetMenuSource(n))):(a.setAttribute("for",this.GetID()+"tm"),a.setAttribute("id",n.FName),n.FEnabled?("sub-menu"===r&&n.FEnabled&&a.setAttribute("onMouseUp",this.GetID()+"MenuClick(this);"),a.addEventListener("click",rtl.createSafeCallback(this,"HandleChange"))):a.style.setProperty("color","gray"),o.appendChild(a)),i.appendChild(o))}return i},this.GetItemByName=function(t,e){var i=null,s=0,n=null;if(i=null,null!=t.FItems)for(var r=0,o=t.FItems.GetCount()-1;r<=o;r++){if(s=r,(n=t.FItems.GetItem(s)).FName===e)return i=n,null!=n.FOnClick&&(i.FOnClick=n.FOnClick),i;null==i&&(i=this.GetItemByName(n,e))}return i},this.CreateInitialize=function(){t.TCustomMainMenu.CreateInitialize.call(this),this.FAppearance=t.TMainMenuAppearance.$create("Create$1",[this]),this.FContainer$1=null,this.FMainMenu=!0,this.FMenuIndex=0,this.FIsPopupMenu=!1,this.FShowPopup=!1,this.SetTop(0),this.SetLeft(0),this.SetWidth(100),4 in this.FComponentState&&(this.SetElementPosition(1),this.SetWidthPercent(100),this.SetWidthStyle(0))},this.CreateElement=function(){var t=null,e=null;return 4 in this.FComponentState?(t=document.createElement("DIV"),(e=document.createElement("DIV")).innerHTML="TWebMainMenu",this.SetBorderStyle(1),e.setAttribute("align","center"),e.style.setProperty("border","1px solid gray"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("display","table-cell"),t.appendChild(e)):(t=document.createElement("DIV"),this.FIsPopupMenu&&t.setAttribute("onMouseLeave",this.GetID()+"MenuOut(this);")),this.FZIndex=pas["WEBLib.Forms"].Application.MaxZIndexStr(),pas["WEBLib.Forms"].Application.ChangeMaxZIndex(1),t},this.Destroy=function(){rtl.free(this,"FAppearance"),t.TCustomMainMenu.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Appearance",0,t.$rtti.TMainMenuAppearance,"FAppearance","FAppearance"),i.addProperty("Container",0,pas["WEBLib.Controls"].$rtti.TControl,"FContainer$1","FContainer$1"),i.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),i.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),i.addProperty("ElementItemClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementItemClassName","FElementItemClassName"),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0})})),rtl.createClass(this,"TPopupMenu",this.TMainMenu,(function(){this.$init=function(){t.TMainMenu.$init.call(this),this.FOnPopup=null},this.$final=function(){this.FOnPopup=void 0,t.TMainMenu.$final.call(this)},this.Create$1=function(t){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),pas["WEBLib.Controls"].TControl.isPrototypeOf(t)&&this.SetParent(t),this},this.CreateInitialize=function(){t.TMainMenu.CreateInitialize.call(this),this.FAppearance.FHamburgerMenu.SetVisible(1),this.FIsPopupMenu=!0},this.Popup=function(t,e){null!=this.FOnPopup&&this.FOnPopup(this),this.SetTop(e),this.SetLeft(t),this.FShowPopup=!0,this.UpdateElement(),this.FShowPopup=!1},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup")})),rtl.createClass(this,"TWebCustomControl",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FPopupMenu=null},this.$final=function(){this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.HandleDoContextMenu=function(t){var e=!1,i=pas.Types.TPoint.$new(),s=null,n=null;return pas["WEBLib.Controls"].TControl.HandleDoContextMenu.apply(this,arguments),null!=this.FPopupMenu&&(t.stopPropagation(),t.preventDefault(),i.$assign(pas.Types.Point(Math.round(t.clientX),Math.round(t.clientY))),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&null!=s.GetContainer()&&(n=s.GetContainer().getBoundingClientRect(),i.x=i.x-Math.round(n.left),i.y=i.y-Math.round(n.top)),this.FPopupMenu.Popup(i.x,i.y),e=!0),e},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FPopupMenu&&(this.FPopupMenu=null)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){rtl.createClass(e,"TCrackedApplication",pas["WEBLib.Forms"].TApplication,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)}));var t=rtl.createSet(null,65,90,null,97,122,95),i=rtl.unionSet(t,rtl.createSet(null,48,57));e.MakeValidName=function(t){var e="",s=0;e="";for(var n=1,r=t.length;n<=r;n++)s=n,t.charCodeAt(s-1)in i&&(e+=t.charAt(s-1));return e}}}),["Types","WEBLib.Forms"]),rtl.module("Rtl.BrowserLoadHelper",["System","Classes","SysUtils","JS","Web"],(function(){"use strict";var t=this;rtl.createClass(this,"TBrowserLoadHelper",pas.Classes.TLoadHelper,(function(){})),t.$init=function(){pas.Classes.SetLoadHelperClass(t.TBrowserLoadHelper)}})),rtl.module("WEBLib.WebSocketClient",["System","Classes","JS","Web","WEBLib.Controls","SysUtils"],(function(){"use strict";var t=this;this.DefaultPort=8888,this.$rtti.$MethodVar("TSocketClientDataReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Origin",rtl.string],["SocketData",pas["WEBLib.Controls"].$rtti.TJSObjectRecord]]),methodkind:0}),this.$rtti.$MethodVar("TSocketClientMessageReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMessage",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TSocketClientBinaryDataReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AData",pas.SysUtils.$rtti.TBytes]]),methodkind:0}),rtl.createClass(this,"TSocketClientBase",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FPort=0,this.FHostName="",this.FPathName="",this.FWebSocket=null,this.FSupport=null,this.FOnConnect=null,this.FOnDisconnect=null,this.FOnDataReceived=null,this.FOnMessageReceived=null,this.FOnBinaryDataReceived=null,this.FUseSSL=!1,this.FActive=!1,this.FProtocols=null},this.$final=function(){this.FWebSocket=void 0,this.FSupport=void 0,this.FOnConnect=void 0,this.FOnDisconnect=void 0,this.FOnDataReceived=void 0,this.FOnMessageReceived=void 0,this.FOnBinaryDataReceived=void 0,this.FProtocols=void 0,pas.Classes.TComponent.$final.call(this)},this.SetActive=function(t){if(this.FActive!==t){if(this.FActive=t,4 in this.FComponentState||0 in this.FComponentState)return;t?this.Connect():this.Disconnect()}},this.SetProtocols=function(t){this.FProtocols.Assign(t)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.FActive&&(this.FActive=!1,this.SetActive(!0))},this.CreateWebSockets=function(){this.FSupport="MozWebSocket"in window?"MozWebSocket":"WebSocket"in window?"WebSocket":null},this.DoMessage=function(t){var e=this,i=pas["WEBLib.Controls"].TJSObjectRecord.$new();null!=t&&(null!=this.FOnDataReceived&&(i.jsobject=t.data,this.FOnDataReceived(e,t.origin,pas["WEBLib.Controls"].TJSObjectRecord.$clone(i))),rtl.isString(t.data)?null!=this.FOnMessageReceived&&this.FOnMessageReceived(e,pas.JS.ToString(t.data)):null!=this.FOnBinaryDataReceived&&this.GetDataAsBytes(t.data,(function(t){e.FOnBinaryDataReceived(e,rtl.arrayRef(t))})))},this.DoOpen=function(t){null!=t&&null!=this.FOnConnect&&this.FOnConnect(this)},this.DoClose=function(t){null!=t&&null!=this.FOnDisconnect&&this.FOnDisconnect(this)},this.Create$1=function(t){return this.Create$5(t,this.GetDefaultHostName(),this.GetDefaultPathName(),this.GetDefaultPort()),this},this.Create$5=function(t,e,i,s){return pas.Classes.TComponent.Create$1.call(this,t),this.FProtocols=pas.Classes.TStringList.$create("Create$1"),this.FUseSSL=!1,this.FActive=!1,this.FPort=s,this.FHostName=e,this.FPathName=i,this.DoMessage(null),this.DoOpen(null),this.DoClose(null),this},this.Destroy=function(){rtl.free(this,"FProtocols"),pas.Classes.TComponent.Destroy.call(this)},this.GetDefaultHostName=function(){return window.location.hostname},this.GetDefaultPort=function(){return window.location.port},this.GetDefaultPathName=function(){return window.location.pathname},this.SupportsWebSockets=function(){return null!=this.FSupport},this.GetDefaultProtocol=function(){return window.location.protocol},this.GetWebSocketPath=function(){var t="";return t=(t="https:"===this.GetDefaultProtocol()||this.FUseSSL?"wss:":"ws:")+"//"+this.FHostName+":"+pas.SysUtils.IntToStr(this.FPort),t+=this.FPathName},this.Send=function(t){this.FWebSocket.send(t)},this.Connect=function(){var t,e=null,i=0;this.Disconnect(),this.CreateWebSockets(),t=this.GetWebSocketPath(),e=new Array;for(var s=0,n=this.FProtocols.GetCount()-1;s<=n;s++)i=s,""!==pas.SysUtils.TStringHelper.Trim.call({p:this.FProtocols.Get(i),get:function(){return this.p},set:function(t){this.p=t}})&&e.push(this.FProtocols.Get(i));if(this.SupportsWebSockets()){var r=this;e.length>0?r.FWebSocket=new window[r.FSupport](t,e):r.FWebSocket=new window[r.FSupport](t),r.FWebSocket.onmessage=function(t){r.DoMessage(t)},1==r.FWebSocket.readyState?r.DoOpen(new Event("open")):r.FWebSocket.onopen=function(t){r.DoOpen(t)},r.FWebSocket.onclose=function(t){r.DoClose(t)}}},this.Disconnect=function(){null!=this.FWebSocket&&null!=this.FSupport&&(this.FWebSocket.close(),this.FWebSocket=null,this.FSupport=null)},this.GetDataAsBytes=function(t,e){var i=null;(i=new FileReader).addEventListener("loadend",(function(t){var i=new Uint8Array(t.target.result);e(i)})),i.readAsArrayBuffer(t)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),t.addMethod("Create$5",2,[["AOwner",pas.Classes.$rtti.TComponent],["AHostName",rtl.string],["APathName",rtl.string],["APort",rtl.longint]])})),rtl.createClass(this,"TSocketClient",this.TSocketClientBase,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive"),e.addProperty("Port",0,rtl.longint,"FPort","FPort",{Default:8888}),e.addProperty("UseSSL",0,rtl.boolean,"FUseSSL","FUseSSL"),e.addProperty("HostName",0,rtl.string,"FHostName","FHostName"),e.addProperty("PathName",0,rtl.string,"FPathName","FPathName"),e.addProperty("Protocols",2,pas.Classes.$rtti.TStringList,"FProtocols","SetProtocols"),e.addProperty("OnConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnConnect","FOnConnect"),e.addProperty("OnDisconnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDisconnect","FOnDisconnect"),e.addProperty("OnDataReceived",0,t.$rtti.TSocketClientDataReceivedEvent,"FOnDataReceived","FOnDataReceived"),e.addProperty("OnMessageReceived",0,t.$rtti.TSocketClientMessageReceivedEvent,"FOnMessageReceived","FOnMessageReceived"),e.addProperty("OnBinaryDataReceived",0,t.$rtti.TSocketClientBinaryDataReceivedEvent,"FOnBinaryDataReceived","FOnBinaryDataReceived")}))})),rtl.module("WEBLib.Forms",["System","Classes","Types","SysUtils","WEBLib.Graphics","WEBLib.Controls","WEBLib.Lang","WEBLib.Menus","Web","JS","Rtl.BrowserLoadHelper","WEBLib.WebSocketClient"],(function(){"use strict";var t=this,e=t.$impl;this.idOK=1,this.idCancel=2,this.idAbort=3,this.idRetry=4,this.idIgnore=5,this.idYes=6,this.idNo=7,this.idClose=8,this.idHelp=9,this.idContinue=11,this.mrNone=0,this.mrOk=1,this.mrCancel=2,this.mrAbort=3,this.mrRetry=4,this.mrIgnore=5,this.mrYes=6,this.mrNo=7,this.mrClose=8,this.mrHelp=9,this.mrContinue=11,this.mrAll=12,this.mrNoToAll=13,this.mrYesToAll=14,this.rgiFirst=-1024,this.igiLast=511,this.clTMSBlue=14917120,this.$rtti.$Int("TConstraintSize",{minvalue:0,maxvalue:2147483647,ordtype:5}),this.TCloseAction={0:"caNone",caNone:0,1:"caHide",caHide:1,2:"caFree",caFree:2,3:"caMinimize",caMinimize:3},this.$rtti.$Enum("TCloseAction",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TCloseAction}),this.TFormStyle={0:"fsNormal",fsNormal:0,1:"fsStayOnTop",fsStayOnTop:1},this.$rtti.$Enum("TFormStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TFormStyle}),this.TNavigationTarget={0:"ntBlank",ntBlank:0,1:"ntPage",ntPage:1},this.$rtti.$Int("TGestureID",{minvalue:-1024,maxvalue:511,ordtype:2}),this.TInteractiveGestureFlag={0:"gfBegin",gfBegin:0,1:"gfInertia",gfInertia:1,2:"gfEnd",gfEnd:2},this.$rtti.$Enum("TInteractiveGestureFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TInteractiveGestureFlag}),this.$rtti.$Set("TInteractiveGestureFlags",{comptype:this.$rtti.TInteractiveGestureFlag}),this.TMouseActivate={0:"maDefault",maDefault:0,1:"maActivate",maActivate:1,2:"maActivateAndEat",maActivateAndEat:2,3:"maNoActivate",maNoActivate:3,4:"maNoActivateAndEat",maNoActivateAndEat:4},this.$rtti.$Enum("TMouseActivate",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMouseActivate}),this.TScreenOrientation={0:"soPortrait",soPortrait:0,1:"soLandscape",soLandscape:1},this.$rtti.$Enum("TScreenOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TScreenOrientation}),this.TApplicationColorScheme={0:"csNoScheme",csNoScheme:0,1:"csLight",csLight:1,2:"csDark",csDark:2},rtl.recNewT(this,"TSmallPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TSmallPoint",{});e.addField("x",rtl.smallint),e.addField("y",rtl.smallint)})),rtl.recNewT(this,"TAlignInfo",(function(){this.AlignList=null,this.ControlIndex=0,this.Align=0,this.Scratch=0,this.$eq=function(t){return this.AlignList===t.AlignList&&this.ControlIndex===t.ControlIndex&&this.Align===t.Align&&this.Scratch===t.Scratch},this.$assign=function(t){return this.AlignList=t.AlignList,this.ControlIndex=t.ControlIndex,this.Align=t.Align,this.Scratch=t.Scratch,this};var e=t.$rtti.$Record("TAlignInfo",{});e.addField("AlignList",pas.Classes.$rtti.TList),e.addField("ControlIndex",rtl.longint),e.addField("Align",pas["WEBLib.Controls"].$rtti.TAlign),e.addField("Scratch",rtl.longint)})),rtl.recNewT(this,"TGestureEventInfo",(function(){this.GestureID=0,this.Angle=0,this.Distance=0,this.$new=function(){var e=Object.create(this);return e.Location=pas.Types.TPoint.$new(),e.Flags={},e.InertiaVector=t.TSmallPoint.$new(),e.TapLocation=t.TSmallPoint.$new(),e},this.$eq=function(t){return this.GestureID===t.GestureID&&this.Location.$eq(t.Location)&&rtl.eqSet(this.Flags,t.Flags)&&this.Angle===t.Angle&&this.InertiaVector.$eq(t.InertiaVector)&&this.Distance===t.Distance&&this.TapLocation.$eq(t.TapLocation)},this.$assign=function(t){return this.GestureID=t.GestureID,this.Location.$assign(t.Location),this.Flags=rtl.refSet(t.Flags),this.Angle=t.Angle,this.InertiaVector.$assign(t.InertiaVector),this.Distance=t.Distance,this.TapLocation.$assign(t.TapLocation),this};var e=t.$rtti.$Record("TGestureEventInfo",{});e.addField("GestureID",t.$rtti.TGestureID),e.addField("Location",pas.Types.$rtti.TPoint),e.addField("Flags",t.$rtti.TInteractiveGestureFlags),e.addField("Angle",rtl.double),e.addField("InertiaVector",t.$rtti.TSmallPoint),e.addField("Distance",rtl.longint),e.addField("TapLocation",t.$rtti.TSmallPoint)})),this.$rtti.$MethodVar("TCloseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Action",this.$rtti.TCloseAction,1]]),methodkind:0}),this.$rtti.$MethodVar("TCloseQueryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["CanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TOrientationChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AOrientation",this.$rtti.TScreenOrientation]]),methodkind:0}),this.$rtti.$MethodVar("TBeforeUnloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMessage",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TAlignInsertBeforeEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["C1",pas["WEBLib.Controls"].$rtti.TControl],["C2",pas["WEBLib.Controls"].$rtti.TControl]],rtl.boolean),methodkind:1}),this.$rtti.$MethodVar("TAlignPositionEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["Control",pas["WEBLib.Controls"].$rtti.TControl],["NewLeft",rtl.longint,1],["NewTop",rtl.longint,1],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["AlignRect",pas.Types.$rtti.TRect,1],["AlignInfo",this.$rtti.TAlignInfo]]),methodkind:0}),this.$rtti.$MethodVar("TCanResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["Resize",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TConstrainedResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MinWidth",rtl.longint,1],["MinHeight",rtl.longint,1],["MaxWidth",rtl.longint,1],["MaxHeight",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TContextPopupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDockDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TDockOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint],["State",pas["WEBLib.Controls"].$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGestureEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["EventInfo",this.$rtti.TGestureEventInfo,2],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetSiteInfoEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DockClient",pas["WEBLib.Controls"].$rtti.TControl],["InfluenceRect",pas.Types.$rtti.TRect,1],["MousePos",pas.Types.$rtti.TPoint],["CanDock",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseActivateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",pas["WEBLib.Controls"].$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint],["HitTest",rtl.longint],["MouseActivate",this.$rtti.TMouseActivate,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TStartDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragDockObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TUnDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Client",pas["WEBLib.Controls"].$rtti.TControl],["NewTarget",pas["WEBLib.Controls"].$rtti.TWinControl],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("THashChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["oldURL",rtl.string],["newURL",rtl.string]]),methodkind:0}),this.TPopupMode={0:"pmNone",pmNone:0,1:"pmAuto",pmAuto:1,2:"pmExplicit",pmExplicit:2},this.TPopupClose={0:"pcOnDeactivate",pcOnDeactivate:0,1:"pcNever",pcNever:1},this.TPosition={0:"poDesigned",poDesigned:0,1:"poDefault",poDefault:1,2:"poDefaultPosOnly",poDefaultPosOnly:2,3:"poDefaultSizeOnly",poDefaultSizeOnly:3,4:"poScreenCenter",poScreenCenter:4,5:"poDesktopCenter",poDesktopCenter:5,6:"poMainFormCenter",poMainFormCenter:6,7:"poOwnerFormCenter",poOwnerFormCenter:7},this.TApplicationErrorType={0:"aeSilent",aeSilent:0,1:"aeDialog",aeDialog:1,2:"aeAlert",aeAlert:2,3:"aeFooter",aeFooter:3},this.TFormBorderStyle={0:"fbNone",fbNone:0,1:"fbSingle",fbSingle:1,2:"fbSizeable",fbSizeable:2,3:"fbDialog",fbDialog:3,4:"fbDialogSizeable",fbDialogSizeable:4},rtl.createClass(this,"TCustomSizeConstraints",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FControl=null,this.FMaxHeight=0,this.FMaxWidth=0,this.FMinHeight=0,this.FMinWidth=0,this.FOnChange=null},this.$final=function(){this.FControl=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetConstraints=function(t,e){var i=t;0===i?e!==this.FMaxHeight&&(this.FMaxHeight=e,e>0&&e<this.FMinHeight&&(this.FMinHeight=e),this.Change()):1===i?e!==this.FMaxWidth&&(this.FMaxWidth=e,e>0&&e<this.FMinWidth&&(this.FMinWidth=e),this.Change()):2===i?e!==this.FMinHeight&&(this.FMinHeight=e,this.FMaxHeight>0&&e>this.FMaxHeight&&(this.FMaxHeight=e),this.Change()):3===i&&e!==this.FMinWidth&&(this.FMinWidth=e,this.FMaxWidth>0&&e>this.FMaxWidth&&(this.FMaxWidth=e),this.Change())},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.AssignTo=function(e){t.TCustomSizeConstraints.isPrototypeOf(e)?(e.FMinHeight=this.FMinHeight,e.FMaxHeight=this.FMaxHeight,e.FMinWidth=this.FMinWidth,e.FMaxWidth=this.FMaxWidth,e.Change()):pas.Classes.TPersistent.AssignTo.call(this,e)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FControl=t,this},this.$rtti.addMethod("Create$1",2,[["AControl",pas["WEBLib.Controls"].$rtti.TControl]])})),rtl.createClass(this,"TSizeConstraints",this.TCustomSizeConstraints,(function(){var e=this.$rtti;e.addProperty("MaxHeight",18,t.$rtti.TConstraintSize,"FMaxHeight","SetConstraints",{index:0,Default:0}),e.addProperty("MaxWidth",18,t.$rtti.TConstraintSize,"FMaxWidth","SetConstraints",{index:1,Default:0}),e.addProperty("MinHeight",18,t.$rtti.TConstraintSize,"FMinHeight","SetConstraints",{index:2,Default:0}),e.addProperty("MinWidth",18,t.$rtti.TConstraintSize,"FMinWidth","SetConstraints",{index:3,Default:0})})),rtl.createClass(this,"TDragDockObject",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBrush=null},this.$final=function(){this.FBrush=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FBrush"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TCustomForm",pas["WEBLib.Controls"].TWinControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TWinControl.$init.call(this),this.FDesignContainer=null,this.FLayer$1=null,this.FPopup=!1,this.FPopupElement=null,this.FFormFileName="",this.FFormContainer="",this.FFormElement="",this.FFormStyle=0,this.FOnCreate=null,this.FOnShow=null,this.FModalResult=0,this.FOnPaint=null,this.FOnDeactivate=null,this.FOnCloseQuery=null,this.FOnClose=null,this.FModalProc=null,this.FCreatedProc=null,this.FCaption="",this.FIsResizing$1=!1,this.FOnScroll=null,this.FOnUnload=null,this.FOnBeforeUnload=null,this.FPopupMode=0,this.FPopupClose=0,this.FPosition=0,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FHasCaption=!1,this.FMoveSpan=null,this.FCaptionElement=null,this.FCaptionCloseElement=null,this.FBorder=0,this.FShadow=!1,this.FTimerID=0,this.FOrigWidth=0,this.FOrigHeight=0,this.FOldWidth=0,this.FOldHeight=0,this.FOnDestroy=null,this.FPopupOpacity=0,this.FCreating=!1,this.FCreated=!1,this.FShown=!1,this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null,this.FCSSLibrary=0,this.FNoHTML=!1,this.FPrevActiveForm=null,this.FElementCaptionClassName="",this.FElementPopupClassName="",this.FMenu=null,this.FResizeObserver=null,this.FOnOrientationChange=null,this.FOnDOMContentLoaded=null,this.FShowClose=!1,this.FOnHashChange=null},this.$final=function(){this.FDesignContainer=void 0,this.FLayer$1=void 0,this.FPopupElement=void 0,this.FOnCreate=void 0,this.FOnShow=void 0,this.FOnPaint=void 0,this.FOnDeactivate=void 0,this.FOnCloseQuery=void 0,this.FOnClose=void 0,this.FModalProc=void 0,this.FCreatedProc=void 0,this.FOnScroll=void 0,this.FOnUnload=void 0,this.FOnBeforeUnload=void 0,this.FMoveSpan=void 0,this.FCaptionElement=void 0,this.FCaptionCloseElement=void 0,this.FOnDestroy=void 0,this.FPrevActiveForm=void 0,this.FMenu=void 0,this.FResizeObserver=void 0,this.FOnOrientationChange=void 0,this.FOnDOMContentLoaded=void 0,this.FOnHashChange=void 0,pas["WEBLib.Controls"].TWinControl.$final.call(this)},this.SetModalResult=function(t){this.FModalResult=t,0!==this.FModalResult&&this.Close()},this.GetFormStyle=function(){return this.FFormStyle},this.SetFormStyle=function(t){this.FFormStyle=t},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.UpdateElement())},this.SetShadow=function(t){this.FShadow!==t&&(this.FShadow=t,this.UpdateElement())},this.SetBorder=function(t){this.FBorder!==t&&(this.FBorder=t,null!=this.GetContainer()&&this.AlignControl(this))},this.SetFormContainer=function(t){var e,i=null,s=0;if(e=this.GetContainer(),4 in this.FComponentState?this.FFormContainer=t:"BODY"===pas.SysUtils.UpperCase(t)?this.FFormContainer="":this.FFormContainer=t,(!(0 in this.FComponentState)||4 in this.FComponentState)&&(null!=this.FLayer$1?i=this.FLayer$1:(""===t||null==(i=document.getElementById(t)))&&(i=document.body),null!=i&&(this.FContainer=i,null!=e)))for(var n=0,r=this.GetControlsCount()-1;n<=r;n++)s=n,this.GetControls(s).FParentElement===e&&(this.GetControls(s).FParentElement=i),null!=this.GetControls(s).GetElementHandle()&&this.GetControls(s).GetElementHandle().parentElement===e&&i.appendChild(this.GetControls(s).GetElementHandle())},this.SetWidth=function(t){var e=null;0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle()?this.SetWidthInt(t):(pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("width",pas.SysUtils.IntToStr(t)+"px"))},this.SetHeight=function(t){var e=null;if(0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle())return this.SetHeightInt(t),void(null!=this.FormContainerElement()&&("BODY"===pas.SysUtils.UpperCase(this.FormContainerElement().tagName)||this.GetIsLinked()||this.FormContainerElement().style.setProperty("height",pas.SysUtils.IntToStr(t)+"px")));pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),""!==this.FFormContainer&&null!=this.FormContainerElement()&&(this.FormContainerElement().style.setProperty("height",pas.SysUtils.IntToStr(t)+"px"),this.Realign()),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("height",pas.SysUtils.IntToStr(t)+"px")},this.GetClientHeight=function(){return this.FBorder in rtl.createSet(3,4)?this.GetHeight():pas["WEBLib.Controls"].TControl.GetClientHeight.call(this)},this.HandleHashChange=function(e){var i,s,n="",r=null,o=null;return i=e.oldURL,s=e.newURL,null!=this.FOnHashChange&&this.FOnHashChange(this,i,s),t.Application.FRouting&&(n=pas.System.Copy(s,pas.System.Pos("#",s)+1,s.length),null!=(r=pas.Classes.GetClass("T"+this.FName))&&t.LastHash!==n&&(0!==pas.System.Pos("#"+this.FName+"?",i+"?")&&0===pas.System.Pos("#"+this.FName+"?",s+"?")&&this.Close(),this.FPopup||null!=(r=pas.Classes.GetClass("T"+n))&&t.Application.AutoCreateForm(r,{get:function(){return o},set:function(t){o=t}}))),!0,!0},this.HandleLoaded=function(t){return this.Resize$1(),this.InitAnchoring(),!0,!0},this.HandleDOMContentLoaded=function(t){return null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),!0,!0},this.HandleScroll=function(t){return null!=this.FOnScroll&&this.FOnScroll(this),!0,!0},this.HandleUnload=function(t){return null!=this.FOnUnload&&this.FOnUnload(this),!0,!0},this.HandleBeforeUnload=function(t){var e="";return e="",null!=this.FOnBeforeUnload&&this.FOnBeforeUnload(this,{get:function(){return e},set:function(t){e=t}}),""!==e?(t.returnValue=e,e):(!0,!0)},this.HandleObserver=function(){return this.Resize$1(),!0,!0},this.HandleResize=function(t){return this.FVisible&&!(3 in this.FComponentState)&&(null==this.GetContainer()&&this.CreateControl(),this.Resize$1(),this.GetElementHandle()===document.body&&window.setTimeout(rtl.createSafeCallback(this,"Resize$1"),25)),!0,!0},this.HandleDocMouseMove=function(t){var e=0,i=0,s=null,n=0,r=0;return this.FDown&&null!=this.GetContainer()&&(e=t.clientX-this.FMdx,i=t.clientY-this.FMdy,(s=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode:this.GetContainer()).style.setProperty("transform",""),s.style.setProperty("position","absolute"),n=Math.round(this.FDlgX+e),r=Math.round(this.FDlgY+i),s.style.setProperty("left",pas.SysUtils.IntToStr(n)+"px"),s.style.setProperty("top",pas.SysUtils.IntToStr(r)+"px"),this.FLeft=n,this.FTop=r),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown&&(this.FCaptured$1=!1,this.FDown=!1,document.body.removeEventListener("mousemove",this.FDocMouseMovePtr),document.body.removeEventListener("mouseup",this.FDocMouseUpPtr),null!=this.FMoveSpan&&document.body.removeChild(this.FMoveSpan),this.FEventStopPropagation=rtl.unionSet(this.FEventStopPropagation,rtl.createSet(3,2)),this.FMoveSpan=null),!0,!0},this.HandleTitleDown=function(t){var e=null;return t.stopPropagation(),t.preventDefault(),this.FPopupClose=1,this.FMdx=Math.round(t.clientX),this.FMdy=Math.round(t.clientY),e=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode.getBoundingClientRect():this.GetContainer().getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,this.FMoveSpan=document.createElement("SPAN"),this.FMoveSpan.style.setProperty("top","0"),this.FMoveSpan.style.setProperty("left","0"),this.FMoveSpan.style.setProperty("right","0"),this.FMoveSpan.style.setProperty("bottom","0"),this.FMoveSpan.style.setProperty("position","absolute"),document.body.appendChild(this.FMoveSpan),this.FEventStopPropagation=rtl.diffSet(this.FEventStopPropagation,rtl.createSet(3,2)),document.body.addEventListener("mousemove",this.FDocMouseMovePtr),document.body.addEventListener("mouseup",this.FDocMouseUpPtr)),!0,!0},this.HandleCloseClick=function(t){var e=!1;return e=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return e},set:function(t){e=t}}),e&&this.Close(),!0,!0},this.SetLeft=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetLeft.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("left",pas.SysUtils.IntToStr(t)+"px")},this.SetTop=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetTop.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("top",pas.SysUtils.IntToStr(t)+"px")},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),null===this.FLoadedPtr&&(this.FLoadedPtr=rtl.createCallback(this,"HandleLoaded"),this.FDOMContentLoadedPtr=rtl.createCallback(this,"HandleDOMContentLoaded"),this.FUnloadPtr=rtl.createCallback(this,"HandleUnload"),this.FBeforeUnloadPtr=rtl.createCallback(this,"HandleBeforeUnload"),this.FResizePtr=rtl.createCallback(this,"HandleResize"),this.FScrollPtr=rtl.createCallback(this,"HandleScroll"),this.FDocMouseUpPtr=rtl.createCallback(this,"HandleDocMouseUp"),this.FDocMouseMovePtr=rtl.createCallback(this,"HandleDocMouseMove"),this.FTitleDownPtr=rtl.createCallback(this,"HandleTitleDown"),this.FDoClickPtr=rtl.createCallback(this,"HandleDoClick$1"),this.FKeyDownPtr$1=rtl.createCallback(this,"HandleKeyDown"),this.FOrientationChangePtr=rtl.createCallback(this,"HandleOrientationChange"),this.FHashChangePtr=rtl.createCallback(this,"HandleHashChange"))},this.VisibleChanged=function(){var t=!1;pas["WEBLib.Controls"].TControl.VisibleChanged.call(this),null!=this.FLayer$1?this.FVisible?this.FLayer$1.style.setProperty("display",""):this.FLayer$1.style.setProperty("display","none"):(t=pas.SysUtils.LowerCase(this.GetID())===pas["WEBLib.WebTools"].cBodyTag,null==this.GetContainer()||""===this.FFormContainer||t||(this.FVisible?this.GetContainer().style.setProperty("display",""):this.GetContainer().style.setProperty("display","none")))},this.Resize$1=function(){var t=0,e=0,i=0,s=0,n=null;if(!(3 in this.FComponentState)&&(this.FIsResizing$1=!0,this.FPopup&&null!=this.FPopupElement?(n=this.FPopupElement.getBoundingClientRect(),i=Math.round(n.right-n.left-2),this.FBorder in rtl.createSet(3,4)?(e=this.GetCaptionHeight(),s=Math.round(n.bottom-n.top-e-2)):s=Math.round(n.bottom-n.top-2)):(i=window.innerWidth,s=window.innerHeight),this.UpdateControlSize(i,s),pas["WEBLib.Controls"].IsAndroid()&&"INPUT"===document.activeElement.tagName||this.AlignControl(this),this.DoResize(),this.FIsResizing$1=!1,!this.IsUpdating())){-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring();for(var r=0,o=this.GetControlsCount()-1;r<=o;r++)t=r,this.GetControls(t).UpdateAnchoring()}},this.CreateControl=function(){var t="";if(this.FVisible||this.FPopup){if(pas["WEBLib.Controls"].TControl.CreateControl.call(this),t="","undefined"!=typeof CONTAINERID)try{t=CONTAINERID}catch(t){}""!==t&&this.SetFormContainer(t),this.UpdateSize()}},this.DoClose=function(t){null!=this.FModalProc&&0!==t.get()&&(this.FModalProc(this.FModalResult),this.FModalProc=null)},this.BindEvents=function(){var e="";pas["WEBLib.Controls"].TControl.BindEvents.call(this),"loading"!==document.readyState&&null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),window.addEventListener("resize",this.FResizePtr),window.addEventListener("load",this.FLoadedPtr),window.addEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.addEventListener("scroll",this.FScrollPtr),window.addEventListener("unload",this.FUnloadPtr),window.addEventListener("beforeunload",this.FBeforeUnloadPtr),window.addEventListener("keydown",this.FKeyDownPtr$1),window.addEventListener("orientationchange",this.FOrientationChangePtr),window.addEventListener("hashchange",this.FHashChangePtr),null!=pas.Classes.GetClass(this.$classname)&&!this.FPopup&&t.Application.FRouting&&(e=this.$classname,pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,1),t.LastHash=e,window.location.hash=e)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FLayer$1&&0===this.FPopupClose&&this.FLayer$1.removeEventListener("click",this.FDoClickPtr),null!=this.FResizeObserver&&this.FResizeObserver.disconnect(),window.removeEventListener("resize",this.FResizePtr),window.removeEventListener("load",this.FLoadedPtr),window.removeEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.removeEventListener("scroll",this.FScrollPtr),window.removeEventListener("unload",this.FUnloadPtr),window.removeEventListener("beforeunload",this.FBeforeUnloadPtr),window.removeEventListener("keydown",this.FKeyDownPtr$1),window.removeEventListener("orientationchange",this.FOrientationChangePtr),window.removeEventListener("hashchange",this.FHashChangePtr)},this.DoCreate=function(){this.BeginUpdate(),this.LoadDFMValues(),this.Loaded(),null!=this.FOnCreate&&this.FOnCreate(this),this.FCreating=!1,this.EndUpdate(),this.UpdateChildren(this),this.Realign(),this.DoResize()},this.Realign=function(){var t=null,e=null,i=pas.Types.TRect.$new();""!==this.FFormContainer&&0!==this.FAlign&&null!=(t=document.getElementById(this.FFormContainer))&&(0===(e=t.getBoundingClientRect()).width&&0===e.height&&"absolute"===t.style.getPropertyValue("position")?i.$assign(pas["WEBLib.Controls"].GetHTMLElementAbsoluteRect(t)):i.$assign(pas.Types.Rect(Math.round(e.left),Math.round(e.top),Math.round(e.right),Math.round(e.bottom))),this.SetBoundsInt(i.Left,i.Top,i.Right-i.Left,i.Bottom-i.Top)),pas["WEBLib.Controls"].TControl.Realign.call(this)},this.DoResize=function(){var t,e;t=this.GetWidth(),e=this.GetHeight(),t===this.FOldWidth&&e===this.FOldHeight||(this.FOldWidth=t,this.FOldHeight=e,null!=this.FOnResize&&this.FOnResize(this))},this.DoShow=function(){this.DoAutoFocus(),null==this.FOnShow||this.FShown||(this.FShown=!0,this.FOnShow(this))},this.DoAutoFocus=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,0===this.GetControls(t).FTabOrder&&this.GetControls(t).FTabStop&&this.GetControls(t).SetFocus()},this.HandleDoClick$1=function(t){return t.stopPropagation(),0===this.FPopupClose&&this.Close(),!0,!0},this.HandleKeyDown=function(t){var e,i=!1;return e=this.GetKeyCode(t.key,!0),pas.System.Assigned(e)?(27===e&&!(4 in this.FComponentState)&&this.FPopup&&this.Close(),i=!0):i},this.HandleOrientationChange=function(t){var e=0;(this.Resize$1(),this.Realign(),!0,null!=this.FOnOrientationChange)&&(e=window.matchMedia("(orientation: portrait)").matches?1:0,this.FOnOrientationChange(this,e));return null!=this.FOnResize&&this.FOnResize(this),!0},this.HandleDoResize=function(){var t,e,i=null;i=this.GetContainer().getBoundingClientRect(),t=Math.round(i.right-i.left),e=Math.round(i.bottom-i.top),t===this.FOrigWidth&&e===this.FOrigHeight||(this.SetWidth(t),this.SetHeight(e),i=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(i.right-i.left),this.FOrigHeight=Math.round(i.bottom-i.top),this.AlignControl(this))},this.KeyPreview=function(e,i){var s=0,n=0,r=0,o=0,a=0;n=-1,r=65535;for(var l=0,h=this.GetControlsCount()-1;l<=h;l++)s=l,!this.GetControls(s).FVisible&&this.GetControls(s).FEnabled||(this.GetControls(s).FTabOrder<r&&(r=this.GetControls(s).FTabOrder,a=s),this.GetControls(s).FTabOrder>n&&(n=this.GetControls(s).FTabOrder,o=s),13!==e.get()&&27!==e.get()||this.GetControls(s).HandleKeyPreview(e.get()));t.Application.FMainForm!==this&&(9===e.get()&&!(0 in i)&&o<this.GetControlsCount()&&a>=0&&a!==o&&this.GetControls(o).Focused()&&(this.GetControls(a).SetFocus(),e.set(0)),9===e.get()&&0 in i&&a>=0&&o<this.GetControlsCount()&&a!==o&&this.GetControls(a).Focused()&&(this.GetControls(o).SetFocus(),e.set(0)))},this.GetWidth=function(){var t=0,e=null,i=null;return""!==this.FFormElement&&null!=(i=document.getElementById(this.FFormElement))?(e=i.getBoundingClientRect(),t=Math.round(e.right-e.left)):(this.GetElementHandle()===document.body?(e=document.documentElement.getBoundingClientRect(),(t=Math.round(e.width))>window.innerWidth&&(t=window.innerWidth)):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetWidth.call(this):0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetWidth.call(this):window.innerWidth),t)},this.GetHeight=function(){var t=0,e=0,i="",s=null,n=null;return""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))?(n=s.getBoundingClientRect(),t=Math.round(n.bottom-n.top)):(this.GetElementHandle()===document.body?(i=window.getComputedStyle(this.GetElementHandle()).getPropertyValue("margin-top"),i=pas.System.Copy(i,1,i.length-2),e=Math.round(pas.SysUtils.StrToFloat$1(i,pas.SysUtils.TFormatSettings.Invariant())-2),n=document.documentElement.getBoundingClientRect(),(t=Math.round(n.height))>window.innerHeight&&(t=window.innerHeight-Math.max(0,e))):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetHeight.call(this):0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetHeight.call(this):window.innerHeight),t)},this.GetLeft=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetLeft.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.left)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetLeft)),t},this.GetTop=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetTop.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.top)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetTop)),t},this.GetClientRect=function(){var t=pas.Types.TRect.$new();return t.$assign(pas["WEBLib.Controls"].TControl.GetClientRect.call(this)),t},this.CreateElement=function(){var e=null,i=null,s=null;return this.FPopup||null==this.FormContainerElement()?(e=document.createElement("DIV"),this.FLayer$1=this.CreateLayer(),document.body.appendChild(this.FLayer$1),i=this.FLayer$1,0===this.FPopupClose&&(this.GetMethodPointers(),i.addEventListener("click",this.FDoClickPtr)),i.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),2===this.FBorder&&(e.style.setProperty("resize","both"),e.style.setProperty("overflow","auto")),this.FHasCaption=!1,this.FBorder in rtl.createSet(2,3,4)&&(s=this.CreateCaption(),e.appendChild(s)),e):e=this.FormContainerElement()},this.UpdateElement=function(){var t="",e=null;this.FCreating||(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||(null==this.GetElementHandle()&&null==this.GetContainer()||""!==this.FCaption&&(this.FPopup?null!=this.FCaptionElement&&(null!=(e=this.FCaptionElement.childNodes.item(0))&&(e.nodeValue=this.FCaption),this.FShowClose&&null==this.FCaptionCloseElement&&(this.FCaptionCloseElement=document.createElement("SPAN"),this.FCaptionCloseElement.style.setProperty("float","right"),this.FCaptionCloseElement.style.setProperty("cursor","default"),this.FCaptionCloseElement.style.setProperty("margin-right","8px"),this.FCaptionCloseElement.innerHTML="&#x2716;",this.FCaptionElement.appendChild(this.FCaptionCloseElement),this.FCaptionCloseElement.addEventListener("click",rtl.createSafeCallback(this,"HandleCloseClick"))),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont))):window.document.title=this.FCaption),null!=this.GetContainer()&&(t=pas["WEBLib.Graphics"].ColorToHTML(this.FColor),null!=this.GetContainer()&&(-1===this.FColor||16777215===this.FColor||this.FPopup||""!==this.FElementClassName||this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,t),this.FPopup||0===this.FCSSLibrary||document.body.style.removeProperty(pas["WEBLib.Controls"].CSSBackground),(""!==this.FElementClassName||-1===this.FColor||16777215===this.FColor&&!this.FPopup)&&this.GetContainer().style.removeProperty(pas["WEBLib.Controls"].CSSBackground),""!==this.FElementClassName||this.FPopup||document.documentElement.style.setProperty("height","100%"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContainer(),this.FFont,!(""===this.FElementClassName&&0===this.FElementFont))),this.FPopup?(null==this.FPopupElement&&(this.FPopupElement=this.GetContainer()),""!==this.FElementPopupClassName?(this.GetContainer().style.removeProperty("border"),this.FPopupElement.setAttribute("class",this.FElementPopupClassName)):(this.FShadow?this.FPopupElement.style.setProperty("box-shadow","3px 3px 3px silver"):this.FPopupElement.style.removeProperty("box-shadow"),this.FPopupElement.style.setProperty("border","1px solid gray")),1===this.FCSSLibrary&&""===this.FElementClassName&&(this.FPopupElement.setAttribute("class","card"),this.FPopupElement.style.setProperty("display","block"),this.GetContainer().style.removeProperty("box-shadow"))):this.GetContainer().style.removeProperty("box-shadow"))))},this.ContainerElement=function(){return this.FormContainerElement()},this.FormContainerElement=function(){var t=null;return 4 in this.FComponentState&&null!=this.FDesignContainer&&(t=this.FDesignContainer),""!==this.FFormContainer?null==(t=document.getElementById(this.FFormContainer))&&(t=document.body):t=document.body,t},this.GetElementBindHandle=function(){return 4 in this.FComponentState||""!==this.FFormContainer?window:this.FPopup?pas["WEBLib.Controls"].TControl.GetElementBindHandle.call(this):window},this.GetElementHandle=function(){var t=null;return this.FPopup?null==(t=pas["WEBLib.Controls"].TControl.GetElementHandle.call(this))&&(t=this.FPopupElement):t=this.FormContainerElement(),t},this.SetElementClassName=function(t){pas["WEBLib.Controls"].TControl.SetElementClassName.apply(this,arguments),this.FPopup&&null!=this.FPopupElement&&this.FPopupElement.setAttribute("class",t)},this.CloseQuery=function(){var t=!1;return t=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return t},set:function(e){t=e}}),t},this.LoadDFMValues=function(){},this.Init=function(){},this.CreateLayer=function(){var e=null;return(e=document.createElement("SPAN")).style.setProperty("top","0"),e.style.setProperty("left","0"),e.style.setProperty("right","0"),e.style.setProperty("bottom","0"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),e.style.setProperty("z-index",t.Application.MaxZIndexStr()),e},this.CreateCaption=function(){var e;return e=pas.SysUtils.IntToStr(t.Application.FFormCaptionHeight),this.FCaptionElement=document.createElement("DIV"),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeColor)),this.FCaptionElement.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeTextColor)),this.FCaptionElement.style.setProperty("cursor","move"),this.FCaptionElement.style.setProperty("height",e+"px"),this.FCaptionElement.style.setProperty("line-height",e+"px"),this.FCaptionElement.style.setProperty("border-bottom","1px solid black"),this.FCaptionElement.style.setProperty("padding-left","4px"),this.FCaptionElement.style.setProperty("-moz-user-select","none"),this.FCaptionElement.style.setProperty("-webkit-user-select","none"),this.FCaptionElement.style.setProperty("-ms-user-select","none"),this.FCaptionElement.style.setProperty("user-select","none"),this.FCaptionElement.style.setProperty("-o-user-select","none"),""!==this.FElementCaptionClassName&&this.FCaptionElement.setAttribute("class",this.FElementCaptionClassName),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont)),null==this.FTitleDownPtr&&this.GetMethodPointers(),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.addEventListener("mousedown",this.FTitleDownPtr),this.FHasCaption=!0,this.FCaptionElement},this.GetCaptionHeight=function(){var t=0,e=null;return t=0,null!=this.FCaptionElement&&this.FBorder in rtl.createSet(3,4)&&(e=this.FCaptionElement.getBoundingClientRect(),t=Math.round(e.bottom-e.top)),t},this.SetColorScheme=function(e){var i="";if(t.Application.FThemed){var s=e;2===s?(this.SetColor(2105636),i="label,option,td,table,ul,li {background-color: #202124; color: #BEC1C6;}\r\nbody,input,textarea,select,fieldset {background-color: #202124; color: #BEC1C6; border: 1px solid gray;}\r\ninput:focus, textarea:focus, select:focus, span:focus { border: 1px solid silver; outline: none !important;}",this.AddCSS("appscheme",i)):1===s&&(this.SetColor(16777215),this.RemoveCSS("appscheme"))}},this.SetCSSLibrary=function(t){this.FCSSLibrary=t,1===t&&4 in this.FComponentState&&!(0 in this.FComponentState)&&this.SetElementFont(1)},this.SetFormPos=function(){null!=this.GetContainer()&&(4===this.FPosition&&(this.FLeft=Math.round((t.WinWidth()-this.GetWidth())/2)+window.scrollX,this.FTop=Math.round((t.WinHeight()-this.GetHeight())/2)+window.scrollY),this.GetContainer().style.setProperty("position","absolute"),this.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth())+"px"),this.GetContainer().style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())+"px"),this.GetContainer().style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),this.GetContainer().style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"))},this.GetHTMLFileName=function(){return this.$module.$name+t.Application.GetFormExtension()},this.LoadedDone=function(){t.Application.TriggerNotification()},this.Loaded=function(){var t=null;pas["WEBLib.Controls"].TControl.Loaded.call(this),""!==this.FFormContainer&&""!==this.FElementClassName&&null!=(t=this.FormContainerElement())&&t.setAttribute("class",this.FElementClassName),this.LoadedDone()},this.ColorChanging=function(){pas["WEBLib.Controls"].TControl.ColorChanging.call(this),null!=this.GetContainer()&&this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TControl.CreateInitialize.call(this),this.FAllowTouch=!0,this.FModalResult=0,this.FFormStyle=0,this.FBorder=2,this.FShadow=!0,this.FShowClose=!0,this.FTimerID=-1,this.FCaptionElement=null,this.FColor=16777215,window.addEventListener("load",this.FLoadedPtr)},this.Create$2=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FFormContainer=t,""===t?pas["WEBLib.Controls"].TControl.Create$2.call(this,pas["WEBLib.WebTools"].cBodyTag):pas["WEBLib.Controls"].TControl.Create$2.call(this,t),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$5=function(t,e){return this.FCreating=!0,this.FFormContainer=t,pas["WEBLib.Controls"].TControl.Create$2.call(this,t),e.set(this),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$1=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FResizeObserver=null,pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FBorder=1,this.FFormFileName="",this.FPopupMode=0,this.FPopupClose=0,this.FPopup=!0,this.FPosition=4,this.FPopupOpacity=1,this.FCreated=!0,this},this.Load=function(){var e=this;return this.FShown=!1,this.FFormFileName=this.$class.GetHTMLFileName(),this.Loading(),""===this.FFormFileName?new Promise((function(t,i){t(e)})):new Promise((function(i,s){t.Application.LoadForm$1(e,e.FFormFileName,(function(t){i(t)}))}))},this.Execute=function(){var t=this;return new Promise((function(e,i){t.ShowModal$1((function(t){e(t)}))}))},this.Destroy=function(){this.FVisible&&this.Close(),null!=this.FOnDestroy&&this.FOnDestroy(this),pas["WEBLib.Controls"].TControl.Destroy.call(this),null!=this.FLayer$1&&(this.FormContainerElement()===this.FLayer$1.parentNode&&this.FormContainerElement().removeChild(this.FLayer$1),this.FLayer$1=null)},this.Close=function(){var i=0,s=null;this.CloseQuery()&&(this.UnbindEvents(),i=1,-1!==this.FTimerID&&(window.clearInterval(this.FTimerID),this.FTimerID=-1),null!=this.FOnClose&&this.FOnClose(this,{get:function(){return i},set:function(t){i=t}}),0!==i&&(null!=this.FLayer$1&&(this.GetContainer().parentNode===this.FLayer$1?this.FLayer$1.removeChild(this.GetContainer()):this.GetContainer().parentNode.parentNode===this.FLayer$1&&this.FLayer$1.removeChild(this.GetContainer().parentNode),this.FContainer=null,this.FormContainerElement()===this.FLayer$1.parentNode&&(this.FormContainerElement().removeChild(this.FLayer$1),t.Application.ChangeMaxZIndex(-1)),this.FLayer$1=null),""===this.FFormFileName?""!==this.FFormElement&&null!=this.GetContainer()?(this.GetContainer().innerHTML="",this.FContainer=null):null!=this.GetContainer()&&(this.FormContainerElement()===this.GetContainer().parentNode&&this.FormContainerElement().removeChild(this.GetContainer()),this.FContainer=null):""!==this.FFormElement&&(this.GetContainer().innerHTML="",this.FContainer=null),this.FFormElement!==this.FFormContainer&&""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))&&(s.innerHTML=""),this.DoClose({get:function(){return i},set:function(t){i=t}}),2!==i||3 in this.FComponentState||(this.SetVisible(!1),e.ReleaseForm(this),t.Application.FMainForm===this&&(t.Application.FMainForm=null)),t.Application.FActiveForm=this.FPrevActiveForm,this.FShown=!1,this.SetVisible(!1)))},this.IsMiletus=function(){var t=!1,e=null;e=this.$class.ClassType(),t=!1;do{if(null!=(e=e.$ancestor)&&"TMiletusForm"===e.$classname){t=!0;break}}while(null!=e&&"TForm"!==e.$classname);return t},this.Show$1=function(){var e=null;this.FCreating&&this.FPopup&&(t.Application.ChangeMaxZIndex(1),this.FCreating=!1,this.UpdateElement()),""===this.FFormFileName&&(null==this.GetContainer()?this.FPopup?(this.FContainer=this.CreateElement(),this.FPopupElement=this.GetContainer(),this.SetFormPos(),this.UpdateElement(),this.FLayer$1.appendChild(this.GetContainer())):(this.FContainer=this.CreateLayer(),this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor)),document.body.appendChild(this.GetContainer())):this.FPopup?(this.SetFormPos(),this.FLayer$1.appendChild(this.GetContainer())):null!=this.FLayer$1?this.FLayer$1.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),this.FPopup&&(2===this.FBorder?(e=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(e.right-e.left),this.FOrigHeight=Math.round(e.bottom-e.top),this.FTimerID=window.setInterval(rtl.createSafeCallback(this,"HandleDoResize"),100)):(this.GetContainer().style.setProperty("resize",""),this.GetContainer().style.setProperty("overflow","")))),this.SetVisible(!0),this.DoShow()},this.ShowModal$1=function(e){return(this.FNoHTML||""===this.FFormFileName)&&(this.FPrevActiveForm=t.Application.FActiveForm,t.Application.FActiveForm=this,this.FCreated||t.Application.CreateNewForm(this,"")),0,this.FNoHTML=!1,this.FModalProc=e,this.SetModalResult(0),this.Show$1(),0},this.AddCSS=function(t,e){var i,s,n;i=t,s=e,(n=document.getElementById(i))?n.innerHTML=s:((n=document.createElement("style")).type="text/css",n.id=i,n.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(n))},this.RemoveCSS=function(t){var e;null!=(e=document.getElementById(t))&&document.head.removeChild(e)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$2",2,[["id",rtl.string]]),i.addMethod("Create$5",2,[["id",rtl.string],["AReference",null,1]]),i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TForm",this.TCustomForm,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("CSSLibrary",2,pas["WEBLib.Controls"].$rtti.TCSSLibrary,"FCSSLibrary","SetCSSLibrary",{Default:pas["WEBLib.Controls"].TCSSLibrary.cssNone}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("FormContainer",2,pas["WEBLib.Controls"].$rtti.TElementID,"FFormContainer","SetFormContainer"),e.addProperty("FormStyle",3,t.$rtti.TFormStyle,"GetFormStyle","SetFormStyle"),e.addProperty("Menu",0,pas["WEBLib.Controls"].$rtti.TCustomControl,"FMenu","FMenu"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Shadow",2,rtl.boolean,"FShadow","SetShadow",{Default:!0}),e.addProperty("ShowClose",0,rtl.boolean,"FShowClose","FShowClose",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("OnBeforeUnload",0,t.$rtti.TBeforeUnloadEvent,"FOnBeforeUnload","FOnBeforeUnload"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnClose",0,t.$rtti.TCloseEvent,"FOnClose","FOnClose"),e.addProperty("OnCloseQuery",0,t.$rtti.TCloseQueryEvent,"FOnCloseQuery","FOnCloseQuery"),e.addProperty("OnCreate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCreate","FOnCreate"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDeactivate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDeactivate","FOnDeactivate"),e.addProperty("OnDestroy",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDestroy","FOnDestroy"),e.addProperty("OnDOMContentLoaded",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDOMContentLoaded","FOnDOMContentLoaded"),e.addProperty("OnHashChange",0,t.$rtti.THashChangeEvent,"FOnHashChange","FOnHashChange"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnShow","FOnShow"),e.addProperty("OnScroll",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnScroll","FOnScroll"),e.addProperty("OnOrientationChange",0,t.$rtti.TOrientationChangeEvent,"FOnOrientationChange","FOnOrientationChange"),e.addProperty("OnPaint",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPaint","FOnPaint"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnUnload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnUnload","FOnUnload")})),rtl.createClass(this,"TCustomFrame",pas["WEBLib.Controls"].TCustomHTMLDiv,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomHTMLDiv.$init.call(this),this.FAutoScroll=!1,this.FAutoSize=!1,this.FBiDiMode$1=0,this.FConstraints=null,this.FCtl3D$1=!1,this.FDockSite=!1,this.FDragCursor=0,this.FDragKind=0,this.FDragMode$1=0,this.FOnAlignInsertBefore=null,this.FOnAlignPosition=null,this.FOnCanResize=null,this.FOnConstrainedResize=null,this.FOnContextPopup=null,this.FOnDockDrop=null,this.FOnDockOver=null,this.FOnEndDock=null,this.FOnGesture=null,this.FOnGetSiteInfo=null,this.FOnMouseActivate=null,this.FOnMouseWheelDown$1=null,this.FOnMouseWheelUp$1=null,this.FOnStartDock=null,this.FOnUnDock=null,this.FPadding=null,this.FParentBackground=!1,this.FParentCtl3D$1=!1,this.FPopupMenu=null},this.$final=function(){this.FConstraints=void 0,this.FOnAlignInsertBefore=void 0,this.FOnAlignPosition=void 0,this.FOnCanResize=void 0,this.FOnConstrainedResize=void 0,this.FOnContextPopup=void 0,this.FOnDockDrop=void 0,this.FOnDockOver=void 0,this.FOnEndDock=void 0,this.FOnGesture=void 0,this.FOnGetSiteInfo=void 0,this.FOnMouseActivate=void 0,this.FOnMouseWheelDown$1=void 0,this.FOnMouseWheelUp$1=void 0,this.FOnStartDock=void 0,this.FOnUnDock=void 0,this.FPadding=void 0,this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomHTMLDiv.$final.call(this)};this.LoadHTMLFile=function(t){var e,i=null;""!==(e=this.$class.GetHTMLFileName())&&((i=new XMLHttpRequest).addEventListener("load",rtl.createSafeCallback(null,(function(e){var i;return null!==e&&(i=e.target.responseText,document.getElementById(t).innerHTML=i,!0,!0)}))),i.open("GET",e),i.send())},this.SetConstraints=function(t){this.FConstraints.Assign(t)},this.SetPopupMenu=function(t){this.FPopupMenu=t},this.SetPadding=function(t){this.FPadding.Assign(t)},this.GetHTMLFileName=function(){return this.$module.$name+t.Application.GetFormExtension()},this.UpdateElement=function(){var t;pas["WEBLib.Controls"].TControl.UpdateElement.call(this),t=this.FColor in rtl.createSet(15790320,-1,16777215,16711422),null!=this.GetElementHandle()&&!this.IsUpdating()&&4 in this.FComponentState&&t&&this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(15790320))},this.Create$2=function(t){return pas["WEBLib.Controls"].TControl.Create$2.call(this,t),this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),this.LoadHTMLFile(t),this},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.call(this,e),this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),this.FConstraints=t.TSizeConstraints.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FConstraints"),rtl.free(this,"FPadding"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$2",2,[["AId",rtl.string]]),e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TFrame",this.TCustomFrame,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoScroll",0,rtl.boolean,"FAutoScroll","FAutoScroll",{Default:!1}),e.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize",{Default:!1}),e.addProperty("BiDiMode",4,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode$1","FBiDiMode$1"),e.addProperty("Constraints",2,t.$rtti.TSizeConstraints,"FConstraints","SetConstraints"),e.addProperty("DockSite",0,rtl.boolean,"FDockSite","FDockSite",{Default:!1}),e.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),e.addProperty("DragCursor",0,pas["WEBLib.Controls"].$rtti.TCursor,"FDragCursor","FDragCursor",{Default:12}),e.addProperty("DragKind",0,pas["WEBLib.Controls"].$rtti.TDragKind,"FDragKind","FDragKind",{Default:pas["WEBLib.Controls"].TDragKind.dkDrag}),e.addProperty("DragMode",0,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode$1","FDragMode$1",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Ctl3D",4,rtl.boolean,"FCtl3D$1","FCtl3D$1"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","SetPadding"),e.addProperty("ParentBackground",0,rtl.boolean,"FParentBackground","FParentBackground",{Default:!0}),e.addProperty("ParentBiDiMode",0,rtl.boolean,"FParentBiDiMode","FParentBiDiMode",{Default:!0}),e.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),e.addProperty("ParentCtl3D",0,rtl.boolean,"FParentCtl3D$1","FParentCtl3D$1",{Default:!0}),e.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default:!0}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ParentShowHint",0,rtl.boolean,"FParentShowHint","FParentShowHint"),e.addProperty("PopupMenu",2,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","SetPopupMenu"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnAlignInsertBefore",0,t.$rtti.TAlignInsertBeforeEvent,"FOnAlignInsertBefore","FOnAlignInsertBefore"),e.addProperty("OnAlignPosition",0,t.$rtti.TAlignPositionEvent,"FOnAlignPosition","FOnAlignPosition"),e.addProperty("OnCanResize",0,t.$rtti.TCanResizeEvent,"FOnCanResize","FOnCanResize"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnConstrainedResize",0,t.$rtti.TConstrainedResizeEvent,"FOnConstrainedResize","FOnConstrainedResize"),e.addProperty("OnContextPopup",0,t.$rtti.TContextPopupEvent,"FOnContextPopup","FOnContextPopup"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDockDrop",0,t.$rtti.TDockDropEvent,"FOnDockDrop","FOnDockDrop"),e.addProperty("OnDockOver",0,t.$rtti.TDockOverEvent,"FOnDockOver","FOnDockOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDock",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FOnEndDock","FOnEndDock"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnGesture",0,t.$rtti.TGestureEvent,"FOnGesture","FOnGesture"),e.addProperty("OnGetSiteInfo",0,t.$rtti.TGetSiteInfoEvent,"FOnGetSiteInfo","FOnGetSiteInfo"),e.addProperty("OnMouseActivate",0,t.$rtti.TMouseActivateEvent,"FOnMouseActivate","FOnMouseActivate"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),e.addProperty("OnMouseWheelDown",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown$1","FOnMouseWheelDown$1"),e.addProperty("OnMouseWheelUp",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp$1","FOnMouseWheelUp$1"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnStartDock",0,t.$rtti.TStartDockEvent,"FOnStartDock","FOnStartDock"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnUnDock",0,t.$rtti.TUnDockEvent,"FOnUnDock","FOnUnDock")})),rtl.recNewT(this,"TApplicationError",(function(){this.AMessage="",this.AFile="",this.ALineNumber=0,this.AColNumber=0,this.AStack="",this.AError=null,this.$eq=function(t){return this.AMessage===t.AMessage&&this.AFile===t.AFile&&this.ALineNumber===t.ALineNumber&&this.AColNumber===t.AColNumber&&this.AStack===t.AStack&&this.AError===t.AError},this.$assign=function(t){return this.AMessage=t.AMessage,this.AFile=t.AFile,this.ALineNumber=t.ALineNumber,this.AColNumber=t.AColNumber,this.AStack=t.AStack,this.AError=t.AError,this}})),this.THintPosition={0:"hpLeft",hpLeft:0,1:"hpTop",hpTop:1,2:"hpRight",hpRight:2,3:"hpBottom",hpBottom:3},this.TOnlineStatus={0:"osOnline",osOnline:0,1:"osOffline",osOffline:1},rtl.createClass(this,"TApplication",pas["WEBLib.Controls"].TControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TControl.$init.call(this),this.FAppContainer="",this.FMainFormOnTaskBar=!1,this.FCanCreateForm=!1,this.FAppInitializing=!1,this.FLastReq=null,this.FFormCaptionHeight=0,this.FWebSocket=null,this.FActiveForm=null,this.FMainForm=null,this.FLoadForm=null,this.FInitFormClassName="",this.FFormStack=null,this.FParameters=null,this.FIsRedirect=!1,this.FLanguage=0,this.FOnError=null,this.FOnHashChange=null,this.FAutoFormRoute=!1,this.FErrorType=0,this.FOnOnlineChange=null,this.FOnActivate=null,this.FThemeTextColor=0,this.FThemeColor=0,this.FThemed=!1,this.FThemeButtonClassName="",this.FOnOAuthToken=null,this.FOnOAuthCallBack=null,this.FOnPopState=null,this.FMaxZIndex=0,this.FCreatedProc=null,this.FHandleOAuth=!1,this.FHintPause=0,this.FHintHidePause=0,this.FHintPosition=0,this.FHintClassName="",this.FOnExit$1=null,this.FOnException=null,this.FOnAutoCreateForm=null,this.FRouting=!1,this.FSBW=0},this.$final=function(){this.FLastReq=void 0,this.FWebSocket=void 0,this.FActiveForm=void 0,this.FMainForm=void 0,this.FLoadForm=void 0,this.FFormStack=void 0,this.FParameters=void 0,this.FOnError=void 0,this.FOnHashChange=void 0,this.FOnOnlineChange=void 0,this.FOnActivate=void 0,this.FOnOAuthToken=void 0,this.FOnOAuthCallBack=void 0,this.FOnPopState=void 0,this.FCreatedProc=void 0,this.FOnExit$1=void 0,this.FOnException=void 0,this.FOnAutoCreateForm=void 0,pas["WEBLib.Controls"].TControl.$final.call(this)},this.DoFormLoad=function(t){var e;return e=t.target.responseText,this.CreateNewForm(this.FLoadForm,e),null!=this.FCreatedProc&&(this.FCreatedProc(this),this.FCreatedProc=null),!0,!0},this.DoFormAbort=function(t){return pas["WEBLib.Dialogs"].ShowMessage("Failed to load form HTML template file"),!0,!0},this.DoHandleError=function(e){var i,s=!1,n=t.TApplicationError.$new(),r=null,o=null,a=null,l="",h="",u="",d=!1,F=!1,c=void 0,p=null;if(d=!0,F=!1,c=null,n.AFile="",n.ALineNumber=0,n.AColNumber=0,n.AError=null,null==e.message&&(d=!1,e instanceof PromiseRejectionEvent&&(d=!0,F=!0,l=e.reason.FMessage,h=e.reason.FStack,c=e.reason)),!F&&"ResizeObserver loop limit exceeded"===e.message)return s;if(!F&&"ResizeObserver loop completed with undelivered notifications."===e.message)return s;if(!d)return n.AMessage="Undefined JavaScript exception",n.AFile="",n.ALineNumber=0,n.AColNumber=0,n.AError=null,null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(n),{get:function(){return s},set:function(t){s=t}}),s;if(F?(n.AMessage=l,n.AStack=h,n.AError=c):(n.AMessage=e.message,n.AFile=e.filename,n.ALineNumber=e.lineno,n.AColNumber=e.colno,n.AError=e.error,n.AStack=""),u="",null!=e.error){e.error.stack&&(n.AStack=e.error.stack),e.error.fMessage&&(n.AMessage=e.error.fMessage),e.error.hasOwnProperty("FJSError")&&(c=e.error.FJSError),u=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+"::"+t[i]+"\n");return e}(e.error)}pas.System.Assigned(c)&&(p=n.AError,null!=this.FOnException&&this.FOnException(this,p)),s=!1,i="ERROR<br>"+n.AMessage+" | "+u+n.AStack+"<BR> at "+n.AFile+" ["+pas.SysUtils.IntToStr(n.ALineNumber)+":"+pas.SysUtils.IntToStr(n.AColNumber)+"]";var C=this.FErrorType;return 3===C?null!=(r=document.getElementById("tmserrormessage"))?rtl.asExt(r.firstChild,HTMLElement).innerHTML=i:((r=document.createElement("DIV")).setAttribute("id","tmserrormessage"),r.style.setProperty("position","absolute"),r.style.setProperty("font-family","Courier"),r.style.setProperty("font-size","8pt"),r.style.setProperty("bottom","0"),r.style.setProperty("width","100%"),r.style.setProperty("height","100px"),r.style.setProperty("background","#ff0000"),r.style.setProperty("color","#ffffff"),document.body.style.setProperty("padding","0"),document.body.style.setProperty("margin","0"),(o=document.createElement("SPAN")).style.setProperty("margin-left","4px"),o.style.setProperty("float","left"),o.style.setProperty("overflow","hidden"),o.style.setProperty("display","block"),o.innerHTML=i,r.appendChild(o),(a=document.createElement("SPAN")).style.setProperty("font-family","Courier"),a.style.setProperty("font-size","8pt"),a.style.setProperty("font-weight","bold"),a.style.setProperty("position","absolute"),a.style.setProperty("width","20px"),a.style.setProperty("vertical-align","top"),a.style.setProperty("cursor","pointer"),a.style.setProperty("text-align","right"),a.style.setProperty("right","4px"),a.style.setProperty("display","block"),a.innerHTML="X",a.onclick=rtl.createSafeCallback(this,"DoErrorClose"),r.appendChild(a),document.body.appendChild(r)):2===C?window.alert(i):1===C&&(this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons"),pas["WEBLib.Dialogs"].MessageDlg(i,1,rtl.createSet(2),null)),null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(n),{get:function(){return s},set:function(t){s=t}}),s},this.DoHandleExit=function(t){return!0,null!=this.FOnExit$1&&this.FOnExit$1(this),!0},this.DoHashChange=function(t){var e="",i=null,s=null,n=null,r=!1;return!0,!this.FAutoFormRoute||(e=location.hash,pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,1),r=!1,null!=this.FOnHashChange&&this.FOnHashChange(this,e,{get:function(){return r},set:function(t){r=t}}),r||(""===e&&(e=this.FInitFormClassName),""!==e&&(""===this.FInitFormClassName&&(this.FInitFormClassName=this.FActiveForm.$classname),null!=(i=pas.Classes.GetClass(e))&&(n=document.body,this.CreateForm$6(i,n,{get:function(){return s},set:function(t){s=t}})))),!0)},this.DoPopState=function(t){return null!=this.FOnPopState&&this.FOnPopState(this,t.state),!0,!0},this.DoErrorClose=function(t){return document.body.removeChild(t.target.parentElement),!0,!0},this.DoUpdateOnlineStatus=function(t){return!0,null!=this.FOnOnlineChange&&(window.navigator.onLine?this.FOnOnlineChange(this,0):this.FOnOnlineChange(this,1)),!0},this.DoVisibilityChange=function(t){var e;return!0,e="visible"===document.visibilityState,null!=this.FOnActivate&&this.FOnActivate(this,e),!0},this.GetIsOnline=function(){return window.navigator.onLine},this.DoGetDataReceived=function(t,e,i){"#reload"===i.jsobject.toString()&&location.reload()},this.DoGetConnected=function(t){var e,i="";e=window.location.href,i=window.navigator.userAgent,i=pas.System.Pos("Edg",i)>0?"Edge":pas.System.Pos("Opera",i)>0||pas.System.Pos("OPR",i)>0?"Opera":pas.System.Pos("Chrome",i)>0?"Chrome":pas.System.Pos("Safari",i)>0?"Safari":pas.System.Pos("Firefox",i)>0?"Firefox":pas.System.Pos("Trident",i)>0?"MSIE":"",this.FWebSocket.Send(e+";"+i)},this.CreateNewForm=function(e,i){var s=null,n=null,r=null,o=null,a=null,l=0,h=0,u=0,d=0,F=null,c=null,p=0,C=null;if(null===this.FMainForm&&(this.FMainForm=e),r=null,a=null,p=0,e.FPopup||""===e.FFormElement){if(e.ClearControls(),e.FLayer$1=e.CreateLayer(),document.body.appendChild(e.FLayer$1),s=e.FLayer$1,e.FPopup&&e.FPopupOpacity<1&&((n=e.CreateLayer()).style.setProperty(pas["WEBLib.Controls"].CSSBackground,"black"),n.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(e.FPopupOpacity)),n.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),s.appendChild(n)),t.Application.ChangeMaxZIndex(1),(r=document.createElement("DIV")).style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),e.FPopupElement=r,e.FBorder in rtl.createSet(3,4)){r.style.setProperty("resize","both"),r.style.setProperty("overflow","auto"),C=null;try{var S=e;(C=new ResizeObserver((function(t){window.requestAnimationFrame(()=>{Array.isArray(t)&&t.length&&t.forEach((function(t){S.HandleObserver()}))})}))).observe(r)}catch(t){r.style.removeProperty("resize"),r.style.removeProperty("overflow")}e.FResizeObserver=C}""!==e.FElementClassName&&r.setAttribute("class",e.FElementClassName),e.FShadow&&e.FPopup&&r.style.setProperty("box-shadow","3px 3px 3px silver"),s.appendChild(r),e.GetMethodPointers(),e.FBorder in rtl.createSet(3,4)?(c=e.CreateCaption(),r.appendChild(c),(o=document.createElement("DIV")).style.setProperty("position","absolute"),o.style.setProperty("width","100%"),o.setAttribute("id","childspan"),r.appendChild(o),a=o,p=t.Application.FFormCaptionHeight):a=r,a.innerHTML=i,e.FContainer=a}else e.FLayer$1=null,null!=(s=document.getElementById(e.FFormElement))&&(s.innerHTML=i,""===e.FElementClassName&&0===e.FCSSLibrary&&s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)));e.Init(),e.LoadDFMValues(),e.FBorder in rtl.createSet(3,4)&&""!==e.FElementCaptionClassName&&(c.classList.add(e.FElementCaptionClassName),c.style.removeProperty("background-color"),c.style.removeProperty("color")),null!=e.FLayer$1&&(e.FPopup||(""===e.FElementClassName?-1!==e.FColor?s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)):s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,"white"):s.setAttribute("class",e.FElementClassName),1===e.FCSSLibrary&&""===e.FElementClassName&&(s.setAttribute("class","card"),s.style.removeProperty("background-color"),s.style.setProperty("display","block")))),null!=r&&""===e.FFormContainer&&e.FPopup&&4===e.FPosition&&(r.style.setProperty("position","absolute"),l=Math.max(0,Math.round((t.WinWidth()-e.GetWidth())/2))+window.scrollX,h=Math.max(0,Math.round((t.WinHeight()-e.GetHeight())/2))+window.scrollY,u=e.GetWidth(),d=e.GetClientHeight()+p,e.FTop=h,e.FLeft=l,e.SetWidthInt(u),e.SetHeightInt(d),""===e.FElementClassName&&0===e.FCSSLibrary&&(r.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)),r.style.setProperty("border","1px Black solid")),r.style.setProperty("top",pas.SysUtils.IntToStr(h)+"px"),r.style.setProperty("left",pas.SysUtils.IntToStr(l)+"px"),r.style.setProperty("width",pas.SysUtils.IntToStr(u)+"px"),r.style.setProperty("height",pas.SysUtils.IntToStr(d)+"px")),null!=a&&this.ActivateChildScripts(a),null!=e.FOnCreate&&e.FOnCreate(e),null!=e.FCreatedProc&&(F=e.FCreatedProc,e.FCreatedProc=null,F(e)),e.Loaded(),e.InitAnchoring(),e.UpdateChildAnchoring(),e.FCreating=!1,e.UpdateElement(),e.EventsBound()||e.BindEvents(),e.Resize$1(),e.DoShow()},this.GetFormExtension=function(){return 0!==this.FLanguage?"_"+pas["WEBLib.Lang"].GetLanguageISO639_1Code(this.FLanguage)+pas["WEBLib.WebTools"].cHTMLExt:pas["WEBLib.WebTools"].cHTMLExt};this.GetAuthorizationPageHTML=function(t){function e(t,e){var i=0,s="";s='<!doctype html>\r\n<html lang="en">\r\n<head>\r\n  <title>Authentication Result</title>\r\n  <meta name="viewport" content="width=device-width, initial-scale=1">\r\n</head>\r\n<body>\r\n<style>\r\n  hr\r\n  {\r\n    border: none;\r\n    height: 1px;\r\n    background-color: rgb(171, 171, 171);\r\n  }\r\n  div.container\r\n  {\r\n    position: fixed;\r\n    font-family: Arial;\r\n    font-size: 12pt;\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n  }\r\n  div.section\r\n  {\r\n    display: inline-block;\r\n    margin: 15px;\r\n    padding: 5px;\r\n    float: left;\r\n  }\r\n  div.image img\r\n  {\r\n    height: 100%;\r\n  }\r\n  div.text\r\n  {\r\n    padding-top: 15px;\r\n  }\r\n  div.text2\r\n  {\r\n    font-size: 18pt;\r\n    color: #PLACEHOLDERCOLOR#;\r\n  }\r\n  span.title\r\n  {\r\n    font-size: 26px;\r\n  }\r\n</style>\r\n  <div class="container">\r\n  <div class="section image">\r\n    <img src="#PLACEHOLDERIMAGE#">\r\n  </div>\r\n  <div class="section text">\r\n  #PLACEHOLDERTEXT#\r\n  </div>\r\n  </div>\r\n </body>\r\n</html>';for(var n=0,r=rtl.length(t)-1;n<=r;n++)i=n,s=pas.SysUtils.StringReplace(s,t[i],e[i],rtl.createSet(0));return s}return e(["#PLACEHOLDERIMAGE#","#PLACEHOLDERTEXT#","#PLACEHOLDERCOLOR#"],t?["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACC0lEQVR4nO2Zv3GDMBSHv+QyQEbICM4EOW+Q9BS4o2QTU9LZBQNkg6zgETyCR0iRkOMIAv3Xk0+/zsiI931nI3iCkpKSkpKSkpKSkpJ7SDN0x2bo3nW//xCymNhphu4E1MAN2PdVe9k6524ETODHXIHXvmpva+c9BqwpWhbgAV6Ar61zsxeggB+z+x1XJmsBG/Bj6mboWtVgtvcATfhpPvqq/ZwfzFKABTwoVobsBFjCj7kyWxmyugc4wsPCypCNAA/wY/L7C3iEP/dVe5geEC8gJDwIFxAaHgQLiAEPQgXEggeBAmLCgzABseFBkIAU8CBEQCp4ECAgJTwYChibCzYXWpmv9jCVFTwYCJgVa31BxXwucapFS4CiWOsLS4EHDQEbxRoXIAkeNgRoFqtdiDR4WBFgWOxmQRLhQdEQsSi2bobuqBqUCg8LvwDHYg991Z49zjeNd3iYCfBU7J8E6fAAT7PPOw9znpqhA3hDODz8F7Dnp2vqKmJ1O8ogQeFh+R7wjB8JrgkOD4plUICEKPCw/hyQSkI0eNh+EowtISo86L0LxJIQHR703wZDS0gCD2b9gFASksGDeUfIt4Sk8GDRE/QoITk8WDZFPUgQAQ8OXWEHCWLgwbEtbiFBFDx42BcwkCAOHjxtjGhIEAkPHneGViSIhQfPW2MLEkTDQ4C9wYmEi3T4kpKSkm+5ax+YhPsUTQAAAABJRU5ErkJggg==",'<div class="text2">Application succesfully authorized</div>You can close this browser window',"rgb(104, 164, 144)"]:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtElEQVR4nO2bUY7CMAxEhz0NB+EgrDjXCg6yB+E4+9NKCAiN7XHcjf1+ED+Z6ahNHScFiqIoBNwvp+v9crpG+3hG6+sgFQFwXv7ejj+/31JBDyy+ugN4ElkJD8HqqyuAhohYjA3D12YAGyIiMSYsXx8D6BTpFmPB9NUMQCjSJcaA7ettAEqRTTErHr5eAjCKfBSz4OXryzhgizOzWCJd/Fs8HoFHzHeCtxf2JNgt3MMID8zXoMpAtDarEDIbidJklMJUQ6MDty6GNDSNRdxtluWwhReDUfONKADAx2jkZCsOAOAaXn4pY2let6oAAN/qTIG61lAHAOwmBFO1aQoACA/BXGqbAwDCQqCsOCkBAMNDoC23aQEAw0Kg9hqoAQDuIdAbLfQAALcQXFptLgEA9BDc+oxeLbF/Qz0C7AFTT4KpX4OpC6HUpXDqxVDq5fBOLn5lbEMkdUssdVM0dVs89cZI6q2x1JujqbfHUx+Q2MPFj/LidUqsKajB05NXS4y6Zl/GurHGe6QOSpLF5jgqqxSb67C0UGzO4/KdYnN/MLEhluOTmYZY+MWvDPU122dzRVHk5g+X6Lw5aVkK9AAAAABJRU5ErkJggg==",'<div class="text2">Application authorization failed</div><br/>Please try again.',"rgb(216, 99, 68)"])},this.GetColorScheme=function(){var t=0;return t=0,"not all"!==window.matchMedia("(prefers-color-scheme)").media&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?2:1),t},this.ActivateChildScripts=function(t){!function t(e){if(!0===function(t){return"SCRIPT"===t.tagName}(e))e.parentNode.replaceChild(function(t){var e=document.createElement("script");e.async=!1,e.text=t.innerHTML;for(var i=t.attributes.length-1;i>=0;i--)e.setAttribute(t.attributes[i].name,t.attributes[i].value);return e}(e),e);else for(var i=0,s=e.childNodes;i<s.length;)t(s[i++]);return e}(t)},this.ChangeMaxZIndex=function(t){this.FMaxZIndex=this.FMaxZIndex+t},this.TriggerNotification=function(){},this.AutoCreateForm=function(t,e){null!=this.FOnAutoCreateForm?this.FOnAutoCreateForm(this,t,e):this.CreateForm(t,e)},this.LockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).DisableTab()},this.UnLockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).EnableTab()},this.Create$1=function(t){return this.FFormStack=pas.Classes.TList.$create("Create$1"),this.FParameters=pas.Classes.TStringList.$create("Create$1"),this.FAppContainer=pas["WEBLib.WebTools"].cBodyTag,this.FMainForm=null,this.FActiveForm=null,this.FInitFormClassName="",this.FIsRedirect=!1,this.FAutoFormRoute=!1,this.FThemed=!1,this.FThemeColor=14917120,this.FThemeTextColor=16777215,this.FFormCaptionHeight=22,this.FMaxZIndex=998,this.FHandleOAuth=!0,this.FHintPause=200,this.FHintHidePause=250,this.FHintPosition=1,this.FHintClassName="",this.FSBW=-1,this.FWebSocket=pas["WEBLib.WebSocketClient"].TSocketClient.$create("Create$1",[this]),this.FWebSocket.FPort=8888,this.FWebSocket.FOnDataReceived=rtl.createCallback(this,"DoGetDataReceived"),this.FWebSocket.FOnConnect=rtl.createCallback(this,"DoGetConnected"),this.FWebSocket.Connect(),window.addEventListener("error",rtl.createCallback(this,"DoHandleError")),window.addEventListener("unhandledrejection",rtl.createCallback(this,"DoHandleError")),window.addEventListener("beforeunload",rtl.createSafeCallback(this,"DoHandleExit")),this.FErrorType=0,this},this.Destroy=function(){rtl.free(this,"FWebSocket"),rtl.free(this,"FFormStack"),rtl.free(this,"FParameters"),pas["WEBLib.Controls"].TControl.Destroy.call(this)},this.MaxZIndexStr=function(){return pas.SysUtils.IntToStr(this.FMaxZIndex)},this.CalcScrollBarWidth=function(){var t=0;if(-1!==this.FSBW)return this.FSBW;return function(){const e=document.createElement("div");e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",e.style.width="100px",e.style.height="100px",document.body.appendChild(e);const i=e.offsetWidth-e.clientWidth;document.body.removeChild(e),t=i}(),this.FSBW=t,this.FSBW},this.CreateForm=function(t,e){this.CreateForm$2(t,this.FAppContainer,e,null)},this.CreateForm$2=function(t,e,i,s){this.CreateForm$3(t,e,i,s,!0)},this.CreateForm$3=function(e,i,s,n,r){var o=this,a="";function l(r){var l,h=null,u=null,d="",F=!1;return(l=null!=r)?(d=r.target.responseText,(h=(F=pas.SysUtils.LowerCase(i)===pas["WEBLib.WebTools"].cBodyTag)?document.body:document.getElementById(i)).innerHTML=d):h=document.body,(u=e.$create("Create$5",[i,s])).FFormFileName=a,""===u.FFormContainer&&u.SetFormContainer(i),F||(u.FFormElement=i,u.FContainer=h),u.CreateControl(),u.Init(),u.SetColorScheme(t.Application.GetColorScheme()),u.FPrevActiveForm=o.FActiveForm,o.FActiveForm=u,null===o.FMainForm&&(o.FMainForm=u),null!=n&&n(u),!0,l&&o.ActivateChildScripts(h),o.FActiveForm.DoShow(),o.FActiveForm.Resize$1(),!0}if(!this.FIsRedirect){if(this.FAppInitializing){if(!this.FCanCreateForm)return;this.FCanCreateForm=!1}""!==(a=e.GetHTMLFileName())&&r?(this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(null,l)),this.FLastReq.open("GET",a),this.FLastReq.send()):l(null)}},this.CreateForm$6=function(t,e,i){this.CreateForm$2(t,e.id,i,null)},this.LoadForm=function(t,e){t.FPrevActiveForm=this.FActiveForm,this.FActiveForm=t,this.FLoadForm=t,null===this.FMainForm&&(this.FMainForm=t),this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(this,"DoFormLoad")),this.FLastReq.addEventListener("abort",rtl.createSafeCallback(this,"DoFormAbort")),this.FLastReq.open("GET",e),this.FLastReq.send()},this.LoadForm$1=function(t,e,i){this.FCreatedProc=i,this.LoadForm(t,e)},this.HasCSS=function(t){var e=!1,i=null,s=0,n="";e=!1;for(var r=0,o=(i=document.querySelectorAll("head > link")).length-1;r<=o;r++)if(s=r,n=i.item(s).href,0===pas.SysUtils.CompareText(n,t)){e=!0;break}return e},this.Initialize=function(){var t,e,i="",s="";if(this.FCanCreateForm=!0,this.FAppInitializing=!0,this.FParameters.Clear(),i=window.location.href,this.InitFormatSettings(pas["WEBLib.WebTools"].GetBrowserLocale()),this.FParameters.SetDelimiter("&"),this.FParameters.FStrictDelimiter=!0,(t=pas.System.Pos("?",i))>0&&(i=pas.System.Copy(i,t+1,i.length)),this.FParameters.SetDelimitedText(i),e="Authentication"==window.name,null!=this.FOnOAuthCallBack&&(-1!==this.FParameters.IndexOfName("oauthcallback")||e))return this.FOnOAuthCallBack(this,i),this.FIsRedirect=!0,void(document.body.innerHTML=this.GetAuthorizationPageHTML(!0));-1!==this.FParameters.IndexOfName("code")&&this.FHandleOAuth&&(null!=this.FOnOAuthToken&&this.FOnOAuthToken(this,i),this.FIsRedirect=!0,s=this.FParameters.GetValue("code"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close())),window.addEventListener("hashchange",rtl.createSafeCallback(this,"DoHashChange")),window.addEventListener("online",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),window.addEventListener("offline",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),window.addEventListener("popstate",rtl.createCallback(this,"DoPopState")),document.addEventListener("visibilitychange",rtl.createSafeCallback(this,"DoVisibilityChange")),null!==window.opener&&-1!==this.FParameters.IndexOfName("access_token")&&(this.FIsRedirect=!0,s=this.FParameters.GetValue("access_token"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close()))},this.InitFormatSettings=function(t){var e,i,s=0;i=t,pas.SysUtils.FormatSettings.ShortDateFormat=pas["WEBLib.WebTools"].GetLocaleShortDateFormat(i),pas.System.Pos("/",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="/"),pas.System.Pos(".",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="."),pas.System.Pos("-",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="-");var n=new Date("Jan 1, 1980 06:07:08 GMT+00:00"),r="";for(r=""==i?navigator.language:i,e=n.toLocaleTimeString(r),pas.System.Pos(":",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator=":"),pas.System.Pos(".",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="."),pas.System.Pos("-",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="-"),s=1;s<=7;s++)pas.SysUtils.FormatSettings.ShortDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortDayName(s,i),pas.SysUtils.FormatSettings.LongDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongDayName(s,i);for(s=1;s<=12;s++)pas.SysUtils.FormatSettings.ShortMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortMonthName(s,i),pas.SysUtils.FormatSettings.LongMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongMonthName(s,i);pas.SysUtils.FormatSettings.DecimalSeparator=pas["WEBLib.WebTools"].GetLocaleDecimalSeparator(""),"."===pas.SysUtils.FormatSettings.DecimalSeparator?pas.SysUtils.FormatSettings.ThousandSeparator=",":pas.SysUtils.FormatSettings.ThousandSeparator="."},this.Run=function(){this.FCanCreateForm=!0,this.FAppInitializing=!1},this.Navigate=function(t,e){0===e?window.open(t,"_blank"):window.location.href=t},this.EXEName=function(){return window.document.location.href},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),this.GetParentForm=function(e){var i=null,s=null;for(i=null,s=e;null!=s&&!t.TCustomForm.isPrototypeOf(s);)s=s===e&&null===s.FOwner?e.FParent:s.FOwner;return null!=s&&t.TCustomForm.isPrototypeOf(s)&&(i=rtl.as(s,t.TCustomForm)),i},this.WinWidth=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientWidth():window.innerWidth},this.WinHeight=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientHeight():window.innerHeight},this.Application=null,this.HandShakeScript=null,this.VSIDE=null,this.LastHash="",t.$implcode=function(){e.ReleaseForm=function(t){t=rtl.freeLoc(t),t=null}},t.$init=function(){t.HandShakeScript=document.createElement("script"),t.HandShakeScript.id="HandShakeScript",t.HandShakeScript.type="text/javascript",t.HandShakeScript.innerHTML='var IDE = null;\r\nvar TMSWEBCoreClientIdentifier = "unknown";\r\nvar TMSWEBCoreOAuthCallback = "unknown";\r\nfunction HandShake(cid){\r\n  TMSWEBCoreClientIdentifier = cid;\r\n}',document.body.appendChild(t.HandShakeScript),t.Application=t.TApplication.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.WebTools","WEBLib.JSON","WEBLib.Utils","Math"]),rtl.module("WEBLib.StdCtrls",["System","Classes","WEBLib.Controls","SysUtils","Web","WEBLib.Graphics","Types","WEBLib.WebTools","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;this.TEditCharCase={0:"wecLowerCase",wecLowerCase:0,1:"wecNormal",wecNormal:1,2:"wecMixedCase",wecMixedCase:2,3:"wecUpperCase",wecUpperCase:3},this.$rtti.$Enum("TEditCharCase",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEditCharCase}),this.TCheckBoxState={0:"cbChecked",cbChecked:0,1:"cbGrayed",cbGrayed:1,2:"cbUnchecked",cbUnchecked:2},this.$rtti.$Enum("TCheckBoxState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TCheckBoxState}),this.TDateTimeKind={0:"dtkDate",dtkDate:0,1:"dtkTime",dtkTime:1},this.$rtti.$Enum("TDateTimeKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDateTimeKind}),this.TEllipsisPosition={0:"epEndEllipsis",epEndEllipsis:0,1:"epNone",epNone:1,2:"epPathEllipsis",epPathEllipsis:2,3:"epWordEllipsis",epWordEllipsis:3},this.$rtti.$Enum("TEllipsisPosition",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEllipsisPosition}),this.TTextLayout={0:"tlTop",tlTop:0,1:"tlCenter",tlCenter:1,2:"tlBottom",tlBottom:2},this.$rtti.$Enum("TTextLayout",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTextLayout}),this.TAutoCompletion={0:"acOff",acOff:0,1:"acHonorificPrefix",acHonorificPrefix:1,2:"acGivenName",acGivenName:2,3:"acAdditionalName",acAdditionalName:3,4:"acFamilyName",acFamilyName:4,5:"acHonorificSuffix",acHonorificSuffix:5,6:"acNickName",acNickName:6,7:"acEmail",acEmail:7,8:"acUserName",acUserName:8,9:"acNewPassword",acNewPassword:9,10:"acCurrentPassword",acCurrentPassword:10,11:"acOrganizationTitle",acOrganizationTitle:11,12:"acOrganization",acOrganization:12,13:"acStreetAddress",acStreetAddress:13,14:"acAddressLine1",acAddressLine1:14,15:"acAddressLine2",acAddressLine2:15,16:"acAddressLine3",acAddressLine3:16,17:"acAddressLevel1",acAddressLevel1:17,18:"acAddressLevel2",acAddressLevel2:18,19:"acAddressLevel3",acAddressLevel3:19,20:"acAddressLevel4",acAddressLevel4:20,21:"acCountry",acCountry:21,22:"acCountryName",acCountryName:22,23:"acPostalCode",acPostalCode:23,24:"acCCName",acCCName:24,25:"acCCGivenName",acCCGivenName:25,26:"acCCAdditionalName",acCCAdditionalName:26,27:"acCCFamilyName",acCCFamilyName:27,28:"acCCNumber",acCCNumber:28,29:"acExpiry",acExpiry:29,30:"acExpiryMonth",acExpiryMonth:30,31:"acExpiryYear",acExpiryYear:31,32:"acCSC",acCSC:32,33:"acType",acType:33,34:"acTransactionCurrency",acTransactionCurrency:34,35:"acTransactionAmount",acTransactionAmount:35,36:"acLanguage",acLanguage:36,37:"acBirthday",acBirthday:37,38:"acBirthdayDay",acBirthdayDay:38,39:"acBirthDayMonth",acBirthDayMonth:39,40:"acBirthDayYear",acBirthDayYear:40,41:"acSex",acSex:41,42:"acTelephone",acTelephone:42,43:"acTelephoneCountryCode",acTelephoneCountryCode:43,44:"acTelephoneNational",acTelephoneNational:44,45:"acTelephoneAreaCode",acTelephoneAreaCode:45,46:"acTelephoneLocal",acTelephoneLocal:46,47:"acTelephoneExtension",acTelephoneExtension:47,48:"acIMPP",acIMPP:48,49:"acURL",acURL:49,50:"acPhoto",acPhoto:50,51:"acNone",acNone:51,52:"acNope",acNope:52},this.$rtti.$Enum("TAutoCompletion",{minvalue:0,maxvalue:52,ordtype:1,enumtype:this.TAutoCompletion}),this.TEditType={0:"weString",weString:0,1:"weFloat",weFloat:1,2:"weHex",weHex:2,3:"weNumeric",weNumeric:3,4:"weSignedFloat",weSignedFloat:4,5:"weSignedNumeric",weSignedNumeric:5,6:"weSearch",weSearch:6},this.$rtti.$Enum("TEditType",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TEditType}),this.THTMLType={0:"tLABELTAG",tLABELTAG:0,1:"tSPAN",tSPAN:1,2:"tDIV",tDIV:2,3:"tH1",tH1:3,4:"tH2",tH2:4,5:"tH3",tH3:5,6:"tH4",tH4:6,7:"tH5",tH5:7,8:"tH6",tH6:8,9:"tP",tP:9},this.$rtti.$Enum("THTMLType",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.THTMLType}),rtl.createClass(this,"TCustomLabel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FContent=null,this.FAutoSize=!1,this.FEllipsisPosition=0,this.FWordWrap=!1,this.FAlignment=0,this.FLayout=0,this.FTransparent=!1,this.FHTMLType=0,this.FFocusControl=null,this.FShowAccelChar=!1,this.FColor$1=0,this.FHasAccel=!1,this.FHasHTML=!1,this.FElementLabelClassName="",this.FOrigWidth=0,this.FOldWidth=0,this.FOldHeight=0,this.FHTML=""},this.$final=function(){this.FContent=void 0,this.FFocusControl=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateElementVisual())},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElementVisual())},this.GetContentHandle=function(){return this.FContent},this.SetTransparent=function(t){this.FTransparent!==t&&(this.FTransparent=t,this.UpdateElementVisual())},this.SetHTMLType=function(t){var e=null;this.FHTMLType!==t&&(this.FHTMLType=t,this.FHTMLType in rtl.createSet(null,3,8)&&this.SetElementFont(1),null!=this.GetElementHandle()&&null!=this.FContent&&null!=(e=this.GetElementHandle().firstChild)&&"lbl"===e.getAttribute("data-lbl")&&(this.GetElementHandle().removeChild(this.FContent),this.FContent=this.CreateLabelElement(),this.GetElementHandle().appendChild(this.FContent),this.UpdateElement()))},this.SetColorEx=function(t){this.FColor$1=t,4 in this.FComponentState&&16777215!==this.FColor$1&&this.SetTransparent(!1),this.UpdateElement()},this.SetElementLabelClassName=function(t){this.FElementLabelClassName!==t&&(this.FElementLabelClassName=t,this.UpdateElement())},this.SetHTML=function(t){this.FHTML!==t&&(this.FHTML=t,this.UpdateElementData())},this.SetWidth=function(t){-1!==t&&0 in this.FComponentState&&(this.FOrigWidth=t),pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments)},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FContent=this.CreateLabelElement(),t.appendChild(this.FContent),t},this.CreateLabelElement=function(){var t=null;t=null;var e=this.FHTMLType;return 1===e?t=document.createElement("SPAN"):2===e?t=document.createElement("DIV"):3===e?t=document.createElement("H1"):4===e?t=document.createElement("H2"):5===e?t=document.createElement("H3"):6===e?t=document.createElement("H4"):7===e?t=document.createElement("H5"):8===e?t=document.createElement("H6"):0===e?t=document.createElement("LABEL"):9===e&&(t=document.createElement("P")),t.setAttribute("data-lbl","lbl"),t},this.GetDisplayText=function(){return this.FCaption},this.CanShowFocus=function(){return!1,!1},this.SetParent=function(t){pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.FAutoSize&&0!==this.FAlignment&&-1!==this.FOrigWidth&&(this.SetLeft(this.GetLeft()+this.FOrigWidth-this.GetWidth()),this.FOrigWidth=-1)},this.BindElement=function(){this.FContent=this.GetContainer().firstElementChild},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.FShowAccelChar&&null!=this.FFocusControl&&this.UpdateElementData()},this.UpdateAutoSize=function(){this.FAutoSize&&0===this.FAlign&&(null!=this.GetElementHandle()&&pas["WEBLib.WebTools"].ElementVisible(this.GetElementHandle())&&(this.SetWidth(-1),this.SetHeight(-1)),this.FEllipsisPosition=1)},this.UpdateElementData=function(){var t="",e="",i=!1,s=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),e="",t=this.GetDisplayText(),t=this.FShowAccelChar&&pas.System.Pos("&",t)>0?pas["WEBLib.WebTools"].ProcessAccelerator(t,{get:function(){return e},set:function(t){e=t}}):""===this.FHTML?pas["WEBLib.WebTools"].HTMLToString(t):this.FHTML,i=!1,pas.System.Pos("\r",t)>0?(i=!0,pas.System.Pos("\n",t)>0&&(t=pas.SysUtils.StringReplace(t,"\n","",rtl.createSet(0,1))),t=pas.SysUtils.StringReplace(t,"\r","<BR>",rtl.createSet(0,1))):pas.System.Pos("\n",t)>0&&(i=!0,t=pas.SysUtils.StringReplace(t,"\n","<BR>",rtl.createSet(0,1))),this.GetIsLinked()&&""===t&&0 in this.FComponentState||(null!=this.GetContentHandle()?this.GetIsLinked()?(s=this.GetContentHandle(),""!==this.GetID()&&(s=document.getElementById(this.GetID())),null!=s&&(pas.System.Assigned(this.GetContentHandle().nodeValue)?s.nodeValue=t:0===s.childElementCount&&(s.innerHTML=t))):this.GetContentHandle().childElementCount>0&&pas.System.Assigned(this.GetContentHandle().nodeValue)&&!this.FHasAccel&&!this.FHasHTML&&!i?this.GetContentHandle().nodeValue=t:this.GetContentHandle().innerHTML=t:this.GetElementHandle().innerHTML=t,this.FHasHTML=pas.System.Pos("</",t)>0,this.FHasAccel=""!==e,""!==e&&null!=this.FFocusControl&&(this.GetContentHandle().setAttribute("accesskey",e),this.GetContentHandle().setAttribute("for",this.FFocusControl.GetID())))},this.UpdateElementVisual=function(){var t=0,e=0;if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),!this.IsUpdating()&&(null!=this.GetElementHandle()&&(e=Math.round(this.GetElementHandle().offsetHeight),t=Math.round(this.GetElementHandle().offsetWidth),e>0&&(this.FOldHeight=e),t>0&&(this.FOldWidth=t),!this.FVisible||this.FAutoSize&&0===this.FAlign||0===this.FAlignment&&0===this.FLayout||this.GetElementHandle().style.setProperty("display","table"),this.GetElementHandle().setAttribute("zindex","1"),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)?this.GetElementHandle().style.setProperty("overflow",""):this.GetElementHandle().style.setProperty("overflow","hidden")),null!=this.GetContentHandle())){var i=this.FLayout;0===i?this.GetContentHandle().style.setProperty("vertical-align","top"):1===i?this.GetContentHandle().style.setProperty("vertical-align","middle"):2===i&&this.GetContentHandle().style.setProperty("vertical-align","bottom");var s=this.FAlignment;0===s?this.GetContentHandle().style.removeProperty("text-align"):2===s?this.GetContentHandle().style.setProperty("text-align","center"):1===s&&this.GetContentHandle().style.setProperty("text-align","right"),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetElementHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetContentHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),this.GetContentHandle().style.setProperty("display","table-cell"),""===this.FElementClassName?(this.FEnabled&&0===this.FElementFont&&!this.GetIsLinked()?this.GetContentHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetContentHandle().style.removeProperty("color"),this.SetElementPointer(this.GetContentHandle(),this.FCursor),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!(0===this.FElementFont&&!this.GetIsLinked()))):(this.GetContentHandle().style.removeProperty("color"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!0)),""!==this.FElementLabelClassName?this.GetContentHandle().setAttribute("class",this.FElementLabelClassName):this.GetContentHandle().removeAttribute("class"),0===this.FElementPosition||1===this.FWidthStyle?1===this.FEllipsisPosition?this.GetContentHandle().style.setProperty("text-overflow","clip"):this.GetContentHandle().style.setProperty("text-overflow","ellipsis"):this.GetContentHandle().style.removeProperty("text-overflow"),this.FWordWrap?this.GetContentHandle().style.setProperty("white-space","normal"):this.GetContentHandle().style.setProperty("white-space","nowrap"),this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor",""),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)&&(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))}},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),this.FAutoSize&&0===this.FAlign&&null!=this.GetElementHandle()&&(4 in this.FComponentState||(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))),null!=this.GetContentHandle()&&this.FAlign in rtl.createSet(3,4,5)&&!this.FAutoSize&&this.FLayout in rtl.createSet(1,2)&&this.GetContentHandle().style.setProperty("height",pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.GetHeight(),get:function(){return this.p},set:function(t){this.p=t}})+"px")},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateAutoSize(),this.UpdateElement())},this.SetCaption=function(t){var e=0;this.FCaption!==t&&(e=this.GetWidth(),pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateAutoSize(),this.UpdateElement(),e-=this.GetWidth(),this.FAutoSize&&0!==this.FAlignment&&0!==e&&2 in this.FAnchors&&!this.IsUpdating()&&this.SetLeft(this.GetLeft()+e))},this.SetControlCursor=function(t){pas["WEBLib.Controls"].TControl.SetControlCursor.apply(this,arguments),""===this.FElementClassName&&null!=this.GetContentHandle()&&this.SetElementPointer(this.GetContentHandle(),this.FCursor)},this.SetEllipsisPosition=function(t){this.FEllipsisPosition!==t&&(this.FEllipsisPosition=t,1!==this.FEllipsisPosition&&(this.FAutoSize=!1),this.UpdateElement())},this.GetWidth=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=pas["WEBLib.Controls"].TControl.GetWidth.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldWidth)):t=pas["WEBLib.Controls"].TControl.GetWidth.call(this),t},this.GetHeight=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=pas["WEBLib.Controls"].TControl.GetHeight.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldHeight)):t=pas["WEBLib.Controls"].TControl.GetHeight.call(this),t},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FAutoSize=!0,this.FLayout=0,this.FEllipsisPosition=1,this.FColor$1=16777215,this.FTransparent=!0,this.FAlignment=0,this.SetTabStop(!1),this.FShowAccelChar=!0},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TLabel",this.TCustomLabel,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!0}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor$1","SetColorEx",{Default:16777215}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EllipsisPosition",2,t.$rtti.TEllipsisPosition,"FEllipsisPosition","SetEllipsisPosition",{Default:t.TEllipsisPosition.epNone}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementLabelClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","SetElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("FocusControl",0,pas["WEBLib.Controls"].$rtti.TWinControl,"FFocusControl","FFocusControl"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HTML",2,rtl.string,"FHTML","SetHTML"),e.addProperty("HTMLType",2,t.$rtti.THTMLType,"FHTMLType","SetHTMLType",{Default:t.THTMLType.tLABELTAG}),e.addProperty("Layout",2,t.$rtti.TTextLayout,"FLayout","SetLayout",{Default:t.TTextLayout.tlTop}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowAccelChar",0,rtl.boolean,"FShowAccelChar","FShowAccelChar",{Default:!0}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("WordWrap",0,rtl.boolean,"FWordWrap","FWordWrap",{Default:!1}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag")})),rtl.createClass(this,"TCustomInput",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.IsInputControl=function(){return!0,!0},this.GetInputType=function(){return"EDIT","EDIT"},this.CreateElement=function(){var t=null;return(t=document.createElement("INPUT")).setAttribute("type",this.GetInputType()),t},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().style.setProperty("-moz-box-sizing","border-box"),this.GetContainer().style.setProperty("-webkit-box-sizing","border-box"),this.GetContainer().style.setProperty("box-sizing","border-box"))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetShowFocus(!0),this.FNoUserSelect=!1},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomEdit",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FCharCase=0,this.FMaxLength=0,this.FReadOnly=!1,this.FText="",this.FTextHint="",this.FSelStart=0,this.FAlignment=0,this.FHideSelection=!1,this.FPasswordChar="\0",this.FOnChange=null,this.FAutoSize=!1,this.FAutoSelect=!1,this.FSelLength=0,this.FNumeric=!1,this.FAutoCompletion=0,this.FEditType=0,this.FRequired=!1,this.FAutoFocus=!1,this.FPattern="",this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FHandleSearchPtr=null,this.FSpellCheck=!1,this.FRequiredText="",this.FOnSearch=null},this.$final=function(){this.FOnChange=void 0,this.FOnSearch=void 0,t.TCustomInput.$final.call(this)},this.SetAlignment=function(t){this.FAlignment=t,this.UpdateElement()},this.SetHideSelection=function(t){this.FHideSelection!==t&&(this.FHideSelection=t,this.UpdateElement())},this.SetAutoSelect=function(t){this.FAutoSelect!==t&&(this.FAutoSelect=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.SetSelLength=function(t){this.FSelLength=t,this.UpdateElement()},this.SetSelStart=function(t){this.FSelStart=t,this.UpdateElement()},this.SetPasswordChar=function(t){this.FPasswordChar=t,this.UpdateElement()},this.SetAutoCompletion=function(t){this.FAutoCompletion!==t&&(this.FAutoCompletion=t,this.UpdateElement())},this.SetAutoFocus=function(t){this.FAutoFocus!==t&&(this.FAutoFocus=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired!==t&&(this.FRequired=t,this.UpdateElement())},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetEditType=function(t){this.FEditType!==t&&(this.FEditType=t,this.UpdateElement())},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.DoHandlePaste=function(t){var e="",i=!1;i=!1;var s=t.clipboardData||window.clipboardData;return s&&(e=s.getData("Text"),i=!0),!i||this.CanPaste(e)&&this.Validate(e)||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.DoHandleSearch=function(t){return!0,null!=this.FOnSearch&&this.FOnSearch(this),!0},this.IsCustomEditor=function(){return!1,!1},this.KeyPress=function(t){var e=!1;pas["WEBLib.Controls"].TControl.KeyPress.call(this,t),e=!0;var i=this.FEditType;3===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57):5===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,43,45):1===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46):4===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===i&&(e=t.get().charCodeAt()in rtl.createSet(null,48,57,null,65,70)),e||t.set("\0")},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.FAutoSelect&&null!=this.GetElementInputHandle()&&this.GetElementInputHandle().select()},this.GetInputType=function(){return"\0"!==this.FPasswordChar?"PASSWORD":this.FNumeric?"NUMBER":this.FEditType in rtl.createSet(1,3)?"TEL":6===this.FEditType?"SEARCH":"TEXT"},this.GetText=function(){var t="";return t=this.FText,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().value),3===this.FCharCase&&(t=pas.SysUtils.UpperCase(t)),0===this.FCharCase&&(t=pas.SysUtils.LowerCase(t)),t},this.GetDisplayText=function(){return this.FText},this.IsReadOnly=function(){return this.FReadOnly},this.Validate=function(t){var e=!1,i=0,s="\0",n=!1;e=!0;for(var r=1,o=t.length;r<=o;r++){i=r,s=t.charAt(i-1),n=!0;var a=this.FEditType;if(3===a?n=s.charCodeAt()in rtl.createSet(null,48,57):5===a?n=s.charCodeAt()in rtl.createSet(null,48,57,43,45):1===a?n=s.charCodeAt()in rtl.createSet(null,48,57,44,46):4===a?n=s.charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===a&&(n=s.charCodeAt()in rtl.createSet(null,48,57,null,65,70)),!n){e=!1;break}}return e},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FHandleSearchPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut"),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid"),this.FHandleSearchPtr=rtl.createCallback(this,"DoHandleSearch")},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr),this.GetElementInputHandle().addEventListener("search",this.FHandleSearchPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr),this.GetElementInputHandle().removeEventListener("search",this.FHandleSearchPtr))},this.UpdateElementData=function(){var e=null,i=0,s=0,n=!1,r=!1;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementInputHandle()){if(!this.GetIsLinked()){var o=this.FCharCase;3===o?this.GetElementInputHandle().style.setProperty("text-transform","uppercase"):0===o?this.GetElementInputHandle().style.setProperty("text-transform","lowercase"):2===o?this.GetElementInputHandle().style.setProperty("text-transform","capitalize"):1===o&&this.GetElementInputHandle().style.setProperty("text-transform","initial")}if(this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),r=!0,this.GetIsLinked()&&(r=!this.GetElementInputHandle().hasAttribute("autocomplete")),r&&(52===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","nope"),this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("name")):51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","off"),this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetIsLinked()||this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("name"))),!this.GetIsLinked()){this.GetElementInputHandle().setAttribute("type",this.GetInputType()),this.GetElementInputHandle().setAttribute("role","textbox");var a=this.FAlignment;0===a?this.GetElementInputHandle().style.removeProperty("text-align"):2===a?this.GetElementInputHandle().style.setProperty("text-align","center"):1===a&&this.GetElementInputHandle().style.setProperty("text-align","right")}this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("required"),this.FAutoFocus?this.GetElementInputHandle().setAttribute("autofocus",""):this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("autofocus"),""!==this.FPattern?this.GetElementInputHandle().setAttribute("pattern",this.FPattern):this.GetElementInputHandle().removeAttribute("pattern"),this.FMaxLength<=0?this.GetElementInputHandle().removeAttribute("maxLength"):this.GetElementInputHandle().maxLength=this.FMaxLength,this.GetElementInputHandle().value=this.GetDisplayText(),n="NUMBER"===pas.SysUtils.UpperCase(this.GetInputType()),this.FSpellCheck?this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),n||this.GetIsLinked()||this.IsCustomEditor()||(i=this.FSelStart,s=this.FSelStart+this.FSelLength,e=this.GetElementInputHandle(),setTimeout((function(){e.setSelectionRange(i,s)}),1))}},this.SetCharCase=function(t){this.FCharCase!==t&&(this.FCharCase=t,this.UpdateElement())},this.SetMaxLength=function(t){this.FMaxLength!==t&&(this.FMaxLength=t,this.UpdateElementData())},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.SetText=function(t){this.FText=t,null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.SetTextHint=function(t){this.FTextHint=t,this.UpdateElement()},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-control"),this.SetHeightStyle(2))},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FAutoCompletion=0,this.FEditType=0,this.FText="",this.FCharCase=1,this.FMaxLength=0,this.FReadOnly=!1,this.FTextHint="",this.FPasswordChar="\0",this.FSpellCheck=!0,this.FAutoSelect=!0,this.SetHeight(25)},this.Change=function(){null!=this.GetElementHandle()&&(this.FText=this.GetElementInputHandle().value),null!=this.FOnChange&&this.FOnChange(this)},this.SetSelection=function(t,e){var i=null;this.FSelStart=t,this.FSelLength=e,null!=(i=this.GetElementInputHandle())&&i.setSelectionRange(t,t+e)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TEdit",this.TCustomEdit,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment"),e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoCompletion",2,t.$rtti.TAutoCompletion,"FAutoCompletion","SetAutoCompletion",{Default:t.TAutoCompletion.acOff}),e.addProperty("AutoFocus",2,rtl.boolean,"FAutoFocus","SetAutoFocus",{Default:!1}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),e.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default:!0}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Center",0,pas["WEBLib.Controls"].$rtti.TCenter,"FCenter",""),e.addProperty("CharCase",2,t.$rtti.TEditCharCase,"FCharCase","SetCharCase",{Default:t.TEditCharCase.wecNormal}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EditType",2,t.$rtti.TEditType,"FEditType","SetEditType",{Default:t.TEditType.weString}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default:"\0"}),e.addProperty("Pattern",2,rtl.string,"FPattern","SetPattern"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default:0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("SpellCheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnSearch",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnSearch","FOnSearch"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TSpinEdit",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FIncrement=0,this.FMaxValue=0,this.FMinValue=0,this.FValue=0,this.FAutoSize=!1,this.FOnChange=null,this.FReadOnly=!1,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FRequiredText="",this.FRequired=!1},this.$final=function(){this.FOnChange=void 0,t.TCustomInput.$final.call(this)},this.GetElementInputHandle=function(){return this.GetContainer()},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired!==t&&(this.FRequired=t,this.UpdateElement())},this.KeyPress=function(t){t.get().charCodeAt()in rtl.createSet(null,48,57)||(t.set("\0"),this.PreventDefault(),this.StopPropagation()),pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)},this.GetInputType=function(){return"NUMBER","NUMBER"},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(this.GetContainer().setAttribute("inputmode","numeric"),this.GetContainer().setAttribute("pattern","[0-9]*"),this.GetContainer().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly(),this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetElementInputHandle().removeAttribute("required"))},this.GetValue=function(){var t,e=0;return e=this.FValue,null==this.GetContainer()||""!==(t=this.GetContainer().value)&&(e=pas.SysUtils.StrToInt(t)),e},this.SetIncrement=function(t){this.FIncrement=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("step",pas.SysUtils.IntToStr(t))},this.SetMaxValue=function(t){this.FMaxValue=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("max",pas.SysUtils.IntToStr(t))},this.SetMinValue=function(t){this.FMinValue=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("min",pas.SysUtils.IntToStr(t))},this.SetValue=function(t){this.FValue=t,this.UpdateElement()},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.IsReadOnly=function(){return this.FReadOnly},this.GetDisplayText=function(){return pas.SysUtils.IntToStr(this.FValue)},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.Change=function(){this.FValue=this.GetValue(),null!=this.FOnChange&&this.FOnChange(this)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-control"),this.SetHeightStyle(2))},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FIncrement=1,this.FMaxValue=100,this.FMinValue=0,this.SetShowFocus(!0),this.SetHeight(25),this.AddControlStyle('input[type="number"]::-webkit-inner-spin-button { opacity: 1 !important; }')},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize"),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Increment",2,rtl.longint,"FIncrement","SetIncrement"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaxValue",2,rtl.longint,"FMaxValue","SetMaxValue",{Default:100}),e.addProperty("MinValue",2,rtl.longint,"FMinValue","SetMinValue",{Default:0}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Value",3,rtl.longint,"GetValue","SetValue"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TDateTimePicker",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FDate=0,this.FTime=0,this.FKind=0,this.FOnChange=null,this.FReadOnly=!1,this.FElementCheck=null,this.FElementPicker=null,this.FShowCheckBox=!1,this.FClickPtr$1=null,this.FHandleChangePtr=null,this.FFocusPtr=null,this.FBlurPtr=null,this.FChecked=!1,this.FShowSeconds=!1,this.FAutoDropDown=!1,this.FIsBootstrap=!1,this.FMax=0,this.FMin=0},this.$final=function(){this.FOnChange=void 0,this.FElementCheck=void 0,this.FElementPicker=void 0,t.TCustomInput.$final.call(this)},this.SetDate=function(t){this.FDate!==t&&(this.FDate=pas.System.Int(t),this.FTime=0,this.UpdateElementData())},this.GetDate=function(){var t,e=0;return e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),null==this.GetElementPicker()?e:(t=this.GetElementPicker().value,e=0===this.FKind?pas["WEBLib.WebTools"].PickerDateToDate(t)+pas.System.Frac(this.FTime):this.FTime)},this.SetTime=function(t){this.FTime!==t&&(this.FDate=0,this.FTime=t,this.UpdateElementData())},this.GetTime=function(){var t,e=0;return e=this.FDate>0?pas.System.Frac(this.FTime)+pas.System.Int(this.FDate):pas.System.Frac(this.FTime),null==this.GetElementPicker()?e:(t=this.GetElementPicker().value,e=1===this.FKind?pas["WEBLib.WebTools"].PickerTimeToTime(t)+pas.System.Int(this.FDate):this.FTime)},this.SetKind=function(t){var e=0;this.FKind=t,null!=this.GetElementPicker()&&(e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),0===t?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),this.SetDate(e),this.SetTime(e),this.UpdateElement())},this.SetText=function(t){this.GetElementPicker()},this.GetText=function(){var t="";return t="",null==this.GetElementPicker()?t:t=this.GetElementPicker().value},this.SetReadOnly=function(t){this.FReadOnly=t,this.UpdateElement()},this.SetShowCheckBox=function(t){this.FShowCheckBox!==t&&(this.FShowCheckBox=t,this.UpdateElementVisual())},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.UpdateElementVisual())},this.GetDateTime=function(){return pas.System.Int(this.FDate)+pas.System.Frac(this.FTime)},this.SetDateTime=function(t){this.FDate=pas.System.Int(t),this.FTime=pas.System.Frac(t),this.UpdateElementData()},this.SetShowSeconds=function(t){this.FShowSeconds!==t&&(this.FShowSeconds=t,this.UpdateElement())},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.UpdateElementData())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.UpdateElementData())},this.DoCheckClick=function(t){return this.FChecked=this.FElementCheck.checked,this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true"),!0,!0},this.DoPickerFocus=function(t){return this.GetIsLinked()||this.FIsBootstrap||this.GetElementHandle().style.setProperty("outline","auto"),!0,this.DoEnter(),!0},this.DoPickerBlur=function(t){return this.GetIsLinked()||this.FIsBootstrap||this.GetElementHandle().style.setProperty("outline","none"),!0,this.DoExit(),!0},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.HandleDoEnter=function(t){var e;return e=pas["WEBLib.Controls"].TControl.HandleDoEnter.call(this,t),this.FAutoDropDown&&this.GetElementPicker().showPicker(),e},this.GetElementBindHandle=function(){return this.GetElementPicker()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.FElementCheck&&this.FElementCheck.addEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().addEventListener("input",this.FHandleChangePtr),this.GetElementPicker().addEventListener("focus",this.FFocusPtr),this.GetElementPicker().addEventListener("blur",this.FBlurPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FElementCheck&&this.FElementCheck.removeEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().removeEventListener("input",this.FHandleChangePtr),this.GetElementPicker().removeEventListener("focus",this.FFocusPtr),this.GetElementPicker().removeEventListener("blur",this.FBlurPtr))},this.UpdateElementData=function(){var t=null,e="",i=0,s=0,n=0,r=0;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=(t=this.GetElementPicker())){t.setAttribute("step","1");var o=this.FKind;if(1===o){for(var a=1,l=(e=this.FShowSeconds?pas.SysUtils.FormatDateTime("HH:MM:SS",this.FTime):pas.SysUtils.FormatDateTime("HH:MM",this.FTime)).length;a<=l;a++)i=a,e.charCodeAt(i-1)in rtl.createSet(null,48,57)||(e=rtl.setCharAt(e,i-1,":"));t.value=e,this.FShowSeconds||t.setAttribute("step","60")}else if(0===o)if(0===this.FDate)t.value="";else{for(var h=1,u=(e=pas.SysUtils.FormatDateTime("yyyy-MM-dd",this.FDate)).length;h<=u;h++)i=h,e.charCodeAt(i-1)in rtl.createSet(null,48,57)||(e=rtl.setCharAt(e,i-1,"-"));t.value=e}this.FTabStop?t.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)):t.setAttribute("tabindex","-1"),0===this.FKind&&(0!==this.FMin?(pas.SysUtils.DecodeDate(this.FMin,{get:function(){return r},set:function(t){r=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),t.setAttribute("min",pas.SysUtils.Format("%d",pas.System.VarRecs(0,r))+"-"+pas.SysUtils.Format("%.*d",pas.System.VarRecs(0,2,0,n))+"-"+pas.SysUtils.Format("%.*d",pas.System.VarRecs(0,2,0,s)))):t.removeAttribute("min"),0!==this.FMax?(pas.SysUtils.DecodeDate(this.FMax,{get:function(){return r},set:function(t){r=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),t.setAttribute("max",pas.SysUtils.Format("%d",pas.System.VarRecs(0,r))+"-"+pas.SysUtils.Format("%.*d",pas.System.VarRecs(0,2,0,n))+"-"+pas.SysUtils.Format("%.*d",pas.System.VarRecs(0,2,0,s)))):t.removeAttribute("max")),t.readOnly=this.IsReadOnly(),this.IsEnabled()?t.removeAttribute("disabled"):t.setAttribute("disabled","")}},this.UpdateElementVisual=function(){var e;t.TCustomInput.UpdateElementVisual.call(this),e=pas["WEBLib.Forms"].GetParentForm(this),this.FIsBootstrap=null!=e&&1===e.FCSSLibrary&&""!==this.FElementClassName,null!=this.GetElementPicker()&&null!=this.GetElementHandle()&&null!=this.FElementCheck&&(this.FElementCheck.setAttribute("type","CHECKBOX"),0===this.FKind?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),""===this.FElementClassName?(this.GetElementPicker().style.setProperty("border","none"),this.GetElementPicker().style.setProperty("border-width","0px"),this.GetElementPicker().style.setProperty("outline","none"),this.GetElementPicker().style.setProperty("font-family","inherit"),this.GetElementPicker().style.setProperty("font-size","inherit"),this.GetElementPicker().style.setProperty("width","100%"),this.GetElementPicker().style.setProperty("height","100%")):this.FIsBootstrap&&(this.GetElementPicker().setAttribute("class",this.FElementClassName),this.GetElementHandle().removeAttribute("class")),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("padding","1px"),this.GetElementHandle().style.setProperty("outline","none")),1===this.FBorderStyle&&""===this.FElementClassName?(this.FEnabled?this.GetElementHandle().style.setProperty("border","1px solid"):this.GetElementHandle().style.setProperty("border","1px silver solid"),this.GetElementHandle().style.setProperty("border-radius","3px")):this.FIsBootstrap&&(this.GetElementHandle().style.removeProperty("border"),this.GetElementHandle().style.removeProperty("box-sizing")),null!=this.FElementCheck&&(this.FShowCheckBox?this.FElementCheck.style.setProperty("display",""):this.FElementCheck.style.setProperty("display","none")),this.FShowCheckBox&&(this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true")))},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FElementCheck=document.createElement("INPUT"),this.FElementPicker=document.createElement("INPUT"),t.appendChild(this.FElementCheck),t.appendChild(this.FElementPicker),t},this.GetInputType=function(){return 0===this.FKind?"DATE":"TIME"},this.Change=function(){this.FTime=this.GetTime(),this.FDate=this.GetDate(),null!=this.FOnChange&&this.FOnChange(this)},this.IsReadOnly=function(){return this.FReadOnly},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FBlurPtr=null,this.FFocusPtr=null,this.FClickPtr$1=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FClickPtr$1=rtl.createCallback(this,"DoCheckClick"),this.FFocusPtr=rtl.createCallback(this,"DoPickerFocus"),this.FBlurPtr=rtl.createCallback(this,"DoPickerBlur")},this.GetElementPicker=function(){return this.GetIsLinked()?this.GetElementHandle():this.FElementPicker},this.SetEnabled=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=(e=this.GetElementPicker())&&(t?e.removeAttribute("disabled"):e.setAttribute("disabled",""))},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-control"),this.SetHeightStyle(2))},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FMin=0,this.FMax=0,this.SetDate(pas.SysUtils.Now()),this.SetShowFocus(!0),4 in this.FComponentState&&(this.SetWidth(170),this.SetHeight(25)),this.FDate=pas.System.Int(pas.SysUtils.Now()),this.FTime=0,this.FReadOnly=!1,this.FShowSeconds=!0,this.FIsBootstrap=!1},this.SetFocus=function(){null!=this.GetElementPicker()&&this.GetElementPicker().focus()},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoDropDown",0,rtl.boolean,"FAutoDropDown","FAutoDropDown",{Default:!1}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Date",3,pas.System.$rtti.TDate,"GetDate","SetDate"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Kind",2,t.$rtti.TDateTimeKind,"FKind","SetKind"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Max",2,pas.System.$rtti.TDateTime,"FMax","SetMax"),e.addProperty("Min",2,pas.System.$rtti.TDateTime,"FMin","SetMin"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowCheckBox",2,rtl.boolean,"FShowCheckBox","SetShowCheckBox",{Default:!1}),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("ShowSeconds",2,rtl.boolean,"FShowSeconds","SetShowSeconds",{Default:!0}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Time",3,pas.System.$rtti.TTime,"GetTime","SetTime"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FModalResult=0,this.FDefault=!1,this.FCancel=!1,this.FButtonType=""},this.SetButtonType=function(t){this.FButtonType=t,this.UpdateElementData()},this.SetDefault=function(t){this.FDefault=t,this.FDefault&&this.SetFocus()},this.CreateElement=function(){var t=null;return(t=document.createElement("BUTTON")).setAttribute("type","BUTTON"),t},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateElementData())},this.UpdateElementData=function(){var t="";pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),this.GetIsLinked()&&""===this.FCaption||null!=this.GetElementHandle()&&((0===this.GetElementHandle().childElementCount||pas.System.Pos("</",this.FCaption)>0||!this.GetIsLinked())&&(this.GetElementHandle().innerHTML=pas["WEBLib.WebTools"].ProcessAccelerator(this.FCaption,{get:function(){return t},set:function(e){t=e}})),""!==t&&this.GetElementHandle().setAttribute("accesskey",t),this.GetElementHandle().setAttribute("role","button"),this.GetElementHandle().setAttribute("aria-label",this.FCaption),""!==this.FButtonType?this.GetElementHandle().setAttribute("type",this.FButtonType):this.GetElementHandle().setAttribute("type","BUTTON"))},this.UpdateElementVisual=function(){var t="";pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().style.removeProperty("outline"),this.GetElementHandle().style.removeProperty("user-select"),"BTN"===(t=pas.SysUtils.UpperCase(this.FElementClassName))||pas.System.Pos("BTN ",t))},this.HandleKeyPreview=function(t){pas["WEBLib.Controls"].TControl.HandleKeyPreview.apply(this,arguments),this.FDefault&&13===t&&this.Click(),this.FCancel&&27===t&&this.Click()},this.InitCSSLibrary=function(t){1===t&&(this.SetElementClassName("btn btn-light"),this.SetElementFont(1),this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetColor(-1),this.FModalResult=0},this.Click=function(){var t=null;pas["WEBLib.Controls"].TControl.Click.call(this),0!==this.FModalResult&&null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&t.SetModalResult(this.FModalResult)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ButtonType",2,rtl.string,"FButtonType","SetButtonType"),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("Cancel",0,rtl.boolean,"FCancel","FCancel",{Default:!1}),t.addProperty("Center",0,pas["WEBLib.Controls"].$rtti.TCenter,"FCenter",""),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("Default",2,rtl.boolean,"FDefault","SetDefault",{Default:!1}),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ModalResult",0,rtl.longint,"FModalResult","FModalResult",{Default:0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TCheckBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FState=0,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FOnCheckClick=null,this.FAlignment=0},this.$final=function(){this.FOnCheckClick=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElementVisual())},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.GetContainer()&&(this.GetIsLinked()||(this.GetContainer().children.item(1).onclick=rtl.createSafeCallback(this,"HandleLabelClick")))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(null!=(t=this.GetCheckElement())&&(t.disabled=!this.IsEnabled(),t.checked=this.FChecked,t.indeterminate=1===this.GetState()),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.GetElementHandle().firstChild.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||0!==this.FElementPosition||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementVisual=function(){var e=null,i=null,s=null,n=!1;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(null!=(e=this.GetElementHandle().firstChild)&&(null!=e.style&&e.style.setProperty("margin-right","4px"),""===this.FElementClassName&&(e.style.setProperty("vertical-align","middle"),e.style.setProperty("margin-top","0px")),""!==this.FElementButtonClassName?e.setAttribute("class",this.FElementButtonClassName):e.removeAttribute("class")),null!=(i=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?i.setAttribute("class",this.FElementLabelClassName):i.removeAttribute("class")),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(1===this.FAlignment?e.style.setProperty("float","left"):e.style.setProperty("float","right"),2===this.FHeightStyle?e.style.removeProperty("height"):0===this.FElementPosition&&e.style.setProperty("height","100%"),e.style.setProperty("vertical-align","middle"),t.TCheckGroup.isPrototypeOf(this.FParent)||(e.style.setProperty("margin-top","0px"),e.style.setProperty("margin-bottom","0px"))),n=null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&1===s.FCSSLibrary,(""===this.FElementLabelClassName||n)&&((i=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),i.style.setProperty("min-height","100%"),i.style.setProperty("height","100%"),i.style.setProperty("position","absolute"),i.style.setProperty("overflow","hidden"),i.style.setProperty("display","inline-flex"),i.style.setProperty("align-items","center")))))},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),e.setAttribute("TYPE","CHECKBOX"),e.setAttribute("id",this.GetID()+"ck"),e.setAttribute("role","checkbox"),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),rtl.asExt(e,HTMLInputElement).onclick=rtl.createSafeCallback(this,"HandleCheckClick"),t},this.SetChecked=function(t){this.FChecked=t,this.FState=t?0:2,this.UpdateElement()},this.GetChecked=function(){var t=null;return null!=this.GetContainer()&&null!=(t=this.GetCheckElement())&&(this.FChecked=t.checked),this.FChecked},this.SetState=function(t){this.FState=t,this.FChecked=0===this.FState,this.UpdateElement()},this.GetState=function(){return this.FState},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetContainer()&&(this.GetIsLinked()?null!=this.GetContainer().lastElementChild&&"SPAN"===this.GetContainer().lastElementChild.tagName&&(this.GetContainer().lastElementChild.innerHTML=t):null!=this.GetContainer().lastElementChild&&(this.GetContainer().lastElementChild.innerHTML=t)))},this.SetEnabled=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&null!=(e=this.GetCheckElement())&&(e.disabled=!t)},this.HandleLabelClick=function(t){var e=null;return null!=this.GetContainer()&&this.FEnabled&&((e=this.GetCheckElement()).checked=!e.checked,this.SetChecked(e.checked)),this.DoCheckClick(),!0,!0},this.HandleCheckClick=function(t){return this.DoCheckClick(),!0,!0},this.Click=function(){pas["WEBLib.Controls"].TControl.Click.call(this),this.FChecked=this.GetChecked(),this.FChecked?this.FState=0:this.FState=2,this.SetFocus()},this.DoCheckClick=function(){null!=this.FOnCheckClick&&this.FOnCheckClick(this)},this.GetCheckElement=function(){return this.GetIsLinked()&&"INPUT"===this.GetElementHandle().tagName?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){var e=null;pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&(null==this.GetContainer()||this.GetIsLinked()||((e=this.GetCheckElement()).checked=!e.checked))},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("custom-control custom-checkbox"),this.FElementButtonClassName="custom-control-input",this.FElementLabelClassName="custom-control-label",this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),this.FChecked=!1,this.FState=2,this.SetAlignment(1),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetShowFocus(!0)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taRightJustify}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("State",3,t.$rtti.TCheckBoxState,"GetState","SetState",{Default:t.TCheckBoxState.cbUnchecked}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TRadioButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FGroupName="",this.FElementButtonClassName="",this.FElementLabelClassName=""},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),t.addEventListener("click",rtl.createSafeCallback(this,"HandleLabelClick")),e.setAttribute("TYPE","RADIO"),e.setAttribute("id",this.GetID()+"rd"),e.setAttribute("name",this.FGroupName),e.setAttribute("role","radio"),e.setAttribute("tabindex","-1"),e.addEventListener("click",rtl.createSafeCallback(this,"HandleRadioClick")),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),t},this.SetChecked=function(t){var e=null;this.FChecked=t,null!=this.GetContainer()&&null!=(e=this.GetRadioElement())&&(e.checked=t)},this.GetChecked=function(){var t=!1,e=null;return t=this.FChecked,null!=this.GetContainer()&&null!=(e=this.GetRadioElement())&&(t=e.checked),t},this.SetEnabled=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&null!=(e=this.GetRadioElement())&&(e.disabled=!t)},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().lastElementChild.innerHTML=t))},this.SetGroupName=function(t){this.FGroupName=t,this.UpdateElementData()},this.HandleLabelClick=function(t){return null!=this.GetContainer()&&this.FEnabled&&(this.GetRadioElement().checked=!0),!0,!0},this.HandleRadioClick=function(t){return this.SetFocus(),!0,!0},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(this.GetIsLinked()?this.GetElementHandle().setAttribute("name",this.FGroupName):(this.GetContainer().firstElementChild.setAttribute("name",this.FGroupName),(t=this.GetElementHandle().firstChild).disabled=!this.FEnabled),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.FTabStop&&null!=t&&t.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementVisual=function(){var e=null,i=null,s=!1,n=null;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||((e=this.GetElementHandle().firstChild).style.setProperty("margin-right","4px"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("margin-top","0px"),null!=e&&(""!==this.FElementButtonClassName?e.setAttribute("class",this.FElementButtonClassName):e.removeAttribute("class")),null!=(i=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?i.setAttribute("class",this.FElementLabelClassName):i.removeAttribute("class"))),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),this.GetElementHandle().style.setProperty("white-space","normal"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(e.style.setProperty("float","left"),2!==this.FHeightStyle?e.style.setProperty("height","100%"):e.style.removeProperty("height"),e.style.setProperty("vertical-align","middle"),t.TRadioGroup.isPrototypeOf(this.FParent)||(e.style.setProperty("margin-top","0px"),e.style.setProperty("margin-bottom","0px"))),s=null!=(n=pas["WEBLib.Forms"].GetParentForm(this))&&1===n.FCSSLibrary,(""===this.FElementLabelClassName||s)&&((i=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),i.style.setProperty("min-height","100%"),i.style.setProperty("height","100%"),t.TRadioGroup.isPrototypeOf(this.FParent)||i.style.setProperty("position","absolute"),i.style.setProperty("overflow","hidden"),i.style.setProperty("display","inline-flex"),i.style.setProperty("align-items","center")))))},this.GetRadioElement=function(){return this.GetIsLinked()?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&(this.GetRadioElement().checked=!0)},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-control"),this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.FGroupName="",this.SetShowFocus(!0)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("GroupName",2,rtl.string,"FGroupName","SetGroupName"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.TComboBoxStyle={0:"csDropDownList",csDropDownList:0,1:"csDropDown",csDropDown:1},this.$rtti.$Enum("TComboBoxStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TComboBoxStyle}),rtl.createClass(this,"TCustomComboBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FItems=null,this.FItemIndex=0,this.FStyle=0,this.FOnChange=null,this.FTextHint="",this.FListName="",this.FText="",this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandleFocusInPtr=null,this.FHandleFocusOutPtr=null,this.FOnFocusOut=null,this.FOnFocusIn=null,this.FRequired=!1,this.FRequiredText="",this.FHandleInvalidPtr=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,this.FOnFocusOut=void 0,this.FOnFocusIn=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){var t="",e=null,i="",s="";return t="",1===this.FStyle?null!=this.GetElementHandle()&&(t=this.GetElementHandle().value):this.GetItemIndex()>=0&&(this.GetItemIndex()<this.FItems.GetCount()?(this.FItems.GetNameValue(this.GetItemIndex(),{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),t=""!==i&&""!==s?i:this.FItems.Get(this.GetItemIndex())):this.GetIsLinked()&&this.GetItemIndex()<this.GetElementHandle().childElementCount&&"OPTION"===(e=this.GetElementHandle().children.item(this.GetItemIndex())).tagName&&(t=e.innerHTML)),t},this.SetText=function(t){var e=0,i="",s="";if(1===this.FStyle)this.FText=t,this.UpdateElement();else for(var n=0,r=this.FItems.GetCount()-1;n<=r;n++)e=n,this.FItems.GetNameValue(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),t!==this.FItems.Get(e)&&t!==i||this.SetItemIndex(e)},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,this.GetIsLinked()||this.RecreateElement())},this.GetElementSelectHandle=function(){return this.GetContainer()},this.SetTextHint=function(t){this.FTextHint!==t&&(this.FTextHint=t,this.DoUpdateList())},this.SetRequired=function(t){this.FRequired!==t&&(this.FRequired=t,this.UpdateElement())},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementHandle().setCustomValidity(""),!0,!0},this.DoHandleInput=function(t){return 1===this.FStyle&&this.Change(),!0,!0},this.DoHandleFocusIn=function(t){return null!=this.FOnFocusIn&&this.FOnFocusIn(this),!0,!0},this.DoHandleFocusOut=function(t){return null!=this.FOnFocusOut&&this.FOnFocusOut(this),!0,!0},this.DoHandleInvalid=function(t){return this.GetElementHandle().setCustomValidity(this.FRequiredText),!0,!0},this.DoItemsChange=function(t){this.DoUpdateList()},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandleFocusInPtr=rtl.createCallback(this,"DoHandleFocusIn"),this.FHandleFocusOutPtr=rtl.createCallback(this,"DoHandleFocusOut"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.AddTextHint=function(){var t=null;""!==this.FTextHint&&0===this.FStyle&&((t=document.createElement("OPTION")).setAttribute("value",""),t.setAttribute("disabled","true"),t.setAttribute("selected","true"),t.setAttribute("hidden","true"),t.innerHTML=this.FTextHint,this.GetContainer().appendChild(t))},this.DoUpdateList=function(){var t=0,e=0,i="",s="",n="",r=null,o=null;if(null!=this.GetContainer()){if("INPUT"===this.GetElementHandle().tagName){this.GetElementHandle().value=this.GetText(),null!=(o=document.getElementById(this.FName+"_LIST"))&&o.parentNode.removeChild(o),""!==this.FTextHint&&(this.GetElementHandle().placeholder=this.FTextHint),(o=document.createElement("DATALIST")).setAttribute("id",this.FListName),document.body.appendChild(o);for(var a=0,l=this.FItems.GetCount()-1;a<=l;a++)t=a,i=this.FItems.Get(t),r=document.createElement("OPTION"),s=i,n=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(n=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),r.setAttribute("value",s),r.innerHTML=n,o.appendChild(r)}else{if("SELECT"!==this.GetElementHandle().tagName)return;for(var h=this.GetContainer().options.length-1;h>=0;h--)t=h,this.GetContainer().remove(t);this.AddTextHint();for(var u=0,d=this.FItems.GetCount()-1;u<=d;u++)t=u,i=this.FItems.Get(t),r=document.createElement("OPTION"),s=i,n=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(n=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),r.setAttribute("value",s),r.innerHTML=n,this.GetContainer().appendChild(r)}this.UpdateElement()}},this.GetItemIndex=function(){var t=0;return 1===this.FStyle?t=this.FItems.IndexOf(this.GetText()):(t=this.FItemIndex,null!=this.GetContainer()&&(t=this.GetContainer().selectedIndex,""!==this.FTextHint&&(t-=1))),t},this.CreateElement=function(){var t=null;return 0===this.FStyle?t=document.createElement("SELECT"):(t=document.createElement("INPUT"),this.FListName=this.FName+"_LIST",t.setAttribute("list",this.FListName)),t},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementHandle().addEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().addEventListener("focusout",this.FHandleFocusOutPtr),this.GetElementHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementHandle().removeEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().removeEventListener("focusout",this.FHandleFocusOutPtr),this.GetElementHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.UpdateElementData=function(){var t=0;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),this.FRequired?this.GetElementHandle().setAttribute("required",""):this.GetIsLinked()||this.GetElementHandle().removeAttribute("required"),1===this.FStyle?null!=this.GetElementHandle()&&(this.GetElementHandle().value=this.FText,this.FListName=this.FName+"_LIST",this.GetElementHandle().setAttribute("list",this.FListName)):null!=this.GetElementSelectHandle()&&(t=0,""!==this.FTextHint&&(t=1),this.GetElementSelectHandle().selectedIndex=this.FItemIndex+t,this.GetElementSelectHandle().setAttribute("role","combobox"))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this)},this.UpdateParent=function(){pas["WEBLib.Controls"].TControl.UpdateParent.call(this),this.DoUpdateList()},this.SetItems=function(t){this.FItems.Assign(t)},this.SetItemIndex=function(t){this.FItemIndex!==t&&(this.FItemIndex=t,t>=0&&this.FStyle in rtl.createSet(1,0)&&t<this.FItems.GetCount()&&(this.FText=this.FItems.Get(t)),this.UpdateElement())},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.Change=function(){this.FItemIndex=this.GetItemIndex(),null!=this.FOnChange&&this.FOnChange(this)},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-select"),this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FItemIndex=-1,this.FStyle=0,this.SetShowFocus(!0),this.SetHeight(25)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Clear=function(){this.FItems.Clear()},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TComboBox",this.TCustomComboBox,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("OnFocusIn",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFocusIn","FOnFocusIn"),e.addProperty("OnFocusOut",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFocusOut","FOnFocusOut"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Style",2,t.$rtti.TComboBoxStyle,"FStyle","SetStyle"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebComboBox",this.TComboBox,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomMemo",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FWordWrap=!1,this.FBlockChange=!1,this.FLines=null,this.FSelStart=0,this.FSelLength=0,this.FAutoSize=!1,this.FOnChange=null,this.FReadOnly=!1,this.FTextHint="",this.FHandleChangePtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleInputPtr=null,this.FHandleInvalidPtr=null,this.FWantTabs=!1,this.FAutoCompletion=0,this.FSpellCheck=!1,this.FModified=!1,this.FScrollbars=0,this.FRequiredText="",this.FRequired=!1},this.$final=function(){this.FLines=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){return null!=this.GetElementInputHandle()&&(this.FBlockChange=!0,this.FLines.SetTextStr(this.GetElementInputHandle().value),this.FBlockChange=!1),this.FLines.GetTextStr()},this.SetText=function(t){this.FLines.SetTextStr(t)},this.SetSelLength=function(t){this.FSelLength!==t&&(this.FSelLength=t,this.UpdateElement())},this.SetSelStart=function(t){this.FSelStart!==t&&(this.FSelStart=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.SetScrollBars=function(t){this.FScrollbars!==t&&(this.FScrollbars=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired!==t&&(this.FRequired=t,this.UpdateElement())},this.IsInputControl=function(){return!0,!0},this.HandleDoKeyDown=function(t){var e=!1,i=null,s=null;if(s=t,9===this.GetKeyCode(s.key,!0)&&this.FWantTabs){var n=(i=this.GetElementInputHandle()).selectionStart,r=i.selectionEnd;i.value=i.value.substring(0,n)+"\t"+i.value.substring(r),i.selectionStart=i.selectionEnd=n+1,s.stopPropagation(),s.preventDefault()}else pas["WEBLib.Controls"].TControl.HandleDoKeyDown.apply(this,arguments);return e},this.CreateElement=function(){return document.createElement("TEXTAREA")},this.DoHandlePaste=function(t){var e="",i=!1;i=!1;var s=t.clipboardData||window.clipboardData;return s&&(e=s.getData("Text"),i=!0),i&&!this.CanPaste(e)&&(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleInput=function(t){return this.GetText(),this.Change(),this.FAutoSize&&this.DoAutoSize(),!0,!0},this.DoHandleChange=function(t){return this.FModified=!0,this.Change(),""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0,!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.IsReadOnly=function(){return this.FReadOnly},this.GetDisplayText=function(){return this.FLines.GetTextStr()},this.DoAutoSize=function(){var t,e=0;this.GetElementInputHandle().style.setProperty("overflow","hidden"),this.GetElementInputHandle().style.setProperty("height","auto"),t=this.GetElementInputHandle(),e=t.scrollHeight,this.GetElementInputHandle().style.setProperty("height",pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}})+"px")},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.UpdateElementData=function(){var e=0,i=0,s=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null==this.GetElementInputHandle()||this.FBlockChange||(this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("required"),this.GetElementInputHandle().value=this.GetDisplayText(),"TEXTAREA"===this.GetElementInputHandle().tagName&&this.GetElementInputHandle().setSelectionRange(this.GetSelStart(),this.GetSelStart()+this.GetSelLength()),this.GetIsLinked()||this.GetElementInputHandle().style.setProperty("resize","none"),this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),this.GetIsLinked()||(51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","none"),this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetIsLinked()||this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetIsLinked()||this.GetElementInputHandle().removeAttribute("name")),e=this.FSelStart,i=this.FSelStart+this.FSelLength,s=this.GetElementInputHandle(),setTimeout((function(){s.setSelectionRange(e,i)}),1)))},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementInputHandle()&&!this.FBlockChange&&!this.GetIsLinked()){if(this.FAutoSize)this.GetElementInputHandle().style.setProperty("overflow","hidden"),this.GetElementInputHandle().style.setProperty("height","auto");else{this.GetElementInputHandle().style.setProperty("overflow","auto");var t=this.FScrollbars;0===t?this.GetElementInputHandle().style.setProperty("overflow","hidden"):2===t?(this.GetElementInputHandle().style.removeProperty("overflow"),this.GetElementInputHandle().style.setProperty("overflow-x","hidden"),this.GetElementInputHandle().style.setProperty("overflow-y","auto")):1===t?(this.GetElementInputHandle().style.removeProperty("overflow"),this.GetElementInputHandle().style.setProperty("overflow-x","auto"),this.GetElementInputHandle().style.setProperty("overflow-y","hidden")):3===t&&this.GetElementInputHandle().style.setProperty("overflow","auto")}this.GetElementInputHandle().style.setProperty("margin","0"),-1!==this.FColor&&16711422!==this.FColor?this.GetElementInputHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)):this.GetElementInputHandle().style.removeProperty("background-color"),this.FSpellCheck?this.GetElementInputHandle().hasAttribute("spellcheck")&&this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),this.FWordWrap?this.GetElementInputHandle().hasAttribute("wrap")&&this.GetElementInputHandle().removeAttribute("wrap"):this.GetElementInputHandle().setAttribute("wrap","off")}},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),this.FAutoSize&&this.DoAutoSize()},this.SetLines=function(t){this.FLines.Assign(t)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.DoLinesChange=function(t){null==this.GetElementInputHandle()||this.FBlockChange||(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.InitCSSLibrary=function(t){1===t&&(this.SetElementFont(1),this.SetElementClassName("form-control"))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FSpellCheck=!0,this.FLines=pas.Classes.TStringList.$create("Create$1"),this.FLines.SetSkipLastLineBreak(!0),this.FLines.FOnChange=rtl.createCallback(this,"DoLinesChange"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300)),this.SetShowFocus(!0),this.SetClipChildren(!1),this.FWantTabs=!1,this.FAutoSize=!1,this.FAutoCompletion=0,this.FWordWrap=!0,this.FScrollbars=3,this.FNoUserSelect=!1},this.Destroy=function(){rtl.free(this,"FLines"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TMemo",this.TCustomMemo,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize"),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Lines",2,pas.Classes.$rtti.TStrings,"FLines","SetLines"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),t.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),t.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("SelStart",3,rtl.longint,"GetSelStart","SetSelStart"),t.addProperty("SelLength",3,rtl.longint,"GetSelLength","SetSelLength"),t.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("Spellcheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebMemo",this.TMemo,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlGroup",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FControls$1=null,this.FOldCount=0,this.FColumns=0,this.FItems=null,this.FOnChange=null,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FElementGroupClassName="",this.FControlPosition=0,this.FElementLegendClassName=""},this.$final=function(){this.FControls$1=void 0,this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetControlPosition=function(t){this.FControlPosition!==t&&(this.FControlPosition=t,this.DoUpdateList())},this.CreateElement=function(){var t=null,e=null;return t=document.createElement("FIELDSET"),e=document.createElement("LEGEND"),t.appendChild(e),e.innerHTML=this.FCaption,e.setAttribute("class","w-auto "+this.FElementLegendClassName),""===this.FCaption?e.style.setProperty("display","none"):e.style.setProperty("display",""),e.style.setProperty("float","none"),t.style.setProperty("display","inline-block"),t.style.setProperty("-webkit-padding-before","0px"),t.style.setProperty("-webkit-padding-after","0px"),t.style.setProperty("-webkit-padding-end","0px"),t.style.setProperty("-webkit-padding-start","0px"),t.style.setProperty("border","1px"),t},this.DoHandleClick=function(t){this.Change()},this.DoItemsChange=function(t){this.DoUpdateList()},this.DoControlClick=function(t){this.DoHandleClick(rtl.as(t,pas["WEBLib.Controls"].TCustomControl))},this.SetCaption=function(t){var e=null;pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetContainer()&&null!=(e=this.GetContainer().firstElementChild)&&(e.innerHTML=t,""===t?e.style.setProperty("display","none"):e.style.setProperty("display",""))},this.SetColumns=function(t){this.FColumns>0&&this.FColumns!==t&&(this.FColumns=t,this.DoUpdateList())},this.SetItems=function(t){this.FItems.Assign(t),this.DoUpdateList()},this.DoUpdateList=function(){var e,i,s=0,n="",r=null,o=0,a=0,l=0,h=0,u=null,d=[];if(null!=this.GetContainer()&&0!==this.FItems.GetCount()){i=Math.round(2.5*this.FFont.FSize),e=rtl.trunc(this.GetWidth()/this.FColumns),o=""!==this.FCaption?this.FFont.FSize:4,a=0,l=0,this.FOldCount>0&&(d=rtl.arraySetLength(d,!1,this.FOldCount));for(var F=0,c=this.FOldCount-1;F<=c;F++)s=F,r=rtl.getObject(this.FControls$1.Get(s)),t.TRadioButton.isPrototypeOf(r)&&(d[s]=rtl.as(r,t.TRadioButton).GetChecked()),t.TCheckBox.isPrototypeOf(r)&&(d[s]=rtl.as(r,t.TCheckBox).GetChecked()),r=rtl.freeLoc(r);for(this.FControls$1.Clear();this.GetContainer().childElementCount>0;)this.GetContainer().removeChild(this.GetContainer().firstChild);""!==this.FCaption&&(u=document.createElement("LEGEND"),this.GetElementHandle().appendChild(u),u.innerHTML=this.FCaption,u.setAttribute("class","w-auto "+this.FElementLegendClassName),u.style.setProperty("float","none"),pas["WEBLib.Controls"].SetHTMLElementFont(u,this.FFont,!(0===this.FElementFont&&""===this.FElementClassName))),""!==this.FElementGroupClassName?this.GetElementHandle().setAttribute("class",this.FElementGroupClassName):this.GetElementHandle().setAttribute("class","border p-2"),this.GetContainer().style.setProperty("margin","0px");for(var p=0,C=this.FItems.GetCount()-1;p<=C;p++)s=p,h=o+l*i,n=this.FItems.Get(s),(r=this.CreateGroupControl(4+a*e,h,s,n,this.FControlPosition,this.GetGroupControlState(s),!0)).SetEnabled(this.FEnabled),this.FControls$1.Add(r),s<=this.FOldCount&&(t.TRadioButton.isPrototypeOf(r)&&rtl.as(r,t.TRadioButton).SetChecked(d[s]),t.TCheckBox.isPrototypeOf(r)&&rtl.as(r,t.TCheckBox).SetChecked(d[s])),this.GetIsLinked()||(r.GetContainer().style.setProperty("float","left"),r.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(pas.System.Trunc(100/this.FColumns)-5)+"%"),this.FTabStop?(r.GetContainer().setAttribute("tabindex",pas.SysUtils.TIntegerHelper.ToString$1.call({p:this,get:function(){return this.p.FTabOrder},set:function(t){this.p.FTabOrder=t}})),this.GetContainer().setAttribute("tabindex","-1")):r.GetContainer().setAttribute("tabindex","-1")),s%this.FColumns==0&&r.GetContainer().style.setProperty("clear","left"),this.GetElementHandle().appendChild(r.GetContainer()),a<this.FColumns-1?a+=1:(a=0,l+=1);this.FOldCount=this.FItems.GetCount()}},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.FontChanged=function(){pas["WEBLib.Controls"].TControl.FontChanged.call(this),this.DoUpdateList()},this.CreateGroupControl=function(t,e,i,s,n,r,o){return null,null},this.GetGroupControlState=function(t){return!1,!1},this.GetGroupControl=function(t){return rtl.getObject(this.FControls$1.Get(t))},this.SetEnabled=function(t){var e=0;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments);for(var i=0,s=this.FControls$1.GetCount()-1;i<=s;i++)e=i,rtl.getObject(this.FControls$1.Get(e)).SetEnabled(t)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FColumns=1,this.FControls$1=pas.Classes.TList.$create("Create$1"),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FOldCount=-1,this.FControlPosition=0,4 in this.FComponentState&&(this.SetWidth(200),this.SetHeight(200))},this.Destroy=function(){rtl.free(this,"FControls$1"),rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},this.SetHeight=function(t){pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),this.DoUpdateList()},this.SetWidth=function(t){pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.DoUpdateList()},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns"),e.addProperty("ControlPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FControlPosition","SetControlPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementGroupClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementGroupClassName","FElementGroupClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementLegendClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLegendClassName","FElementLegendClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TRadioGroup",this.TControlGroup,(function(){this.$init=function(){t.TControlGroup.$init.call(this),this.FItemIndex=0,this.FOldItemIndex=0},this.DoHandleClick=function(t){this.GetItemIndex()!==this.FOldItemIndex&&(this.Change(),this.FOldItemIndex=this.GetItemIndex())},this.GetItemIndex=function(){var t=0,e=null,i=0;t=this.FItemIndex;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)i=s,null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(i)+"rd"))&&e.checked&&(t=i);return t},this.SetItemIndex=function(t){var e=null;-1===t&&this.GetItemIndex()>=0?(null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(this.GetItemIndex())+"rd"))&&(e.checked=!1),this.FItemIndex=-1):(this.FItemIndex=t,t>=0&&t<this.FItems.GetCount()&&null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(t)+"rd"))&&(e.checked=!0))},this.CreateGroupControl=function(e,i,s,n,r,o,a){var l=null,h="";return""===(h=this.GetID())&&(h=this.FName),(l=t.TRadioButton.$create("Create$2",[h+pas.SysUtils.IntToStr(s)])).SetElementPosition(r),l.SetElementFont(this.FElementFont),l.SetElementClassName(this.FElementClassName),l.FElementButtonClassName=this.FElementButtonClassName,l.FElementLabelClassName=this.FElementLabelClassName,l.SetHeightStyle(2),l.SetParentFont(!1),l.FFont.Assign(this.FFont),l.SetParent(this),l.SetCaption(n),l.SetGroupName(h),l.SetTop(i),l.SetLeft(e),l.SetWidthStyle(2),l.SetWidthPercent(100),l.FOnClick=rtl.createCallback(this,"DoControlClick"),l.SetChecked(o),l.SetEnabled(a),l.FTag$1=s,l.SetTabStop(!0),l},this.GetGroupControlState=function(t){return t===this.FItemIndex},this.CreateInitialize=function(){t.TControlGroup.CreateInitialize.call(this),this.FItemIndex=-1,this.FOldItemIndex=-2},this.SetFocus=function(){var t=0,e=null;0!==this.FItems.GetCount()&&((t=this.GetItemIndex())<0&&(t=0),null!=(e=this.GetGroupControl(t))&&e.SetFocus())},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex")})),this.$rtti.$MethodVar("TCheckClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AIndex",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TCheckGroup",this.TControlGroup,(function(){this.$init=function(){t.TControlGroup.$init.call(this),this.FOnCheckClick=null},this.$final=function(){this.FOnCheckClick=void 0,t.TControlGroup.$final.call(this)},this.DoHandleClick=function(e){t.TControlGroup.DoHandleClick.apply(this,arguments),null!=this.FOnCheckClick&&this.FOnCheckClick(this,e.FTag$1)},this.CreateGroupControl=function(e,i,s,n,r,o,a){var l=null,h="";return""===(h=this.GetID())&&(h=this.FName),(l=t.TCheckBox.$create("Create$2",[h+pas.SysUtils.IntToStr(s)])).SetCaption(n),l.SetElementPosition(r),l.SetElementFont(this.FElementFont),l.SetElementClassName(this.FElementClassName),l.FElementButtonClassName=this.FElementButtonClassName,l.FElementLabelClassName=this.FElementLabelClassName,l.SetParentFont(!1),l.FFont.Assign(this.FFont),l.SetParent(this),l.SetTop(i),l.SetLeft(e),l.SetWidthStyle(0),l.SetWidthPercent(100),l.SetHeightStyle(2),l.FOnCheckClick=rtl.createCallback(this,"DoControlClick"),l.SetChecked(o),l.SetEnabled(a),l.FTag$1=s,l.SetTabStop(!0),l},this.GetGroupControlState=function(t){return!1,!1},this.CreateInitialize=function(){t.TControlGroup.CreateInitialize.call(this)},this.SetFocus=function(){var t=null;this.FItems.GetCount()>0&&null!=(t=this.GetGroupControl(0))&&t.SetFocus()},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("OnCheckClick",0,t.$rtti.TCheckClickEvent,"FOnCheckClick","FOnCheckClick")})),this.GetAutoCompletionName=function(t){var e="";return 0===t?e="":1===t?e="honorific-prefix":2===t?e="given-name":3===t?e="additional-name":4===t?e="family-name":5===t?e="honorific-suffix":6===t?e="nickname":7===t?e="email":8===t?e="username":9===t?e="new-password":10===t?e="current-password":11===t?e="organization-title":12===t?e="organization":13===t?e="street-address":14===t?e="address-line1":15===t?e="address-line2":16===t?e="address-line3":17===t?e="address-level1":18===t?e="address-level2":19===t?e="address-level3":20===t?e="address-level4":21===t?e="country":22===t?e="country-name":23===t?e="postal-code":24===t?e="cc-name":25===t?e="cc-given-name":26===t?e="cc-additional-name":27===t?e="cc-family-name":28===t?e="cc-number":29===t?e="cc-exp":30===t?e="cc-exp-month":31===t?e="cc-exp-year":32===t?e="cc-csc":33===t?e="cc-type":34===t?e="transaction-currency":35===t?e="transaction-amount":36===t?e="language":37===t?e="bday":38===t?e="bday-day":39===t?e="bday-month":40===t?e="bday-year":41===t?e="sex":42===t?e="tel":43===t?e="tel-country-code":44===t?e="tel-national":45===t?e="tel-area-code":46===t?e="tel-local":47===t?e="tel-extension":48===t?e="impp":49===t?e="url":50===t?e="photo":52===t&&(e="nope"),e}})),rtl.module("WEBLib.Imaging.pngImage",["System"],(function(){"use strict";this.$init=function(){}})),rtl.module("WEBLib.ExtCtrls",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.Graphics","Web","JS","WEBLib.WebTools","WEBLib.Menus","WEBLib.REST"],(function(){"use strict";var t=this;rtl.createClass(this,"TCustomPanel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FAutoSize=!1,this.FIsSizing=!1,this.FPadding=null,this.FShowCaption=!1,this.FLabel=null,this.FPanelBody=null,this.FElementBodyClassName="",this.FAlignment=0},this.$final=function(){this.FPadding=void 0,this.FLabel=void 0,this.FPanelBody=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetShowCaption=function(t){this.FShowCaption!==t&&(this.FShowCaption=t,this.UpdateElementVisual())},this.SetPadding=function(t){this.FPadding.Assign(t),this.Realign()},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElement())},this.CreateElement=function(){var t=null;return t=document.createElement("SPAN"),this.FPanelBody=document.createElement("DIV"),this.FPanelBody.setAttribute("class","card-body"),t.appendChild(this.FPanelBody),t},this.SetCaption=function(t){pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetElementHandle()&&this.FShowCaption&&(null==this.FLabel?(this.FLabel=document.createElement("SPAN"),this.FLabel.innerHTML=this.FCaption,null!=this.GetChildContainer()?this.GetChildContainer().appendChild(this.FLabel):this.GetElementHandle().appendChild(this.FLabel),this.UpdateElementVisual()):this.FLabel.innerHTML=this.FCaption)},this.SetBorderStyle=function(t){pas["WEBLib.Controls"].TCustomControl.SetBorderStyle.apply(this,arguments),this.UpdateElement()},this.SetAutoSize=function(t){this.FAutoSize=t,this.FAutoSize&&!this.IsUpdating()&&this.DoAutoSize()},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()){if(this.GetIsLinked()||(this.FAutoSize?(this.GetElementHandle().style.setProperty("overflow",""),this.GetElementHandle().style.setProperty("white-space","normal"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline")):(this.GetElementHandle().style.setProperty("overflow","hidden"),this.GetElementHandle().style.setProperty("white-space","nowrap"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline-block")),this.GetElementHandle().style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FPadding.FLeft)+"px"),this.GetElementHandle().style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FPadding.FRight)+"px"),this.GetElementHandle().style.setProperty("padding-top",pas.SysUtils.IntToStr(this.FPadding.FTop)+"px"),this.GetElementHandle().style.setProperty("padding-bottom",pas.SysUtils.IntToStr(this.FPadding.FBottom)+"px"),this.GetElementHandle().style.setProperty("box-sizing","border-box"),""!==this.FElementBodyClassName?this.GetChildContainer().setAttribute("class",this.FElementBodyClassName):this.GetChildContainer().removeAttribute("class")),null!=this.FLabel&&(this.FShowCaption?this.FLabel.innerHTML=this.FCaption:this.FLabel.innerHTML="",this.FVisible)){this.GetElementHandle().style.setProperty("display","flex");var t=this.FAlignment;0===t?this.GetElementHandle().style.setProperty("justify-content","flex-start"):2===t?this.GetElementHandle().style.setProperty("justify-content","center"):1===t&&this.GetElementHandle().style.setProperty("justify-content","flex-end"),this.GetElementHandle().style.setProperty("align-items","center")}this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor","")}},this.GetOuterWidth=function(){return pas["WEBLib.Controls"].TControl.GetOuterWidth.call(this)},this.GetOuterHeight=function(){return pas["WEBLib.Controls"].TControl.GetOuterHeight.call(this)},this.GetChildContainer=function(){return null!=this.FPanelBody?this.FPanelBody:pas["WEBLib.Controls"].TControl.GetChildContainer.call(this)},this.RegisterParent=function(t){pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.UnRegisterParent=function(t){pas["WEBLib.Controls"].TControl.UnRegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.UpdatePadding=function(t){t.Left=this.FPadding.FLeft,t.Top=this.FPadding.FTop,t.Right=t.Right-this.FPadding.FRight,t.Bottom=t.Bottom-this.FPadding.FBottom},this.DoAutoSize=function(){var t=0,e=0,i=0,s=0,n=0,r=null,o=null;if(!this.FIsSizing){if(this.FIsSizing=!0,1===this.FWidthStyle&&1===this.FHeightStyle){s=0,n=0,e=65535,i=65535;for(var a=0,l=this.GetControlsCount()-1;a<=l;a++)t=a,1===this.GetControls(t).FWidthStyle?(this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()>s&&(s=this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()),this.GetControls(t).GetLeft()<e&&(e=this.GetControls(t).GetLeft())):null!=(o=this.GetControls(t).GetElementHandle())&&((r=o.getBoundingClientRect()).x-this.GetLeft()+r.width>s&&(s=Math.round(r.x-this.GetLeft()+r.width)),e=0),1===this.GetControls(t).FHeightStyle?(this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()>n&&(n=this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()),this.GetControls(t).GetTop()<i&&(i=this.GetControls(t).GetTop())):null!=(o=this.GetControls(t).GetElementHandle())&&((r=o.getBoundingClientRect()).y-this.GetTop()+r.height>n&&(n=Math.round(r.y-this.GetTop()+r.height)),i=0);if(4 in this.FComponentState&&(0===this.GetControlsCount()||0===s||0===n))return;1===this.FBorderStyle&&(s+=1,n+=1);for(var h=0,u=this.GetControlsCount()-1;h<=u;h++)t=h,this.GetControls(t).SetLeft(this.GetControls(t).GetLeft()-e),this.GetControls(t).SetTop(this.GetControls(t).GetTop()-i);this.SetWidth(s-e),this.SetHeight(n-i)}else this.SetWidth(-1),this.SetHeight(-1);this.UpdateElement(),this.FIsSizing=!1}},this.AlignControl=function(t){pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&(this.FEnablePropagation=!0),this.FAutoSize=!1,this.FAlignment=2,this.SetColor(15790320),this.SetTabStop(!1),this.FCustomBorder=!0,this.SetShowCaption(!0),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.FLabel=null,this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FPadding"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.FAutoSize&&this.SetAutoSize(!0)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TPanel",this.TCustomPanel,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taCenter}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),t.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("Center",0,pas["WEBLib.Controls"].$rtti.TCenter,"FCenter",""),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementBodyClassName","FElementBodyClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","SetPadding"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ShowCaption",2,rtl.boolean,"FShowCaption","SetShowCaption",{Default:!0}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),t.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),t.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),t.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),t.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel")})),rtl.createClass(this,"TCustomGroupBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FCaption$1="",this.FLegend=null,this.FFieldSet=null,this.FElementLegendClassName="",this.FPadding=null},this.$final=function(){this.FLegend=void 0,this.FFieldSet=void 0,this.FPadding=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetElementLegendClassName=function(t){this.FElementLegendClassName!==t&&(this.FElementLegendClassName=t,this.UpdateElementVisual())},this.UpdatePadding=function(t){t.Left=this.FPadding.FLeft,t.Top=this.FPadding.FTop,t.Right=t.Right-this.FPadding.FRight,t.Bottom=t.Bottom-this.FPadding.FBottom},this.SetFieldSetSize=function(){var t=0,e=0;null!=this.FFieldSet&&(t=4,e=2,""===this.FElementClassName&&""===this.FElementLegendClassName||(t=0,e=0),1===this.FWidthStyle?this.FFieldSet.style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth()-t)+"px"):this.FFieldSet.style.setProperty("width","90%"),1===this.FHeightStyle?this.FFieldSet.style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight()-e)+"px"):this.FFieldSet.style.setProperty("height","90%"))},this.SetCaption=function(t){this.FCaption$1!==t&&(this.FCaption$1=t,this.UpdateElementData())},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FFieldSet=document.createElement("FIELDSET"),t.appendChild(this.FFieldSet),this.FLegend=document.createElement("LEGEND"),this.FFieldSet.appendChild(this.FLegend),this.FLegend.innerHTML=this.FCaption$1,t},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.FLegend&&(this.FLegend.innerHTML=this.FCaption$1)},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().style.removeProperty("background-color"),null!=this.FLegend&&(this.FLegend.setAttribute("class","w-auto "+this.FElementLegendClassName),this.FLegend.style.setProperty("float","none")),null!=this.FFieldSet&&(this.FFieldSet.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)),this.FFieldSet.style.setProperty("overflow","visible"),this.SetFieldSetSize(),this.FFieldSet.style.setProperty("white-space","nowrap"),this.FFieldSet.style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FPadding.FLeft)+"px"),this.FFieldSet.style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FPadding.FRight)+"px"),this.FFieldSet.style.setProperty("padding-top",pas.SysUtils.IntToStr(this.FPadding.FTop)+"px"),this.FFieldSet.style.setProperty("padding-bottom",pas.SysUtils.IntToStr(this.FPadding.FBottom)+"px"),this.FVisible&&this.FFieldSet.style.setProperty("display","inline-block"),this.FFieldSet.style.setProperty("webkit-user-select","none"),this.FFieldSet.style.setProperty("moz-user-select","none"),this.FFieldSet.style.setProperty("khtml-user-select","none"),this.FFieldSet.style.setProperty("ms-user-select","none"),this.FFieldSet.style.setProperty("user-select","none"),this.FFieldSet.style.setProperty("border","1px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor)))},this.SetBoundsInt=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBoundsInt.apply(this,arguments),this.SetFieldSetSize()},this.InitCSSLibrary=function(t){1===t&&this.SetElementLegendClassName("h6")},this.Destroy=function(){rtl.free(this,"FPadding"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FEnablePropagation=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetColor(15790320),this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TGroupBox",this.TCustomGroupBox,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),t.addProperty("Caption",2,rtl.string,"FCaption$1","SetCaption"),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementLegendClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLegendClassName","SetElementLegendClassName"),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),t.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),t.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),t.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),t.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel")})),this.TVerticalAlignment={0:"vaTop",vaTop:0,1:"vaCenter",vaCenter:1,2:"vaBottom",vaBottom:2},this.$rtti.$Enum("TVerticalAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TVerticalAlignment}),this.TGridPanelExpandStyle={0:"esAddRows",esAddRows:0,1:"esAddColumns",esAddColumns:1},this.$rtti.$Enum("TGridPanelExpandStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TGridPanelExpandStyle}),rtl.createClass(this,"TGridPanelRow",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSizeStyle=0,this.FValue=0,this.FMarginBottom=0,this.FMarginTop=0,this.FAlignment=0,this.FElementClassName=""},this.SetMarginBottom=function(t){this.FMarginBottom!==t&&(this.FMarginBottom=t,this.FCollection.Update(this))},this.SetMarginTop=function(t){this.FMarginTop!==t&&(this.FMarginTop=t,this.FCollection.Update(this))},this.SetSizeStyle=function(t){this.FSizeStyle!==t&&(this.FSizeStyle=t,this.FCollection.Update(this))},this.SetValue=function(t){this.FValue!==t&&(this.FValue=t,this.FCollection.Update(this))},this.HeightAttribute=function(){var t="";t="";var e=this.FSizeStyle;return 0===e?t=pas.SysUtils.IntToStr(this.FValue)+"%":1===e&&(t=pas.SysUtils.IntToStr(this.FValue)+"px"),t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FSizeStyle=0,this.FAlignment=0,this.FMarginTop=0,this.FMarginBottom=0,this},this.Assign=function(e){t.TGridPanelRow.isPrototypeOf(e)&&(this.FAlignment=rtl.as(e,t.TGridPanelRow).FAlignment,this.FSizeStyle=rtl.as(e,t.TGridPanelRow).FSizeStyle,this.FElementClassName=rtl.as(e,t.TGridPanelRow).FElementClassName,this.FValue=rtl.as(e,t.TGridPanelRow).FValue,this.FMarginTop=rtl.as(e,t.TGridPanelRow).FMarginTop,this.FMarginBottom=rtl.as(e,t.TGridPanelRow).FMarginBottom)};var e=this.$rtti;e.addMethod("Create$1",2,[["ACollection",pas.Classes.$rtti.TCollection]]),e.addProperty("Alignment",0,t.$rtti.TVerticalAlignment,"FAlignment","FAlignment",{Default:t.TVerticalAlignment.vaTop}),e.addProperty("ElementClassName",0,rtl.string,"FElementClassName","FElementClassName"),e.addProperty("MarginTop",2,rtl.longint,"FMarginTop","SetMarginTop"),e.addProperty("MarginBottom",2,rtl.longint,"FMarginBottom","SetMarginBottom"),e.addProperty("SizeStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FSizeStyle","SetSizeStyle"),e.addProperty("Value",2,rtl.longint,"FValue","SetValue")})),rtl.createClass(this,"TGridPanelRows",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TGridPanelRow),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.$rtti.addMethod("Create$3",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TGridPanelColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSizeStyle=0,this.FValue=0,this.FMarginLeft=0,this.FAlignment=0,this.FMarginRight=0,this.FElementClassName=""},this.SetMarginLeft=function(t){this.FMarginLeft!==t&&(this.FMarginLeft=t,this.FCollection.Update(this))},this.SetMarginRight=function(t){this.FMarginRight!==t&&(this.FMarginRight=t,this.FCollection.Update(this))},this.SetSizeStyle=function(t){this.FSizeStyle!==t&&(this.FSizeStyle=t,this.FCollection.Update(this))},this.SetValue=function(t){this.FValue!==t&&(this.FValue=t,this.FCollection.Update(this))},this.WidthAttribute=function(){var t="";t="";var e=this.FSizeStyle;return 0===e?t=pas.SysUtils.IntToStr(this.FValue)+"%":1===e&&(t=pas.SysUtils.IntToStr(this.FValue)+"px"),t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FSizeStyle=0,this.FValue=0,this.FMarginLeft=0,this.FMarginRight=0,this.FAlignment=0,this},this.Assign=function(e){t.TGridPanelColumn.isPrototypeOf(e)&&(this.FAlignment=rtl.as(e,t.TGridPanelColumn).FAlignment,this.FSizeStyle=rtl.as(e,t.TGridPanelColumn).FSizeStyle,this.FElementClassName=rtl.as(e,t.TGridPanelColumn).FElementClassName,this.FValue=rtl.as(e,t.TGridPanelColumn).FValue,this.FMarginLeft=rtl.as(e,t.TGridPanelColumn).FMarginLeft,this.FMarginRight=rtl.as(e,t.TGridPanelColumn).FMarginRight)};var e=this.$rtti;e.addMethod("Create$1",2,[["ACollection",pas.Classes.$rtti.TCollection]]),e.addProperty("Alignment",0,pas.Classes.$rtti.TAlignment,"FAlignment","FAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("ElementClassName",0,rtl.string,"FElementClassName","FElementClassName"),e.addProperty("MarginLeft",2,rtl.longint,"FMarginLeft","SetMarginLeft",{Default:0}),e.addProperty("MarginRight",2,rtl.longint,"FMarginRight","SetMarginRight",{Default:0}),e.addProperty("SizeStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FSizeStyle","SetSizeStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssPercent}),e.addProperty("Value",2,rtl.longint,"FValue","SetValue")})),rtl.createClass(this,"TGridPanelColumns",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TGridPanelColumn),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.$rtti.addMethod("Create$3",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TControlCollectionItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FControl=null,this.FRow=0,this.FColumn=0},this.$final=function(){this.FControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.Assign=function(e){t.TControlCollectionItem.isPrototypeOf(e)&&(this.FColumn=rtl.as(e,t.TControlCollectionItem).FColumn,this.FRow=rtl.as(e,t.TControlCollectionItem).FRow,this.FControl=rtl.as(e,t.TControlCollectionItem).FControl)};var e=this.$rtti;e.addProperty("Column",0,rtl.longint,"FColumn","FColumn"),e.addProperty("Row",0,rtl.longint,"FRow","FRow"),e.addProperty("Control",0,pas["WEBLib.Controls"].$rtti.TWinControl,"FControl","FControl")})),rtl.createClass(this,"TControlCollection",pas.Classes.TOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TControlCollectionItem),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.$rtti.addMethod("Create$3",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TGridPanel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FDesignTime$1=!1,this.FUpdateTable=!1,this.FColCount=0,this.FRowCollection=null,this.FColumnCollection=null,this.FControlCollection=null,this.FGridLineWidth=0,this.FGridLineColor=0,this.FExpandStyle=0,this.FTbl=null,this.FTblBody=null},this.$final=function(){this.FRowCollection=void 0,this.FColumnCollection=void 0,this.FControlCollection=void 0,this.FTbl=void 0,this.FTblBody=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetColumnCollection=function(t){this.FColumnCollection.Assign(t)},this.SetRowCollection=function(t){this.FRowCollection.Assign(t)},this.SetControlCollection=function(t){this.FControlCollection.Assign(t)},this.CreateTable=function(){var t=null,e=0,i="";this.FTbl=document.createElement("table"),this.FTbl.setAttribute("width","100%"),this.FTbl.setAttribute("height","100%"),""!==this.FElementClassName?this.FTbl.setAttribute("class",this.FElementClassName):(i=-1!==this.FGridLineColor&&this.FGridLineWidth>0?pas.SysUtils.IntToStr(this.FGridLineWidth)+"px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FGridLineColor):4 in this.FComponentState?"1px dotted gray":"0px",this.FTbl.style.setProperty("border",i),this.FTbl.style.setProperty("border-collapse","collapse")),pas["WEBLib.Controls"].SetHTMLElementColor(this.FTbl,this.FColor,!(""===this.FElementClassName&&!this.GetIsLinked())),this.FTblBody=document.createElement("tbody");for(var s=0,n=this.FRowCollection.GetCount()-1;s<=n;s++)e=s,t=this.CreateRow(e),this.FTblBody.appendChild(t);return this.FTbl.appendChild(this.FTblBody),this.FTbl},this.CreateRow=function(t){var e=null,i=null,s=0,n="";if(n=-1!==this.FGridLineColor&&this.FGridLineWidth>0?pas.SysUtils.IntToStr(this.FGridLineWidth)+"px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FGridLineColor):4 in this.FComponentState?"1px dotted gray":"0px",e=document.createElement("tr"),""===this.FElementClassName&&e.style.setProperty("border",n),t<this.FRowCollection.GetCount()){0!==this.FRowCollection.GetItem$1(t).FMarginTop&&e.style.setProperty("margin-top",pas.SysUtils.IntToStr(this.FRowCollection.GetItem$1(t).FMarginTop)),0!==this.FRowCollection.GetItem$1(t).FMarginBottom&&e.style.setProperty("margin-bottom",pas.SysUtils.IntToStr(this.FRowCollection.GetItem$1(t).FMarginBottom)),""!==this.FRowCollection.GetItem$1(t).FElementClassName&&e.setAttribute("class",this.FRowCollection.GetItem$1(t).FElementClassName);var r=this.FRowCollection.GetItem$1(t).FAlignment;1===r?e.setAttribute("valign","middle"):2===r&&e.setAttribute("valign","bottom"),""===this.FElementClassName&&e.style.setProperty("border",n),e.setAttribute("height",this.FRowCollection.GetItem$1(t).HeightAttribute())}for(var o=0,a=this.FColumnCollection.GetCount()-1;o<=a;o++){s=o,i=document.createElement("td"),""===this.FElementClassName&&i.style.setProperty("border",n),0!==this.FColumnCollection.GetItem$1(s).FMarginLeft&&i.style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FColumnCollection.GetItem$1(s).FMarginLeft)+"px"),0!==this.FColumnCollection.GetItem$1(s).FMarginRight&&i.style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FColumnCollection.GetItem$1(s).FMarginRight)+"px"),""!==this.FColumnCollection.GetItem$1(s).FElementClassName&&i.setAttribute("class",this.FColumnCollection.GetItem$1(s).FElementClassName);var l=this.FColumnCollection.GetItem$1(s).FAlignment;2===l?i.setAttribute("align","center"):1===l&&i.setAttribute("align","right"),i.setAttribute("id",this.FName+"R"+pas.SysUtils.IntToStr(t)+"C"+pas.SysUtils.IntToStr(s)),0===t&&i.style.setProperty("width",this.FColumnCollection.GetItem$1(s).WidthAttribute()),e.appendChild(i)}return e},this.CreateElement=function(){return document.createElement("SPAN")},this.AlignControl=function(t){3 in this.FComponentState||this.UpdateTable(),pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments)},this.UpdateTable=function(){var t=0,e=0,i=0,s=0,n=0,r=null,o="",a=null,l=null,h=null,u=!1,d=0;if(null!=this.FTblBody&&!this.IsUpdating()&&!(3 in this.FComponentState)){u=!0,s=0;for(var F=0,c=this.FRowCollection.GetCount()-1;F<=c;F++){if(t=F,0!==this.FRowCollection.GetItem$1(t).FSizeStyle){u=!1;break}s+=this.FRowCollection.GetItem$1(t).FValue}if(u&&s>100){d=s/100;for(var p=0,C=this.FRowCollection.GetCount()-1;p<=C;p++)t=p,this.FRowCollection.GetItem$1(t).FValue=pas.System.Trunc(this.FRowCollection.GetItem$1(t).FValue/d)}u=!0,s=0;for(var S=0,m=this.FColumnCollection.GetCount()-1;S<=m;S++){if(t=S,0!==this.FColumnCollection.GetItem$1(t).FSizeStyle){u=!1;break}s+=this.FColumnCollection.GetItem$1(t).FValue}if(u&&s>100){d=s/100;for(var f=0,y=this.FColumnCollection.GetCount()-1;f<=y;f++)t=f,this.FColumnCollection.GetItem$1(t).FValue=pas.System.Trunc(this.FColumnCollection.GetItem$1(t).FValue/d)}for(n=this.FRowCollection.GetCount(),this.FColCount!==this.FColumnCollection.GetCount()&&(n=0);this.FTblBody.childNodes.length>n;)this.FTblBody.removeChild(this.FTblBody.childNodes.item(this.FTblBody.childNodes.length-1));for(;this.FTblBody.childNodes.length<this.FRowCollection.GetCount();)h=this.CreateRow(this.FTblBody.childNodes.length),this.FTblBody.appendChild(h);for(var g=0,T=this.FRowCollection.GetCount()-1;g<=T;g++)t=g,(h=this.FTblBody.childNodes.item(t)).setAttribute("height",this.FRowCollection.GetItem$1(t).HeightAttribute());t=0,e=0;for(var E=0,D=this.FControlCollection.GetCount()-1;E<=D;E++)i=E,null!=this.FControlCollection.GetItem$1(i).FControl&&(r=document.createDocumentFragment(),a=this.FControlCollection.GetItem$1(i).FControl,this.FControlCollection.GetItem$1(i).FColumn=t,this.FControlCollection.GetItem$1(i).FRow=e,a.SetElementPosition(1),a.SetChildOrderEx(-1),3===a.FAlign&&(a.SetHeightStyle(0),a.SetHeightPercent(100),null!=a.GetElementHandle()&&a.GetElementHandle().style.setProperty("float","left")),4===a.FAlign&&(a.SetHeightStyle(0),a.SetHeightPercent(100),null!=a.GetElementHandle()&&a.GetElementHandle().style.setProperty("float","right")),a.FAlign in rtl.createSet(1,2)&&(a.SetWidthStyle(0),a.SetWidthPercent(100)),5===a.FAlign&&(a.SetWidthStyle(0),a.SetHeightStyle(0),a.SetWidthPercent(100),a.SetHeightPercent(100)),null!=(h=this.FTblBody.childNodes.item(e))&&e<this.FRowCollection.GetCount()&&(h.setAttribute("height",this.FRowCollection.GetItem$1(e).HeightAttribute()),""!==this.FRowCollection.GetItem$1(e).FElementClassName?h.setAttribute("class",this.FRowCollection.GetItem$1(e).FElementClassName):h.removeAttribute("class")),null!=a.GetElementHandle()&&r.appendChild(a.GetElementHandle()),o=this.FName+"R"+pas.SysUtils.IntToStr(e)+"C"+pas.SysUtils.IntToStr(t),null==(l=document.getElementById(o))?(h=this.CreateRow(e),this.FTblBody.appendChild(h),l=document.getElementById(o),this.FRowCollection.GetCount()>e&&h.setAttribute("height",this.FRowCollection.GetItem$1(e).HeightAttribute())):0===e&&t<this.FColumnCollection.GetCount()&&(1===this.FColumnCollection.GetItem$1(t).FSizeStyle?(this.FTbl.removeAttribute("width"),this.FTbl.removeAttribute("height")):(this.FTbl.setAttribute("width","100%"),this.FTbl.setAttribute("height","100%")),l.style.setProperty("width",this.FColumnCollection.GetItem$1(t).WidthAttribute())),null!=l&&(l.appendChild(r),1===a.FAlign&&l.style.setProperty("vertical-align","top"),2===a.FAlign&&l.style.setProperty("vertical-align","bottom")),(t+=1)===this.FColumnCollection.GetCount()&&(t=0,e+=1));for(var b=0,P=this.FColumnCollection.GetCount()-1;b<=P;b++)t=b,o=this.FName+"R0C"+pas.SysUtils.IntToStr(t),null!=(l=document.getElementById(o))&&l.style.setProperty("width",this.FColumnCollection.GetItem$1(t).WidthAttribute());this.FColCount=this.FColumnCollection.GetCount()}},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),null==this.GetElementHandle()||this.IsUpdating()||(this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor",""),this.FUpdateTable&&null!=this.GetContainer()&&(this.GetContainer().appendChild(this.CreateTable()),this.UpdateTable(),this.FUpdateTable=!1))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),4 in this.FComponentState&&this.GetElementHandle().style.setProperty("border","1px dotted gray"),this.GetIsLinked()||null==this.FTbl||(-1!==this.FColor?this.FTbl.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)):this.FTbl.style.removeProperty("background-color"))},this.RegisterParent=function(t){if(pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments),!this.IsUpdating()&&!(0 in this.FComponentState)){if(0 in t.FComponentState)return;this.FControlCollection.Add$1().FControl=t,this.FControlCollection.GetCount()>this.FColumnCollection.GetCount()*this.FRowCollection.GetCount()&&(0===this.FExpandStyle?this.FRowCollection.Add$1():this.FColumnCollection.Add$1()),this.UpdateTable()}},this.TableChanged=function(t){this.UpdateTable()},this.Notification=function(t,e){var i=0,s="",n=null;if(1===e&&!(3 in this.FComponentState)){for(var r=this.FControlCollection.GetCount()-1;r>=0;r--)i=r,this.FControlCollection.GetItem$1(i).FControl===t&&(s=this.FName+"R"+pas.SysUtils.IntToStr(this.FControlCollection.GetItem$1(i).FRow)+"C"+pas.SysUtils.IntToStr(this.FControlCollection.GetItem$1(i).FColumn),(n=document.getElementById(s)).removeChild(n.firstChild),this.FControlCollection.GetItem$1(i).FControl=null,this.FControlCollection.Delete(i));this.UpdateTable()}pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FDesignTime$1=4 in this.FComponentState&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState),this.FEnablePropagation=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.FUpdateTable=!0,this.FColCount=-1,this.FRowCollection=t.TGridPanelRows.$create("Create$3",[this]),this.FRowCollection.FPropName="RowCollection",this.FDesignTime$1&&!(0 in this.FComponentState)&&(this.FRowCollection.Add$1(),this.FRowCollection.GetItem$1(0).SetValue(100),this.FRowCollection.GetItem$1(0).SetSizeStyle(0)),this.FColumnCollection=t.TGridPanelColumns.$create("Create$3",[this]),this.FColumnCollection.FPropName="ColumnCollection",this.FDesignTime$1&&!(0 in this.FComponentState)&&(this.FColumnCollection.Add$1(),this.FColumnCollection.Add$1(),this.FColumnCollection.GetItem$1(0).SetValue(50),this.FColumnCollection.GetItem$1(1).SetValue(50),this.FColumnCollection.GetItem$1(0).SetSizeStyle(0),this.FColumnCollection.GetItem$1(1).SetSizeStyle(0)),this.FRowCollection.FOnChange=rtl.createCallback(this,"TableChanged"),this.FColumnCollection.FOnChange=rtl.createCallback(this,"TableChanged"),this.FControlCollection=t.TControlCollection.$create("Create$3",[this]),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FRowCollection"),rtl.free(this,"FColumnCollection"),rtl.free(this,"FControlCollection"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.UpdateTable()},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("ControlCollection",2,t.$rtti.TControlCollection,"FControlCollection","SetControlCollection"),e.addProperty("ColumnCollection",2,t.$rtti.TGridPanelColumns,"FColumnCollection","SetColumnCollection"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("ExpandStyle",0,t.$rtti.TGridPanelExpandStyle,"FExpandStyle","FExpandStyle",{Default:t.TGridPanelExpandStyle.esAddRows}),e.addProperty("GridLineWidth",0,rtl.longint,"FGridLineWidth","FGridLineWidth",{Default:0}),e.addProperty("GridLineColor",0,pas["WEBLib.Graphics"].$rtti.TColor,"FGridLineColor","FGridLineColor",{Default:0}),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("RowCollection",2,t.$rtti.TGridPanelRows,"FRowCollection","SetRowCollection"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel")}))}),["WEBLib.Utils","Math"]),rtl.module("Generics.Defaults",["System"],(function(){"use strict";rtl.createInterface(this,"IComparer$$$G$$generics$defaults$$Longint","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.Longint>")})),rtl.module("Generics.Collections",["System","Classes","SysUtils","RTLConsts","Types","JS","Generics.Defaults"],(function(){"use strict";var t=this;t.$impl;this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnRemoved",cnRemoved:1,2:"cnExtracted",cnExtracted:2},rtl.createClass(this,"EDictionary",pas.SysUtils.Exception,(function(){})),rtl.recNewT(this,"TPair$$$G$$generics$collections$$Double$$Double",(function(){this.Key=0,this.Value=0,this.$eq=function(t){return this.Key===t.Key&&this.Value===t.Value},this.$assign=function(t){return this.Key=t.Key,this.Value=t.Value,this}})),rtl.recNewT(this,"TPair$$$G$$generics$collections$$Longint$$TPair$System$Double$System$Double$",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$$$G$$generics$collections$$TPair$System$Longint$Generics$Collections$TPair$System$Double$System$Double$$",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.Longint,Generics.Collections.TPair<System.Double,System.Double>>>"),rtl.createClass(this,"TEnumerable$$$G$$generics$collections$$TPair$System$Double$System$Double$",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.Double,System.Double>>"),rtl.createClass(this,"TEnumerable$$$G$$generics$collections$$Longint",pas.System.TObject,(function(){}),"TEnumerable<System.Longint>"),rtl.createClass(this,"TDictionary$$$G$$generics$collections$$Longint$$TPair$System$Double$System$Double$",this.TEnumerable$$$G$$generics$collections$$TPair$System$Longint$Generics$Collections$TPair$System$Double$System$Double$$,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$$$G$$generics$collections$$TPair$System$Double$System$Double$,(function(){}),"TDictionary<System.Longint,Generics.Collections.TPair<System.Double,System.Double>>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$$$G$$generics$collections$$Longint,(function(){}),"TDictionary<System.Longint,Generics.Collections.TPair<System.Double,System.Double>>.TKeyCollection"),this.$init=function(){t.TEnumerable$$$G$$generics$collections$$TPair$System$Longint$Generics$Collections$TPair$System$Double$System$Double$$.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$$$G$$generics$collections$$TPair$System$Longint$Generics$Collections$TPair$System$Double$System$Double$$.$final.call(this)},this.GetEffectiveKey=function(t){var e=0,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.trunc(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(e,i){this.FMap.set(this.GetEffectiveKey(e),t.TPair$$$G$$generics$collections$$Double$$Double.$clone(i)),this.KeyNotify(e,0),this.ValueNotify(i,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var e=null,i=null,s=[],n=0,r=t.TPair$$$G$$generics$collections$$Double$$Double.$new();if(this.CanClearMap())this.FMap.clear();else{e=this.FMap.entries();do{(i=e.next()).done||(s=i.value,n=rtl.trunc(s[0]),r.$assign(rtl.getObject(s[1])),this.FMap.delete(n),this.PairNotify(n,t.TPair$$$G$$generics$collections$$Double$$Double.$clone(r),1))}while(!i.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.$assign(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.Longint,Generics.Collections.TPair<System.Double,System.Double>>"),t.$implcode=function(){t.$resourcestrings={SErrDictDuplicateKey:{org:"Duplicate key value"}}}}),[]),rtl.module("dateutils.helper",["System","Generics.Defaults","Generics.Collections"],(function(){"use strict";rtl.createClass(this,"TDateUtilsHelper",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FCache=null},this.$final=function(){this.FCache=void 0,pas.System.TObject.$final.call(this)};this.CalcPoints=function(t,e){var i,s=0,n=0,r=0,o=null,a=0,l=!1,h=0;for(l=!0,s=0;s<=11;s++)for(var u=1,d=pas.SysUtils.MonthDays[+pas.SysUtils.IsLeapYear(t)][s+1-1];u<=d;u++)for(n=u,r=0;r<=23;r++)a=(o=new Date(t,s,n,r,0,0,0)).getTimezoneOffset(),o.setHours(o.getHours()+1),a!==o.getTimezoneOffset()&&(h=pas.SysUtils.EncodeDate(t,s+1,n),l?e.Key=h+pas.SysUtils.EncodeTime(r+1,0,0,0):e.Value=h+pas.SysUtils.EncodeTime(r,0,0,0),l=!1);return(i=!l)&&this.FCache.Add(t,e),i},this.Find=function(t,e){return this.FCache.TryGetValue(t,e)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FCache=pas["Generics.Collections"].TDictionary$$$G$$generics$collections$$Longint$$TPair$System$Double$System$Double$.$create("Create$1",[0]),this},this.Destroy=function(){rtl.free(this,"FCache"),pas.System.TObject.Destroy.call(this)},this.Force=function(t,e){var i=!1;return(i=this.Find(t,e))||(i=this.CalcPoints(t,e)),i}}))}),["SysUtils","JS"]),rtl.module("DateUtils",["System","SysUtils","Math","dateutils.helper"],(function(){"use strict";var t=this,e=t.$impl;this.OneMillisecond=1/864e5,this.RecodeLeaveFieldAsIs=65535,this.YearOf=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),e},this.IncHour=function(t,i){var s=0;return s=t>=0?t+i/24:e.IncNegativeTime(t,i/24),e.MaybeSkipTimeWarp(t,{get:function(){return s},set:function(t){s=t}}),s},this.IncHour$1=function(e){return t.IncHour(e,1)},this.DecodeDateTime=function(t,e,i,s,n,r,o,a){pas.SysUtils.DecodeTime(t,n,r,o,a),24===n.get()?(n.set(0),pas.SysUtils.DecodeDate(Math.round(t),e,i,s)):pas.SysUtils.DecodeDate(t,e,i,s)},this.TryEncodeDateTime=function(t,e,i,s,n,r,o,a){var l=!1,h=0;return(l=(l=pas.SysUtils.TryEncodeDate(t,e,i,a))&&pas.SysUtils.TryEncodeTime(s,n,r,o,{get:function(){return h},set:function(t){h=t}}))&&a.set(pas.SysUtils.ComposeDateTime(a.get(),h)),l},this.RecodeMilliSecond=function(e,i){return t.RecodeDateTime(e,65535,65535,65535,65535,65535,65535,i)},this.RecodeDateTime=function(e,i,s,n,r,o,a,l){var h=0;return t.TryRecodeDateTime(e,i,s,n,r,o,a,l,{get:function(){return h},set:function(t){h=t}})||t.InvalidDateTimeError(i,s,n,r,o,a,l,e),h},this.TryRecodeDateTime=function(e,i,s,n,r,o,a,l,h){function u(t,e){65535!==e&&t.set(e)}var d=0,F=0,c=0,p=0,C=0,S=0,m=0;return t.DecodeDateTime(e,{get:function(){return d},set:function(t){d=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return S},set:function(t){S=t}},{get:function(){return m},set:function(t){m=t}}),u({get:function(){return d},set:function(t){d=t}},i),u({get:function(){return F},set:function(t){F=t}},s),u({get:function(){return c},set:function(t){c=t}},n),u({get:function(){return p},set:function(t){p=t}},r),u({get:function(){return C},set:function(t){C=t}},o),u({get:function(){return S},set:function(t){S=t}},a),u({get:function(){return m},set:function(t){m=t}},l),t.TryEncodeDateTime(d,F,c,p,C,S,m,h)},this.SameDateTime=function(t,e){return Math.abs(t-e)<1.1574074074074074e-8},this.SameDate=function(t,e){return pas.System.Trunc(t)===pas.System.Trunc(e)},this.InvalidDateTimeError=function(e,i,s,n,r,o,a,l){function h(t,e,i){return 65535!==t?pas.SysUtils.Format("%.*d",pas.System.VarRecs(19,i.length,0,t)):0===l?i:pas.SysUtils.Format("%.*d",pas.System.VarRecs(19,i.length,0,t))}var u=0,d=0,F=0,c=0,p=0,C=0,S=0,m="";throw t.DecodeDateTime(l,{get:function(){return u},set:function(t){u=t}},{get:function(){return d},set:function(t){d=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return S},set:function(t){S=t}}),m=(m=(m=(m=(m=(m=(m=h(e,0,"????"))+pas.SysUtils.FormatSettings.DateSeparator+h(i,0,"??"))+pas.SysUtils.FormatSettings.DateSeparator+h(s,0,"??"))+" "+h(n,0,"??"))+pas.SysUtils.FormatSettings.TimeSeparator+h(r,0,"??"))+pas.SysUtils.FormatSettings.TimeSeparator+h(o,0,"??"))+pas.SysUtils.FormatSettings.DecimalSeparator+h(a,0,"???"),pas.SysUtils.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeStamp"),pas.System.VarRecs(18,m)])},this.DateTimeToUnix=function(i){return Math.round(86400*e.DateTimeDiff(t.RecodeMilliSecond(i,0),25569))},this.DateTimeToRFC3339=function(t){return pas.SysUtils.FormatDateTime('yyyy-mm-dd"T"hh":"nn":"ss"."zzz"Z"',t)};var i=[11,1,6,9,12,15,18,21];this.TryRFC3339ToDateTime=function(t,e){var s,n,r,o=!1,a=0,l=0,h=0,u=0;return""===pas.SysUtils.Trim(t)&&(o=!0,e.set(0)),s=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[1],4),-1),n=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[2],2),-1),r=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[3],2),-1),t.length>=i[0]?(a=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[4],2),-1),l=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[5],2),-1),h=t.length>=i[6]?pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[6],2),-1):0,t.length>=i[7]&&(u=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[7],3),-1))):(a=0,l=0,h=0,u=0),(o=s>=0&&n>=0&&r>=0&&a>=0&&l>=0&&h>=0&&u>=0)?0===s||0===n||0===r?e.set(pas.SysUtils.EncodeTime(a,l,h,0)):e.set(pas.SysUtils.EncodeDate(s,n,r)+pas.SysUtils.EncodeTime(a,l,h,u)):e.set(0),o},rtl.createClass(this,"TDateTimeScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPattern="",this.FText="",this.FPatternOffset=0,this.FLen=0,this.FPatternLen=0,this.FPatternPos=0,this.FPos=0,this.FY=0,this.FM=0,this.FD=0,this.FTimeval=0},this.ArrayMatchError=function(){e.raiseexception(pas.SysUtils.Format(e.SNoArrayMatch,pas.System.VarRecs(0,this.FPatternPos+1,0,this.FPos)))},this.DoDateTime=function(){this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat),this.MatchPattern("\t"),this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat),this.FPatternPos+=1},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.FPatternLen=this.FPattern.length)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FLen=this.FText.length)},this.ScanFixedInt=function(t){var i,s,n=0,r="\0";for(n=0,s=this.FPos,i=this.FPattern.charAt(this.FPatternPos-1);this.FPatternPos<=this.FPatternLen&&this.FPattern.charAt(this.FPatternPos-1)===i;)this.FPatternPos+=1;for(r=this.FText.charAt(this.FPos-1);t>0&&this.FPos<=this.FLen&&r.charCodeAt()in rtl.createSet(null,48,57);)n=10*n+r.charCodeAt()-48,this.FPos+=1,t-=1,this.FPos<=this.FLen&&(r=this.FText.charAt(this.FPos-1));return s===this.FPos&&e.raiseexception(pas.SysUtils.Format(e.SPatternCharMismatch,pas.System.VarRecs(9,i,0,s))),n},this.ScanPatternLength=function(){var t,e=0,i=0;for(e=this.FPatternPos,i=this.FPatternPos,t=this.FPattern.charAt(i-1);i<=this.FPatternLen&&this.FPattern.charAt(i-1)===t;)i+=1;return e=i-e},this.MatchChar=function(t){var i="\0";(i=this.FPos<=this.FLen?this.FText.charAt(this.FPos-1):"?")!==t&&e.raiseexception(pas.SysUtils.Format(e.SNoCharMatch,pas.System.VarRecs(9,i,9,t,0,this.FPatternPos+this.FPatternOffset,0,this.FPos))),this.FPatternPos+=1,this.FPos+=1},this.FindIMatch=function(t,e){var i,s=0,n=0;for(s=-1,i=rtl.length(t)-1,n=0;n<=i&&-1===s;)pas.SysUtils.SameText(pas.System.Copy(e,1,t[n].length),t[n])&&(s=n),n+=1;return s},this.FindMatch=function(t){var e=0;return-1===(e=this.FindIMatch(t,pas.System.Copy(this.FText,this.FPos,this.FLen-this.FPos+1)))?this.ArrayMatchError():(this.FPos+=t[e].length+1,this.FPatternPos+=t[e].length+1,e+=1),e},this.MatchPattern=function(t){var e,i;e=this.FPattern,i=this.FPatternPos,this.FPatternOffset=this.FPatternPos,this.FPattern=t,this.FPatternLen=t.length;try{this.Scan(-1)}finally{this.FPattern=e,this.FPatternLen=t.length,this.FPatternPos=i,this.FPatternOffset=0}},this.DoYear=function(){var e,i=0;e=this.ScanPatternLength(),this.FY=this.ScanFixedInt(4),e<=2&&(i=t.YearOf(pas.SysUtils.Now())-pas.SysUtils.TwoDigitYearCenturyWindow,this.FY+=100*rtl.trunc(i/100),pas.SysUtils.TwoDigitYearCenturyWindow>0&&this.FY<i&&(this.FY+=100))},this.DoMonth=function(){var t=this.ScanPatternLength();1===t||2===t?this.FM=this.ScanFixedInt(2):3===t?this.FM=this.FindMatch(pas.SysUtils.FormatSettings.ShortMonthNames):4===t&&(this.FM=this.FindMatch(pas.SysUtils.FormatSettings.LongMonthNames))},this.DoDay=function(){var t=this.ScanPatternLength();1===t||2===t?this.FD=this.ScanFixedInt(2):3===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.ShortDayNames):4===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.LongDayNames):5===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat):6===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongDateFormat)},this.DoTime=function(){var t=this.ScanPatternLength();1===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortTimeFormat):2===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat)},this.DoAMPM=function(){var t=0,i=t=this.FindIMatch(e.AMPMformatting,pas.System.Copy(this.FPattern,this.FPatternPos,5));if(0===i){t=this.FindIMatch(["AM","PM"],pas.System.Copy(this.FText,this.FPos,2));0===t||(1===t?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[0].length,this.FPos+=2}else if(1===i){var s=pas.System.upcase(this.FText.charAt(this.FPos-1));"A"===s||("P"===s?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[1].length,this.FPos+=1}else if(2===i){var n=t=this.FindIMatch([pas.SysUtils.FormatSettings.TimeAMString,pas.SysUtils.FormatSettings.TimePMString],pas.System.Copy(this.FText,this.FPos,5));0===n?this.FPos+=pas.SysUtils.FormatSettings.TimeAMString.length:1===n?(this.FTimeval=this.FTimeval+.5,this.FPos+=pas.SysUtils.FormatSettings.TimePMString.length):this.ArrayMatchError(),this.FPatternPos+=e.AMPMformatting[2].length,this.FPatternPos+=2,this.FPos+=2}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))},this.Scan=function(t){var i=0,s="\0",n="\0",r="\0";for(t<1&&(t=1),this.FPos<t&&(this.FPos=t),this.FPatternPos=1,n="\0",s=" ";this.FPos<=this.FLen&&this.FPatternPos<=this.FPatternLen;)if(r=pas.System.upcase(this.FPattern.charAt(this.FPatternPos-1)),"\0"!==n)n!==r?this.MatchChar(r):(n="\0",this.FPatternPos+=1);else{if("M"===r&&"H"===s)this.ScanPatternLength()>2&&e.raiseexception(pas.SysUtils.Format(e.SHHMMError,pas.System.VarRecs(0,this.FPatternOffset+this.FPatternPos+1))),this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else{var o=r;if("Y"===o)this.DoYear();else if("M"===o)this.DoMonth();else if("D"===o)this.DoDay();else if("T"===o)this.DoTime();else if("H"===o)this.FTimeval=this.FTimeval+.041666666666666664*this.ScanFixedInt(2);else if("N"===o)this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else if("S"===o)this.FTimeval=this.FTimeval+11574074074074073e-21*this.ScanFixedInt(2);else if("Z"===o)this.FTimeval=this.FTimeval+1.1574074074074074e-8*this.ScanFixedInt(3);else if("A"===o)this.DoAMPM();else if("/"===o)this.MatchChar(pas.SysUtils.FormatSettings.DateSeparator);else if(":"===o)this.MatchChar(pas.SysUtils.FormatSettings.TimeSeparator),r=s;else if("'"===o||'"'===o)n=r,this.FPatternPos+=1;else if("C"===o)this.DoDateTime();else if("?"===o)this.FPatternPos+=1,this.FPos+=1;else if("\t"===o){for(;this.FPos<=this.FLen&&this.FText.charCodeAt(this.FPos-1)in e.whitespace;)this.FPos+=1;this.FPatternPos+=1}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))}s=r}return i=this.FTimeval,this.FY>0&&this.FM>0&&this.FD>0&&(i+=pas.SysUtils.EncodeDate(this.FY,this.FM,this.FD)),i}})),this.ScanDateTime=function(e,i,s){var n=0,r=null;r=t.TDateTimeScanner.$create("Create");try{r.SetPattern(e),r.SetText(i),n=r.Scan(s)}finally{r=rtl.freeLoc(r)}return n},this.TLocalTimeType={0:"lttStandard",lttStandard:0,1:"lttDaylight",lttDaylight:1,2:"lttAmbiguous",lttAmbiguous:2,3:"lttInvalid",lttInvalid:3},rtl.createClass(this,"ELocalTimeInvalid",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"TTimeZone",pas.System.TObject,(function(){this.FLocal=null,this.GetLocal=function(){return null==this.FLocal&&(t.TTimeZone.FLocal=t.TLocalTimeZone.$create("Create$1")),this.FLocal},this.GetUtcOffsetInSeconds=function(e,i){var s=0,n=0,r=0;if(this.DoGetOffsetsAndType(e,{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return r},set:function(t){r=t}}),3===r)throw t.ELocalTimeInvalid.$create("CreateFmt",[rtl.getResStr(t,"SLocalTimeInvalid"),pas.System.VarRecs(18,pas.SysUtils.DateTimeToStr(e,!1))]);return 1===r||2===r&&i?n+s:n},this.IncMilliSecond=function(t,e){var i=0,s=pas.SysUtils.TTimeStamp.$new();return s.$assign(pas.SysUtils.DateTimeToTimeStamp(t)),i=pas.SysUtils.TimeStampToMSecs(s),i+=e,s.$assign(pas.SysUtils.MSecsToTimeStamp(i)),pas.SysUtils.TimeStampToDateTime(s)},this.IncSecond=function(t,e){return this.IncMilliSecond(t,1e3*e)},this.ToUniversalTime=function(t,e){var i;return i=this.GetUtcOffsetInSeconds(t,e),this.IncSecond(t,-i)}})),rtl.createClass(this,"TLocalTimeZone",this.TTimeZone,(function(){this.$init=function(){t.TTimeZone.$init.call(this),this.FDST=null},this.$final=function(){this.FDST=void 0,t.TTimeZone.$final.call(this)};this.DoGetOffsetsAndType=function(e,i,s,n){var r,o,a,l=null,h=pas["Generics.Collections"].TPair$$$G$$generics$collections$$Double$$Double.$new();if(l=new Date(1e3*t.DateTimeToUnix(e)),r=new Date(t.YearOf(e),6,1,0,0,0,0).getTimezoneOffset(),o=new Date(t.YearOf(e),0,1,0,0,0,0).getTimezoneOffset(),a=Math.max(r,o),i.set(60*-a),s.set(60*Math.abs(r-o)),this.FDST.Force(t.YearOf(e),h)){if(e>h.Key&&e<t.IncHour$1(h.Key))return void n.set(3);if(e>h.Value&&e<t.IncHour$1(h.Value))return void n.set(2)}l.getTimezoneOffset()===a?n.set(0):n.set(1)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FDST=pas["dateutils.helper"].TDateUtilsHelper.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FDST"),pas.System.TObject.Destroy.call(this)}})),t.$implcode=function(){e.TDateTimeEpsilon=22204460493e-26,e.DateTimeDiff=function(t,e){var i=0;return i=t-e,t>0&&e<0?i-=.5:t<-1&&e>-1&&(i+=.5),i},e.MaybeSkipTimeWarp=function(t,e){t>=0&&e.get()<-22204460493e-26?e.set(pas.System.Int(e.get()-1+22204460493e-26)-pas.System.Frac(1+pas.System.Frac(e.get()))):t<=-1&&e.get()>22204460493e-26-1&&e.set(pas.System.Int(e.get()+1-22204460493e-26)+pas.System.Frac(1-Math.abs(pas.System.Frac(1+e.get()))))},e.IncNegativeTime=function(t,e){var i=0;return i=-pas.System.Frac(t)+pas.System.Frac(e),pas.Math.SameValue(i,pas.System.Int(i)+1,22204460493e-26)?i=pas.System.Int(i)+1:pas.Math.SameValue(i,pas.System.Int(i),22204460493e-26)&&(i=pas.System.Int(i)),i<-22204460493e-26?(i=1+i,t=pas.System.Int(t)-1):i>=.9999999999999998&&(i-=1,t=pas.System.Int(t)+1),pas.System.Int(t)+pas.System.Int(e)-i},e.LFAI=65535,e.whitespace=rtl.createSet(32,13,10),e.hrfactor=1/24,e.minfactor=1/1440,e.secfactor=1/86400,e.mssecfactor=1/864e5,e.AMPMformatting=["am/pm","a/p","ampm"],e.raiseexception=function(t){throw pas.SysUtils.EConvertError.$create("Create$1",[t])},e.SPatternCharMismatch='Pattern mismatch char "%s" at position %d.',e.SNoCharMatch='Mismatch char "%s" <> "%s" at pattern position %d, string position %d.',e.SHHMMError="mm in a sequence hh:mm is interpreted as minutes. No longer versions allowed! (Position : %d).",e.SNoArrayMatch="Can't match any allowed value at pattern position %d, string position %d.",t.$resourcestrings={SLocalTimeInvalid:{org:'The given "%s" local time is invalid (situated within the missing period prior to DST).'}}}}),["JS","RTLConsts"]),rtl.module("DBConst",["System"],(function(){"use strict";this.$resourcestrings={SActiveDataset:{org:"Operation cannot be performed on an active dataset"},SDatasetReadOnly:{org:"Dataset is read-only."},SDuplicateFieldName:{org:'Duplicate fieldname : "%s"'},SFieldNotFound:{org:'Field not found : "%s"'},SInactiveDataset:{org:"Operation cannot be performed on an inactive dataset"},SInvalidDisplayValues:{org:'"%s" are not valid boolean displayvalues'},SInvalidFieldSize:{org:"Invalid field size : %d"},SInvalidTypeConversion:{org:"Invalid type conversion to %s in field %s"},SNeedField:{org:"Field %s is required, but not supplied."},SNeedFieldName:{org:"Field needs a name"},SNoDataset:{org:'No dataset asssigned for field : "%s"'},SNoSuchRecord:{org:"Could not find the requested record."},SNotABoolean:{org:'"%s" is not a valid boolean'},SNotAFloat:{org:'"%s" is not a valid float'},SNotAninteger:{org:'"%s" is not a valid integer'},SNotEditing:{org:'Operation not allowed, dataset "%s" is not in an edit or insert state.'},SRangeError:{org:"%f is not between %f and %f for %s"},SUniDirectional:{org:"Operation cannot be performed on an unidirectional dataset"},SUnknownFieldType:{org:"Unknown field type : %s"},SUnknownParamFieldType:{org:'Unknown fieldtype for parameter "%s".'},SIndexNotFound:{org:"Index '%s' not found"},SFieldValueError:{org:"Invalid value for field '%s'"},SDuplicateName:{org:"Duplicate name '%s' in %s"},SLookupInfoError:{org:"Lookup information for field '%s' is incomplete"},SDatasetEmpty:{org:"The dataset is empty"},SErrInvalidDateTime:{org:'Invalid date/time value : "%s"'},SatEOFInternalOnly:{org:"loAtEOF is for internal use only."},SErrInsertingSameRecordtwice:{org:"Attempt to insert the same record twice."},SNestedDataSetClass:{org:"Nested dataset must inherit from %s"},SCircularDataLink:{org:"Circular datalinks are not allowed"}}})),rtl.module("DB",["System","Classes","SysUtils","JS","Types","DateUtils"],(function(){"use strict";var t=this,e=t.$impl;this.YesNoChars=["N","Y"],this.TDataSetState={0:"dsInactive",dsInactive:0,1:"dsBrowse",dsBrowse:1,2:"dsEdit",dsEdit:2,3:"dsInsert",dsInsert:3,4:"dsSetKey",dsSetKey:4,5:"dsCalcFields",dsCalcFields:5,6:"dsFilter",dsFilter:6,7:"dsNewValue",dsNewValue:7,8:"dsOldValue",dsOldValue:8,9:"dsCurValue",dsCurValue:9,10:"dsBlockRead",dsBlockRead:10,11:"dsInternalCalc",dsInternalCalc:11,12:"dsOpening",dsOpening:12,13:"dsRefreshFields",dsRefreshFields:13},this.TDataEvent={0:"deFieldChange",deFieldChange:0,1:"deRecordChange",deRecordChange:1,2:"deDataSetChange",deDataSetChange:2,3:"deDataSetScroll",deDataSetScroll:3,4:"deLayoutChange",deLayoutChange:4,5:"deUpdateRecord",deUpdateRecord:5,6:"deUpdateState",deUpdateState:6,7:"deCheckBrowseMode",deCheckBrowseMode:7,8:"dePropertyChange",dePropertyChange:8,9:"deFieldListChange",deFieldListChange:9,10:"deFocusControl",deFocusControl:10,11:"deParentScroll",deParentScroll:11,12:"deConnectChange",deConnectChange:12,13:"deReconcileError",deReconcileError:13,14:"deDisabledStateChange",deDisabledStateChange:14},this.TUpdateStatus={0:"usModified",usModified:0,1:"usInserted",usInserted:1,2:"usDeleted",usDeleted:2},this.TProviderFlag={0:"pfInUpdate",pfInUpdate:0,1:"pfInWhere",pfInWhere:1,2:"pfInKey",pfInKey:2,3:"pfHidden",pfHidden:3,4:"pfRefreshOnInsert",pfRefreshOnInsert:4,5:"pfRefreshOnUpdate",pfRefreshOnUpdate:5},this.$rtti.$Enum("TProviderFlag",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TProviderFlag}),this.$rtti.$Set("TProviderFlags",{comptype:this.$rtti.TProviderFlag}),this.$rtti.$Class("TFieldDefs"),this.$rtti.$Class("TField"),this.$rtti.$Class("TDataSet"),this.$rtti.$Class("TDataSource"),this.$rtti.$Class("TRecordUpdateDescriptor"),rtl.createClass(this,"EDatabaseError",pas.SysUtils.Exception,(function(){})),this.TFieldType={0:"ftUnknown",ftUnknown:0,1:"ftString",ftString:1,2:"ftSmallint",ftSmallint:2,3:"ftInteger",ftInteger:3,4:"ftWord",ftWord:4,5:"ftBoolean",ftBoolean:5,6:"ftFloat",ftFloat:6,7:"ftCurrency",ftCurrency:7,8:"ftBCD",ftBCD:8,9:"ftDate",ftDate:9,10:"ftTime",ftTime:10,11:"ftDateTime",ftDateTime:11,12:"ftBytes",ftBytes:12,13:"ftVarBytes",ftVarBytes:13,14:"ftAutoInc",ftAutoInc:14,15:"ftBlob",ftBlob:15,16:"ftMemo",ftMemo:16,17:"ftGraphic",ftGraphic:17,18:"ftFmtMemo",ftFmtMemo:18,19:"ftParadoxOle",ftParadoxOle:19,20:"ftDBaseOle",ftDBaseOle:20,21:"ftTypedBinary",ftTypedBinary:21,22:"ftCursor",ftCursor:22,23:"ftFixedChar",ftFixedChar:23,24:"ftWideString",ftWideString:24,25:"ftLargeint",ftLargeint:25,26:"ftADT",ftADT:26,27:"ftArray",ftArray:27,28:"ftReference",ftReference:28,29:"ftDataSet",ftDataSet:29,30:"ftOraBlob",ftOraBlob:30,31:"ftOraClob",ftOraClob:31,32:"ftVariant",ftVariant:32,33:"ftInterface",ftInterface:33,34:"ftIDispatch",ftIDispatch:34,35:"ftGuid",ftGuid:35,36:"ftTimeStamp",ftTimeStamp:36,37:"ftFMTBcd",ftFMTBcd:37,38:"ftFixedWideChar",ftFixedWideChar:38,39:"ftWideMemo",ftWideMemo:39,40:"ftOraTimeStamp",ftOraTimeStamp:40,41:"ftOraInterval",ftOraInterval:41,42:"ftLongWord",ftLongWord:42,43:"ftShortint",ftShortint:43,44:"ftByte",ftByte:44,45:"ftExtended",ftExtended:45,46:"ftConnection",ftConnection:46,47:"ftParams",ftParams:47,48:"ftStream",ftStream:48,49:"ftTimeStampOffset",ftTimeStampOffset:49,50:"ftObject",ftObject:50,51:"ftSingle",ftSingle:51},this.$rtti.$Enum("TFieldType",{minvalue:0,maxvalue:51,ordtype:1,enumtype:this.TFieldType}),this.TFieldAttribute={0:"faHiddenCol",faHiddenCol:0,1:"faReadonly",faReadonly:1,2:"faRequired",faRequired:2,3:"faLink",faLink:3,4:"faUnNamed",faUnNamed:4,5:"faFixed",faFixed:5},this.$rtti.$Enum("TFieldAttribute",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TFieldAttribute}),this.$rtti.$Set("TFieldAttributes",{comptype:this.$rtti.TFieldAttribute}),rtl.createClass(this,"TNamedItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FName=""},this.GetDisplayName=function(){return this.FName},this.SetDisplayName=function(e){var i=0;this.FName!==e&&(""!==e&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&(i=this.FCollection.IndexOf(e))>=0&&i!==this.GetIndex()&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SDuplicateName"),pas.System.VarRecs(18,e,18,this.FCollection.$classname)),this.FName=e,pas.Classes.TCollectionItem.SetDisplayName.call(this,e))},this.$rtti.addProperty("Name",2,rtl.string,"FName","SetDisplayName")})),rtl.createClass(this,"TDefCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FDataset=null},this.$final=function(){this.FDataset=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.SetItemName=function(e){var i=null,s="";""===(i=rtl.as(e,t.TNamedItem)).FName?(s=pas.System.Copy(this.$classname,2,5)+pas.SysUtils.IntToStr(i.FID+1),null!=this.FDataset&&(s=this.FDataset.FName+s),i.SetDisplayName(s)):pas.Classes.TCollection.SetItemName.call(this,e)},this.create$3=function(t,e,i){return pas.Classes.TOwnedCollection.Create$2.call(this,e,i),this.FDataset=t,this},this.Find=function(t){var e=null,i=0;e=null;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=this.GetItem(i);break}return e},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=i;break}return e},this.$rtti.addMethod("create$3",2,[["ADataset",t.$rtti.TDataSet],["AOwner",pas.Classes.$rtti.TPersistent],["AClass",pas.Classes.$rtti.TCollectionItemClass]])})),rtl.createClass(this,"TFieldDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FAttributes={},this.FDataType=0,this.FFieldNo=0,this.FInternalCalcField=!1,this.FPrecision=0,this.FRequired=!1,this.FSize=0},this.$final=function(){this.FAttributes=void 0,t.TNamedItem.$final.call(this)},this.GetFieldClass=function(){return null!=this.FCollection&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&null!=this.FCollection.FDataset?this.FCollection.FDataset.GetFieldClass(this.FDataType):null},this.SetAttributes=function(t){this.FAttributes=rtl.refSet(t),this.Changed(!1)},this.SetDataType=function(t){this.FDataType=t,this.Changed(!1)},this.SetPrecision=function(t){this.FPrecision=t,this.Changed(!1)},this.SetSize=function(t){this.FSize=t,this.Changed(!1)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FFieldNo=this.GetIndex()+1,this},this.Create$3=function(t,e,i,s,n,r){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.SetDisplayName(e),this.FDataType=i,this.FSize=s,this.FRequired=n,this.FPrecision=-1,this.FFieldNo=r,this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){var i=null;if(i=null,t.TFieldDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TFieldDef)),null!=i){this.FCollection.BeginUpdate();try{this.SetDisplayName(i.FName),this.SetDataType(i.FDataType),this.SetSize(i.FSize),this.SetPrecision(i.FPrecision),this.FRequired=i.FRequired}finally{this.FCollection.EndUpdate()}}else pas.Classes.TPersistent.Assign.call(this,e)},this.CreateField=function(e){var i=null,s=null;null===(s=this.GetFieldClass())&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SUnknownFieldType"),pas.System.VarRecs(18,this.FName)),i=s.$create("Create$1",[e]);try{i.FFieldDef=this,i.SetSize(this.FSize),i.FRequired=this.FRequired,i.FFieldName=this.FName,i.FDisplayLabel=this.GetDisplayName(),i.FFieldNo=this.FFieldNo,i.SetFieldType(this.FDataType),i.FReadOnly=1 in this.FAttributes,i.SetDataset(this.FCollection.FDataset),t.TFloatField.isPrototypeOf(i)&&i.SetPrecision(this.FPrecision)}catch(t){throw i=rtl.freeLoc(i),t}return i};var e=this.$rtti;e.addMethod("Create$1",2,[["ACollection",pas.Classes.$rtti.TCollection]]),e.addMethod("Create$3",2,[["AOwner",t.$rtti.TFieldDefs],["AName",rtl.string,2],["ADataType",t.$rtti.TFieldType],["ASize",rtl.longint],["ARequired",rtl.boolean],["AFieldNo",rtl.longint]]),e.addProperty("Attributes",2,t.$rtti.TFieldAttributes,"FAttributes","SetAttributes",{Default:{}}),e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:0}),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TFieldDefs",this.TDefCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.FieldDefClass=function(){return t.TFieldDef},this.Create$4=function(e){return t.TDefCollection.create$3.call(this,e,this.Owner(),this.$class.FieldDefClass()),this},this.Add$2=function(t,e,i,s,n){return this.$class.FieldDefClass().$create("Create$3",[this,t,e,i,s,n])},this.Add$3=function(e,i,s,n){0===e.length&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNeedFieldName"),this.FDataset),this.BeginUpdate();try{this.Add$2(e,i,s,n,this.GetCount()+1)}finally{this.EndUpdate()}},this.Add$4=function(t,e,i){this.Add$3(t,e,i,!1)},this.Add$5=function(t,e){this.Add$3(t,e,0,!1)},this.Assign$2=function(t){var e=0;this.Clear();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.Add$3(t.GetItem$1(e).FName,t.GetItem$1(e).FDataType,t.GetItem$1(e).FSize,t.GetItem$1(e).FRequired)},this.$rtti.addMethod("Create$4",2,[["ADataSet",t.$rtti.TDataSet]])})),this.TFieldKind={0:"fkData",fkData:0,1:"fkCalculated",fkCalculated:1,2:"fkLookup",fkLookup:2,3:"fkInternalCalc",fkInternalCalc:3},this.$rtti.$Enum("TFieldKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFieldKind}),this.$rtti.$MethodVar("TFieldNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField]]),methodkind:0}),this.$rtti.$MethodVar("TFieldGetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,1],["DisplayText",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TFieldSetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,2]]),methodkind:0}),rtl.createClass(this,"TLookupList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return this.FList=pas.Classes.TFPList.$create("Create"),this},this.Destroy=function(){this.Clear(),this.FList.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Clear=function(){this.FList.Clear()}})),rtl.createClass(this,"TField",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAlignment=0,this.FConstraintErrorMessage="",this.FCustomConstraint="",this.FDataSet=null,this.FDataType=0,this.FDefaultExpression="",this.FDisplayLabel="",this.FDisplayWidth=0,this.FFieldDef=null,this.FFieldKind=0,this.FFieldName="",this.FFieldNo=0,this.FFields=null,this.FHasConstraints=!1,this.FImportedConstraint="",this.FKeyFields="",this.FLookupCache=!1,this.FLookupDataSet=null,this.FLookupKeyfields="",this.FLookupresultField="",this.FLookupList=null,this.FOnChange=null,this.FOnGetText=null,this.FOnSetText=null,this.FOnValidate=null,this.FOrigin="",this.FReadOnly=!1,this.FRequired=!1,this.FSize=0,this.FValidChars=[],this.FValueBuffer=void 0,this.FValidating=!1,this.FVisible=!1,this.FProviderFlags={}},this.$final=function(){this.FDataSet=void 0,this.FFieldDef=void 0,this.FFields=void 0,this.FLookupDataSet=void 0,this.FLookupList=void 0,this.FOnChange=void 0,this.FOnGetText=void 0,this.FOnSetText=void 0,this.FOnValidate=void 0,this.FValidChars=void 0,this.FProviderFlags=void 0,pas.Classes.TComponent.$final.call(this)},this.GetIndex=function(){return null!=this.FDataSet?this.FDataSet.FFieldList.IndexOf(this):-1},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.PropertyChanged(!1))},this.SetIndex=function(t){null!==this.FFields&&this.FFields.SetFieldIndex(this,t)},this.GetDisplayText=function(){var t="";return t=rtl.strSetLength(t,0),null!=this.FOnGetText?this.FOnGetText(this,{get:function(){return t},set:function(e){t=e}},!0):this.GetText({get:function(){return t},set:function(e){t=e}},!0),t},this.GetEditText=function(){var t="";return t=rtl.strSetLength(t,0),null!=this.FOnGetText?this.FOnGetText(this,{get:function(){return t},set:function(e){t=e}},!1):this.GetText({get:function(){return t},set:function(e){t=e}},!1),t},this.SetDisplayLabel=function(t){this.FDisplayLabel!==t&&(this.FDisplayLabel=t,this.PropertyChanged(!0))},this.SetDisplayWidth=function(t){this.FDisplayWidth!==t&&(this.FDisplayWidth=t,this.PropertyChanged(!0))},this.GetDisplayWidth=function(){return 0===this.FDisplayWidth?this.GetDefaultWidth():this.FDisplayWidth},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.PropertyChanged(!0))},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.PropertyChanged(!0))},this.IsDisplayLabelStored=function(){return this.GetDisplayName()!==this.FFieldName},this.IsDisplayWidthStored=function(){return 0!==this.FDisplayWidth},this.GetLookupList=function(){return null==this.FLookupList&&(this.FLookupList=t.TLookupList.$create("Create$1")),this.FLookupList},this.CalcLookupValue=function(){null!=this.FLookupDataSet&&this.FLookupDataSet.GetActive()?this.SetAsJSValue(this.FLookupDataSet.Lookup(this.FLookupKeyfields,this.FDataSet.GetFieldValues(this.FKeyFields),this.FLookupresultField)):this.SetAsJSValue(null)},this.RaiseAccessError=function(t){throw this.AccessError(t)},this.AccessError=function(e){return t.EDatabaseError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SInvalidTypeConversion"),pas.System.VarRecs(18,e,18,this.FFieldName)])},this.CheckInactive=function(){null!=this.FDataSet&&this.FDataSet.CheckInactive()},this.CheckTypeSize=function(e){0===e||this.IsBlob()||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Bind=function(e){e&&2===this.FFieldKind&&(null!==this.FLookupDataSet&&""!==this.FLookupKeyfields&&""!==this.FLookupresultField&&""!==this.FKeyFields||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SLookupInfoError"),pas.System.VarRecs(18,this.GetDisplayName())),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.Open(),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.FLookupCache&&this.RefreshLookupList())},this.GetAsBoolean=function(){return this.RaiseAccessError(e.SBoolean),!1,!1},this.GetAsLargeInt=function(){return this.RaiseAccessError(e.SLargeInt),0,0},this.GetAsDateTime=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsFloat=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsInteger=function(){return this.RaiseAccessError(e.SInteger),0,0},this.GetAsJSValue=function(){return this.GetData()},this.GetAsString=function(){return this.GetClassDesc()},this.GetClassDesc=function(){var t;return t=pas.System.Copy(this.$classname,2,pas.System.Pos("Field",this.$classname)-2),this.GetIsNull()?"("+pas.SysUtils.LowerCase(t)+")":"("+pas.SysUtils.UpperCase(t)+")"},this.GetDataSize=function(){return 0,0},this.GetDefaultWidth=function(){return 10,10},this.GetDisplayName=function(){return""!==this.FDisplayLabel?this.FDisplayLabel:this.FFieldName},this.GetIsNull=function(){return pas.JS.isNull(this.GetData())},this.GetText=function(t,e){t.set(this.GetAsString())},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FLookupDataSet&&(this.FLookupDataSet=null)},this.PropertyChanged=function(t){null!==this.FDataSet&&this.FDataSet.GetActive()&&(t?this.FDataSet.DataEvent(4,0):this.FDataSet.DataEvent(2,0))},this.SetAsBoolean=function(t){this.RaiseAccessError(e.SBoolean)},this.SetAsDateTime=function(t){this.RaiseAccessError(e.SDateTime)},this.SetAsFloat=function(t){this.RaiseAccessError(e.SFloat)},this.SetAsInteger=function(t){this.RaiseAccessError(e.SInteger)},this.SetAsJSValue=function(e){if(pas.JS.isNull(e))this.Clear();else try{this.SetVarValue(e)}catch(e){if(!pas.SysUtils.EVariantError.isPrototypeOf(e))throw e;t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SFieldValueError"),pas.System.VarRecs(18,this.GetDisplayName()))}},this.SetAsString=function(t){this.RaiseAccessError(e.SString)},this.SetDataset=function(t){t!==this.FDataSet&&(null!=this.FDataSet&&(this.FDataSet.CheckInactive(),this.FDataSet.FFieldList.Remove(this)),null!=t&&(t.CheckInactive(),t.FFieldList.Add(this)),this.FDataSet=t)},this.SetDataType=function(t){this.FDataType=t},this.SetSize=function(t){this.CheckInactive(),this.$class.CheckTypeSize(t),this.FSize=t},this.SetVarValue=function(t){this.RaiseAccessError(e.SJSValue)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FVisible=!0,this.FValidChars=rtl.arraySetLength(this.FValidChars,"\0",255),this.FProviderFlags=rtl.createSet(0,1),this},this.Destroy=function(){null!=this.FDataSet&&(this.FDataSet.SetActive(!1),null!=this.FFields&&this.FFields.Remove(this)),rtl.free(this,"FLookupList"),pas.Classes.TComponent.Destroy.call(this)},this.SetParentComponent=function(e){this.SetDataset(rtl.as(e,t.TDataSet))},this.Assign=function(e){null===e?this.Clear():t.TField.isPrototypeOf(e)?this.SetAsJSValue(e.GetAsJSValue()):pas.Classes.TPersistent.Assign.call(this,e)},this.Clear=function(){this.SetData(null)},this.GetData=function(){var e=void 0;return null===this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FValidating?e=this.FValueBuffer:(e=this.FDataSet.GetFieldData(this),pas.JS.isUndefined(e)&&(e=null)),e},this.IsBlob=function(){return!1,!1},this.RefreshLookupList=function(){var t;if(null!=this.FLookupDataSet&&0!==this.FLookupKeyfields.length&&0!==this.FLookupresultField.length&&0!==this.FKeyFields.length){t=this.FLookupDataSet.GetActive();try{this.FLookupDataSet.SetActive(!0),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.GetLookupList().Clear(),this.FLookupDataSet.DisableControls();try{for(this.FLookupDataSet.First();!this.FLookupDataSet.GetEOF();)this.FLookupDataSet.Next()}finally{this.FLookupDataSet.EnableControls()}}finally{this.FLookupDataSet.SetActive(t)}}},this.SetData=function(e){null==this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FDataSet.SetFieldData(this,e)},this.SetFieldType=function(t){},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),i.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),i.addProperty("ConstraintErrorMessage",0,rtl.string,"FConstraintErrorMessage","FConstraintErrorMessage"),i.addProperty("DefaultExpression",0,rtl.string,"FDefaultExpression","FDefaultExpression"),i.addProperty("DisplayLabel",15,rtl.string,"GetDisplayName","SetDisplayLabel",{stored:"IsDisplayLabelStored"}),i.addProperty("DisplayWidth",15,rtl.longint,"GetDisplayWidth","SetDisplayWidth",{stored:"IsDisplayWidthStored"}),i.addProperty("FieldKind",0,t.$rtti.TFieldKind,"FFieldKind","FFieldKind"),i.addProperty("FieldName",0,rtl.string,"FFieldName","FFieldName"),i.addProperty("HasConstraints",0,rtl.boolean,"FHasConstraints",""),i.addProperty("Index",3,rtl.longint,"GetIndex","SetIndex"),i.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint"),i.addProperty("KeyFields",0,rtl.string,"FKeyFields","FKeyFields"),i.addProperty("LookupCache",0,rtl.boolean,"FLookupCache","FLookupCache"),i.addProperty("LookupDataSet",0,t.$rtti.TDataSet,"FLookupDataSet","FLookupDataSet"),i.addProperty("LookupKeyFields",0,rtl.string,"FLookupKeyfields","FLookupKeyfields"),i.addProperty("LookupResultField",0,rtl.string,"FLookupresultField","FLookupresultField"),i.addProperty("Origin",0,rtl.string,"FOrigin","FOrigin"),i.addProperty("ProviderFlags",0,t.$rtti.TProviderFlags,"FProviderFlags","FProviderFlags"),i.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),i.addProperty("Required",0,rtl.boolean,"FRequired","FRequired"),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("OnChange",0,t.$rtti.TFieldNotifyEvent,"FOnChange","FOnChange"),i.addProperty("OnGetText",0,t.$rtti.TFieldGetTextEvent,"FOnGetText","FOnGetText"),i.addProperty("OnSetText",0,t.$rtti.TFieldSetTextEvent,"FOnSetText","FOnSetText"),i.addProperty("OnValidate",0,t.$rtti.TFieldNotifyEvent,"FOnValidate","FOnValidate")})),rtl.createClass(this,"TStringField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FFixedChar=!1,this.FTransliterate=!1},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetAsBoolean=function(){var e="";return(e=this.GetAsString()).length>0&&pas.System.upcase(e.charAt(0)).charCodeAt()in rtl.createSet(84,t.YesNoChars[1].charCodeAt())},this.GetAsDateTime=function(){return pas.SysUtils.StrToDateTime(this.GetAsString())},this.GetAsFloat=function(){return pas.SysUtils.StrToFloat(this.GetAsString())},this.GetAsInteger=function(){return pas.SysUtils.StrToInt(this.GetAsString())},this.GetAsLargeInt=function(){return pas.SysUtils.StrToInt64(this.GetAsString())},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isString(t)?""+t:""},this.GetAsJSValue=function(){return this.GetData()},this.GetDefaultWidth=function(){return this.FSize},this.GetText=function(t,e){t.set(this.GetAsString())},this.SetAsBoolean=function(t){t?this.SetAsString("T"):this.SetAsString("F")},this.SetAsDateTime=function(t){this.SetAsString(pas.SysUtils.DateTimeToStr(t,!1))},this.SetAsFloat=function(t){this.SetAsString(pas.SysUtils.FloatToStr(t))},this.SetAsInteger=function(t){this.SetAsString(pas.SysUtils.IntToStr(t))},this.SetAsString=function(t){this.SetData(t)},this.SetVarValue=function(t){rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError(rtl.getResStr(pas.DBConst,"SFieldValueError"))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(1),this.FFixedChar=!1,this.FTransliterate=!1,this.FSize=20,this},this.SetFieldType=function(t){t in rtl.createSet(1,23,24)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:20})})),rtl.createClass(this,"TNumericField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat="",this.FEditFormat=""},this.CheckTypeSize=function(e){e>16&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.RangeError=function(e,i,s){t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SRangeError"),pas.System.VarRecs(3,e,3,i,3,s,18,this.FFieldName))},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.SetEditFormat=function(t){this.FEditFormat!==t&&(this.FEditFormat=t,this.PropertyChanged(!0))},this.GetAsBoolean=function(){return 0!==this.GetAsInteger()},this.SetAsBoolean=function(t){this.SetAsInteger(t+0)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetAlignment(1),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taRightJustify}),e.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat"),e.addProperty("EditFormat",2,rtl.string,"FEditFormat","SetEditFormat")})),rtl.createClass(this,"TIntegerField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsInteger()},this.GetAsInteger=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetText=function(t,e){var i=0,s="";t.set(""),this.GetValue({get:function(){return i},set:function(t){i=t}})&&(0!==(s=e||""===this.FEditFormat?this.FDisplayFormat:this.FEditFormat).length?t.set(pas.SysUtils.FormatFloat(s,i)):t.set(""+i))},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsInteger(Math.round(t))},this.SetAsInteger=function(t){this.CheckRange(t)?this.SetData(t):0!==this.FMinValue||0!==this.FMaxValue?this.RangeError(t,this.FMinValue,this.FMaxValue):this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val$6(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsInteger(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsInteger(rtl.trunc(t)):this.RaiseAccessError(e.SInteger)},this.GetAsLargeInt=function(){return this.GetAsInteger()},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(3),this.FMinRange=-2147483648,this.FMaxRange=2147483647,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("MaxValue",2,rtl.longint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.longint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TSmallIntField",this.TIntegerField,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TWordField",this.TIntegerField,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TLargeintField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsLargeInt()},this.GetAsInteger=function(){return this.GetAsLargeInt()},this.GetAsLargeInt=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetText=function(t,e){var i=0,s="";t.set(""),this.GetValue({get:function(){return i},set:function(t){i=t}})&&(0!==(s=e||""===this.FEditFormat?this.FDisplayFormat:this.FEditFormat).length?t.set(pas.SysUtils.FormatFloat(s,i)):t.set(""+i))},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsLargeInt(Math.round(t))},this.SetAsInteger=function(t){this.SetAsLargeInt(t)},this.SetAsLargeInt=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsLargeInt(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsLargeInt(rtl.trunc(t)):this.RaiseAccessError(e.SLargeInt)},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(25),this.FMinRange=-9007199254740991,this.FMaxRange=9007199254740991,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("MaxValue",2,rtl.nativeint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.nativeint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TAutoIncField",this.TIntegerField,(function(){this.SetAsInteger=function(e){t.TIntegerField.SetAsInteger.apply(this,arguments)},this.Create$1=function(e){return t.TIntegerField.Create$1.call(this,e),this.SetDataType(14),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TFloatField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FCurrency=!1,this.FMaxValue=0,this.FMinValue=0,this.FPrecision=0},this.SetCurrency=function(t){this.FCurrency!==t&&(this.FCurrency=t)},this.SetPrecision=function(t){this.FPrecision=-1===t||t>1?t:2},this.GetAsFloat=function(){var t;return t=this.GetData(),rtl.isNumber(t)?rtl.getNumber(t):0},this.GetAsLargeInt=function(){return Math.round(this.GetAsFloat())},this.GetAsInteger=function(){return Math.round(this.GetAsFloat())},this.GetAsJSValue=function(){var t;return t=this.GetData(),rtl.isNumber(t)?t:null},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isNumber(t)?pas.SysUtils.FloatToStr(rtl.getNumber(t)):""},this.GetText=function(t,e){var i,s,n="",r=0,o=0;t.set(""),s=this.GetData(),rtl.isNumber(s)&&(i=rtl.getNumber(s),n=e||0===this.FEditFormat.length?this.FDisplayFormat:this.FEditFormat,r=0,this.FCurrency?(r=2,o=0):o=1,""!==n?t.set(pas.SysUtils.FormatFloat(n,i)):t.set(pas.SysUtils.FloatToStrF(i,o,this.FPrecision,r)))},this.SetAsFloat=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsInteger=function(t){this.SetAsFloat(t)},this.SetAsString=function(e){var i=0;""===e?this.Clear():(pas.SysUtils.TryStrToFloat$2(e,{get:function(){return i},set:function(t){i=t}})||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAFloat"),pas.System.VarRecs(18,e)),this.SetAsFloat(i))},this.SetVarValue=function(t){rtl.isNumber(t)?this.SetAsFloat(rtl.getNumber(t)):this.RaiseAccessError("Float")},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(6),this.FPrecision=15,this},this.CheckRange=function(t){return 0===this.FMinValue&&0===this.FMaxValue||t>=this.FMinValue&&t<=this.FMaxValue},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Currency",2,rtl.boolean,"FCurrency","SetCurrency",{Default:!1}),e.addProperty("MaxValue",0,rtl.double,"FMaxValue","FMaxValue"),e.addProperty("MinValue",0,rtl.double,"FMinValue","FMinValue"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:15})})),rtl.createClass(this,"TBooleanField",this.TField,(function(){this.FDisplays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.$init=function(){t.TField.$init.call(this),this.FDisplayValues="",this.FDisplays=rtl.arraySetLength(null,"",2,2)},this.$final=function(){this.FDisplays=void 0,t.TField.$final.call(this)},this.SetDisplayValues=function(e){var i=0;this.FDisplayValues!==e&&(((i=pas.System.Pos(";",e))<2||i===e.length)&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidDisplayValues"),pas.System.VarRecs(18,e)),this.FDisplayValues=e,this.FDisplays[0][1]=pas.System.Copy(e,1,i-1),this.FDisplays[1][1]=pas.SysUtils.UpperCase(this.FDisplays[0][1]),this.FDisplays[0][0]=pas.System.Copy(e,i+1,e.length-i),this.FDisplays[1][0]=pas.SysUtils.UpperCase(this.FDisplays[0][0]),this.PropertyChanged(!0))},this.GetAsBoolean=function(){var t;return t=this.GetData(),!!pas.JS.isBoolean(t)&&!(0==t)},this.GetAsString=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?this.FDisplays[0][+!(0==t)]:""},this.GetAsJSValue=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?!(0==t):null},this.GetAsInteger=function(){return this.GetAsBoolean()+0},this.GetDefaultWidth=function(){var t=0;return(t=this.FDisplays[0][0].length)<this.FDisplays[0][1].length&&(t=this.FDisplays[0][1].length),t},this.SetAsBoolean=function(t){this.SetData(t)},this.SetAsString=function(e){var i;""===(i=pas.SysUtils.UpperCase(e))?this.Clear():1===pas.System.Pos(i,this.FDisplays[1][1])?this.SetAsBoolean(!0):1===pas.System.Pos(i,this.FDisplays[1][0])?this.SetAsBoolean(!1):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotABoolean"),pas.System.VarRecs(18,e))},this.SetAsInteger=function(t){this.SetAsBoolean(0!==t)},this.SetVarValue=function(t){pas.JS.isBoolean(t)?this.SetAsBoolean(!(0==t)):rtl.isNumber(t)&&this.SetAsBoolean(0!==rtl.getNumber(t))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(5),this.SetDisplayValues("True;False"),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("DisplayValues",2,rtl.string,"FDisplayValues","SetDisplayValues")})),rtl.createClass(this,"TDateTimeField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat=""},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.ConvertToDateTime=function(e,i){return pas.JS.isNull(e)?0:null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,i):t.TDataSet.DefaultConvertToDateTime(this,e,i)},this.DateTimeToNativeDateTime=function(e){return null!=this.FDataSet?this.FDataSet.ConvertDateTimeToNative(this,e):t.TDataSet.DefaultConvertDateTimeToNative(this,e)},this.GetAsDateTime=function(){return this.ConvertToDateTime(this.GetData(),!1)},this.GetAsFloat=function(){return this.GetAsDateTime()},this.GetAsString=function(){var t="";return this.GetText({get:function(){return t},set:function(e){t=e}},!1),t},this.GetAsJSValue=function(){var t=void 0;return t=this.GetData(),rtl.isString(t)||(t=null),t},this.GetDataSize=function(){return t.TField.GetDataSize.call(this)},this.GetText=function(t,e){var i,s="";if(0===(i=this.ConvertToDateTime(this.GetData(),!1)))t.set("");else{if(e&&0!==this.FDisplayFormat.length)s=this.FDisplayFormat;else{var n=this.FDataType;s=10===n?pas.SysUtils.FormatSettings.LongTimeFormat:9===n?pas.SysUtils.FormatSettings.ShortDateFormat:"c"}t.set(pas.SysUtils.FormatDateTime(s,i))}},this.SetAsDateTime=function(t){this.SetData(this.DateTimeToNativeDateTime(t))},this.SetAsFloat=function(t){this.SetAsDateTime(t)},this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToDateTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.SetVarValue=function(t){this.SetAsDateTime(this.ConvertToDateTime(t,!0))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(11),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat")})),rtl.createClass(this,"TDateField",this.TDateTimeField,(function(){this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(9),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TTimeField",this.TDateTimeField,(function(){this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(10),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TBinaryField",this.TField,(function(){this.CheckTypeSize=function(e){e<1&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.BlobToBytes=function(e){return null!=this.FDataSet?this.FDataSet.BlobDataToBytes(e):t.TDataSet.DefaultBlobDataToBytes(e)},this.BytesToBlob=function(e){return null!=this.FDataSet?this.FDataSet.BytesToBlobData(rtl.arrayRef(e)):t.TDataSet.DefaultBytesToBlobData(rtl.arrayRef(e))},this.GetAsString=function(){var t,e="",i=[],s=0;if(e="",null!=(t=this.GetData()))if(this.FDataType in rtl.createSet(16,17))e=""+t;else{i=this.BlobToBytes(t);for(var n=0,r=rtl.length(i)-1;n<=r;n++)s=n,e=e.concat(String.fromCharCode(i[s]))}return e},this.GetAsJSValue=function(){return this.GetData()},this.SetAsString=function(t){var e=[],i=0;if(this.FDataType in rtl.createSet(16,17))this.SetData(t);else{e=rtl.arraySetLength(e,0,t.length);for(var s=1,n=t.length;s<=n;s++)e[(i=s)-1]=t.charCodeAt(i-1);this.SetAsBytes(e)}},this.SetVarValue=function(t){var e=[],i=0,s=0;if(rtl.isArray(t)){s=rtl.length(t),e=rtl.arraySetLength(e,0,s);for(var n=1,r=s-1;n<=r;n++)e[i=n]=t[i];this.SetAsBytes(e)}else rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError("Blob")},this.GetAsBytes=function(){var t,e=[];return t=this.GetData(),e=pas.System.Assigned(t)?this.BlobToBytes(t):rtl.arraySetLength(e,0,0)},this.SetAsBytes=function(t){this.SetData(this.BytesToBlob(rtl.arrayRef(t)))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:16})})),this.TBlobDisplayValue={0:"dvClass",dvClass:0,1:"dvFull",dvFull:1,2:"dvClip",dvClip:2,3:"dvFit",dvFit:3},this.$rtti.$Enum("TBlobDisplayValue",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBlobDisplayValue}),this.$rtti.$Enum("TBlobType",{minvalue:15,maxvalue:39,ordtype:1,enumtype:this.TFieldType}),rtl.createClass(this,"TBlobField",this.TBinaryField,(function(){this.$init=function(){t.TBinaryField.$init.call(this),this.FDisplayValue=0,this.FModified=!1},this.GetBlobType=function(){t.TFieldType.ftBlob;return this.FDataType},this.SetBlobType=function(t){this.GetBlobType()!==t&&(this.SetFieldType(t),this.PropertyChanged(!0))},this.SetDisplayValue=function(t){this.FDisplayValue!==t&&(this.FDisplayValue=t,this.PropertyChanged(!1))},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetBlobSize=function(){var t;return t=this.GetAsBytes(),rtl.length(t)},this.GetIsNull=function(){return this.FModified?0===this.GetBlobSize():t.TField.GetIsNull.call(this)},this.GetText=function(t,e){var i=this.FDisplayValue;0===i?t.set(this.GetClassDesc()):1===i?t.set(this.GetAsString()):2===i?(t.set(this.GetAsString()),e&&t.get().length>this.GetDisplayWidth()&&t.set(pas.System.Copy(this.GetEditText(),1,this.GetDisplayWidth())+"...")):3===i&&(t.set(this.GetAsString()),e&&t.get().length>this.GetDisplayWidth()&&t.set(this.GetClassDesc()))},this.Create$1=function(e){return t.TBinaryField.Create$1.call(this,e),this.SetDataType(15),this},this.Clear=function(){this.SetData(null)},this.IsBlob=function(){return!0,!0},this.SetFieldType=function(t){t in rtl.createSet(null,15,39)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("DisplayValue",2,t.$rtti.TBlobDisplayValue,"FDisplayValue","SetDisplayValue",{Default:t.TBlobDisplayValue.dvClass}),e.addProperty("BlobType",3,t.$rtti.TBlobType,"GetBlobType","SetBlobType"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TMemoField",this.TBlobField,(function(){this.GetText=function(e,i){e.set(t.TBinaryField.GetAsString.call(this))},this.Create$1=function(e){return t.TBlobField.Create$1.call(this,e),this.SetDataType(16),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TGraphicField",this.TBlobField,(function(){this.Create$1=function(e){return t.TBlobField.Create$1.call(this,e),this.SetDataType(17),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TVariantField",this.TField,(function(){this.CheckTypeSize=function(t){},this.GetAsBoolean=function(){return 1==this.GetAsJSValue()},this.SetAsBoolean=function(t){this.SetVarValue(t)},this.GetAsDateTime=function(){var e;return e=this.GetData(),null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,!0):t.TDataSet.DefaultConvertToDateTime(this,e,!0)},this.SetAsDateTime=function(t){this.SetVarValue(t)},this.GetAsFloat=function(){var t,e=0;return t=this.GetData(),rtl.isNumber(t)?e=rtl.getNumber(t):rtl.isString(t)?e=parseFloat(""+t):this.RaiseAccessError("Variant"),e},this.SetAsFloat=function(t){this.SetVarValue(t)},this.GetAsInteger=function(){var t,e=0;return t=this.GetData(),pas.JS.isInteger(t)?e=rtl.trunc(t):rtl.isString(t)?e=parseInt(""+t):this.RaiseAccessError("Variant"),e},this.SetAsInteger=function(t){this.SetVarValue(t)},this.GetAsString=function(){var t,e="";return t=this.GetData(),pas.JS.isInteger(t)?e=pas.SysUtils.IntToStr(rtl.trunc(t)):rtl.isNumber(t)?e=pas.SysUtils.FloatToStr(rtl.getNumber(t)):rtl.isString(t)?e=""+t:this.RaiseAccessError("Variant"),e},this.SetAsString=function(t){this.SetVarValue(t)},this.GetAsJSValue=function(){return this.GetData()},this.SetVarValue=function(t){this.SetData(t)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(32),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TDataSetField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FNestedDataSet=null},this.$final=function(){this.FNestedDataSet=void 0,t.TField.$final.call(this)},this.AssignNestedDataSet=function(t){null!=this.FNestedDataSet&&(this.FNestedDataSet.Close(),this.FNestedDataSet.FDataSetField=null,null!=this.FDataSet&&this.FDataSet.GetNestedDataSets().Remove(this.FNestedDataSet)),null!=t&&this.FDataSet.GetNestedDataSets().Add(t),this.FNestedDataSet=t},this.Bind=function(e){t.TField.Bind.apply(this,arguments),null!=this.FNestedDataSet&&(e?0===this.FNestedDataSet.FState&&this.FNestedDataSet.Open():this.FNestedDataSet.Close())},this.Create$1=function(e){return t.TField.Create$1.apply(this,arguments),this.SetDataType(29),this},this.Destroy=function(){this.AssignNestedDataSet(null),t.TField.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),this.TIndexOption={0:"ixPrimary",ixPrimary:0,1:"ixUnique",ixUnique:1,2:"ixDescending",ixDescending:2,3:"ixCaseInsensitive",ixCaseInsensitive:3,4:"ixExpression",ixExpression:4,5:"ixNonMaintained",ixNonMaintained:5},this.$rtti.$Enum("TIndexOption",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TIndexOption}),this.$rtti.$Set("TIndexOptions",{comptype:this.$rtti.TIndexOption}),rtl.createClass(this,"TIndexDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FCaseinsFields="",this.FDescFields="",this.FExpression="",this.FFields="",this.FOptions={},this.FSource=""},this.$final=function(){this.FOptions=void 0,t.TNamedItem.$final.call(this)},this.GetExpression=function(){return this.FExpression},this.SetCaseInsFields=function(t){this.FCaseinsFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(3))),this.FCaseinsFields=t)},this.SetDescFields=function(t){this.FDescFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(2))),this.FDescFields=t)},this.SetExpression=function(t){this.FExpression=t},this.Assign=function(e){var i=null;i=null,t.TIndexDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TIndexDef)),null!=i?(this.FName=i.FName,this.FFields=i.FFields,this.FOptions=rtl.refSet(i.FOptions),this.FCaseinsFields=i.FCaseinsFields,this.FDescFields=i.FDescFields,this.FSource=i.FSource,this.FExpression=i.GetExpression()):pas.Classes.TPersistent.Assign.call(this,e)};var e=this.$rtti;e.addProperty("Expression",3,rtl.string,"GetExpression","SetExpression"),e.addProperty("Fields",0,rtl.string,"FFields","FFields"),e.addProperty("CaseInsFields",2,rtl.string,"FCaseinsFields","SetCaseInsFields"),e.addProperty("DescFields",2,rtl.string,"FDescFields","SetDescFields"),e.addProperty("Options",0,t.$rtti.TIndexOptions,"FOptions","FOptions"),e.addProperty("Source",0,rtl.string,"FSource","FSource")})),rtl.createClass(this,"TIndexDefs",this.TDefCollection,(function(){this.GetItem$1=function(e){return rtl.as(pas.Classes.TCollection.GetItem.call(this,e),t.TIndexDef)},this.Find$1=function(e){var i;return null===(i=rtl.as(t.TDefCollection.Find.call(this,e),t.TIndexDef))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SIndexNotFound"),pas.System.VarRecs(18,e),this.FDataset),i}})),rtl.createClass(this,"TCheckConstraint",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCustomConstraint="",this.FErrorMessage="",this.FFromDictionary=!1,this.FImportedConstraint=""},this.Assign=function(t){};var t=this.$rtti;t.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),t.addProperty("ErrorMessage",0,rtl.string,"FErrorMessage","FErrorMessage"),t.addProperty("FromDictionary",0,rtl.boolean,"FFromDictionary","FFromDictionary"),t.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint")})),rtl.createClass(this,"TCheckConstraints",pas.Classes.TCollection,(function(){this.GetOwner=function(){return null,null},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TCheckConstraint),this},this.$rtti.addMethod("Create$2",2,[["AOwner",pas.Classes.$rtti.TPersistent]])})),rtl.createClass(this,"TFields",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FFieldList=null,this.FOnChange=null,this.FValidFieldKinds={}},this.$final=function(){this.FDataset=void 0,this.FFieldList=void 0,this.FOnChange=void 0,this.FValidFieldKinds=void 0,pas.System.TObject.$final.call(this)},this.ClearFieldDefs=function(){for(var t=0,e=0,i=this.GetCount()-1;e<=i;e++)t=e,this.GetField(t).FFieldDef=null},this.Changed=function(){null===this.FDataset||3 in this.FDataset.FComponentState||this.FDataset.DataEvent(9,0),null!=this.FOnChange&&this.FOnChange(this)},this.GetCount=function(){return this.FFieldList.FCount},this.GetField=function(t){return rtl.getObject(this.FFieldList.Get(t))},this.SetFieldIndex=function(t,e){var i;-1!==(i=this.FFieldList.IndexOf(t))&&(e<0&&(e=0),e>=this.GetCount()&&(e=this.GetCount()-1),e!==i&&(this.FFieldList.Delete(i),this.FFieldList.Insert(e,t),t.PropertyChanged(!0),this.Changed()))},this.Create$1=function(t){return this.FDataset=t,this.FFieldList=pas.Classes.TFPList.$create("Create"),this.FValidFieldKinds=rtl.createSet(null,0,3),this},this.Destroy=function(){null!=this.FFieldList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldList},set:function(t){this.p.FFieldList=t}}),pas.System.TObject.Destroy.call(this)},this.Add=function(t){this.CheckFieldName(t.FFieldName),this.FFieldList.Add(t),t.FFields=this,this.Changed()},this.CheckFieldName=function(e){null!==this.FindField(e)&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SDuplicateFieldName"),pas.System.VarRecs(18,e),this.FDataset)},this.CheckFieldNames=function(e){var i="",s=0;if(""!==e){s=1;do{i=t.ExtractFieldName(e,{get:function(){return s},set:function(t){s=t}}),this.FieldByName(i)}while(!(s>e.length))}},this.Clear=function(){for(var t=null;this.FFieldList.FCount>0;)(t=rtl.getObject(this.FFieldList.Last())).FDataSet=null,t=rtl.freeLoc(t),this.FFieldList.Delete(this.FFieldList.FCount-1);this.Changed()},this.FindField=function(t){var e,i=null,s=0;e=pas.SysUtils.UpperCase(t);for(var n=0,r=this.FFieldList.FCount-1;n<=r;n++)if(s=n,i=rtl.getObject(this.FFieldList.Get(s)),e===pas.SysUtils.UpperCase(i.FFieldName))return i;return i=null},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this.FDataset),i},this.IndexOf=function(t){return this.FFieldList.IndexOf(t)},this.Remove=function(t){this.FFieldList.Remove(t),t.FFields=null,this.Changed()}})),this.TParamType={0:"ptUnknown",ptUnknown:0,1:"ptInput",ptInput:1,2:"ptOutput",ptOutput:2,3:"ptInputOutput",ptInputOutput:3,4:"ptResult",ptResult:4},this.$rtti.$Enum("TParamType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TParamType}),rtl.createClass(this,"TParam",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FValue=void 0,this.FPrecision=0,this.FNumericScale=0,this.FName="",this.FDataType=0,this.FBound=!1,this.FParamType=0,this.FSize=0},this.GetDataSet=function(){return null!=this.FCollection&&t.TParams.isPrototypeOf(this.FCollection)?this.FCollection.GetDataSet():null},this.IsParamStored=function(){return this.FBound},this.AssignParam=function(t){null==t?(this.Clear(),this.FDataType=0,this.FParamType=0,this.FName="",this.FSize=0,this.FPrecision=0,this.FNumericScale=0):(this.FDataType=t.FDataType,t.GetIsNull()?this.Clear():this.FValue=t.FValue,this.FBound=t.FBound,this.FName=t.FName,0===this.FParamType&&(this.FParamType=t.FParamType),this.FSize=t.FSize,this.FPrecision=t.FPrecision,this.FNumericScale=t.FNumericScale)},this.AssignTo=function(e){t.TField.isPrototypeOf(e)?this.AssignToField(e):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetAsBoolean=function(){return this.GetIsNull()||1!==this.FDataType?!this.GetIsNull()&&1==this.FValue:pas.SysUtils.StrToBool(""+this.FValue)},this.GetAsDateTime=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()?0:rtl.getNumber(this.FValue):pas.SysUtils.StrToDateTime(""+this.FValue)},this.GetAsFloat=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()?0:rtl.getNumber(this.FValue):pas.SysUtils.StrToFloat(""+this.FValue)},this.GetAsInteger=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()||!pas.JS.isInteger(this.FValue)?0:rtl.trunc(this.FValue):pas.SysUtils.StrToInt(""+this.FValue)},this.GetAsString=function(){return this.GetIsNull()||!rtl.isString(this.FValue)?"":""+this.FValue},this.GetAsJSValue=function(){return this.GetIsNull()?null:this.FValue},this.GetIsNull=function(){return pas.JS.isNull(this.FValue)},this.SetAsMemo=function(t){this.FDataType=16,this.SetAsJSValue(t)},this.SetAsJSValue=function(t){if(this.FValue=t,this.FBound=!pas.JS.isNull(t),this.FBound){var e=pas.JS.GetValueType(t);1===e?this.FDataType=5:2===e?this.FDataType=3:3===e?this.FDataType=6:5!==e&&6!==e||(this.FDataType=15)}},this.SetDataType=function(t){this.FDataType=t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FParamType=0,this.SetDataType(0),this.FValue=null,this},this.Assign=function(e){t.TParam.isPrototypeOf(e)?this.AssignParam(e):t.TField.isPrototypeOf(e)?this.AssignField(e):pas.Classes.TStrings.isPrototypeOf(e)?this.SetAsMemo(e.GetTextStr()):pas.Classes.TPersistent.Assign.call(this,e)},this.AssignField=function(t){null!=t?(this.AssignFieldValue(t,t.GetAsJSValue()),this.FName=t.FFieldName):(this.Clear(),this.FName="")},this.AssignToField=function(e){if(null!=e){var i=this.FDataType;0===i?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SUnknownParamFieldType"),pas.System.VarRecs(18,this.FName),this.GetDataSet()):3===i||14===i?e.SetAsInteger(this.GetAsInteger()):6===i?e.SetAsFloat(this.GetAsFloat()):5===i?e.SetAsBoolean(this.GetAsBoolean()):15===i||1===i||24===i||16===i||23===i?e.SetAsString(this.GetAsString()):10!==i&&9!==i&&11!==i||e.SetAsDateTime(this.GetAsDateTime())}},this.AssignFieldValue=function(t,e){null!=t&&(1===t.FDataType&&t.FFixedChar?this.FDataType=23:16===t.FDataType&&t.FSize>255?this.FDataType=1:this.FDataType=t.FDataType,pas.JS.isNull(e)?this.Clear():this.SetAsJSValue(e),this.FSize=t.GetDataSize(),this.FBound=!0)},this.Clear=function(){this.FValue=null};var e=this.$rtti;e.addMethod("Create$1",2,[["ACollection",pas.Classes.$rtti.TCollection]]),e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("NumericScale",0,rtl.longint,"FNumericScale","FNumericScale",{Default:0}),e.addProperty("ParamType",0,t.$rtti.TParamType,"FParamType","FParamType"),e.addProperty("Precision",0,rtl.longint,"FPrecision","FPrecision",{Default:0}),e.addProperty("Size",0,rtl.longint,"FSize","FSize",{Default:0}),e.addProperty("Value",15,rtl.jsvalue,"GetAsJSValue","SetAsJSValue",{stored:"IsParamStored"})})),rtl.createClass(this,"TParams",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollection.$final.call(this)},this.AssignTo=function(e){t.TParams.isPrototypeOf(e)?e.Assign(this):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetDataSet=function(){return t.TDataSet.isPrototypeOf(this.FOwner)?this.FOwner:null},this.GetOwner=function(){return this.FOwner}})),this.TBookmarkFlag={0:"bfCurrent",bfCurrent:0,1:"bfBOF",bfBOF:1,2:"bfEOF",bfEOF:2,3:"bfInserted",bfInserted:3},rtl.recNewT(this,"TBookmark",(function(){this.Data=void 0,this.Flag=0,this.$eq=function(t){return this.Data===t.Data&&this.Flag===t.Flag},this.$assign=function(t){return this.Data=t.Data,this.Flag=t.Flag,this}})),this.TGetMode={0:"gmCurrent",gmCurrent:0,1:"gmNext",gmNext:1,2:"gmPrior",gmPrior:2},this.TGetResult={0:"grOK",grOK:0,1:"grBOF",grBOF:1,2:"grEOF",grEOF:2,3:"grError",grError:3},this.TResyncMode$a={0:"rmExact",rmExact:0,1:"rmCenter",rmCenter:1},this.TDataAction={0:"daFail",daFail:0,1:"daAbort",daAbort:1,2:"daRetry",daRetry:2},this.$rtti.$Enum("TDataAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDataAction}),this.TLocateOption={0:"loCaseInsensitive",loCaseInsensitive:0,1:"loPartialKey",loPartialKey:1,2:"loFromCurrent",loFromCurrent:2},this.$rtti.$MethodVar("TDataSetNotifyEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet]]),methodkind:0}),this.$rtti.$MethodVar("TDataSetErrorEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["E",this.$rtti.EDatabaseError],["DataAction",this.$rtti.TDataAction,1]]),methodkind:0}),this.TFilterOption={0:"foCaseInsensitive",foCaseInsensitive:0,1:"foNoPartialCompare",foNoPartialCompare:1},this.TLoadOption={0:"loNoOpen",loNoOpen:0,1:"loNoEvents",loNoEvents:1,2:"loAtEOF",loAtEOF:2,3:"loCancelPending",loCancelPending:3},this.$rtti.$MethodVar("TFilterRecordEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["Accept",rtl.boolean,1]]),methodkind:0}),this.TRecordState={0:"rsNew",rsNew:0,1:"rsClean",rsClean:1,2:"rsUpdate",rsUpdate:2,3:"rsDelete",rsDelete:3},rtl.recNewT(this,"TDataRecord",(function(){this.data=void 0,this.state=0,this.bookmark=void 0,this.bookmarkFlag=0,this.$eq=function(t){return this.data===t.data&&this.state===t.state&&this.bookmark===t.bookmark&&this.bookmarkFlag===t.bookmarkFlag},this.$assign=function(t){return this.data=t.data,this.state=t.state,this.bookmark=t.bookmark,this.bookmarkFlag=t.bookmarkFlag,this}})),rtl.createClass(this,"TDataSet",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAfterLoad=null,this.FBeforeLoad=null,this.FBlockReadSize=0,this.FCalcBuffer=t.TDataRecord.$new(),this.FCalcFieldsCount=0,this.FOnLoadFail=null,this.FOpenAfterRead=!1,this.FActiveRecord=0,this.FAfterCancel=null,this.FAfterClose=null,this.FAfterDelete=null,this.FAfterEdit=null,this.FAfterInsert=null,this.FAfterOpen=null,this.FAfterPost=null,this.FAfterScroll=null,this.FAutoCalcFields=!1,this.FBOF=!1,this.FBeforeCancel=null,this.FBeforeClose=null,this.FBeforeDelete=null,this.FBeforeEdit=null,this.FBeforeInsert=null,this.FBeforeOpen=null,this.FBeforePost=null,this.FBeforeScroll=null,this.FBlobFieldCount=0,this.FBuffers=[],this.FBufferCount=0,this.FConstraints=null,this.FDisableControlsCount=0,this.FDisableControlsState=0,this.FCurrentRecord=0,this.FDataSources=null,this.FDefaultFields=!1,this.FEOF=!1,this.FEnableControlsEvent=0,this.FFieldList=null,this.FFieldDefs=null,this.FFilterOptions={},this.FFilterText="",this.FFiltered=!1,this.FInternalCalcFields=!1,this.FModified=!1,this.FOnCalcFields=null,this.FOnDeleteError=null,this.FOnEditError=null,this.FOnFilterRecord=null,this.FOnNewRecord=null,this.FOnPostError=null,this.FRecordCount=0,this.FIsUniDirectional=!1,this.FState=0,this.FInternalOpenComplete=!1,this.FDataProxy=null,this.FDataRequestID=0,this.FChangeList=null,this.FLoadCount=0,this.FMinLoadID=0,this.FDataSetField=null,this.FNestedDataSets=null,this.FNestedDataSetClass=null},this.$final=function(){this.FAfterLoad=void 0,this.FBeforeLoad=void 0,this.FCalcBuffer=void 0,this.FOnLoadFail=void 0,this.FAfterCancel=void 0,this.FAfterClose=void 0,this.FAfterDelete=void 0,this.FAfterEdit=void 0,this.FAfterInsert=void 0,this.FAfterOpen=void 0,this.FAfterPost=void 0,this.FAfterScroll=void 0,this.FBeforeCancel=void 0,this.FBeforeClose=void 0,this.FBeforeDelete=void 0,this.FBeforeEdit=void 0,this.FBeforeInsert=void 0,this.FBeforeOpen=void 0,this.FBeforePost=void 0,this.FBeforeScroll=void 0,this.FBuffers=void 0,this.FConstraints=void 0,this.FDataSources=void 0,this.FFieldList=void 0,this.FFieldDefs=void 0,this.FFilterOptions=void 0,this.FOnCalcFields=void 0,this.FOnDeleteError=void 0,this.FOnEditError=void 0,this.FOnFilterRecord=void 0,this.FOnNewRecord=void 0,this.FOnPostError=void 0,this.FDataProxy=void 0,this.FChangeList=void 0,this.FDataSetField=void 0,this.FNestedDataSets=void 0,this.FNestedDataSetClass=void 0,pas.Classes.TComponent.$final.call(this)},this.DoInsertAppend=function(e){var i=this;function s(e){var s=t.TBookmark.$new(),n=t.TDataRecord.$new(),r=0;if(i.FRecordCount>0&&s.$assign(i.GetBookmark()),e)i.FRecordCount===i.FBufferCount?i.ShiftBuffersBackward():i.FRecordCount>0&&(i.FActiveRecord+=1);else if(i.FRecordCount>0){n.$assign(i.FBuffers[i.FBufferCount]);for(var o=i.FBufferCount,a=i.FActiveRecord+1;o>=a;o--)r=o,i.FBuffers[r].$assign(i.FBuffers[r-1]);i.FBuffers[i.FActiveRecord].$assign(n)}i.InitRecord(i.FBuffers[i.FActiveRecord]),i.CursorPosChanged(),0===i.FRecordCount?i.SetBookmarkFlag(i.FBuffers[i.FActiveRecord],2):(i.FBOF=!1,i.FRecordCount>0&&(i.SetBookmarkData(i.FBuffers[i.FActiveRecord],t.TBookmark.$clone(s)),i.FreeBookmark(t.TBookmark.$clone(s)))),i.InternalInsert(),i.FRecordCount<i.FBufferCount&&(i.FRecordCount+=1)}this.CheckBrowseMode(),this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),i),this.DoBeforeInsert(),this.DoBeforeScroll(),e?(this.ClearBuffers(),this.InternalLast(),this.GetPriorRecords(),this.FRecordCount>0&&(this.FActiveRecord=this.FRecordCount-1),s(!0),this.SetBookmarkFlag(this.FBuffers[this.FActiveRecord],2),this.FBOF=!1,this.FEOF=!0):s(!1),this.SetState(3);try{this.DoOnNewRecord()}catch(t){throw this.SetCurrentRecord(this.FActiveRecord),this.Resync({}),t}this.FModified=!1,this.DataEvent(2,0),this.DoAfterInsert(),this.DoAfterScroll()},this.DoInternalOpen=function(){this.InternalOpen(),this.FInternalOpenComplete=!0,this.FRecordCount=0,this.RecalcBufListSize(),this.FBOF=!0,this.FEOF=0===this.FRecordCount,this.InitChangeList()},this.GetDataProxy=function(){return null===this.FDataProxy&&this.SetDataProxy(this.DoGetDataProxy()),this.FDataProxy},this.RegisterDataSource=function(t){this.FDataSources.Add(t),this.RecalcBufListSize()},this.SetDataProxy=function(t){t!==this.FDataProxy&&(null!=this.FDataProxy&&this.FDataProxy.RemoveFreeNotification(this),this.FDataProxy=t,null!=this.FDataProxy&&this.FDataProxy.FreeNotification(this))},this.ShiftBuffersForward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[this.FBufferCount]);for(var s=this.FBufferCount;s>=1;s--)i=s,this.FBuffers[i].$assign(this.FBuffers[i-1]);this.FBuffers[0].$assign(e)},this.ShiftBuffersBackward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[0]);for(var s=1,n=this.FBufferCount;s<=n;s++)i=s,this.FBuffers[i-1].$assign(this.FBuffers[i]);this.FBuffers[this.FBufferCount].$assign(e)},this.TryDoing=function(e,i){var s=0;for(!0,s=2;2===s;)try{return this.UpdateCursorPos(),e(),!0}catch(e){if(!t.EDatabaseError.isPrototypeOf(e))throw e;s=0,null!=i&&i(this,e,{get:function(){return s},set:function(t){s=t}});if(0===s)throw e;1===s&&pas.SysUtils.Abort()}return!0},this.GetActive=function(){return 0!==this.FState&&12!==this.FState},this.UnRegisterDataSource=function(t){this.FDataSources.Remove(t)},this.HandleRequestResponse=function(t){var e=!1;if(null!=t)if(t.FRequestID<=this.FMinLoadID)t.$destroy("Destroy");else{this.FLoadCount-=1;var i=t.FSuccess;0===i?null!=this.FOnLoadFail&&this.FOnLoadFail(this,t.FRequestID,t.FErrorMsg):1!==i&&2!==i||(e=!1,null!=t.FEvent&&t.FEvent(this,t.FData),1!==t.FSuccess&&(e=this.DataPacketReceived(t)),this.GetActive()||0 in t.FLoadOptions?(2 in t.FLoadOptions&&e&&(this.FEOF=!1),1 in t.FLoadOptions||this.DoAfterLoad()):(1 in t.FLoadOptions||this.DoAfterLoad(),this.Open())),t.$destroy("Destroy")}},this.GetNestedDataSets=function(){return null==this.FNestedDataSets&&(this.FNestedDataSets=pas.Classes.TFPList.$create("Create")),this.FNestedDataSets},this.DataPacketReceived=function(t){return!1,!1},this.DoLoad=function(t,e){var i,s=null;return 1 in t||this.DoBeforeLoad(),(i=null!==this.GetDataProxy())?((s=this.GetDataProxy().GetDataRequest(rtl.refSet(t),rtl.createCallback(this,"HandleRequestResponse"),e)).FDataset=this,this.GetActive()&&s.FBookmark.$assign(this.GetBookmark()),this.FDataRequestID+=1,s.FRequestID=this.FDataRequestID,this.GetDataProxy().DoGetData(s)?this.FLoadCount+=1:s=rtl.freeLoc(s),i):i},this.DoGetDataProxy=function(){return null,null},this.InitChangeList=function(){this.DoneChangeList(),this.FChangeList=pas.Classes.TFPList.$create("Create")},this.DoneChangeList=function(){this.ClearChangeList(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FChangeList},set:function(t){this.p.FChangeList=t}})},this.ClearChangeList=function(){var t=0;if(null!=this.FChangeList)for(var e=0,i=this.FChangeList.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FChangeList.Get(t)).$destroy("Destroy"),this.FChangeList.Put(t,null)},this.GetApplyUpdateData=function(t){return t.data},this.IndexInChangeList=function(e){var i=0;if(i=-1,null==this.FChangeList)return i;for(i=this.FChangeList.FCount-1;i>=0&&0!==this.CompareBookmarks(t.TBookmark.$clone(e),t.TBookmark.$clone(rtl.getObject(this.FChangeList.Get(i)).FBookmark));)i-=1;return i},this.AddToChangeList=function(e){var i,s=null,n=t.TBookmark.$new(),r=void 0;if(s=null,null==this.FChangeList)return s;if(n.$assign(this.GetBookmark()),-1===(i=this.IndexInChangeList(t.TBookmark.$clone(n))))r=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())),s=null!=this.GetDataProxy()?this.GetDataProxy().GetUpdateDescriptor(this,t.TBookmark.$clone(n),r,e):t.TRecordUpdateDescriptor.$create("Create$1",[null,this,t.TBookmark.$clone(n),r,e]),this.FChangeList.Add(s);else{s=rtl.getObject(this.FChangeList.Get(i));var o=e;2===o?1===s.FStatus?this.FChangeList.Delete(i):s.FStatus=2:1===o?t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SErrInsertingSameRecordtwice"),this):0===o&&(s.FData=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())))}return s},this.RemoveFromChangeList=function(t){null!=t&&this.FChangeList},this.RecalcBufListSize=function(){var t=0,e=0,i=0,s=null;if(this.IsCursorOpen()){i=this.FIsUniDirectional?1:10;for(var n=0,r=this.FDataSources.FCount-1;n<=r;n++){t=n;for(var o=0,a=rtl.getObject(this.FDataSources.Get(t)).FDataLinks.GetCount()-1;o<=a;o++)e=o,i<(s=rtl.getObject(rtl.getObject(this.FDataSources.Get(t)).FDataLinks.Get(e))).GetBufferCount()&&(i=s.GetBufferCount())}this.FBufferCount!==i&&(this.SetBufListSize(i),this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&!this.FIsUniDirectional&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords(),this.CursorPosChanged()))}},this.ActivateBuffers=function(){this.FBOF=!1,this.FEOF=!1,this.FActiveRecord=0},this.BindFields=function(e){var i=0,s=0,n=null,r=null;this.FCalcFieldsCount=0,this.FBlobFieldCount=0;for(var o=0,a=this.FFieldList.GetCount()-1;o<=a;o++)i=o,(r=this.FFieldList.GetField(i)).FFieldDef=null,e?r.FFieldKind in rtl.createSet(1,2)?(r.FFieldNo=-1,this.FCalcFieldsCount+=1):-1===(s=this.FFieldDefs.IndexOf(r.FFieldName))?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,r.FFieldName),this):(n=this.FFieldDefs.GetItem$1(s),r.FFieldDef=n,r.FFieldNo=n.FFieldNo,n.FInternalCalcField&&(this.FInternalCalcFields=!0),r.$class.IsBlob()&&(r.FSize=n.FSize,this.FBlobFieldCount+=1)):r.FFieldNo=0,r.Bind(e)},this.BlockReadNext=function(){this.MoveBy(1)};var e=rtl.createSet(1,2,3);this.BookmarkAvailable=function(){return!this.IsEmpty()&&!this.FIsUniDirectional&&this.FState in e&&0===this.GetBookmarkFlag(t.TDataRecord.$clone(this.ActiveBuffer()))},this.CalculateFields=function(t){var e=0;if(this.FCalcBuffer.$assign(t),11!==this.FState&&(this.ClearCalcFields(this.FCalcBuffer),!this.FIsUniDirectional))for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,2===this.FFieldList.GetField(e).FFieldKind&&this.FFieldList.GetField(e).CalcLookupValue();this.DoOnCalcFields()},this.CheckActive=function(){this.GetActive()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SInactiveDataset"),this)},this.CheckInactive=function(){this.GetActive()&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SActiveDataset"),this)},this.CheckBiDirectional=function(){this.FIsUniDirectional&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SUniDirectional"),this)},this.Loaded=function(){pas.Classes.TComponent.Loaded.call(this);try{this.FOpenAfterRead&&this.SetActive(!0)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;var t=e;4 in this.FComponentState&&this.InternalHandleException(t)}},this.ClearBuffers=function(){this.FRecordCount=0,this.FActiveRecord=0,this.FCurrentRecord=-1,this.FBOF=!0,this.FEOF=!0},this.ClearCalcFields=function(t){},this.CloseCursor=function(){this.ClearBuffers(),this.SetBufListSize(1),this.FFieldList.ClearFieldDefs(),this.InternalClose(),this.FInternalOpenComplete=!1},this.CreateFields=function(){for(var t=0,e=0,i=this.FFieldDefs.GetCount()-1;e<=i;e++)t=e,0!==this.FFieldDefs.GetItem$1(t).FDataType&&this.FFieldDefs.GetItem$1(t).CreateField(this)},this.DataEvent=function(t,e){var i=this;var s,n=0,r=t;if(0===r?((s=rtl.getObject(e)).FFieldKind in rtl.createSet(0,3)&&i.SetModified(!0),4!==i.FState&&(0===s.FFieldKind&&(i.FInternalCalcFields?i.RefreshInternalCalcFields(i.FBuffers[i.FActiveRecord]):i.FAutoCalcFields&&0!==i.FCalcFieldsCount&&i.CalculateFields(i.FBuffers[i.FActiveRecord])),s.Change())):2===r||3===r?function(){var t=0,e=null;if(3!==i.FState&&i.UpdateCursorPos(),null!=i.FNestedDataSets)for(var s=0,n=i.GetNestedDataSets().FCount-1;s<=n;s++)t=s,(e=rtl.getObject(i.GetNestedDataSets().Get(t))).GetActive()&&e.DataEvent(11,0)}():4===r&&(this.FEnableControlsEvent=4),!this.ControlsDisabled()&&10!==this.FState)for(var o=0,a=this.FDataSources.FCount-1;o<=a;o++)n=o,rtl.getObject(this.FDataSources.Get(n)).ProcessEvent(t,e)},this.DestroyFields=function(){this.FFieldList.Clear()},this.DoAfterCancel=function(){null!=this.FAfterCancel&&this.FAfterCancel(this)},this.DoAfterClose=function(){null==this.FAfterClose||3 in this.FComponentState||this.FAfterClose(this)},this.DoAfterDelete=function(){null!=this.FAfterDelete&&this.FAfterDelete(this)},this.DoAfterEdit=function(){null!=this.FAfterEdit&&this.FAfterEdit(this)},this.DoAfterInsert=function(){null!=this.FAfterInsert&&this.FAfterInsert(this)},this.DoAfterOpen=function(){null!=this.FAfterOpen&&this.FAfterOpen(this)},this.DoAfterPost=function(){null!=this.FAfterPost&&this.FAfterPost(this)},this.DoAfterScroll=function(){null!=this.FAfterScroll&&this.FAfterScroll(this)},this.DoBeforeCancel=function(){null!=this.FBeforeCancel&&this.FBeforeCancel(this)},this.DoBeforeClose=function(){null==this.FBeforeClose||3 in this.FComponentState||this.FBeforeClose(this)},this.DoBeforeDelete=function(){null!=this.FBeforeDelete&&this.FBeforeDelete(this)},this.DoBeforeEdit=function(){null!=this.FBeforeEdit&&this.FBeforeEdit(this)},this.DoBeforeInsert=function(){null!=this.FBeforeInsert&&this.FBeforeInsert(this)},this.DoBeforeOpen=function(){null!=this.FBeforeOpen&&this.FBeforeOpen(this)},this.DoBeforePost=function(){null!=this.FBeforePost&&this.FBeforePost(this)},this.DoBeforeScroll=function(){null!=this.FBeforeScroll&&this.FBeforeScroll(this)},this.DoOnCalcFields=function(){null!=this.FOnCalcFields&&this.FOnCalcFields(this)},this.DoOnNewRecord=function(){null!=this.FOnNewRecord&&this.FOnNewRecord(this)},this.DoBeforeLoad=function(){null!=this.FBeforeLoad&&this.FBeforeLoad(this)},this.DoAfterLoad=function(){null!=this.FAfterLoad&&this.FAfterLoad(this)},this.GetCalcFields=function(t){var e=0;if(this.FCalcFieldsCount>0||this.FInternalCalcFields){e=this.FState,this.FState=5;try{this.CalculateFields(t)}finally{this.FState=e}}},this.GetCanModify=function(){return!this.FIsUniDirectional},this.GetFieldClass=function(e){return t.DefaultFieldClasses[e]},this.GetfieldCount=function(){return this.FFieldList.GetCount()},this.GetFieldValues=function(t){var e=void 0,i=0,s=null,n=[];s=pas.Classes.TList.$create("Create$1");try{if(this.GetFieldList(s,t),s.GetCount()>1){n=rtl.arraySetLength(n,void 0,s.GetCount());for(var r=0,o=s.GetCount()-1;r<=o;r++)n[i=r]=rtl.getObject(s.Get(i)).GetAsJSValue();e=n}else e=this.FieldByName(t).GetAsJSValue()}finally{s=rtl.freeLoc(s)}return e},this.GetNextRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetNextRecord();)t+=1;return t},this.GetNextRecord=function(){var e,i=t.TDataRecord.$new();return this.FRecordCount>0&&this.SetCurrentRecord(this.FRecordCount-1),(e=0===this.GetRecord(this.FBuffers[this.FBufferCount],1,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.FRecordCount===this.FBufferCount?this.ShiftBuffersBackward():(this.FRecordCount+=1,this.FCurrentRecord=this.FRecordCount-1,i.$assign(this.FBuffers[this.FCurrentRecord]),this.FBuffers[this.FCurrentRecord].$assign(this.FBuffers[this.FBufferCount]),this.FBuffers[this.FBufferCount].$assign(i))):this.CursorPosChanged(),e},this.GetPriorRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetPriorRecord();)t+=1;return t},this.GetPriorRecord=function(){var t;return this.CheckBiDirectional(),this.FRecordCount>0&&this.SetCurrentRecord(0),(t=0===this.GetRecord(this.FBuffers[this.FBufferCount],2,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.ShiftBuffersForward(),this.FRecordCount<this.FBufferCount&&(this.FRecordCount+=1)):this.CursorPosChanged(),t},this.GetRecordCount=function(){return-1,-1},this.GetRecNo=function(){return-1,-1},this.InitFieldDefsFromfields=function(){var t=0;if(0===this.FFieldDefs.GetCount()){this.FFieldDefs.BeginUpdate();try{for(var e=0,i=this.FFieldList.GetCount()-1;e<=i;e++)t=e,this.FFieldList.GetField(t).FFieldKind in rtl.createSet(1,2)||(this.FFieldList.GetField(t).FFieldDef=this.FFieldDefs.$class.FieldDefClass().$create("Create$3",[this.FFieldDefs,this.FFieldList.GetField(t).FFieldName,this.FFieldList.GetField(t).FDataType,this.FFieldList.GetField(t).FSize,this.FFieldList.GetField(t).FRequired,this.FFieldDefs.GetCount()+1]),this.FFieldList.GetField(t).FRequired&&this.FFieldList.GetField(t).FFieldDef.SetAttributes(rtl.unionSet(this.FFieldList.GetField(t).FFieldDef.FAttributes,rtl.createSet(2))),this.FFieldList.GetField(t).FReadOnly&&this.FFieldList.GetField(t).FFieldDef.SetAttributes(rtl.unionSet(this.FFieldList.GetField(t).FFieldDef.FAttributes,rtl.createSet(1))))}finally{this.FFieldDefs.EndUpdate()}}},this.InitRecord=function(t){this.InternalInitRecord(t),this.ClearCalcFields(t)},this.InternalCancel=function(){},this.InternalEdit=function(){},this.InternalInsert=function(){},this.OpenCursor=function(t){t?this.InternalInitFieldDefs():12!==this.FState&&this.DoInternalOpen()},this.OpenCursorcomplete=function(){try{12===this.FState&&this.DoInternalOpen()}finally{this.FInternalOpenComplete?(this.SetState(1),this.DoAfterOpen(),this.IsEmpty()||this.DoAfterScroll()):(this.SetState(0),this.CloseCursor())}},this.RefreshInternalCalcFields=function(t){},this.RestoreState=function(t){this.FState=t,this.FDisableControlsCount-=1},this.SetActive=function(t){if(t&&0===this.FState){if(0 in this.FComponentState)return void(this.FOpenAfterRead=!0);this.DoBeforeOpen(),this.FEnableControlsEvent=4,this.FInternalCalcFields=!1;try{this.FDefaultFields=0===this.GetfieldCount(),this.OpenCursor(!1)}finally{12!==this.FState&&this.OpenCursorcomplete()}this.FModified=!1}else t||0===this.FState||(this.DoBeforeClose(),this.SetState(0),this.FDataRequestID=0,this.DoneChangeList(),this.CloseCursor(),this.DoAfterClose(),this.FModified=!1)},this.SetBufListSize=function(e){var i=0;if(e<0&&(e=0),e!==this.FBufferCount){if(e>this.FBufferCount){this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1);for(var s=this.FBufferCount,n=e;s<=n;s++)i=s,this.FBuffers[i].$assign(this.AllocRecordBuffer())}else if(e<this.FBufferCount&&e>=0&&this.FActiveRecord>e-1){for(var r=0,o=this.FActiveRecord-e;r<=o;r++)i=r,this.ShiftBuffersBackward();this.FActiveRecord=e-1}this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1),this.FBufferCount=e,this.FRecordCount>this.FBufferCount&&(this.FRecordCount=this.FBufferCount)}},this.SetCurrentRecord=function(e){if(this.FCurrentRecord!==e){if(!this.FIsUniDirectional){var i=this.GetBookmarkFlag(t.TDataRecord.$clone(this.FBuffers[e]));0===i?this.InternalSetToRecord(t.TDataRecord.$clone(this.FBuffers[e])):1===i?this.InternalFirst():2===i&&this.InternalLast()}this.FCurrentRecord=e}},this.SetFiltered=function(t){t&&this.CheckBiDirectional(),this.FFiltered=t},this.SetFilterOptions=function(t){this.CheckBiDirectional(),this.FFilterOptions=rtl.refSet(t)},this.SetFilterText=function(t){this.FFilterText=t},this.SetModified=function(t){this.FModified=t},this.SetName=function(t){var e=this;function i(t){var i="",s=0,n=0;for(i=t,s=0,n=0;s<e.FFieldList.GetCount();)i===e.FFieldList.GetField(s).FFieldName?(n+=1,i=t+pas.SysUtils.IntToStr(n)):s+=1;return i}var s,n=0,r="";if(e.FName!==t&&(s=e.FName,pas.Classes.TComponent.SetName.call(this,t),4 in this.FComponentState))for(var o=0,a=this.FFieldList.GetCount()-1;o<=a;o++)n=o,r=s+this.FFieldList.GetField(n).FFieldName,pas.System.Copy(this.FFieldList.GetField(n).FName,1,r.length)===r&&this.FFieldList.GetField(n).SetName(i(t+this.FFieldList.GetField(n).FFieldName))},this.SetOnFilterRecord=function(t){this.CheckBiDirectional(),this.FOnFilterRecord=t},this.SetState=function(t){t!==this.FState&&(this.FState=t,1===t&&(this.FModified=!1),this.DataEvent(6,0))},this.SetTempState=function(t){var e;return e=this.FState,this.FState=t,this.FDisableControlsCount+=1,e},this.AllocRecordBuffer=function(){var e=t.TDataRecord.$new();return e.data=null,e.state=0,e},this.FreeRecordBuffer=function(t){},this.GetBookmarkData=function(t,e){},this.GetBookmarkFlag=function(t){return 0,0},this.GetDataSource=function(){return null,null},this.InternalDelete=function(){},this.InternalFirst=function(){},this.InternalGotoBookmark=function(t){},this.InternalHandleException=function(t){pas.SysUtils.ShowException(t,null)},this.InternalInitRecord=function(t){},this.InternalLast=function(){},this.InternalPost=function(){var e=this;!function(){for(var i=0,s=0,n=e.FFieldList.GetCount()-1;s<=n;s++)i=s,e.FFieldList.GetField(i).FRequired&&!e.FFieldList.GetField(i).FReadOnly&&0===e.FFieldList.GetField(i).FFieldKind&&14!==e.FFieldList.GetField(i).FDataType&&e.FFieldList.GetField(i).GetIsNull()&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNeedField"),pas.System.VarRecs(18,e.FFieldList.GetField(i).GetDisplayName()),e)}()},this.InternalSetToRecord=function(t){},this.SetBookmarkFlag=function(t,e){},this.SetBookmarkData=function(t,e){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FDataProxy&&(this.FDataProxy=null)},this.SetDataSetField=function(e){e!==this.FDataSetField&&(null!==e&&(e.FDataSet===this||null!==e.FDataSet.GetDataSource()&&e.FDataSet.GetDataSource().FDataSet===this)&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SCircularDataLink"),this),null==e||this.$class.InheritsFrom(e.FDataSet.FNestedDataSetClass)||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNestedDataSetClass"),pas.System.VarRecs(18,e.FDataSet.FNestedDataSetClass.$classname),this),this.GetActive()&&this.Close(),null!=this.FDataSetField&&this.FDataSetField.AssignNestedDataSet(null),this.FDataSetField=e,null!=e&&(e.AssignNestedDataSet(this),e.FDataSet.GetActive()&&this.Open()))},this.GetFieldData=function(e){return this.GetFieldData$1(e,t.TDataRecord.$clone(this.ActiveBuffer()))},this.SetFieldData=function(t,e){this.SetFieldData$1(t,this.FBuffers[this.FActiveRecord],e)},this.GetFieldData$1=function(t,e){var i=void 0;return i=e.data[t.FFieldName],pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){e.data[t.FFieldName]=i},this.FieldDefsClass=function(){return t.TFieldDefs},this.FieldsClass=function(){return t.TFields},this.GetBOF=function(){return this.FBOF},this.GetEOF=function(){return this.FEOF},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FFieldDefs=this.$class.FieldDefsClass().$create("Create$4",[this]),this.FFieldList=this.$class.FieldsClass().$create("Create$1",[this]),this.FDataSources=pas.Classes.TFPList.$create("Create"),this.FConstraints=t.TCheckConstraints.$create("Create$2",[this]),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),this.FActiveRecord=0,this.FEOF=!0,this.FBOF=!0,this.FIsUniDirectional=!1,this.FAutoCalcFields=!0,this.FDataRequestID=0,this.FNestedDataSetClass=this.$class.ClassType(),this},this.Destroy=function(){var e=0;for(this.SetActive(!1),this.SetDataSetField(null),rtl.free(this,"FFieldDefs"),rtl.free(this,"FFieldList"),rtl.free(this,"FNestedDataSets");this.FDataSources.FCount>0;)rtl.getObject(this.FDataSources.Get(this.FDataSources.FCount-1)).SetDataSet(null);this.FDataSources.$destroy("Destroy");for(var i=0,s=this.FBufferCount;i<=s;i++)e=i,this.FreeRecordBuffer(this.FBuffers[e]);rtl.free(this,"FConstraints"),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),pas.Classes.TComponent.Destroy.call(this)},this.ActiveBuffer=function(){var e=t.TDataRecord.$new();return-1!==this.FActiveRecord?e.$assign(this.FBuffers[this.FActiveRecord]):e.$assign(t.TDataRecord.$new()),e},this.Append=function(){this.DoInsertAppend(!0)},this.BookmarkValid=function(t){return!1,!1},this.ConvertToDateTime=function(t,e,i){return this.$class.DefaultConvertToDateTime(t,e,i)},this.ConvertDateTimeToNative=function(t,e){return this.$class.DefaultConvertDateTimeToNative(t,e)},this.DefaultConvertToDateTime=function(t,e,i){var s=0;if(s=0,rtl.isString(e)){if(""+e=="")s=0;else if(!pas.DateUtils.TryRFC3339ToDateTime(""+e,{get:function(){return s},set:function(t){s=t}}))throw pas.SysUtils.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SErrInvalidDateTime"),pas.System.VarRecs(18,""+e)])}else rtl.isNumber(e)?s=rtl.getNumber(e):pas.JS.isDate(e)&&(s=pas.SysUtils.JSDateToDateTime(e));return s},this.DefaultConvertDateTimeToNative=function(t,e){return pas.DateUtils.DateTimeToRFC3339(e)},this.BlobDataToBytes=function(t){return this.$class.DefaultBlobDataToBytes(t)},this.DefaultBlobDataToBytes=function(t){var e=[],i="",s=0,n=0,r=0;if(e=rtl.arraySetLength(e,0,0),rtl.isString(t))for(r=(i=""+t).length,e=rtl.arraySetLength(e,0,rtl.trunc((r+1)/2)),s=1,n=0;s<r;)try{e[n]=pas.SysUtils.StrToInt("$"+pas.System.Copy(i,s,2)),s+=2,n+=1}catch(t){e[n]=i.charCodeAt(s-1),s+=1,n+=1}return e},this.BytesToBlobData=function(t){return this.$class.DefaultBytesToBlobData(rtl.arrayRef(t))},this.DefaultBytesToBlobData=function(t){var e=void 0,i="",s=0;if(0===rtl.length(t))e=null;else{i="";for(var n=0,r=rtl.length(t)-1;n<=r;n++)s=n,i=i.concat(pas.SysUtils.IntToHex(t[s],2));e=i}return e},this.Cancel=function(){this.FState in rtl.createSet(2,3)&&(this.DataEvent(7,0),this.DoBeforeCancel(),this.UpdateCursorPos(),this.InternalCancel(),3===this.FState&&1===this.FRecordCount?(this.FEOF=!0,this.FBOF=!0,this.FRecordCount=0,this.InitRecord(this.FBuffers[this.FActiveRecord]),this.SetState(1),this.DataEvent(2,0)):(this.SetState(1),this.SetCurrentRecord(this.FActiveRecord),this.Resync({})),this.DoAfterCancel())},this.CheckBrowseMode=function(){this.CheckActive(),this.DataEvent(7,0);var t=this.FState;2===t||3===t?(this.UpdateRecord(),this.FModified?this.Post():this.Cancel()):4===t&&this.Post()},this.Close=function(){this.SetActive(!1)},this.ControlsDisabled=function(){return this.FDisableControlsCount>0},this.CompareBookmarks=function(t,e){return 0,0},this.CursorPosChanged=function(){this.FCurrentRecord=-1},this.Delete=function(){var e=null;if(this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),this),this.IsEmpty()&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetEmpty"),this),this.FState in rtl.createSet(3))this.Cancel();else{if(this.DataEvent(7,0),this.DoBeforeDelete(),this.DoBeforeScroll(),e=this.AddToChangeList(2),!this.TryDoing(rtl.createCallback(this,"InternalDelete"),this.FOnDeleteError))return void(null!=e&&this.RemoveFromChangeList(e));this.SetState(1),this.SetCurrentRecord(this.FActiveRecord),this.Resync({}),this.DoAfterDelete(),this.DoAfterScroll()}},this.DisableControls=function(){0===this.FDisableControlsCount&&(this.FDisableControlsState=this.FState,this.FEnableControlsEvent=2),this.FDisableControlsCount+=1},this.Edit=function(){this.FState in rtl.createSet(2,3)||(this.CheckBrowseMode(),this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),this),0!==this.FRecordCount?(this.DoBeforeEdit(),this.TryDoing(rtl.createCallback(this,"InternalEdit"),this.FOnEditError)&&(this.GetCalcFields(this.FBuffers[this.FActiveRecord]),this.SetState(2),this.DataEvent(1,0),this.DoAfterEdit())):this.Append())},this.EnableControls=function(){this.FDisableControlsCount>0&&(this.FDisableControlsCount-=1),0===this.FDisableControlsCount&&(this.FState!==this.FDisableControlsState&&this.DataEvent(6,0),0!==this.FState&&0!==this.FDisableControlsState&&this.DataEvent(this.FEnableControlsEvent,0))},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this),i},this.FindField=function(t){return this.FFieldList.FindField(t)},this.First=function(){this.CheckBrowseMode(),this.DoBeforeScroll(),this.FIsUniDirectional?this.FBOF||(this.SetActive(!1),this.SetActive(!0)):this.ClearBuffers();try{this.InternalFirst(),this.FIsUniDirectional||this.GetNextRecords()}finally{this.FBOF=!0,this.DataEvent(2,0),this.DoAfterScroll()}},this.FreeBookmark=function(t){},this.GetBookmark=function(){var e=t.TBookmark.$new();return this.BookmarkAvailable()?this.GetBookmarkData(t.TDataRecord.$clone(this.ActiveBuffer()),e):e.Data=null,e},this.GetFieldList=function(e,i){var s=null,n="",r=0;if(""!==i&&null!==e){r=1;do{n=t.ExtractFieldName(i,{get:function(){return r},set:function(t){r=t}}),s=this.FieldByName(n),e.Add(s)}while(!(r>i.length))}},this.GetFieldList$1=function(e,i){var s=null,n="",r=0;if(""!==i&&null!==e){r=1;do{n=t.ExtractFieldName(i,{get:function(){return r},set:function(t){r=t}}),s=this.FieldByName(n),e.Add(s)}while(!(r>i.length))}},this.GotoBookmark=function(e){pas.JS.isNull(e.Data)||(this.CheckBrowseMode(),this.DoBeforeScroll(),this.InternalGotoBookmark(t.TBookmark.$clone(e)),this.Resync(rtl.createSet(0,1)),this.DoAfterScroll())},this.Insert$1=function(){this.DoInsertAppend(!1)},this.IsEmpty=function(){return this.FBOF&&this.FEOF&&!(3===this.FState)},this.Last=function(){this.CheckBiDirectional(),this.CheckBrowseMode(),this.DoBeforeScroll(),this.ClearBuffers();try{this.InternalLast(),this.GetPriorRecords(),this.FRecordCount>0&&(this.FActiveRecord=this.FRecordCount-1)}finally{this.FEOF=!0,this.DataEvent(2,0),this.DoAfterScroll()}},this.Load=function(e,i){return 2 in e&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SatEOFInternalOnly"),this),3 in e&&this.CancelLoading(),this.DoLoad(rtl.refSet(e),i)},this.Locate=function(t,e,i){return this.CheckBiDirectional(),!1,!1},this.Lookup=function(t,e,i){return this.CheckBiDirectional(),null,null},this.MoveBy=function(t){var e=this,i=0,s=0;var n=0;if(this.CheckBrowseMode(),i=0,s=0,this.DoBeforeScroll(),0===t||t>0&&this.FEOF||t<0&&this.FBOF)return i;try{n=0,n=t>0?function(){var i=0;for(i=0,e.FBOF=!1;t>0&&!e.FEOF;)e.FActiveRecord<e.FRecordCount-1?(e.FActiveRecord+=1,t-=1,s+=1):e.GetNextRecord()?(t-=1,i-=1,s+=1):(e.FEOF=!0,e.DoLoad(rtl.createSet(0,2),null));return i}():function(){var i=0;for(e.CheckBiDirectional(),i=0,e.FEOF=!1;t<0&&!e.FBOF;)e.FActiveRecord>0?(e.FActiveRecord-=1,t+=1,s-=1):e.GetPriorRecord()?(t+=1,i+=1,s-=1):e.FBOF=!0;return i}()}finally{this.DataEvent(3,n),this.DoAfterScroll(),i=s}return i},this.Next=function(){this.FBlockReadSize>0?this.BlockReadNext():this.MoveBy(1)},this.Open=function(){this.SetActive(!0)};var i=[0,1];this.Post=function(){var e=null,s=!1;if(this.UpdateRecord(),this.FState in rtl.createSet(2,3)){if(this.DataEvent(7,0),this.DoBeforePost(),s=3===this.FState,!this.TryDoing(rtl.createCallback(this,"InternalPost"),this.FOnPostError))return;this.CursorPosChanged(),this.SetState(1),this.Resync({}),null!=(e=this.AddToChangeList(i[+s]))&&e.FBookmark.$assign(this.GetBookmark()),this.DoAfterPost()}else 4!==this.FState&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this)},this.Resync=function(e){var i=0,s=0;if(!this.FIsUniDirectional){if(0!==this.GetRecord(this.FBuffers[0],0,!1))if(0 in e)t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNoSuchRecord"),this);else if(0!==this.GetRecord(this.FBuffers[0],1,!0)&&0!==this.GetRecord(this.FBuffers[0],2,!0))return this.ClearBuffers(),this.InternalInitRecord(this.FBuffers[this.FActiveRecord]),void this.DataEvent(2,0);this.FCurrentRecord=0,this.FEOF=!1,this.FBOF=!1,s=1 in e?rtl.trunc(this.FRecordCount/2):this.FActiveRecord,i=0,this.FRecordCount=1,this.FActiveRecord=0;for(;i<s&&this.GetPriorRecord();)i+=1;this.FActiveRecord=i,this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords()),this.DataEvent(2,0)}},this.CancelLoading=function(){this.FMinLoadID=this.FDataRequestID,this.FLoadCount=0},this.UpdateCursorPos=function(){this.FRecordCount>0&&this.SetCurrentRecord(this.FActiveRecord)},this.UpdateRecord=function(){this.FState in t.dsEditModes||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this),this.DataEvent(5,0)},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TDataLink",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFirstRecord=0,this.FBufferCount=0,this.FActive=!1,this.FDataSourceFixed=!1,this.FEditing=!1,this.FReadOnly=!1,this.FUpdatingRecord=!1,this.FVisualControl=!1,this.FDataSource=null},this.$final=function(){this.FDataSource=void 0,pas.Classes.TPersistent.$final.call(this)},this.CalcFirstRecord=function(t){var e=0;return e=this.FDataSource.FDataSet.FActiveRecord>this.FFirstRecord+t+this.FBufferCount-1?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t+this.FBufferCount-1):this.FDataSource.FDataSet.FActiveRecord<this.FFirstRecord+t?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t):0,this.FFirstRecord+=t+e,e},this.CalcRange=function(){var t=0,e=0;(e=this.GetDataset().FActiveRecord-this.FBufferCount+1)<0&&(e=0),(t=this.GetDataset().FBufferCount-this.FBufferCount)<0&&(t=0),t>this.GetDataset().FActiveRecord&&(t=this.GetDataset().FActiveRecord),this.FFirstRecord<e&&(this.FFirstRecord=e),this.FFirstRecord>t&&(this.FFirstRecord=t),0!==this.FFirstRecord&&this.GetDataset().FActiveRecord-this.FFirstRecord<this.FBufferCount-1&&(this.FFirstRecord-=1)},this.CheckActiveAndEditing=function(){var e=!1;(e=null!=this.FDataSource&&!(this.FDataSource.FState in rtl.createSet(0,12)))!==this.FActive&&(this.FActive=e,this.ActiveChanged()),(e=null!=this.FDataSource&&this.FDataSource.FState in t.dsEditModes&&!this.FReadOnly)!==this.FEditing&&(this.FEditing=e,this.EditingChanged())},this.GetDataset=function(){return null!=this.FDataSource?this.FDataSource.FDataSet:null},this.SetActive=function(t){this.FActive!==t&&(this.FActive=t,this.ActiveChanged())},this.SetDataSource=function(t){this.FDataSource!==t&&(this.FDataSourceFixed||(null!=this.FDataSource&&(this.FDataSource.UnregisterDataLink(this),this.FDataSource=null,this.CheckActiveAndEditing()),this.FDataSource=t,null!=this.FDataSource&&(this.FDataSource.RegisterDataLink(this),this.CheckActiveAndEditing())))},this.ActiveChanged=function(){this.FFirstRecord=0},this.CheckBrowseMode=function(){},this.DataEvent=function(t,e){if(6===t)this.CheckActiveAndEditing();else if(this.FActive){var i=t;0===i||1===i?this.FUpdatingRecord||this.RecordChanged(rtl.getObject(e)):2===i?(this.SetActive(this.FDataSource.FDataSet.GetActive()),this.CalcRange(),this.CalcFirstRecord(rtl.trunc(e)),this.DataSetChanged()):3===i?this.DataSetScrolled(this.CalcFirstRecord(rtl.trunc(e))):4===i?(this.CalcFirstRecord(rtl.trunc(e)),this.LayoutChanged()):5===i?this.UpdateRecord():7===i?this.CheckBrowseMode():10===i&&this.FocusControl(e)}},this.DataSetChanged=function(){this.RecordChanged(null)},this.DataSetScrolled=function(t){this.DataSetChanged()},this.EditingChanged=function(){},this.FocusControl=function(t){},this.GetBOF=function(){return this.GetDataset().GetBOF()},this.GetBufferCount=function(){return this.FBufferCount},this.GetEOF=function(){return this.GetDataset().GetEOF()},this.LayoutChanged=function(){this.DataSetChanged()},this.MoveBy=function(t){return this.GetDataset().MoveBy(t)},this.RecordChanged=function(t){},this.UpdateData=function(){},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FBufferCount=1,this.FFirstRecord=0,this.FDataSource=null,this.FDataSourceFixed=!1,this},this.Destroy=function(){this.FActive=!1,this.FEditing=!1,this.FDataSourceFixed=!1,this.SetDataSource(null),pas.System.TObject.Destroy.call(this)},this.UpdateRecord=function(){this.FUpdatingRecord=!0;try{this.UpdateData()}finally{this.FUpdatingRecord=!1}},this.$rtti.addMethod("Create$1",2,[])})),this.$rtti.$MethodVar("TDataChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Field",this.$rtti.TField]]),methodkind:0}),rtl.createClass(this,"TDataSource",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataSet=null,this.FDataLinks=null,this.FEnabled=!1,this.FAutoEdit=!1,this.FState=0,this.FOnStateChange=null,this.FOnDataChange=null,this.FOnUpdateData=null},this.$final=function(){this.FDataSet=void 0,this.FDataLinks=void 0,this.FOnStateChange=void 0,this.FOnDataChange=void 0,this.FOnUpdateData=void 0,pas.Classes.TComponent.$final.call(this)},this.DistributeEvent=function(t,e){for(var i=0,s=0,n=this.FDataLinks.GetCount()-1;s<=n;s++)i=s,rtl.getObject(this.FDataLinks.Get(i)).FVisualControl||rtl.getObject(this.FDataLinks.Get(i)).DataEvent(t,e);for(var r=0,o=this.FDataLinks.GetCount()-1;r<=o;r++)i=r,rtl.getObject(this.FDataLinks.Get(i)).FVisualControl&&rtl.getObject(this.FDataLinks.Get(i)).DataEvent(t,e)},this.RegisterDataLink=function(t){this.FDataLinks.Add(t),null!=this.FDataSet&&this.FDataSet.RecalcBufListSize()};var e=rtl.createSet(1,2,3,4,6);this.ProcessEvent=function(t,i){var s=!1,n=0;if(6===t){if(s=0===this.FState,n=this.FState,null!=this.FDataSet&&this.FEnabled?this.FState=this.FDataSet.FState:this.FState=0,this.FState===n)return}else s=!0;this.DistributeEvent(t,i),3 in this.FComponentState||(6===t&&this.DoStateChange(),t in e&&s&&this.DoDataChange(null),0===t&&this.DoDataChange(i),5===t&&this.DoUpdateData())},this.SetDataSet=function(t){null!==this.FDataSet&&(this.FDataSet.UnRegisterDataSource(this),this.FDataSet=null,this.ProcessEvent(6,0)),null!==t&&(t.RegisterDataSource(this),this.FDataSet=t,this.ProcessEvent(6,0))},this.SetEnabled=function(t){this.FEnabled=t,this.ProcessEvent(6,0)},this.UnregisterDataLink=function(t){this.FDataLinks.Remove(t),null!==this.FDataSet&&this.FDataSet.RecalcBufListSize()},this.DoDataChange=function(t){null!=this.FOnDataChange&&(null!=t?this.FOnDataChange(this,t):this.FOnDataChange(this,null))},this.DoStateChange=function(){null!=this.FOnStateChange&&this.FOnStateChange(this)},this.DoUpdateData=function(){null!=this.FOnUpdateData&&this.FOnUpdateData(this)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FDataLinks=pas.Classes.TList.$create("Create$1"),this.FEnabled=!0,this.FAutoEdit=!0,this},this.Destroy=function(){for(this.FOnStateChange=null,this.SetDataSet(null);this.FDataLinks.GetCount()>0;)rtl.getObject(this.FDataLinks.Get(this.FDataLinks.GetCount()-1)).SetDataSource(null);rtl.free(this,"FDataLinks"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("AutoEdit",0,rtl.boolean,"FAutoEdit","FAutoEdit",{Default:!0}),i.addProperty("DataSet",2,t.$rtti.TDataSet,"FDataSet","SetDataSet"),i.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),i.addProperty("OnStateChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnStateChange","FOnStateChange"),i.addProperty("OnDataChange",0,t.$rtti.TDataChangeEvent,"FOnDataChange","FOnDataChange"),i.addProperty("OnUpdateData",0,pas.Classes.$rtti.TNotifyEvent,"FOnUpdateData","FOnUpdateData")})),this.TDataRequestResult={0:"rrFail",rrFail:0,1:"rrEOF",rrEOF:1,2:"rrOK",rrOK:2},rtl.createClass(this,"TDataRequest",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FDataset=null,this.FErrorMsg="",this.FEvent=null,this.FLoadOptions={},this.FRequestID=0,this.FSuccess=0,this.FData=void 0,this.FAfterRequest=null,this.FDataProxy=null},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FEvent=void 0,this.FLoadOptions=void 0,this.FAfterRequest=void 0,this.FDataProxy=void 0,pas.System.TObject.$final.call(this)},this.DoAfterRequest=function(){null!=this.FAfterRequest&&this.FAfterRequest(this)},this.Create$1=function(t,e,i,s){return this.FDataProxy=t,this.FLoadOptions=rtl.refSet(e),this.FEvent=s,this.FAfterRequest=i,this}})),rtl.createClass(this,"TRecordUpdateDescriptor",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FData=void 0,this.FDataset=null,this.FProxy=null,this.FStatus=0},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FProxy=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s,n){return this.FDataset=e,this.FBookmark.$assign(i),this.FData=s,this.FStatus=n,this.FProxy=t,this}})),rtl.createClass(this,"TDataProxy",pas.Classes.TComponent,(function(){this.GetDataRequestClass=function(){return t.TDataRequest},this.GetUpdateDescriptorClass=function(){return t.TRecordUpdateDescriptor},this.GetDataRequest=function(t,e,i){return this.GetDataRequestClass().$create("Create$1",[this,rtl.refSet(t),e,i])},this.GetUpdateDescriptor=function(e,i,s,n){return this.GetUpdateDescriptorClass().$create("Create$1",[this,e,t.TBookmark.$clone(i),s,n])},rtl.addIntf(this,pas.System.IUnknown)})),this.FieldTypeNames=["Unknown","String","SmallInt","Integer","Word","Boolean","Float","Currency","BCD","Date","Time","DateTime","Bytes","VarBytes","AutoInc","Blob","Memo","Graphic","FmtMemo","ParadoxOle","dBaseOle","TypedBinary","Cursor","FixedChar","WideString","LargeInt","ADT","Array","Reference","DataSet","OraBlob","OraClob","Variant","Interface","IDispatch","Guid","TimeStamp","FMTBcd","FixedWideChar","WideMemo","OraTimeStamp","OraInterval","LongWord","ShortInt","Byte","Extended","Connection","Params","Stream","TimeStampOffset","Object","Single"],this.DefaultFieldClasses=[null,this.TStringField,this.TSmallIntField,this.TIntegerField,this.TWordField,this.TBooleanField,this.TFloatField,null,null,this.TDateField,this.TTimeField,this.TDateTimeField,null,null,this.TAutoIncField,this.TBlobField,this.TMemoField,this.TGraphicField,this.TBlobField,this.TBlobField,this.TBlobField,this.TBlobField,null,this.TStringField,null,this.TLargeintField,null,null,null,this.TDataSetField,this.TBlobField,this.TMemoField,this.TVariantField,null,null,null,null,null,null,null,null,this.TStringField,null,null,null,null,null,null,null,null,null,null],this.dsEditModes=rtl.createSet(2,3,4),this.DatabaseError=function(e){throw t.EDatabaseError.$create("Create$1",[e])},this.DatabaseError$1=function(e,i){if(null!=i&&""!==i.FName)throw t.EDatabaseError.$create("CreateFmt",["%s : %s",pas.System.VarRecs(18,i.FName,18,e)]);t.DatabaseError(e)},this.DatabaseErrorFmt=function(e,i){throw t.EDatabaseError.$create("CreateFmt",[e,i])},this.DatabaseErrorFmt$1=function(e,i,s){if(null!=s)throw t.EDatabaseError.$create("CreateFmt",[pas.SysUtils.Format("%s : %s",pas.System.VarRecs(18,s.FName,18,e)),i]);t.DatabaseErrorFmt(e,i)},this.ExtractFieldName=function(t,e){var i,s,n=0;for(n=e.get(),s=t.length;n<=s&&";"!==t.charAt(n-1);)n+=1;return i=pas.SysUtils.Trim(pas.System.Copy(t,e.get(),n-e.get())),n<=s&&";"===t.charAt(n-1)&&(n+=1),e.set(n),i},t.$implcode=function(){e.DefaultBufferCount=10,e.SBoolean="Boolean",e.SDateTime="TDateTime",e.SFloat="Float",e.SInteger="Integer",e.SLargeInt="NativeInt",e.SJSValue="JSValue",e.SString="String"}}),["DBConst","TypInfo"]),rtl.module("fpexprpars",["System","Classes","SysUtils","contnrs","JS"],(function(){"use strict";var t=this,e=t.$impl;this.TTokenType={0:"ttPlus",ttPlus:0,1:"ttMinus",ttMinus:1,2:"ttLessThan",ttLessThan:2,3:"ttLargerThan",ttLargerThan:3,4:"ttEqual",ttEqual:4,5:"ttDiv",ttDiv:5,6:"ttMod",ttMod:6,7:"ttMul",ttMul:7,8:"ttLeft",ttLeft:8,9:"ttRight",ttRight:9,10:"ttLessThanEqual",ttLessThanEqual:10,11:"ttLargerThanEqual",ttLargerThanEqual:11,12:"ttunequal",ttunequal:12,13:"ttNumber",ttNumber:13,14:"ttString",ttString:14,15:"ttIdentifier",ttIdentifier:15,16:"ttComma",ttComma:16,17:"ttAnd",ttAnd:17,18:"ttOr",ttOr:18,19:"ttXor",ttXor:19,20:"ttTrue",ttTrue:20,21:"ttFalse",ttFalse:21,22:"ttNot",ttNot:22,23:"ttif",ttif:23,24:"ttCase",ttCase:24,25:"ttPower",ttPower:25,26:"ttLike",ttLike:26,27:"ttEOF",ttEOF:27},this.ttComparisons=rtl.createSet(3,2,11,10,4,12,26),this.$rtti.$Class("TFPExpressionParser"),this.$rtti.$ClassRef("TFPExprFunctionClass",{instancetype:this.$rtti.TFPExprFunction}),this.TNumberKind={0:"nkDecimal",nkDecimal:0,1:"nkHex",nkHex:1,2:"nkOctal",nkOctal:2,3:"nkBinary",nkBinary:3},rtl.createClass(this,"TFPExpressionScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FSource="",this.LSource=0,this.FPos=0,this.FChar="\0",this.FToken="",this.FTokenType=0,this.FAllowLike=!1},this.GetCurrentChar=function(){return this.FChar},this.ScanError=function(e){throw t.EExprScanner.$create("Create$1",[e])},this.SetSource=function(t){this.FSource=t,this.LSource=this.FSource.length,this.FTokenType=27,0===this.LSource?(this.FPos=0,this.FChar=e.cNull):(this.FPos=1,this.FChar=this.FSource.charAt(0)),this.FToken=""},this.DoIdentifier=function(){var i,s="\0",n=!1;for(s=this.GetCurrentChar(),n=!1;!this.IsWordDelim(s)&&s!==e.cNull||n&&" "===s;){if("["===s&&(n=!0),"]"===s&&(n=!1),'"'!==s)this.FToken=this.FToken+s;else{for(s=this.NextPos();!(s.charCodeAt()in rtl.createSet(e.cNull.charCodeAt(),34));)this.FToken=this.FToken+s,s=this.NextPos();'"'!==s&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedIdentifier"),pas.System.VarRecs(18,this.FToken)))}s=this.NextPos()}return"or"===(i=pas.SysUtils.LowerCase(this.FToken))?18:"xor"===i?19:"and"===i?17:"true"===i?20:"false"===i?21:"not"===i?22:"if"===i?23:"case"===i?24:"mod"===i?6:"like"===i&&this.FAllowLike?26:15},this.DoNumber=function(i){var s=this,n="\0",r=0,o=0,a="\0";function l(t,i){var n=!1;if(!(n=s.IsDigit(t,i))){var r=i;0===r?n=""!==s.FToken&&"E"===pas.System.upcase(t)||""!==s.FToken&&t.charCodeAt()in rtl.createSet(43,45)&&"E"===a:1===r?n=t===e.cHexIdentifier&&"\0"===a:2===r?n=t===e.cOctalIdentifier&&"\0"===a:3===r&&(n=t===e.cBinaryIdentifier&&"\0"===a)}return n}for(n=this.GetCurrentChar(),a="\0";n!==e.cNull;){if(this.IsWordDelim(n)){var h=i;if(0===h){if(!(a.charCodeAt()in rtl.createSet(69,45,43)))break}else{if(1===h||2===h)break;if(3===h&&"\0"!==a)break}}l(n,i)||this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumberChar"),pas.System.VarRecs(9,n))),this.FToken=this.FToken+n,a=pas.System.upcase(n),n=this.NextPos()}return pas.System.val$8(this.FToken,{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),0!==o&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumber"),pas.System.VarRecs(18,this.FToken))),13,13},this.DoDelimiter=function(){var e,i,s=0,n="\0";if(n=this.FChar,this.FToken=n,e=n.charCodeAt()in rtl.createSet(60,62),i=n,n=this.NextPos(),e&&n.charCodeAt()in rtl.createSet(61,62))this.FToken=this.FToken+n,this.NextPos(),s=">"===i?11:">"===n?12:10;else{"+"===i?s=0:"-"===i?s=1:"<"===i?s=2:">"===i?s=3:"="===i?s=4:"/"===i?s=5:"*"===i?s=7:"("===i?s=8:")"===i?s=9:","===i?s=16:"^"===i?s=25:this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SUnknownDelimiter"),pas.System.VarRecs(9,i)))}return s},this.DoString=function(){var i=this;function s(t){return t===e.cNull||t===e.cSingleQuote&&!(i.FPos<i.LSource&&i.FSource.charAt(i.FPos+1-1)===e.cSingleQuote)}var n="\0";for(this.FToken="",n=this.NextPos();!s(n);)this.FToken=this.FToken+n,n===e.cSingleQuote&&this.NextPos(),n=this.NextPos();return n===e.cNull&&this.ScanError(rtl.getResStr(t,"SBadQuotes")),14,this.FTokenType=14,this.NextPos(),14},this.NextPos=function(){return this.FPos+=1,this.FPos>this.FSource.length?this.FChar=e.cNull:this.FChar=this.FSource.charAt(this.FPos-1),this.FChar},this.SkipWhiteSpace=function(){for(;this.FChar.charCodeAt()in e.WhiteSpace&&this.FPos<=this.LSource;)this.NextPos()},this.IsWordDelim=function(t){return t.charCodeAt()in e.WordDelimiters},this.IsDelim=function(t){return t.charCodeAt()in e.Delimiters},this.IsDigit=function(t,i){var s=!1,n=i;return 0===n?s=t.charCodeAt()in e.Digits:1===n?s=t.charCodeAt()in e.HexDigits:2===n?s=t.charCodeAt()in e.OctalDigits:3===n&&(s=t.charCodeAt()in e.BinaryDigits),s},this.IsAlpha=function(t){return t.charCodeAt()in rtl.createSet(null,65,90,null,97,122)},this.Create$1=function(){return this.SetSource(""),this},this.GetToken=function(){var i,s=0;return this.FToken="",this.SkipWhiteSpace(),(i=this.FChar)===e.cNull?s=27:this.IsDelim(i)?s=this.DoDelimiter():i===e.cSingleQuote?s=this.DoString():i===e.cHexIdentifier?s=this.DoNumber(1):i===e.cOctalIdentifier?s=this.DoNumber(2):i===e.cBinaryIdentifier?s=this.DoNumber(3):this.IsDigit(i,0)?s=this.DoNumber(0):this.IsAlpha(i)||'"'===i||"_"===i||"["===i||"]"===i?s=this.DoIdentifier():this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownCharacter"),pas.System.VarRecs(0,this.FPos,9,i))),this.FTokenType=s,s}})),rtl.createClass(this,"EExprScanner",pas.SysUtils.Exception,(function(){})),this.TResultType={0:"rtBoolean",rtBoolean:0,1:"rtInteger",rtInteger:1,2:"rtFloat",rtFloat:2,3:"rtDateTime",rtDateTime:3,4:"rtString",rtString:4,5:"rtCurrency",rtCurrency:5},this.$rtti.$Enum("TResultType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TResultType}),rtl.recNewT(this,"TFPExpressionResult",(function(){this.ResultType=0,this.resValue=void 0,this.$eq=function(t){return this.ResultType===t.ResultType&&this.resValue===t.resValue},this.$assign=function(t){return this.ResultType=t.ResultType,this.resValue=t.resValue,this};var e=t.$rtti.$Record("TFPExpressionResult",{});e.addField("ResultType",t.$rtti.TResultType),e.addField("resValue",rtl.jsvalue)})),this.$rtti.$DynArray("TExprParameterArray",{eltype:this.$rtti.TFPExpressionResult}),rtl.createClass(this,"TFPExprNode",pas.System.TObject,(function(){this.CheckNodeType=function(i,s){var n="",r=0;if(null===i&&e.RaiseParserError(rtl.getResStr(t,"SErrNoNodeToCheck")),!(i.NodeType()in s)){for(n="",r=0;r<=5;r++)r in s&&(""!==n&&(n+=","),n+=t.ResultTypeName(r));e.RaiseParserError$1(rtl.getResStr(t,"SInvalidNodeType"),pas.System.VarRecs(18,t.ResultTypeName(i.NodeType()),18,n,18,i.AsString()))}},this.NodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.GetNodeValue()),e}})),rtl.createClass(this,"TFPBinaryOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FLeft=null,this.FRight=null},this.$final=function(){this.FLeft=void 0,this.FRight=void 0,t.TFPExprNode.$final.call(this)},this.CheckSameNodeTypes=function(){var i,s;i=this.FLeft.NodeType(),(s=this.FRight.NodeType())!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrTypesDoNotMatch"),pas.System.VarRecs(18,t.ResultTypeName(i),18,t.ResultTypeName(s),18,this.FLeft.AsString(),18,this.FRight.AsString()))},this.Create$1=function(t,e){return this.FLeft=t,this.FRight=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLeft},set:function(t){this.p.FLeft=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FRight},set:function(t){this.p.FRight=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FLeft&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoleftOperand"),pas.System.VarRecs(18,this.$classname)),null==this.FRight&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoRightOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPBooleanOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,rtl.createSet(1,0)),this.CheckNodeType(this.FRight,rtl.createSet(1,0)),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPBinaryAndOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue||0==i.resValue):1===s&&(e.resValue=rtl.and(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" and "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue&&0==i.resValue):1===s&&(e.resValue=rtl.or(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" or "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryXOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue)^!(0==i.resValue):1===s&&(e.resValue=rtl.xor(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" xor "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBooleanResultOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckSameNodeTypes()},this.NodeType=function(){return 0,0}})),rtl.createClass(this,"TFPEqualOperation",this.TFPBooleanResultOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=e.resValue==i.resValue,e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" = "+this.FRight.AsString()}})),rtl.createClass(this,"TFPLikeOperation",this.TFPBooleanResultOperation,(function(){this.$init=function(){t.TFPBooleanResultOperation.$init.call(this),this.FRE=null,this.FLast=""},this.$final=function(){this.FRE=void 0,t.TFPBooleanResultOperation.$final.call(this)};this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i="",s=null;if(i=""+this.FRight.NodeValue().resValue,""!==this.FLast&&i===this.FLast)s=this.FRE;else{this.FLast=i,i=i.replace(new RegExp("([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])","g"),"\\$1"),i=pas.SysUtils.StringReplace(i,"%","(.*)",rtl.createSet(0)),i="^"+(i=pas.SysUtils.StringReplace(i,"_","(.)",rtl.createSet(0)))+"$";try{this.FRE=new RegExp(i,"i"),s=this.FRE}catch(t){return e.resValue=!1,e}}return e.resValue=s.test(""+this.FLeft.NodeValue().resValue),e},this.Check=function(){4!==this.FLeft.NodeType()&&e.RaiseParserError$1(rtl.getResStr(t,"SErrStringTypeRequired"),pas.System.VarRecs(18,t.ResultTypeName(this.FLeft.NodeType()),18,this.FLeft.AsString())),4!==this.FRight.NodeType()&&e.RaiseParserError$1(rtl.getResStr(t,"SErrStringTypeRequired"),pas.System.VarRecs(18,t.ResultTypeName(this.FRight.NodeType()),18,this.FRight.AsString())),t.TFPBooleanResultOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" LIKE "+this.FRight.AsString()}})),rtl.createClass(this,"TFPUnequalOperation",this.TFPEqualOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPEqualOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <> "+this.FRight.AsString()}})),rtl.createClass(this,"TFPOrderingOperation",this.TFPBooleanResultOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TFPBooleanResultOperation.Check.call(this)}})),rtl.createClass(this,"TFPLessThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)<rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):5===s?e.resValue=rtl.trunc(1e4*e.resValue)<rtl.trunc(1e4*i.resValue):3===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue<""+i.resValue),e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" < "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;if(1===s){var n=this.FRight.NodeType();1===n?e.resValue=rtl.trunc(e.resValue)>rtl.trunc(i.resValue):2===n?e.resValue=rtl.trunc(e.resValue)>rtl.getNumber(i.resValue):5===n&&(e.resValue=1e4*rtl.trunc(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(2===s){var r=this.FRight.NodeType();1===r?e.resValue=rtl.getNumber(e.resValue)>rtl.trunc(i.resValue):2===r?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):5===r&&(e.resValue=1e4*rtl.getNumber(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(5===s){var o=this.FRight.NodeType();1===o?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.trunc(i.resValue):2===o?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.getNumber(i.resValue):5===o&&(e.resValue=rtl.trunc(1e4*e.resValue)>rtl.trunc(1e4*i.resValue))}else 3===s?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue>""+i.resValue);return e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" > "+this.FRight.AsString()}})),rtl.createClass(this,"TFPLessThanEqualOperation",this.TFPGreaterThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPGreaterThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <= "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanEqualOperation",this.TFPLessThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPLessThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" >= "+this.FRight.AsString()}})),rtl.createClass(this,"TIfOperation",this.TFPBinaryOperation,(function(){this.$init=function(){t.TFPBinaryOperation.$init.call(this),this.FCondition=null},this.$final=function(){this.FCondition=void 0,t.TFPBinaryOperation.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FCondition.GetNodeValue()),0!=e.resValue?e.$assign(this.FLeft.GetNodeValue()):e.$assign(this.FRight.GetNodeValue()),e},this.Check=function(){t.TFPBinaryOperation.Check.call(this),0!==this.FCondition.NodeType()&&e.RaiseParserError$1(rtl.getResStr(t,"SErrIFNeedsBoolean"),pas.System.VarRecs(18,this.FCondition.AsString())),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()},this.Create$2=function(e,i,s){return t.TFPBinaryOperation.Create$1.call(this,i,s),this.FCondition=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FCondition},set:function(t){this.p.FCondition=t}}),t.TFPBinaryOperation.Destroy.call(this)},this.AsString=function(){return pas.SysUtils.Format("if(%s , %s , %s)",pas.System.VarRecs(18,this.FCondition.AsString(),18,this.FLeft.AsString(),18,this.FRight.AsString()))}})),rtl.createClass(this,"TCaseOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FArgs=[]},this.$final=function(){this.FArgs=void 0,t.TFPExprNode.$final.call(this)},this.GetNodeValue=function(){var e,i=t.TFPExpressionResult.$new(),s=0,n=!1,r=t.TFPExpressionResult.$new(),o=t.TFPExpressionResult.$new();for(r.$assign(this.FArgs[0].GetNodeValue()),e=rtl.length(this.FArgs),s=2,n=!1;!n&&s<e;){i.$assign(this.FArgs[s].GetNodeValue());var a=r.ResultType;(0===a||1===a||2===a||5===a||3===a||4===a)&&(n=r.resValue==o.resValue),n||(s+=2)}return i.ResultType=this.FArgs[1].NodeType(),n?i.$assign(this.FArgs[s+1].GetNodeValue()):e%2==0&&i.$assign(this.FArgs[1].GetNodeValue()),i},this.Check=function(){var i,s,n=0,r=null;rtl.length(this.FArgs)<3&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseNeeds3")),rtl.length(this.FArgs)%2==1&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseEvenCount")),i=this.FArgs[0].NodeType(),s=this.FArgs[1].NodeType();for(var o=2,a=rtl.length(this.FArgs)-1;o<=a;o++)n=o,r=this.FArgs[n],n%2==0?(t.TFPConstExpression.isPrototypeOf(r)||e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelNotAConst"),pas.System.VarRecs(0,rtl.trunc(n/2),18,r.AsString())),r.NodeType()!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelType"),pas.System.VarRecs(0,rtl.trunc(n/2),18,r.AsString(),18,t.ResultTypeName(i),18,t.ResultTypeName(r.NodeType())))):r.NodeType()!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseValueType"),pas.System.VarRecs(0,rtl.trunc((n-1)/2),18,r.AsString(),18,t.ResultTypeName(s),18,t.ResultTypeName(r.NodeType())))},this.NodeType=function(){return this.FArgs[1].NodeType()},this.Create$1=function(t){return this.FArgs=rtl.arrayRef(t),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgs)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgs,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgs)-1;i<=s;i++)e=i,""!==t&&(t+=", "),t+=this.FArgs[e].AsString();return t="Case("+t+")"}})),rtl.createClass(this,"TMathOperation",this.TFPBinaryOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPAddOperation",this.TMathOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)+rtl.trunc(i.resValue):4===s?e.resValue=e.resValue+""+i.resValue:3===s||2===s?e.resValue=rtl.getNumber(e.resValue)+rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)+rtl.trunc(1e4*i.resValue))/1e4),e.ResultType=this.NodeType(),e},this.AsString=function(){return this.FLeft.AsString()+" + "+this.FRight.AsString()}})),rtl.createClass(this,"TFPSubtractOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,2,5,3);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)-rtl.trunc(i.resValue):3===s||2===s?e.resValue=rtl.getNumber(e.resValue)-rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)-rtl.trunc(1e4*i.resValue))/1e4),e},this.AsString=function(){return this.FLeft.AsString()+" - "+this.FRight.AsString()}})),rtl.createClass(this,"TFPMultiplyOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" * "+this.FRight.AsString()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)*rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)*rtl.getNumber(i.resValue):5===s&&(e.resValue=rtl.trunc(1e4*e.resValue)*rtl.trunc(1e4*i.resValue)/1e4/1e4),e}})),rtl.createClass(this,"TFPDivideOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" / "+this.FRight.AsString()},this.NodeType=function(){return 5===this.FLeft.NodeType()&&5===this.FRight.NodeType()?5:2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)/rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue):5===s&&(5===this.NodeType()?e.resValue=rtl.trunc(rtl.trunc(1e4*e.resValue)/rtl.trunc(1e4*i.resValue)*1e4)/1e4:e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPModuloOperation",this.TMathOperation,(function(){this.Check=function(){this.CheckNodeType(this.FLeft,rtl.createSet(1)),this.CheckNodeType(this.FRight,rtl.createSet(1)),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" mod "+this.FRight.AsString()},this.NodeType=function(){return 1,1},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=rtl.trunc(e.resValue)%rtl.trunc(i.resValue),e.ResultType=1,e}})),rtl.createClass(this,"TFPPowerOperation",this.TMathOperation,(function(){var i=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,i),this.CheckNodeType(this.FRight,i)},this.AsString=function(){return this.FLeft.AsString()+"^"+this.FRight.AsString()},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var i=t.TFPExpressionResult.$new(),s=t.TFPExpressionResult.$new();return i.$assign(this.FLeft.GetNodeValue()),s.$assign(this.FRight.GetNodeValue()),i.resValue=e.power(t.ArgToFloat(t.TFPExpressionResult.$clone(i)),t.ArgToFloat(t.TFPExpressionResult.$clone(s))),i.ResultType=2,i}})),rtl.createClass(this,"TFPUnaryOperator",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FOperand=null},this.$final=function(){this.FOperand=void 0,t.TFPExprNode.$final.call(this)},this.Create$1=function(t){return this.FOperand=t,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FOperand},set:function(t){this.p.FOperand=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FOperand&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPConvertNode",this.TFPUnaryOperator,(function(){this.AsString=function(){return this.FOperand.AsString()}})),rtl.createClass(this,"TFPNotNode",this.TFPUnaryOperator,(function(){this.Check=function(){this.FOperand.NodeType()in rtl.createSet(1,0)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNOTOperation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return(1===i||0===i)&&(e.resValue=!e.resValue),e},this.AsString=function(){return"not "+this.FOperand.AsString()}})),rtl.createClass(this,"TIntConvertNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(1))}})),rtl.createClass(this,"TIntToFloatNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=2,e}})),rtl.createClass(this,"TIntToCurrencyNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=5,e}})),rtl.createClass(this,"TIntToDateTimeNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToCurrencyNode",this.TFPConvertNode,(function(){this.Check=function(){this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=5,e.resValue=e.resValue,e}})),rtl.createClass(this,"TCurrencyToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return i.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*i.resValue)/1e4,e.ResultType=3,e}})),rtl.createClass(this,"TCurrencyToFloatNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*e.resValue)/1e4,e.ResultType=2,e}})),rtl.createClass(this,"TFPNegateOperation",this.TFPUnaryOperator,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.FOperand.NodeType()in rtl.createSet(1,2,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNegation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return 1===i?e.resValue=-rtl.trunc(e.resValue):2===i?e.resValue=-rtl.getNumber(e.resValue):5===i&&(e.resValue=-rtl.trunc(1e4*e.resValue)/1e4),e},this.AsString=function(){return"-"+pas.SysUtils.TrimLeft(this.FOperand.AsString())}})),rtl.createClass(this,"TFPConstExpression",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FValue=t.TFPExpressionResult.$new()},this.$final=function(){this.FValue=void 0,t.TFPExprNode.$final.call(this)},this.CreateString=function(t){return this.FValue.ResultType=4,this.FValue.resValue=t,this},this.CreateInteger=function(t){return this.FValue.ResultType=1,this.FValue.resValue=t,this},this.CreateFloat=function(t){return pas.System.TObject.Create.call(this),this.FValue.ResultType=2,this.FValue.resValue=t,this},this.CreateBoolean=function(t){return this.FValue.ResultType=0,this.FValue.resValue=t,this},this.Check=function(){},this.NodeType=function(){return this.FValue.ResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FValue),e},this.AsString=function(){var t="",e=this.NodeType();return 4===e?t="'"+this.FValue.resValue+"'":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):3===e?t="'"+pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue))+"'":0===e?t=0!=this.FValue.resValue?"True":"False":2===e?t=rtl.floatToStr(rtl.getNumber(this.FValue.resValue)):5===e&&(t=rtl.floatToStr(rtl.trunc(1e4*this.FValue.resValue)/1e4)),t}})),this.TIdentifierType={0:"itVariable",itVariable:0,1:"itFunctionHandler",itFunctionHandler:1,2:"itFunctionNode",itFunctionNode:2},this.$rtti.$Enum("TIdentifierType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TIdentifierType}),this.$rtti.$RefToProcVar("TFPExprFunctionEvent",{procsig:rtl.newTIProcSig([["Args",this.$rtti.TExprParameterArray,2]],this.$rtti.TFPExpressionResult)}),this.$rtti.$RefToProcVar("TFPExprVariableEvent",{procsig:rtl.newTIProcSig([["AName",rtl.string,2]],this.$rtti.TFPExpressionResult)}),rtl.createClass(this,"TFPExprIdentifierDef",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FNodeType=null,this.FOnGetVarValue=null,this.FStringValue="",this.FValue=t.TFPExpressionResult.$new(),this.FArgumentTypes="",this.FIDType=0,this.FName="",this.FOnGetValue=null},this.$final=function(){this.FNodeType=void 0,this.FOnGetVarValue=void 0,this.FValue=void 0,this.FOnGetValue=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.GetResultType=function(){return this.FValue.ResultType},this.GetValue=function(){var t="",e=this.FValue.ResultType;return 0===e?t=this.FValue.resValue?"True":"False":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):2===e?t=pas.SysUtils.FloatToStr(rtl.getNumber(this.FValue.resValue)):5===e?t=pas.SysUtils.CurrToStr(rtl.trunc(1e4*this.FValue.resValue)):3===e?t=pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue)):4===e&&(t=""+this.FValue.resValue),t},this.SetArgumentTypes=function(e){var i=0;if(this.FArgumentTypes!==e){for(var s=1,n=e.length;s<=n;s++)i=s,t.CharToResultType(e.charAt(i-1));this.FArgumentTypes=e}},this.SetName=function(i){this.FName!==i&&(""!==i&&null!=this.FCollection&&-1!==this.FCollection.IndexOfIdentifier(i)&&e.RaiseParserError$1(rtl.getResStr(t,"SErrDuplicateIdentifier"),pas.System.VarRecs(18,i)),this.FName=i)},this.SetResultType=function(t){t!==this.FValue.ResultType&&(this.FValue.ResultType=t,this.SetValue(this.FStringValue))},this.SetValue=function(t){if(this.FStringValue=t,""!==t){var e=this.FValue.ResultType;0===e?this.FValue.resValue="True"===this.FStringValue:1===e?this.FValue.resValue=pas.SysUtils.StrToInt(t):2===e?this.FValue.resValue=pas.SysUtils.StrToFloat(t):5===e?this.FValue.resValue=pas.SysUtils.StrToCurr(t)/1e4:3===e?this.FValue.resValue=pas.SysUtils.StrToDateTime(t):4===e&&(this.FValue.resValue=t)}else{var i=this.FValue.ResultType;0===i?this.FValue.resValue=!1:1===i||2===i||5===i||3===i?this.FValue.resValue=0:4===i&&(this.FValue.resValue="")}},this.FetchValue=function(){var e,i,s=0;if(e=this.GetResultType(),null!=this.FOnGetVarValue&&this.FValue.$assign(this.FOnGetVarValue(this.FName)),(i=this.FValue.ResultType)!==e){if(1!==i||2!==e)throw this.FValue.ResultType=e,t.EExprParser.$create("CreateFmt",['Value handler for variable %s returned wrong type, expected "%s", got "%s"',pas.System.VarRecs(18,this.FName,18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,e),18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,i))]);this.FValue.ResultType=e,s=rtl.trunc(this.FValue.resValue),this.FValue.resValue=s}},this.ArgumentCount=function(){return this.FArgumentTypes.length},this.Assign=function(e){var i=null;t.TFPExprIdentifierDef.isPrototypeOf(e)?(i=rtl.as(e,t.TFPExprIdentifierDef),this.FStringValue=i.FStringValue,this.FValue.$assign(i.FValue),this.FArgumentTypes=i.FArgumentTypes,this.FIDType=i.FIDType,this.FName=i.FName,this.FOnGetValue=i.FOnGetValue,this.FOnGetVarValue=i.FOnGetVarValue):pas.Classes.TPersistent.Assign.call(this,e)},this.EventBasedVariable=function(){return null!=this.FOnGetVarValue};var i=this.$rtti;i.addProperty("IdentifierType",0,t.$rtti.TIdentifierType,"FIDType","FIDType"),i.addProperty("Name",2,rtl.string,"FName","SetName"),i.addProperty("Value",3,rtl.string,"GetValue","SetValue"),i.addProperty("ParameterTypes",2,rtl.string,"FArgumentTypes","SetArgumentTypes"),i.addProperty("ResultType",3,t.$rtti.TResultType,"GetResultType","SetResultType"),i.addProperty("OnGetFunctionValue",0,t.$rtti.TFPExprFunctionEvent,"FOnGetValue","FOnGetValue"),i.addProperty("OnGetVariableValue",0,t.$rtti.TFPExprVariableEvent,"FOnGetVarValue","FOnGetVarValue"),i.addProperty("NodeType",0,t.$rtti.TFPExprFunctionClass,"FNodeType","FNodeType")})),this.TBuiltInCategory={0:"bcStrings",bcStrings:0,1:"bcDateTime",bcDateTime:1,2:"bcMath",bcMath:2,3:"bcBoolean",bcBoolean:3,4:"bcConversion",bcConversion:4,5:"bcData",bcData:5,6:"bcVaria",bcVaria:6,7:"bcUser",bcUser:7,8:"bcAggregate",bcAggregate:8},this.$rtti.$Enum("TBuiltInCategory",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TBuiltInCategory}),this.$rtti.$Set("TBuiltInCategories",{comptype:this.$rtti.TBuiltInCategory}),rtl.createClass(this,"TFPBuiltInExprIdentifierDef",this.TFPExprIdentifierDef,(function(){this.$init=function(){t.TFPExprIdentifierDef.$init.call(this),this.FCategory=0},this.Assign=function(e){t.TFPExprIdentifierDef.Assign.call(this,e),t.TFPBuiltInExprIdentifierDef.isPrototypeOf(e)&&(this.FCategory=rtl.as(e,t.TFPBuiltInExprIdentifierDef).FCategory)},this.$rtti.addProperty("Category",0,t.$rtti.TBuiltInCategory,"FCategory","FCategory")})),rtl.createClass(this,"TFPExprIdentifierDefs",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FParser=null},this.$final=function(){this.FParser=void 0,pas.Classes.TCollection.$final.call(this)},this.GetI=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.call(this,t),null!=this.FParser&&(this.FParser.FDirty=!0)},this.IndexOfIdentifier=function(t){var e=0;for(e=this.GetCount()-1;e>=0&&0!==pas.SysUtils.CompareText(this.GetI(e).FName,t);)e-=1;return e},this.AddVariable=function(e,i,s){var n=null;return(n=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,n.SetName(e),n.SetResultType(i),n.FOnGetVarValue=s,n},this.AddFloatVariable=function(e,i){var s=null;return(s=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,s.SetName(e),s.SetResultType(2),s.FValue.resValue=i,s},this.AddFunction=function(e,i,s,n){var r=null;return(r=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),r.FIDType=1,r.SetArgumentTypes(s),r.SetResultType(t.CharToResultType(i)),r.FOnGetValue=n,r},this.AddFunction$1=function(e,i,s,n){var r=null;return(r=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),r.FIDType=2,r.SetArgumentTypes(s),r.SetResultType(t.CharToResultType(i)),r.FNodeType=n,r}})),rtl.createClass(this,"TFPExprIdentifierNode",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FID=null,this.PResult=null,this.FResultType=0},this.$final=function(){this.FID=void 0,t.TFPExprNode.$final.call(this)},this.CreateIdentifier=function(t){return pas.System.TObject.Create.call(this),this.FID=t,this.PResult=this.FID.FValue,this.FResultType=this.FID.GetResultType(),this},this.NodeType=function(){return this.FResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return this.FID.EventBasedVariable()&&(this.FID.FetchValue(),this.PResult=this.FID.FValue),e.$assign(this.PResult),e.ResultType=this.FResultType,e}})),rtl.createClass(this,"TFPExprVariable",this.TFPExprIdentifierNode,(function(){this.Check=function(){},this.AsString=function(){return this.FID.FName}})),rtl.createClass(this,"TFPExprFunction",this.TFPExprIdentifierNode,(function(){this.$init=function(){t.TFPExprIdentifierNode.$init.call(this),this.FArgumentNodes=[],this.FargumentParams=[]},this.$final=function(){this.FArgumentNodes=void 0,this.FargumentParams=void 0,t.TFPExprIdentifierNode.$final.call(this)},this.CalcParams=function(){for(var t=0,e=0,i=rtl.length(this.FargumentParams)-1;e<=i;e++)t=e,this.FargumentParams[t].$assign(this.FArgumentNodes[t].GetNodeValue())},this.ConvertArgument=function(i,s,n){var r;return s===(r=t.TFPExpressionParser.ConvertNode(s,n))&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(n),18,t.ResultTypeName(s.NodeType()))),r},this.Check=function(){var i=0,s=0;rtl.length(this.FArgumentNodes)!==this.FID.ArgumentCount()&&e.RaiseParserError$1(rtl.getResStr(t,"ErrInvalidArgumentCount"),pas.System.VarRecs(18,this.FID.FName));for(var n=0,r=rtl.length(this.FArgumentNodes)-1;n<=r;n++)i=n,(s=t.CharToResultType(this.FID.FArgumentTypes.charAt(i+1-1)))!==this.FArgumentNodes[i].NodeType()&&(this.FArgumentNodes[i]=this.ConvertArgument(i+1,this.FArgumentNodes[i],s))},this.CreateFunction=function(e,i){return t.TFPExprIdentifierNode.CreateIdentifier.call(this,e),this.FArgumentNodes=rtl.arrayRef(i),this.FargumentParams=rtl.arraySetLength(this.FargumentParams,t.TFPExpressionResult,rtl.length(i)),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgumentNodes)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgumentNodes,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgumentNodes)-1;i<=s;i++)e=i,""!==t&&(t+=","),t+=this.FArgumentNodes[e].AsString();return""!==t&&(t="("+t+")"),this.FID.FName+t}})),rtl.createClass(this,"TAggregateExpr",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FResult=t.TFPExpressionResult.$new()},this.$final=function(){this.FResult=void 0,t.TFPExprFunction.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FResult),e}})),rtl.createClass(this,"TAggregateMin",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateMax",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateSum",this.TAggregateExpr,(function(){this.ConvertArgument=function(i,s,n){return s.NodeType()in rtl.createSet(2,1,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(n),18,t.ResultTypeName(s.NodeType()))),s}})),rtl.createClass(this,"TAggregateAvg",this.TAggregateSum,(function(){this.$init=function(){t.TAggregateSum.$init.call(this),this.FCount=0},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();if(e.$assign(t.TAggregateExpr.GetNodeValue.call(this)),e.ResultType=this.FResult.ResultType,0===this.FCount){var i=this.FResult.ResultType;1===i?(e.ResultType=2,e.resValue=0):(2===i||5===i)&&(e.resValue=0)}else{var s=this.FResult.ResultType;1===s?(e.ResultType=2,e.resValue=rtl.trunc(this.FResult.resValue)/this.FCount):2===s?e.resValue=rtl.getNumber(this.FResult.resValue)/this.FCount:5===s&&(e.resValue=rtl.trunc(rtl.trunc(1e4*this.FResult.resValue)/this.FCount)/1e4)}return e}})),rtl.createClass(this,"TAggregateCount",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TFPFunctionEventHandler",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FCallBack=null},this.$final=function(){this.FCallBack=void 0,t.TFPExprFunction.$final.call(this)},this.CreateFunction=function(e,i){return t.TFPExprFunction.CreateFunction.apply(this,arguments),this.FCallBack=e.FOnGetValue,this},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return rtl.length(this.FargumentParams)>0&&this.CalcParams(),e.$assign(this.FCallBack(this.FargumentParams)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPExpressionParser",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FBuiltIns={},this.FExpression="",this.FScanner=null,this.FExprNode=null,this.FIdentifiers=null,this.FHashList=null,this.FDirty=!1},this.$final=function(){this.FBuiltIns=void 0,this.FScanner=void 0,this.FExprNode=void 0,this.FIdentifiers=void 0,this.FHashList=void 0,pas.Classes.TComponent.$final.call(this)},this.CheckEOF=function(){27===this.TokenType()&&this.ParserError(rtl.getResStr(t,"SErrUnexpectedEndOfExpression"))},this.GetAsBoolean=function(){var e=t.TFPExpressionResult.$new();return this.EvaluateExpression(e),this.CheckResultType(e,0),!(0==e.resValue)},this.MatchNodes=function(t,e){var i,s,n=null;if(n=t,(i=t.NodeType())!==(s=e.NodeType())){var r=i;1===r?s in rtl.createSet(2,5,3)&&(n=this.$class.ConvertNode(t,s)):2===r?s in rtl.createSet(5,3)&&(n=this.$class.ConvertNode(t,s)):5===r&&s in rtl.createSet(2,3)&&(n=this.$class.ConvertNode(t,s))}return n},this.CheckNodes=function(t,e){t.set(this.MatchNodes(t.get(),e.get())),e.set(this.MatchNodes(e.get(),t.get()))},this.SetBuiltIns=function(t){rtl.eqSet(this.FBuiltIns,t)||(this.FBuiltIns=rtl.refSet(t),this.FDirty=!0)},this.SetIdentifiers=function(t){this.FIdentifiers.Assign(t)},this.SetAllowLike=function(t){this.FScanner.FAllowLike=t},this.ParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},this.SetExpression=function(e){this.FExpression!==e&&(this.FExpression=e,this.FScanner.SetSource(e),null!=this.FExprNode&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),""!==this.FExpression?(this.GetToken(),this.FExprNode=this.Level1(),27!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedExpression"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.FExprNode.Check()):this.FExprNode=null)},this.CheckResultType=function(i,s){i.ResultType!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultType"),pas.System.VarRecs(18,t.ResultTypeName(i.ResultType)))},this.ConvertNode=function(e,i){var s=null;s=e;var n=e.NodeType();if(1===n){var r=i;2===r?s=t.TIntToFloatNode.$create("Create$1",[s]):5===r?s=t.TIntToCurrencyNode.$create("Create$1",[s]):3===r&&(s=t.TIntToDateTimeNode.$create("Create$1",[s]))}else if(2===n){var o=i;5===o?s=t.TFloatToCurrencyNode.$create("Create$1",[s]):3===o&&(s=t.TFloatToDateTimeNode.$create("Create$1",[s]))}else if(5===n){var a=i;2===a?s=t.TCurrencyToFloatNode.$create("Create$1",[s]):3===a&&(s=t.TCurrencyToDateTimeNode.$create("Create$1",[s]))}return s},this.BuiltinsManager=function(){return t.BuiltinIdentifiers()},this.Level1=function(){var e=null,i=0,s=null;22===this.TokenType()?(this.GetToken(),this.CheckEOF(),s=this.Level2(),e=t.TFPNotNode.$create("Create$1",[s])):e=this.Level2();try{for(;this.TokenType()in rtl.createSet(17,18,19);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level2();var n=i;18===n?e=t.TFPBinaryOrOperation.$create("Create$1",[e,s]):17===n?e=t.TFPBinaryAndOperation.$create("Create$1",[e,s]):19===n?e=t.TFPBinaryXOrOperation.$create("Create$1",[e,s]):this.ParserError(rtl.getResStr(t,"SErrUnknownBooleanOp"))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level2=function(){var e=null,i=null,s=0,n=null;e=this.Level3();try{if(this.TokenType()in t.ttComparisons){s=this.TokenType(),this.GetToken(),this.CheckEOF(),i=this.Level3(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}});var r=s;2===r?n=t.TFPLessThanOperation:10===r?n=t.TFPLessThanEqualOperation:3===r?n=t.TFPGreaterThanOperation:11===r?n=t.TFPGreaterThanEqualOperation:4===r?n=t.TFPEqualOperation:12===r?n=t.TFPUnequalOperation:26===r?n=t.TFPLikeOperation:this.ParserError(rtl.getResStr(t,"SErrUnknownComparison")),e=n.$create("Create$1",[e,i])}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level3=function(){var e=null,i=0,s=null;e=this.Level4();try{for(;this.TokenType()in rtl.createSet(0,1);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level4(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var n=i;0===n?e=t.TFPAddOperation.$create("Create$1",[e,s]):1===n&&(e=t.TFPSubtractOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level4=function(){var e=null,i=0,s=null;e=this.Level5();try{for(;this.TokenType()in rtl.createSet(7,5,6);){i=this.TokenType(),this.GetToken(),s=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var n=i;7===n?e=t.TFPMultiplyOperation.$create("Create$1",[e,s]):5===n?e=t.TFPDivideOperation.$create("Create$1",[e,s]):6===n&&(e=t.TFPModuloOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level5=function(){var e=null,i=!1;return i=!1,this.TokenType()in rtl.createSet(0,1)&&(i=1===this.TokenType(),this.GetToken()),e=this.Level6(),i&&(e=t.TFPNegateOperation.$create("Create$1",[e])),e},this.Level6=function(){var e=null,i=null;e=this.Level7();try{for(;25===this.TokenType();)this.GetToken(),i=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e=t.TFPPowerOperation.$create("Create$1",[e,i])}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level7=function(){var e=null;if(8===this.TokenType()){this.GetToken(),e=this.Level1();try{9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.GetToken()}catch(t){throw e=rtl.freeLoc(e),t}}else e=this.Primitive();return e},this.Primitive=function(){var e=null,i=0,s=0,n=0,r=0,o=!1,a=!1,l=null,h=[],u=0;if(h=rtl.arraySetLength(h,null,0),13===this.TokenType())pas.SysUtils.TryStrToInt64(this.CurrentToken(),{get:function(){return i},set:function(t){i=t}})?e=t.TFPConstExpression.$create("CreateInteger",[i]):(pas.System.val$8(this.CurrentToken(),{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),0===s?e=t.TFPConstExpression.$create("CreateFloat",[n]):this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidFloat"),pas.System.VarRecs(18,this.CurrentToken()))));else if(14===this.TokenType())e=t.TFPConstExpression.$create("CreateString",[this.CurrentToken()]);else if(this.TokenType()in rtl.createSet(20,21))e=t.TFPConstExpression.$create("CreateBoolean",[20===this.TokenType()]);else if(this.TokenType()in rtl.createSet(15,23,24)){if(o=23===this.TokenType(),a=24===this.TokenType(),o||a||null===(l=this.IdentifierByName(this.CurrentToken()))&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownIdentifier"),pas.System.VarRecs(18,this.CurrentToken()))),0!==(r=o?3:a?-4:l.FIDType in rtl.createSet(1,2)?l.ArgumentCount():0)){this.GetToken(),8!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrLeftBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),h=rtl.arraySetLength(h,null,Math.abs(r)),u=0;try{do{this.GetToken(),r<0&&u===rtl.length(h)&&((h=rtl.arraySetLength(h,null,u+1))[u]=null),h[u]=this.Level1(),u+=1,16!==this.TokenType()&&u<Math.abs(r)&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrCommaExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}while(!(u===r||r<0&&9===this.TokenType()));9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){for(u-=1;u>=0;)pas.SysUtils.FreeAndNil({a:u,p:h,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}}),u-=1;throw t}throw t}}if(o)e=t.TIfOperation.$create("Create$2",[h[0],h[1],h[2]]);else if(a)e=t.TCaseOperation.$create("Create$1",[rtl.arrayRef(h)]);else{var d=l.FIDType;0===d?e=t.TFPExprVariable.$create("CreateIdentifier",[l]):1===d?e=t.TFPFunctionEventHandler.$create("CreateFunction",[l,h]):2===d&&(e=l.FNodeType.$create("CreateFunction",[l,h]))}}else this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SerrUnknownTokenAtPos"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())));return this.GetToken(),e},this.GetToken=function(){return this.FScanner.GetToken()},this.TokenType=function(){return this.FScanner.FTokenType},this.CurrentToken=function(){return this.FScanner.FToken},this.CreateHashList=function(){var t=null,e=null,i=0,s=null;if(this.FHashList.Clear(),s=this.$class.BuiltinsManager(),rtl.neSet(this.FBuiltIns,{})&&null!=s)for(var n=0,r=s.GetCount()-1;n<=r;n++)i=n,(e=s.GetI(i)).FCategory in this.FBuiltIns&&this.FHashList.Add(pas.SysUtils.LowerCase(e.FName),e);for(var o=0,a=this.FIdentifiers.GetCount()-1;o<=a;o++)i=o,t=this.FIdentifiers.GetI(i),this.FHashList.Add(pas.SysUtils.LowerCase(t.FName),t);this.FDirty=!1},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FIdentifiers=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPExprIdentifierDef]),this.FIdentifiers.FParser=this,this.FScanner=t.TFPExpressionScanner.$create("Create$1"),this.FHashList=pas.contnrs.TFPObjectHashTable.$create("Create$2",[!1]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FHashList},set:function(t){this.p.FHashList=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIdentifiers},set:function(t){this.p.FIdentifiers=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FScanner},set:function(t){this.p.FScanner=t}}),pas.Classes.TComponent.Destroy.call(this)},this.IdentifierByName=function(t){var e="";return this.FDirty&&this.CreateHashList(),(e=t).length>2&&"["===e.charAt(0)&&"]"===e.charAt(e.length-1)&&(pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,1),pas.System.Delete({get:function(){return e},set:function(t){e=t}},e.length,1)),this.FHashList.GetData(pas.SysUtils.LowerCase(e))},this.EvaluateExpression=function(t){t.$assign(this.Evaluate$1())},this.Evaluate$1=function(){var e=t.TFPExpressionResult.$new();return""===this.FExpression&&this.ParserError(rtl.getResStr(t,"SErrInExpressionEmpty")),null==this.FExprNode&&this.ParserError(rtl.getResStr(t,"SErrInExpression")),e.$assign(this.FExprNode.GetNodeValue()),e},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("Expression",2,rtl.string,"FExpression","SetExpression"),i.addProperty("Identifiers",2,t.$rtti.TFPExprIdentifierDefs,"FIdentifiers","SetIdentifiers"),i.addProperty("BuiltIns",2,t.$rtti.TBuiltInCategories,"FBuiltIns","SetBuiltIns")})),rtl.createClass(this,"TExprBuiltInManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDefs=null},this.$final=function(){this.FDefs=void 0,pas.Classes.TComponent.$final.call(this)},this.GetCount=function(){return this.FDefs.GetCount()},this.GetI=function(t){return this.FDefs.GetI(t)},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FDefs=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPBuiltInExprIdentifierDef]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefs},set:function(t){this.p.FDefs=t}}),pas.Classes.TComponent.Destroy.call(this)},this.AddFloatVariable=function(t,e,i){var s=null;return(s=this.FDefs.AddFloatVariable(e,i)).FCategory=t,s},this.AddFunction=function(t,e,i,s,n){var r=null;return(r=this.FDefs.AddFunction(e,i,s,n)).FCategory=t,r},this.AddFunction$1=function(t,e,i,s,n){var r=null;return(r=this.FDefs.AddFunction$1(e,i,s,n)).FCategory=t,r},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"EExprParser",pas.SysUtils.Exception,(function(){})),this.AllBuiltIns=rtl.createSet(0,1,2,3,4,5,6,7,8),this.ResultTypeName=function(e){return pas.TypInfo.GetEnumName(t.$rtti.TResultType,e)},this.CharToResultType=function(i){var s=0,n=pas.System.upcase(i);return"S"===n?s=4:"D"===n?s=3:"B"===n?s=0:"I"===n?s=1:"F"===n?s=2:"C"===n?s=5:e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultCharacter"),pas.System.VarRecs(9,i)),s},this.BuiltinIdentifiers=function(){return null===e.BuiltIns&&(e.BuiltIns=t.TExprBuiltInManager.$create("Create$1",[null])),e.BuiltIns},this.RegisterStdBuiltins=function(i,s){2 in s&&(i.AddFloatVariable(2,"pi",Math.PI),i.AddFunction(2,"cos","F","F",e.BuiltInCos),i.AddFunction(2,"sin","F","F",e.BuiltInSin),i.AddFunction(2,"abs","F","F",e.BuiltInAbs),i.AddFunction(2,"sqr","F","F",e.BuiltInSqr),i.AddFunction(2,"sqrt","F","F",e.BuiltInSqrt),i.AddFunction(2,"exp","F","F",e.BuiltInExp),i.AddFunction(2,"ln","F","F",e.BuiltInLn),i.AddFunction(2,"log","F","F",e.BuiltInLog),i.AddFunction(2,"frac","F","F",e.BuiltInFrac),i.AddFunction(2,"int","F","F",e.BuiltInInt),i.AddFunction(2,"round","I","F",e.BuiltInRound),i.AddFunction(2,"trunc","I","F",e.BuiltInTrunc)),0 in s&&(i.AddFunction(0,"length","I","S",e.BuiltInLength),i.AddFunction(0,"copy","S","SII",e.BuiltInCopy),i.AddFunction(0,"delete","S","SII",e.BuiltInDelete),i.AddFunction(0,"pos","I","SS",e.BuiltInPos),i.AddFunction(0,"lowercase","S","S",e.BuiltInLowercase),i.AddFunction(0,"uppercase","S","S",e.BuiltInUppercase),i.AddFunction(0,"stringreplace","S","SSSBB",e.BuiltInStringReplace),i.AddFunction(0,"comparetext","I","SS",e.BuiltInCompareText)),1 in s&&(i.AddFunction(1,"date","D","",e.BuiltInDate),i.AddFunction(1,"time","D","",e.BuiltInTime),i.AddFunction(1,"now","D","",e.BuiltInNow),i.AddFunction(1,"dayofweek","I","D",e.BuiltInDayofWeek),i.AddFunction(1,"extractyear","I","D",e.BuiltInExtractYear),i.AddFunction(1,"extractmonth","I","D",e.BuiltInExtractMonth),i.AddFunction(1,"extractday","I","D",e.BuiltInExtractDay),i.AddFunction(1,"extracthour","I","D",e.BuiltInExtractHour),i.AddFunction(1,"extractmin","I","D",e.BuiltInExtractMin),i.AddFunction(1,"extractsec","I","D",e.BuiltInExtractSec),i.AddFunction(1,"extractmsec","I","D",e.BuiltInExtractMSec),i.AddFunction(1,"encodedate","D","III",e.BuiltInEncodedate),i.AddFunction(1,"encodetime","D","IIII",e.BuiltInEncodeTime),i.AddFunction(1,"encodedatetime","D","IIIIIII",e.BuiltInEncodeDateTime),i.AddFunction(1,"shortdayname","S","I",e.BuiltInShortDayName),i.AddFunction(1,"shortmonthname","S","I",e.BuiltInShortMonthName),i.AddFunction(1,"longdayname","S","I",e.BuiltInLongDayName),i.AddFunction(1,"longmonthname","S","I",e.BuiltInLongMonthName)),3 in s&&(i.AddFunction(3,"shl","I","II",e.BuiltInShl),i.AddFunction(3,"shr","I","II",e.BuiltInShr),i.AddFunction(3,"IFS","S","BSS",e.BuiltinIFS),i.AddFunction(3,"IFF","F","BFF",e.BuiltinIFF),i.AddFunction(3,"IFD","D","BDD",e.BuiltinIFD),i.AddFunction(3,"IFI","I","BII",e.BuiltinIFI)),4 in s&&(i.AddFunction(4,"inttostr","S","I",e.BuiltInIntToStr),i.AddFunction(4,"strtoint","I","S",e.BuiltInStrToInt),i.AddFunction(4,"strtointdef","I","SI",e.BuiltInStrToIntDef),i.AddFunction(4,"floattostr","S","F",e.BuiltInFloatToStr),i.AddFunction(4,"strtofloat","F","S",e.BuiltInStrToFloat),i.AddFunction(4,"strtofloatdef","F","SF",e.BuiltInStrToFloatDef),i.AddFunction(4,"booltostr","S","B",e.BuiltInBoolToStr),i.AddFunction(4,"strtobool","B","S",e.BuiltInStrToBool),i.AddFunction(4,"strtobooldef","B","SB",e.BuiltInStrToBoolDef),i.AddFunction(4,"datetostr","S","D",e.BuiltInDateToStr),i.AddFunction(4,"timetostr","S","D",e.BuiltInTimeToStr),i.AddFunction(4,"strtodate","D","S",e.BuiltInStrToDate),i.AddFunction(4,"strtodatedef","D","SD",e.BuiltInStrToDateDef),i.AddFunction(4,"strtotime","D","S",e.BuiltInStrToTime),i.AddFunction(4,"strtotimedef","D","SD",e.BuiltInStrToTimeDef),i.AddFunction(4,"strtodatetime","D","S",e.BuiltInStrToDateTime),i.AddFunction(4,"strtodatetimedef","D","SD",e.BuiltInStrToDateTimeDef),i.AddFunction(4,"formatfloat","S","SF",e.BuiltInFormatFloat),i.AddFunction(4,"formatdatetime","S","SD",e.BuiltInFormatDateTime)),8 in s&&(i.AddFunction$1(8,"count","I","",t.TAggregateCount),i.AddFunction$1(8,"sum","F","F",t.TAggregateSum),i.AddFunction$1(8,"avg","F","F",t.TAggregateAvg),i.AddFunction$1(8,"min","F","F",t.TAggregateMin),i.AddFunction$1(8,"max","F","F",t.TAggregateMax))},this.ArgToFloat=function(t){return 1===t.ResultType?rtl.trunc(t.resValue):5===t.ResultType?rtl.trunc(1e4*t.resValue)/1e4:rtl.getNumber(t.resValue)},t.$implcode=function(){e.cNull="\0",e.cSingleQuote="'",e.cHexIdentifier="$",e.cOctalIdentifier="&",e.cBinaryIdentifier="%",e.Digits=rtl.createSet(null,48,57,46),e.HexDigits=rtl.createSet(null,48,57,null,65,70,null,97,102),e.OctalDigits=rtl.createSet(null,48,55),e.BinaryDigits=rtl.createSet(48,49),e.WhiteSpace=rtl.createSet(32,13,10,9),e.Operators=rtl.createSet(43,45,60,62,61,47,42,94),e.Delimiters=rtl.unionSet(e.Operators,rtl.createSet(44,40,41)),e.Symbols=rtl.unionSet(rtl.createSet(37),e.Delimiters),e.WordDelimiters=rtl.unionSet(e.WhiteSpace,e.Symbols),e.FileFormatSettings=pas.SysUtils.TFormatSettings.$new(),e.RaiseParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},e.RaiseParserError$1=function(e,i){throw t.EExprParser.$create("CreateFmt",[e,i])},e.BuiltIns=null,e.power=function(t,e){var i=0,s=0;return 0===e?i=1:0===t&&e>0?i=0:t<0&&0===pas.System.Frac(e)?(s=Math.round(e),i=Math.exp(e*Math.log(-t)),pas.System.Odd(s)&&(i=-i)):i=Math.exp(e*Math.log(t)),i},e.BuiltInCos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.cos(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSin=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sin(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInAbs=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.abs(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Sqr$1(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqrt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sqrt(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInExp=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.exp(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLn=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.L10=0,e.BuiltInLog=function(i){var s=t.TFPExpressionResult.$new();return s.ResultType=2,s.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(i[0])))/e.L10,s},e.BuiltInRound=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=Math.round(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInTrunc=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Trunc(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Int(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInFrac=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Frac(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLength=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=(""+e[0].resValue).length,i},e.BuiltInCopy=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.System.Copy(""+e[0].resValue,rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInDelete=function(e){var i=t.TFPExpressionResult.$new(),s="";return i.ResultType=4,s=""+e[0].resValue,pas.System.Delete({get:function(){return s},set:function(t){s=t}},rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i.resValue=s,i},e.BuiltInPos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Pos(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInUppercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.UpperCase(""+e[0].resValue),i},e.BuiltInLowercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.LowerCase(""+e[0].resValue),i},e.BuiltInStringReplace=function(e){var i=t.TFPExpressionResult.$new(),s={};return i.ResultType=4,s={},0!=e[3].resValue&&(s=rtl.includeSet(s,0)),0!=e[4].resValue&&(s=rtl.includeSet(s,1)),i.resValue=pas.SysUtils.StringReplace(""+e[0].resValue,""+e[1].resValue,""+e[2].resValue,rtl.refSet(s)),i},e.BuiltInCompareText=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.CompareText(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInDate=function(e){var i=t.TFPExpressionResult.$new();return rtl.length(e),i.ResultType=3,i.resValue=pas.SysUtils.Date(),i},e.BuiltInTime=function(e){var i=t.TFPExpressionResult.$new();return rtl.length(e),i.ResultType=3,i.resValue=pas.SysUtils.Time(),i},e.BuiltInNow=function(e){var i=t.TFPExpressionResult.$new();return rtl.length(e),i.ResultType=3,i.resValue=pas.SysUtils.Now(),i},e.BuiltInDayofWeek=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.DayOfWeek(rtl.getNumber(e[0].resValue)),i},e.BuiltInExtractYear=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=s,i},e.BuiltInExtractMonth=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=n,i},e.BuiltInExtractDay=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=r,i},e.BuiltInExtractHour=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=s,i},e.BuiltInExtractMin=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=n,i},e.BuiltInExtractSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=r,i},e.BuiltInExtractMSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,r=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=o,i},e.BuiltInEncodedate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInEncodeTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeTime(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue),rtl.trunc(e[3].resValue)),i},e.BuiltInEncodeDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue))+pas.SysUtils.EncodeTime(rtl.trunc(e[3].resValue),rtl.trunc(e[4].resValue),rtl.trunc(e[5].resValue),rtl.trunc(e[6].resValue)),i},e.BuiltInShortDayName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInShortMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongDayName=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.FormatSettings.LongDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.LongMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInFormatDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatDateTime(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInIntToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.IntToStr(rtl.trunc(e[0].resValue)),i},e.BuiltInStrToInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToInt(""+e[0].resValue),i},e.BuiltInStrToIntDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToIntDef$1(""+e[0].resValue,rtl.trunc(e[1].resValue)),i},e.BuiltInFloatToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FloatToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloat(""+e[0].resValue),i},e.BuiltInStrToFloatDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloatDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInDateToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.DateToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInTimeToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.TimeToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToDate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDate(""+e[0].resValue),i},e.BuiltInStrToDateDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTime(""+e[0].resValue),i},e.BuiltInStrToTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTime(""+e[0].resValue),i},e.BuiltInStrToDateTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInFormatFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatFloat(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInBoolToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.BoolToStr(!(0==e[0].resValue),!1),i},e.BuiltInStrToBool=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=0,i.resValue=pas.SysUtils.StrToBool(""+e[0].resValue),i},e.BuiltInStrToBoolDef=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.StrToBoolDef(""+e[0].resValue,!(0==e[1].resValue)),i.ResultType=0,i},e.BuiltInShl=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shl(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltInShr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shr(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltinIFS=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFI=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFF=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFD=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.InitFileFormatSettings=function(){e.FileFormatSettings.$assign(pas.SysUtils.FormatSettings),e.FileFormatSettings.DecimalSeparator=".",e.FileFormatSettings.DateSeparator="-",e.FileFormatSettings.TimeSeparator=":",e.FileFormatSettings.ShortDateFormat="yyyy-mm-dd",e.FileFormatSettings.LongTimeFormat="hh:nn:ss"},t.$resourcestrings={SBadQuotes:{org:"Unterminated string"},SUnknownDelimiter:{org:'Unknown delimiter character: "%s"'},SErrUnknownCharacter:{org:'Unknown character at pos %d: "%s"'},SErrUnexpectedEndOfExpression:{org:"Unexpected end of expression"},SErrUnknownComparison:{org:"Internal error: Unknown comparison"},SErrUnknownBooleanOp:{org:"Internal error: Unknown boolean operation"},SErrBracketExpected:{org:"Expected ) bracket at position %d, but got %s"},SerrUnknownTokenAtPos:{org:"Unknown token at pos %d : %s"},SErrLeftBracketExpected:{org:"Expected ( bracket at position %d, but got %s"},SErrInvalidFloat:{org:"%s is not a valid floating-point value"},SErrUnknownIdentifier:{org:"Unknown identifier: %s"},SErrInExpression:{org:"Cannot evaluate: error in expression"},SErrInExpressionEmpty:{org:"Cannot evaluate: empty expression"},SErrCommaExpected:{org:"Expected comma (,) at position %d, but got %s"},SErrInvalidNumberChar:{org:"Unexpected character in number : %s"},SErrInvalidNumber:{org:"Invalid numerical value : %s"},SErrUnterminatedIdentifier:{org:"Unterminated quoted identifier: %s"},SErrNoOperand:{org:"No operand for unary operation %s"},SErrNoleftOperand:{org:"No left operand for binary operation %s"},SErrNoRightOperand:{org:"No right operand for binary operation %s"},SErrNoNegation:{org:"Cannot negate expression of type %s : %s"},SErrNoNOTOperation:{org:'Cannot perform "not" on expression of type %s: %s'},SErrTypesDoNotMatch:{org:'Type mismatch: %s<>%s for expressions "%s" and "%s".'},SErrNoNodeToCheck:{org:"Internal error: No node to check !"},SInvalidNodeType:{org:"Node type (%s) not in allowed types (%s) for expression: %s"},SErrUnterminatedExpression:{org:"Badly terminated expression. Found token at position %d : %s"},SErrDuplicateIdentifier:{org:'An identifier with name "%s" already exists.'},SErrInvalidResultCharacter:{org:'"%s" is not a valid return type indicator'},ErrInvalidArgumentCount:{org:"Invalid argument count for function %s"},SErrInvalidArgumentType:{org:"Invalid type for argument %d: Expected %s, got %s"},SErrInvalidResultType:{org:"Invalid result type: %s"},SErrIFNeedsBoolean:{org:"First argument to IF must be of type boolean: %s"},SErrCaseNeeds3:{org:"Case statement needs to have at least 4 arguments"},SErrCaseEvenCount:{org:"Case statement needs to have an even number of arguments"},SErrCaseLabelNotAConst:{org:'Case label %d "%s" is not a constant expression'},SErrCaseLabelType:{org:'Case label %d "%s" needs type %s, but has type %s'},SErrCaseValueType:{org:'Case value %d "%s" needs type %s, but has type %s'},SErrStringTypeRequired:{org:'Expression requires string type, got type "%s" for %s'}}},t.$init=function(){e.L10=Math.log(10),t.RegisterStdBuiltins(t.BuiltinIdentifiers(),t.AllBuiltIns),e.InitFileFormatSettings()}}),["TypInfo"]),rtl.module("JSONDataset",["System","Types","JS","DB","Classes","SysUtils","TypInfo","fpexprpars"],(function(){"use strict";var t=this;this.TJSONRowType={0:"rtJSONObject",rtJSONObject:0,1:"rtJSONArray",rtJSONArray:1},rtl.createClass(this,"TJSONFieldMapper",pas.System.TObject,(function(){this.CopyRow=function(t){return JSON.parse(JSON.stringify(t))},this.GetJSONDataForField$1=function(t,e){return this.GetJSONDataForField(t.FFieldName,t.GetIndex(),e)},this.SetJSONDataForField$1=function(t,e,i){this.SetJSONDataForField(t.FFieldName,t.GetIndex(),e,i)}})),rtl.createClass(this,"TJSONDateField",pas.DB.TDateField,(function(){this.$init=function(){pas.DB.TDateField.$init.call(this),this.FDateFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateFormat",0,rtl.string,"FDateFormat","FDateFormat")})),rtl.createClass(this,"TJSONTimeField",pas.DB.TTimeField,(function(){this.$init=function(){pas.DB.TTimeField.$init.call(this),this.FTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("TimeFormat",0,rtl.string,"FTimeFormat","FTimeFormat")})),rtl.createClass(this,"TJSONDateTimeField",pas.DB.TDateTimeField,(function(){this.$init=function(){pas.DB.TDateTimeField.$init.call(this),this.FDateTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateTimeFormat",0,rtl.string,"FDateTimeFormat","FDateTimeFormat")})),rtl.createClass(this,"TFieldComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDesc=!1,this.FValue=void 0,this.FField=null,this.FOptions={},this.FDataset=null},this.$final=function(){this.FField=void 0,this.FOptions=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s){return this.FField=e,this.FValue=i,this.FOptions=rtl.refSet(s),this.FDataset=t,this},this.GetFieldValue=function(t){return this.FDataset.FFieldMapper.GetJSONDataForField$1(this.FField,this.FDataset.FRows[t])},this.CompareRows=function(t,e){return this.Compare(t,this.GetFieldValue(e))},this.Compare$1=function(t){return this.Compare(t,this.FValue)}})),rtl.createClass(this,"TStringFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s="";return s=""+this.GetFieldValue(t),i=""+e,1 in this.FOptions&&(s=pas.System.Copy(s,1,i.length)),0 in this.FOptions?pas.SysUtils.CompareText(s,i):pas.SysUtils.CompareStr(s,i)}})),rtl.createClass(this,"TNativeIntFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return rtl.trunc(this.GetFieldValue(t))-rtl.trunc(e)}})),rtl.createClass(this,"TBooleanFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return!(0==this.GetFieldValue(t))+0-(!(0==e)+0)}})),rtl.createClass(this,"TDateTimeFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s,n=this;function r(t){return pas.JS.isDate(t)?pas.SysUtils.JSDateToDateTime(t):n.FDataset.ConvertDateTimeField(""+t,n.FField)}return i=r(this.GetFieldValue(t)),s=r(e),Math.round(i-s)}})),rtl.createClass(this,"TFloatFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s;return i=rtl.getNumber(this.GetFieldValue(t)),s=rtl.getNumber(e),Math.round(i-s)}})),rtl.createClass(this,"TRecordComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FIndexBased=!1,this.FItems=[],this.FOptions={},this.FValues=[]},this.$final=function(){this.FDataset=void 0,this.FItems=void 0,this.FOptions=void 0,this.FValues=void 0,pas.System.TObject.$final.call(this)},this.ConstructItems=function(t){var e=null,i=null,s=null,n=0;e=pas.Classes.TFPList.$create("Create");try{if(this.FDataset.GetFieldList$1(e,t),!this.FIndexBased&&e.FCount!==rtl.length(this.FValues))throw pas.DB.EDatabaseError.$create("CreateFmt",["Array of values has different length (%d) from array of fields (%d)",pas.System.VarRecs(19,rtl.length(this.FValues),0,e.FCount)]);this.FItems=rtl.arraySetLength(this.FItems,null,e.FCount);for(var r=0,o=e.FCount-1;r<=o;r++){if(n=r,s=rtl.getObject(e.Get(n)),null===(i=this.DataTypeToComparerClass(s.FDataType)))throw pas.DB.EDatabaseError.$create("CreateFmt",["Cannot locate on field %s of type %s)",pas.System.VarRecs(18,s.FFieldName,18,pas.TypInfo.GetEnumName(pas.DB.$rtti.TFieldType,s.FDataType))]);this.FIndexBased?this.FItems[n]=i.$create("Create$1",[this.FDataset,s,null,rtl.refSet(this.FOptions)]):this.FItems[n]=i.$create("Create$1",[this.FDataset,s,this.FValues[n],rtl.refSet(this.FOptions)])}}finally{e=rtl.freeLoc(e)}},this.DataTypeToComparerClass=function(e){var i=e;return 16===i||23===i||1===i?t.TStringFieldComparer:14===i||3===i||25===i?t.TNativeIntFieldComparer:5===i?t.TBooleanFieldComparer:6===i?t.TFloatFieldComparer:9===i||10===i||11===i?t.TDateTimeFieldComparer:null},this.Compare=function(t){var e,i=0,s=0;for(i=0,s=0,e=rtl.length(this.FItems);0===i&&s<e;)i=this.FItems[s].Compare$1(t),s+=1;return i},this.CompareRows=function(t,e){var i,s=0,n=0;for(s=0,n=0,i=rtl.length(this.FItems);0===s&&n<i;)0!==(s=this.FItems[n].CompareRows(t,e))&&this.FItems[n].FDesc&&(s=-s),n+=1;return s},this.updateFromIndex=function(t){var e=null,i=0;e=pas.Classes.TFPList.$create("Create");try{if(""!==t.FCaseinsFields){this.FDataset.GetFieldList$1(e,t.FCaseinsFields);for(var s=0,n=rtl.length(this.FItems)-1;s<=n;s++)i=s,-1!==e.IndexOf(this.FItems[i].FField)&&(this.FItems[i].FOptions=rtl.unionSet(this.FItems[i].FOptions,rtl.createSet(0)))}e.Clear(),this.FDataset.GetFieldList$1(e,t.FDescFields);for(var r=0,o=rtl.length(this.FItems)-1;r<=o;r++)i=r,this.FItems[i].FDesc=2 in t.FOptions||-1!==e.IndexOf(this.FItems[i].FField)}finally{e=rtl.freeLoc(e)}},this.Create$1=function(t,e,i,s){return this.FDataset=t,rtl.isArray(i)?this.FValues=i:(this.FValues=rtl.arraySetLength(this.FValues,void 0,1),this.FValues[0]=i),this.FOptions=rtl.refSet(s),this.ConstructItems(e),this},this.Create$2=function(t,e){return this.FDataset=t,this.FIndexBased=!0,3 in e.FOptions&&(this.FOptions=rtl.createSet(0)),this.ConstructItems(e.FFields),this.updateFromIndex(e),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FItems)-1;e<=i;e++)t=e,rtl.free(this.FItems,t);pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TJSONIndex",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null,this.FRows=null,this.FDataset=null},this.$final=function(){this.FList=void 0,this.FRows=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.GetRecordIndex=function(t){return pas.JS.isUndefined(this.FList[t])?-1:rtl.trunc(this.FList[t])},this.GetCount=function(){return this.FList.length},this.ClearIndex=function(){this.FList.length=0},this.Create$1=function(t,e){return this.FRows=e,this.FList=new Array(this.FRows.length),this.FDataset=t,this.CreateIndex(),this},this.Delete=function(t){var e;return(e=this.FList.splice(t,1)).length>0?rtl.trunc(e[0]):-1},this.DeleteByRowIndex=function(t){var e;return-1!==(e=this.IndexOfRow(t))&&this.FList.splice(e,1),e},this.Insert=function(t,e){return this.Append(e)},this.IndexOfRow=function(t){return this.FList.indexOf(t)}})),rtl.createClass(this,"TDefaultJSONIndex",this.TJSONIndex,(function(){this.CreateIndex=function(){for(var t=0,e=0,i=this.FRows.length-1;e<=i;e++)t=e,this.FList[t]=t},this.AppendToIndex=function(){var t,e=0;t=this.FList.length,this.FList.length=this.FRows.length;for(var i=t,s=this.FRows.length-1;i<=s;i++)e=i,this.FList[e]=e},this.Append=function(t){return this.FList.push(t)-1},this.Insert=function(t,e){return this.FList.splice(t,0,e),t},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){return t}})),rtl.createClass(this,"TSortedJSONIndex",this.TJSONIndex,(function(){this.$init=function(){t.TJSONIndex.$init.call(this),this.FComparer=null,this.FUnique=!1},this.$final=function(){this.FComparer=void 0,t.TJSONIndex.$final.call(this)},this.FindPos=function(t){var e=0,i=0,s=0,n=0,r=0;if(null==this.FComparer)return e;for(i=0,s=this.GetCount()-1;i<=s;)n=i+rtl.trunc((s-i)/2),(r=this.FComparer.CompareRows(t,rtl.trunc(this.FList[n])))>0?i=n+1:(s=n-1,0===r&&this.FUnique&&(i=n));return e=i},this.MergeSort=function(t){var e,i=null,s=null,n=0,r=0,o=0,a=0,l=0,h=0,u=0,d=0;if(null===t)return null;if(e=t.length,i=new Array(e),0===e)return i;for(l=1;;){for(n=0,a=0,h=0;n<e;){for(h+=1,l<(u=e-n)&&(u=l),r=n+u,d=l;u>0||d>0&&r<e;)0===u?(o=r,r+=1,d-=1):0===d||r>=e||this.FComparer.CompareRows(rtl.trunc(t[n]),rtl.trunc(t[r]))<=0?(o=n,n+=1,u-=1):(o=r,r+=1,d-=1),i[a]=t[o],a+=1;n=r}if(h<=1)return i;l*=2,s=i,i=t,t=s}return i},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),pas.System.TObject.Destroy.call(this)},this.CreateComparer=function(e){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),this.FComparer=t.TRecordComparer.$create("Create$2",[this.FDataset,e])},this.CreateIndex=function(){var t,e=[],i=0,s=0;if(null!==this.FComparer){t=this.FRows.length,e=rtl.arraySetLength(e,0,t),s=0;for(var n=0,r=t-1;n<=r;n++)i=n,pas.JS.isUndefined(this.FRows[i])||(e[s]=i,s+=1);e=rtl.arraySetLength(e,0,s),this.FList=this.MergeSort(e)}},this.AppendToIndex=function(){this.CreateIndex()},this.Append=function(t){var e;return e=this.FindPos(t),this.FList.splice(e,0,t),e},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){var e,i;return i=this.FindRecord(t),(e=this.FindPos(t))!==i&&this.FList.splice(e,0,this.FList.splice(i,1)[0]),e}})),rtl.createClass(this,"TJSONIndexDef",pas.DB.TIndexDef,(function(){this.$init=function(){pas.DB.TIndexDef.$init.call(this),this.FIndex=null},this.$final=function(){this.FIndex=void 0,pas.DB.TIndexDef.$final.call(this)},this.ClearIndex=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndex},set:function(t){this.p.FIndex=t}})},this.BuildIndex=function(e){null===this.FIndex?this.FIndex=t.TSortedJSONIndex.$create("Create$1",[e,e.FRows]):this.FIndex.ClearIndex(),this.FIndex.CreateComparer(this),this.FIndex.CreateIndex()}})),rtl.createClass(this,"TJSONIndexDefs",pas.DB.TIndexDefs,(function(){this.GetD=function(e){return rtl.as(this.GetItem$1(e),t.TJSONIndexDef)}})),this.TBlobFormat={0:"bfHex",bfHex:0,1:"bfBase64",bfBase64:1,2:"bfBytes",bfBytes:2,3:"bfCustom",bfCustom:3},rtl.createClass(this,"TBaseJSONDataSet",pas.DB.TDataSet,(function(){this.$init=function(){pas.DB.TDataSet.$init.call(this),this.FActiveIndex="",this.FBlobFormat=0,this.FIndexes=null,this.FOnDecodeBlobValue=null,this.FOnEncodeBlobValue=null,this.FOwnsData=!1,this.FDefaultIndex=null,this.FCurrentIndex=null,this.FCurrent=0,this.FMetaData=null,this.FRows=null,this.FDeletedRows=null,this.FFieldMapper=null,this.FEditIdx=0,this.FEditRow=void 0,this.FFilterRow=void 0,this.FUseDateTimeFormatFields=!1,this.FRowType=0,this.FFilterExpression=null},this.$final=function(){this.FIndexes=void 0,this.FOnDecodeBlobValue=void 0,this.FOnEncodeBlobValue=void 0,this.FDefaultIndex=void 0,this.FCurrentIndex=void 0,this.FMetaData=void 0,this.FRows=void 0,this.FDeletedRows=void 0,this.FFieldMapper=void 0,this.FFilterExpression=void 0,pas.DB.TDataSet.$final.call(this)},this.GetFilterField=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new(),i=null,s=0;i=this.FieldByName(t),e.ResultType=this.FieldTypeToExpressionType(i.FDataType);var n=e.ResultType;return 0===n?e.resValue=i.GetAsBoolean():1===n?e.resValue=i.GetAsLargeInt():2===n?e.resValue=i.GetAsFloat():3===n?e.resValue=i.GetAsDateTime():4===n?e.resValue=i.GetAsString():5===n&&(s=1e4*i.GetAsFloat(),e.resValue=s/1e4),e},this.SetMetaData=function(t){this.CheckInactive(),this.FMetaData=t},this.SetRows=function(t){t!==this.FRows&&(this.CheckInactive(),this.FRows=null,this.AddToRows(t))},this.RemoveCalcFields=function(t){for(var e=0,i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,this.FFieldList.GetField(e).FFieldKind in rtl.createSet(1,3,2)&&this.FFieldMapper.RemoveField(this.FFieldList.GetField(e).FFieldName,this.FFieldList.GetField(e).GetIndex(),t)},this.ActivateIndex=function(e){var i=null;null===(i=""!==this.FActiveIndex?rtl.as(this.FIndexes.Find$1(this.FActiveIndex),t.TJSONIndexDef):null)?this.FCurrentIndex=this.FDefaultIndex:(null===i.FIndex&&e&&i.BuildIndex(this),this.FCurrentIndex=i.FIndex),this.GetActive()&&this.Resync(rtl.createSet(1))},this.FieldTypeToExpressionType=function(t){var e=0;return 16===t||23===t||1===t?e=4:3===t||14===t||25===t?e=1:5===t?e=0:6===t?e=2:9===t||10===t||11===t?e=3:pas.DB.DatabaseErrorFmt$1("Fields of type %s are not supported in filter expressions.",pas.System.VarRecs(18,pas.DB.FieldTypeNames[t]),this),e},this.GetFilterIsNull=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new();return e.ResultType=0,e.resValue=this.FieldByName(""+t[0].resValue).GetIsNull(),e},this.FilterExpressionClass=function(){return pas.fpexprpars.TFPExpressionParser},this.CreateFilterExpression=function(){var t=null,e=0;(t=this.FilterExpressionClass().$create("Create$1",[this])).SetAllowLike(!0);for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,this.FFieldList.GetField(e).FDataType in rtl.createSet(15,16)||t.FIdentifiers.AddVariable(this.FFieldList.GetField(e).FFieldName,this.FieldTypeToExpressionType(this.FFieldList.GetField(e).FDataType),rtl.createCallback(this,"GetFilterField"));return t.FIdentifiers.AddFunction("IsNull","B","S",rtl.createCallback(this,"GetFilterIsNull")),t.SetExpression(this.FFilterText),t},this.DoFilterRecord=function(){var t,e=!1;e=!0,t=this.SetTempState(6);try{if(null!=this.FOnFilterRecord&&(this.FOnFilterRecord(this,{get:function(){return e},set:function(t){e=t}}),!e))return e;if(!this.FFiltered||""===this.FFilterText)return e;null===this.FFilterExpression&&(this.FFilterExpression=this.CreateFilterExpression()),e=this.FFilterExpression.GetAsBoolean()}finally{this.RestoreState(t)}return e},this.CreateIndexDefs=function(){return t.TJSONIndexDefs.$create("create$3",[this,this,t.TJSONIndexDef])},this.RecordComparerClass=function(){return t.TRecordComparer},this.LocateRecordIndex=function(t,e,i){var s=0,n=null,r=0,o=0;s=-1,n=this.RecordComparerClass().$create("Create$1",[this,t,e,rtl.refSet(i)]);try{o=2 in i?this.FCurrent:0,r=this.FCurrentIndex.GetRecordIndex(o);for(;-1===s&&-1!==r;)0===n.Compare(r)&&(s=r),o+=1,r=this.FCurrentIndex.GetRecordIndex(o)}finally{n=rtl.freeLoc(n)}return s},this.AllocRecordBuffer=function(){var t=pas.DB.TDataRecord.$new();return t.data=new Object,t.bookmark=null,t.state=0,t},this.FreeRecordBuffer=function(t){t.data=null,t.bookmark=null,t.state=0},this.InternalInitRecord=function(t){t.data=this.FFieldMapper.CreateRow(),t.bookmark=null,t.state=0},this.GetRecord=function(t,e,i){var s=0,n=0,r=!1;s=0;do{r=!0;var o=e;1===o?this.FCurrent<this.FCurrentIndex.GetCount()-1?this.FCurrent+=1:s=2:2===o?this.FCurrent>0?this.FCurrent-=1:s=1:0===o&&(this.FCurrent<0||this.FCurrent>=this.FCurrentIndex.GetCount())&&(s=2),0===s&&(n=this.FCurrentIndex.GetRecordIndex(this.FCurrent),t.data=this.FRows[n],t.bookmarkFlag=0,t.bookmark=n,this.GetCalcFields(t),this.FFiltered&&(this.FFilterRow=t.data,(r=this.DoFilterRecord())||0!==e||(r=!0,s=2)))}while(!r);return s},this.AddToRows=function(t){null===this.FRows?this.FRows=t:(this.FRows=this.FRows.concat(t),this.AppendToIndexes())},this.InternalClose=function(){this.BindFields(!1),this.FDefaultFields&&this.DestroyFields(),this.FreeData()},this.InternalDelete=function(){var t,e=0,i=null;if(-1!==(t=this.FCurrentIndex.Delete(this.FCurrent))){for(var s=0,n=this.FIndexes.GetCount()-1;s<=n;s++)e=s,(i=this.FIndexes.GetD(e).FIndex)!==this.FCurrentIndex&&i.DeleteByRowIndex(t);null==this.FDeletedRows?this.FDeletedRows=new Array(this.FRows[t]):this.FDeletedRows.push(this.FRows[t]),this.FRows[t]=void 0}},this.InternalFirst=function(){this.FCurrent=-1},this.InternalLast=function(){this.FCurrent=this.FCurrentIndex.GetCount()},this.InternalOpen=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FFieldMapper=this.CreateFieldMapper(),null===this.FRows&&(this.FRows=new Array,this.FOwnsData=!0),this.CreateIndexes(),this.InternalInitFieldDefs(),this.FDefaultFields&&this.CreateFields(),this.BindFields(!0),this.InitDateTimeFields(),""!==this.FActiveIndex&&this.ActivateIndex(!0),this.FCurrent=-1},this.InternalPost=function(){var t=0,e=0,i=0,s=0,n=pas.DB.TBookmark.$new();if(pas.DB.TDataSet.InternalPost.call(this),i=-1,this.GetBookmarkData(pas.DB.TDataRecord.$clone(this.ActiveBuffer()),n),3===this.FState)if(s=this.FRows.push(this.FEditRow)-1,2===this.GetBookmarkFlag(pas.DB.TDataRecord.$clone(this.ActiveBuffer()))){this.FDefaultIndex.Append(s);for(var r=0,o=this.FIndexes.GetCount()-1;r<=o;r++)t=r,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{this.FCurrent=this.FDefaultIndex.Insert(this.FCurrent,s);for(var a=0,l=this.FIndexes.GetCount()-1;a<=l;a++)t=a,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{-1===this.FEditIdx&&pas.DB.DatabaseErrorFmt("Failed to retrieve record index for record %d",pas.System.VarRecs(0,this.FCurrent)),s=this.FEditIdx,this.FRows[s]=this.FEditRow,this.FDefaultIndex.Update(s);for(var h=0,u=this.FIndexes.GetCount()-1;h<=u;h++)t=h,e=this.FCurrentIndex.Update(s),null!=this.FIndexes.GetD(t).FIndex&&this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e)}-1!==i&&(this.FCurrent=i),this.FEditIdx=-1,this.FEditRow=null},this.InternalInsert=function(){var t=0,e=null;this.FEditRow=this.ActiveBuffer().data;for(var i=0,s=this.FFieldDefs.GetCount()-1;i<=s;i++)t=i,e=this.FFieldDefs.GetItem$1(t),this.FFieldMapper.SetJSONDataForField(e.FName,e.GetIndex(),this.FEditRow,null)},this.InternalEdit=function(){this.FEditIdx=this.FCurrentIndex.GetRecordIndex(this.FCurrent),pas.JS.isUndefined(this.FRows[this.FEditIdx])?this.FEditRow=this.FFieldMapper.CreateRow():this.FEditRow=this.FFieldMapper.CopyRow(this.FRows[this.FEditIdx])},this.InternalCancel=function(){this.FEditIdx=-1,this.FEditRow=null},this.InternalInitFieldDefs=function(){if(null!=this.FMetaData&&this.MetaDataToFieldDefs(),0===this.FFieldDefs.GetCount())throw t.EJSONDataset.$create("Create$1",["No fields found"])},this.InternalSetToRecord=function(t){this.FCurrent=this.FCurrentIndex.FindRecord(rtl.trunc(t.bookmark))},this.SetFilterText=function(t){pas.DB.TDataSet.SetFilterText.call(this,t),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterExpression},set:function(t){this.p.FFilterExpression=t}}),this.GetActive()&&this.Resync(rtl.createSet(1))},this.SetFiltered=function(t){pas.DB.TDataSet.SetFiltered.call(this,t),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterExpression},set:function(t){this.p.FFilterExpression=t}}),this.GetActive()&&this.Resync(rtl.createSet(1))},this.GetFieldClass=function(e){var i=null;if(this.FUseDateTimeFormatFields&&e in rtl.createSet(9,11,10)){var s=e;9===s?i=t.TJSONDateField:11===s?i=t.TJSONDateTimeField:10===s&&(i=t.TJSONTimeField)}else i=pas.DB.TDataSet.GetFieldClass.call(this,e);return i},this.GetApplyUpdateData=function(t){var e;return e=this.FFieldMapper.CopyRow(t.data),this.RemoveCalcFields(e),e},this.IsCursorOpen=function(){return null!=this.FDefaultIndex},this.GetBookmarkData=function(t,e){e.Data=t.bookmark},this.GetBookmarkFlag=function(t){return t.bookmarkFlag},this.InternalGotoBookmark=function(t){rtl.isNumber(t.Data)&&(this.FCurrent=this.FCurrentIndex.FindRecord(rtl.trunc(t.Data)))},this.SetBookmarkFlag=function(t,e){t.bookmarkFlag=e},this.SetBookmarkData=function(t,e){t.bookmark=e.Data},this.GetRecordCount=function(){return null!=this.FCurrentIndex?this.FCurrentIndex.GetCount():0},this.GetRecNo=function(){var t;return t=rtl.trunc(this.ActiveBuffer().bookmark),this.FCurrentIndex.FindRecord(t)+1},this.FreeData=function(){var t=0;this.FOwnsData&&(this.FRows=null,this.FMetaData=null);for(var e=0,i=this.FIndexes.GetCount()-1;e<=i;e++)t=e,this.FIndexes.GetD(t).ClearIndex();this.FCurrentIndex=null,pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefaultIndex},set:function(t){this.p.FDefaultIndex=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FCurrentIndex=null,this.FDeletedRows=null},this.AppendToIndexes=function(){this.FDefaultIndex.AppendToIndex(),null!=this.FCurrentIndex&&this.FCurrentIndex!==this.FDefaultIndex&&this.FCurrentIndex.AppendToIndex()},this.Clone=function(t){t.FFieldDefs.GetCount()>0?(this.FFieldDefs.Assign$2(t.FFieldDefs),this.CreateFields()):(t.InitFieldDefsFromfields(),this.FFieldDefs.Assign$2(t.FFieldDefs),this.CreateFields()),this.SetRows(t.FRows)},this.CreateIndexes=function(){this.FDefaultIndex=t.TDefaultJSONIndex.$create("Create$1",[this,this.FRows]),this.AppendToIndexes(),null===this.FCurrentIndex&&(this.FCurrentIndex=this.FDefaultIndex)},this.MetaDataToFieldDefs=function(){},this.InitDateTimeFields=function(){},this.ConvertDateTimeField=function(e,i){var s="";s="";var n=i.FDataType;return 9===n?t.TJSONDateField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateField).FDateFormat):10===n?t.TJSONTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONTimeField).FTimeFormat):11===n&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateTimeField).FDateTimeFormat),""===s?this.$class.DefaultConvertToDateTime(i,e,!0):pas.DateUtils.ScanDateTime(s,e,1)},this.FormatDateTimeField=function(e,i){var s="";s="";var n=i.FDataType;return 9===n?t.TJSONDateField.isPrototypeOf(i)&&(s=i.FDateFormat):10===n?t.TJSONTimeField.isPrototypeOf(i)&&(s=i.FTimeFormat):11===n&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=i.FDateTimeFormat),""===s?pas.DateUtils.DateTimeToRFC3339(e):pas.SysUtils.FormatDateTime(s,e)},this.CreateFieldMapper=function(){return 1===this.FRowType?t.TJSONArrayFieldMapper.$create("Create"):t.TJSONObjectFieldMapper.$create("Create")},this.Create$1=function(t){return pas.DB.TDataSet.Create$1.apply(this,arguments),this.FOwnsData=!0,this.FUseDateTimeFormatFields=!1,this.FEditIdx=-1,this.FIndexes=this.CreateIndexDefs(),this},this.Destroy=function(){this.Close(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterExpression},set:function(t){this.p.FFilterExpression=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndexes},set:function(t){this.p.FIndexes=t}}),this.FEditIdx=-1,pas.DB.TDataSet.Destroy.call(this)},this.BlobDataToBytes=function(t){var e=[];e=[];var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBlobDataToBytes(t):1===i?e=pas.SysUtils.BytesOf(atob(""+t)):2===i?e=t:3===i&&null!=this.FOnDecodeBlobValue&&this.FOnDecodeBlobValue(this,t,{get:function(){return e},set:function(t){e=t}}),e},this.BytesToBlobData=function(t){var e=void 0;e="";var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBytesToBlobData(rtl.arrayRef(t)):1===i?e=btoa(pas.SysUtils.StringOf(t)):2===i?e=t:3===i&&null!=this.FOnEncodeBlobValue&&this.FOnEncodeBlobValue(this,rtl.arrayRef(t),{get:function(){return e},set:function(t){e=t}}),e},this.ConvertDateTimeToNative=function(t,e){return isNaN(e)?null:this.FormatDateTimeField(e,t)},this.Locate=function(t,e,i){var s=!1,n=0,r=pas.DB.TBookmark.$new();return s=pas.DB.TDataSet.Locate.apply(this,arguments),(s=-1!==(n=this.LocateRecordIndex(t,e,rtl.refSet(i))))&&(r.Data=n,r.Flag=0,this.GotoBookmark(r)),s},this.Lookup=function(t,e,i){var s=void 0,n=0,r=0,o=null,a=[];s=null,o=pas.Classes.TFPList.$create("Create");try{if(this.GetFieldList$1(o,i),s=pas.DB.TDataSet.Lookup.call(this,t,e,i),-1!==(n=this.LocateRecordIndex(t,e,{}))){a=rtl.arraySetLength(a,void 0,o.FCount);for(var l=0,h=o.FCount-1;l<=h;l++)a[r=l]=this.FFieldMapper.GetJSONDataForField$1(rtl.getObject(o.Get(r)),this.FRows[n]);s=1===o.FCount?a[r]:a}}finally{o=rtl.freeLoc(o)}return s},this.GetFieldData$1=function(t,e){var i=void 0,s=void 0;if(this.FState in rtl.createSet(5,11))s=this.FCalcBuffer.data;else if(6===this.FState)s=this.FFilterRow;else if(this.FEditIdx==e.bookmark)s=8===this.FState?e.data:this.FEditRow;else{if(8===this.FState)return null;s=e.data}return i=this.FFieldMapper.GetJSONDataForField$1(t,s),pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){var s=void 0;s=this.FState in rtl.createSet(5,11)?this.FCalcBuffer.data:this.FEditRow,this.FFieldMapper.SetJSONDataForField$1(t,s,i),this.FState in rtl.createSet(5,11,6,7)||this.DataEvent(0,t),this.SetModified(!0)},this.GetClonedDataSet=function(e){var i=null,s=null;i=t.TBaseJSONDataSet.$create("Create$1",[null]);try{s=rtl.as(i,t.TBaseJSONDataSet),e&&(s.SetFilterText(this.FFilterText),s.SetOnFilterRecord(this.FOnFilterRecord),s.SetFilterOptions(rtl.refSet(this.FFilterOptions)),s.SetFiltered(this.FFiltered)),s.Clone(this),s.SetActive(this.GetActive())}catch(t){throw i=rtl.freeLoc(i),t}return i},this.BookmarkValid=function(t){return rtl.isNumber(t.Data)},this.CompareBookmarks=function(t,e){return rtl.isNumber(t.Data)&&rtl.isNumber(e.Data)?rtl.trunc(e.Data)-rtl.trunc(t.Data):rtl.isNumber(t.Data)?-1:rtl.isNumber(e.Data)?1:0},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TJSONObjectFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){pas.JS.JSDelete(i,t)},this.SetJSONDataForField=function(t,e,i,s){i[t]=s},this.GetJSONDataForField=function(t,e,i){return i[t]},this.CreateRow=function(){return new Object}})),rtl.createClass(this,"TJSONArrayFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){i.splice(e,1)},this.SetJSONDataForField=function(t,e,i,s){i[e]=s},this.GetJSONDataForField=function(t,e,i){return i[e]},this.CreateRow=function(){return new Array}})),rtl.createClass(this,"EJSONDataset",pas.DB.EDatabaseError,(function(){}))}),["DateUtils"]),rtl.module("WEBLib.CDS",["System","Classes","DB","JSONDataset","Web","JS","WEBLib.Controls","WEBLib.REST"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TConnectErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ErrorCode",rtl.longint]]),methodkind:0}),this.TURLType={0:"utGet",utGet:0,1:"utPost",utPost:1,2:"utPut",utPut:2,3:"utDelete",utDelete:3},this.$rtti.$Enum("TURLType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TURLType}),this.$rtti.$MethodVar("TClientConnectionGetURLEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["URL",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetUpdatePayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["Data",rtl.jsvalue],["aPayLoad",rtl.string,4]]),methodkind:0}),this.$rtti.$MethodVar("TGetDataPayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["aPayLoad",rtl.jsvalue,1]]),methodkind:0}),this.$rtti.$MethodVar("TProcessMetaDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["FieldDefs",pas.DB.$rtti.TFieldDefs],["aMetaData",pas.JS.$rtti.TJSObject]]),methodkind:0}),this.$rtti.$MethodVar("TDataReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",pas["WEBLib.Controls"].$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string,1]]),methodkind:0}),rtl.createClass(this,"TClientConnection",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataProxy=null,this.FActive=!1,this.FURI="",this.FDS=null,this.FDataNode="",this.FAutoOpen=!1,this.FUpdateCount=0,this.FOnConnectError=null,this.FBeforeConnect=null,this.FAfterConnect=null,this.FHeaders=null,this.FPassword="",this.FUser="",this.FOnGetURL=null,this.FPageParam="",this.FOnGetUpdatePayLoad=null,this.FAppendKeyToURL=!1,this.FOnGetDataPayLoad=null,this.FMetaDataNode="",this.FOnProcessMetaData=null,this.FOnDataReceived=null,this.FXHR=null,this.FCommand=0,this.FCustomCommand="",this.FPostData="",this.FDelimiter="\0",this.FSkipFirstCSVLine=!1,this.FOpenResolver=null},this.$final=function(){this.FDataProxy=void 0,this.FDS=void 0,this.FOnConnectError=void 0,this.FBeforeConnect=void 0,this.FAfterConnect=void 0,this.FHeaders=void 0,this.FOnGetURL=void 0,this.FOnGetUpdatePayLoad=void 0,this.FOnGetDataPayLoad=void 0,this.FOnProcessMetaData=void 0,this.FOnDataReceived=void 0,this.FXHR=void 0,this.FOpenResolver=void 0,pas.Classes.TComponent.$final.call(this)},this.SetHeaders=function(t){this.FHeaders.Assign(t)},this.GetPageURL=function(t){var e="";return e=this.GetReadBaseURL(t),""!==this.FPageParam&&(0!==pas.System.Pos("?",e)?e+="&":e+="?",e=e+this.FPageParam+"="+pas.SysUtils.IntToStr(t.FRequestID-1)),e},this.GetDataProxy=function(){return null===this.FDataProxy&&(this.FDataProxy=this.DoGetDataProxy()),this.FDataProxy},this.SetDataNode=function(t){this.FDataNode!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FDataNode=t},this.SetURI=function(t){this.FURI!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FURI=t},this.onError=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onAbort=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onLoad=function(t){var e=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new(),i="";return null!=this.FOnDataReceived&&(e.req=this.FXHR,i=this.FXHR.responseText,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(e),{get:function(){return i},set:function(t){i=t}})),!0,!0},this.SetActive=function(t){if(this.FActive!==t){if(this.FActive=t,this.FUpdateCount>0)return;if(0 in this.FComponentState)return;t?""!==this.FURI&&this.DoConnect():this.DoDisconnect()}},this.ProcessMetadata=function(t,e,i){null!=this.FOnProcessMetaData&&this.FOnProcessMetaData(this,t,e,i)},this.GetReadBaseURL=function(t){var e="";return e=this.FURI,null!=this.FOnGetURL&&this.FOnGetURL(this,t.FDataset,0,{get:function(){return e},set:function(t){e=t}}),e},this.RegisterDataSet=function(t){this.FDS=t},this.DoOpenResolve=function(t){null!=this.FOpenResolver&&this.FOpenResolver(t)},this.DoAfterLoad=function(t){this.DoOpenResolve(!0)},this.DoRequest=function(){var t;this.FXHR=new XMLHttpRequest,this.FXHR.addEventListener("load",rtl.createSafeCallback(this,"onLoad")),this.FXHR.addEventListener("abort",rtl.createSafeCallback(this,"onAbort")),this.FXHR.addEventListener("error",rtl.createSafeCallback(this,"onError")),t=pas["WEBLib.REST"].HTTPCommand(this.FCommand,this.FCustomCommand),this.FXHR.open(t,this.FURI),this.SetupRequest(this.FXHR),this.FXHR.setRequestHeader("content-type","application/json"),""!==this.FPostData?this.FXHR.send(this.FPostData):this.FXHR.send()},this.DoConnect=function(){null!=this.FDS?(this.DoBeforeConnect(),this.FAutoOpen?(this.FDS.SetActive(!1),this.FDS.FAfterLoad=rtl.createCallback(this,"DoAfterLoad"),this.FDS.Load({},null)):this.DoRequest()):this.DoRequest()},this.DoDisconnect=function(){null!=this.FDS&&this.FAutoOpen&&this.FDS.SetActive(!1)},this.DoBeforeConnect=function(){null!=this.FBeforeConnect&&this.FBeforeConnect(this)},this.DoAfterConnect=function(){null!=this.FAfterConnect&&this.FAfterConnect(this)},this.DoError=function(t){throw null!=this.FOnConnectError&&this.FOnConnectError(this,t),this.DoOpenResolve(!1),pas.SysUtils.Exception.$create("Create$1",["Error connecting to URI "+this.FURI])},this.DoDataReceived=function(t,e){var i=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new();null!=this.FOnDataReceived&&(i.req=t,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(i),e))},this.SetupRequest=function(t){var e=0,i="",s="";""!==this.FUser&&t.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var n=0,r=this.FHeaders.GetCount()-1;n<=r;n++)e=n,this.FHeaders.GetNameValue(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),t.setRequestHeader(i,s);""!==this.FUser&&t.setRequestHeader("Authorization","Basic "+window.btoa(this.FUser+":"+this.FPassword))},this.GetDataNode=function(){var t="";return""===(t=this.FDataNode)&&(t="data"),t},this.GetMetaDataNode=function(){var t="";return""===(t=this.FMetaDataNode)&&(t="metaData"),t},this.DoGetDataProxy=function(){return t.TWebClientDataProxy.$create("Create$1",[this])},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FActive=!1,this.FDS=null,this.FAutoOpen=!0,this.FCommand=0,this.FHeaders=pas.Classes.TStringList.$create("Create$1"),this.FDelimiter=";",this.FSkipFirstCSVLine=!1,this.FAppendKeyToURL=!0,this},this.Destroy=function(){rtl.free(this,"FHeaders"),pas.Classes.TComponent.Destroy.call(this)},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.FActive&&""!==this.FURI&&this.DoConnect()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Active",2,rtl.boolean,"FActive","SetActive"),e.addProperty("AppendKeyToURL",0,rtl.boolean,"FAppendKeyToURL","FAppendKeyToURL",{Default:!0}),e.addProperty("AutoOpenDataSet",0,rtl.boolean,"FAutoOpen","FAutoOpen",{Default:!0}),e.addProperty("Command",0,pas["WEBLib.REST"].$rtti.THTTPCommand,"FCommand","FCommand",{Default:pas["WEBLib.REST"].THTTPCommand.httpGET}),e.addProperty("CustomCommand",0,rtl.string,"FCustomCommand","FCustomCommand"),e.addProperty("DataNode",2,rtl.string,"FDataNode","SetDataNode"),e.addProperty("Delimiter",0,rtl.char,"FDelimiter","FDelimiter"),e.addProperty("MetaDataNode",0,rtl.string,"FMetaDataNode","FMetaDataNode"),e.addProperty("PageParam",0,rtl.string,"FPageParam","FPageParam"),e.addProperty("PostData",0,rtl.string,"FPostData","FPostData"),e.addProperty("Headers",2,pas.Classes.$rtti.TStringList,"FHeaders","SetHeaders"),e.addProperty("Password",0,rtl.string,"FPassword","FPassword"),e.addProperty("SkipFirstCSVLine",0,rtl.boolean,"FSkipFirstCSVLine","FSkipFirstCSVLine",{Default:!1}),e.addProperty("User",0,rtl.string,"FUser","FUser"),e.addProperty("URI",2,rtl.string,"FURI","SetURI"),e.addProperty("AfterConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FAfterConnect","FAfterConnect"),e.addProperty("BeforeConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FBeforeConnect","FBeforeConnect"),e.addProperty("OnConnectError",0,t.$rtti.TConnectErrorEvent,"FOnConnectError","FOnConnectError"),e.addProperty("OnDataReceived",0,t.$rtti.TDataReceivedEvent,"FOnDataReceived","FOnDataReceived"),e.addProperty("OnGetURL",0,t.$rtti.TClientConnectionGetURLEvent,"FOnGetURL","FOnGetURL"),e.addProperty("OnGetUpdatePayLoad",0,t.$rtti.TGetUpdatePayloadEvent,"FOnGetUpdatePayLoad","FOnGetUpdatePayLoad"),e.addProperty("OnGetDataPayload",0,t.$rtti.TGetDataPayloadEvent,"FOnGetDataPayLoad","FOnGetDataPayLoad"),e.addProperty("OnProcessMetaData",0,t.$rtti.TProcessMetaDataEvent,"FOnProcessMetaData","FOnProcessMetaData")})),rtl.createClass(this,"TWebClientDataProxy",pas.DB.TDataProxy,(function(){this.$init=function(){pas.DB.TDataProxy.$init.call(this),this.FConnection=null},this.$final=function(){this.FConnection=void 0,pas.DB.TDataProxy.$final.call(this)},this.GetUpdateDescriptorClass=function(){return e.TWebClientUpdateRequest},this.DoGetData=function(t){var i,s=!1,n=null,r="";return s=!1,(n=rtl.as(t,e.TWebClientDataRequest)).FXHR=new XMLHttpRequest,""===(i=this.FConnection.GetPageURL(t))?2 in n.FLoadOptions?n.FSuccess=1:(n.FSuccess=0,n.FErrorMsg="No URL to get data",n.DoAfterRequest()):(2 in n.FLoadOptions&&""===this.FConnection.FPageParam?n.FSuccess=1:(r=pas["WEBLib.REST"].HTTPCommand(this.FConnection.FCommand,this.FConnection.FCustomCommand),n.FXHR.open(r,i,!0),this.FConnection.SetupRequest(n.FXHR),n.FXHR.addEventListener("load",rtl.createSafeCallback(n,"onLoad")),n.FXHR.addEventListener("abort",rtl.createSafeCallback(n,"onAbort")),n.FXHR.addEventListener("error",rtl.createSafeCallback(n,"onError")),""!==this.FConnection.FPostData?n.FXHR.send(this.FConnection.FPostData):n.FXHR.send()),s=!0),s},this.GetDataRequest=function(t,i,s){var n=null;return(n=e.TWebClientDataRequest.$create("Create$1",[this,rtl.refSet(t),i,s])).FConnection=this.FConnection,n},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),t.TClientConnection.isPrototypeOf(e)&&(this.FConnection=e),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),this.$rtti.$MethodVar("TUpdateRecordEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADescriptor",pas.DB.$rtti.TRecordUpdateDescriptor]]),methodkind:0}),rtl.createClass(this,"TCustomClientDataSet",pas.JSONDataset.TBaseJSONDataSet,(function(){this.$init=function(){pas.JSONDataset.TBaseJSONDataSet.$init.call(this),this.FConnection=null,this.FOnUpdateRecord=null,this.FUpdateCount=0,this.FIDField="",this.FuseServerMetadata=!1,this.FParams=null,this.FOpenResolver=null,this.FPostResolver=null,this.FInsertResolver=null,this.FDeleteResolver=null},this.$final=function(){this.FConnection=void 0,this.FOnUpdateRecord=void 0,this.FParams=void 0,this.FOpenResolver=void 0,this.FPostResolver=void 0,this.FInsertResolver=void 0,this.FDeleteResolver=void 0,pas.JSONDataset.TBaseJSONDataSet.$final.call(this)},this.SetParams=function(t){this.FParams.Assign(t)},this.GetStringFieldLength=function(t,e,i){var s=0,n=0,r=0,o=void 0;if(s=0,o=t.maxLen,isNaN(pas.JS.toNumber(o)))for(var a=0,l=this.FRows.length-1;a<=l;a++)n=a,o=this.FFieldMapper.GetJSONDataForField(e,i,this.FRows[n]),rtl.isString(o)&&(r=(""+o).length)>s&&(s=r);else(s=pas.System.Trunc(pas.JS.toNumber(o)))<=0&&pas.DB.DatabaseErrorFmt$1("Invalid maximum length specifier for field %s",pas.System.VarRecs(18,e),this);return 0===s&&(s=20),s},this.StringToFieldType=function(t){return"int"===t?3:"bigint"===t?25:"float"===t?6:"bool"===t?5:"date"===t?9:"datetime"===t?11:"time"===t?10:"blob"===t?15:1},this.DataPacketReceived=function(t){var e=!1,i=null,s=null,n=void 0,r=null,o="",a="",l="",h="",u=!1,d=null,F=null,c=0,p=0,C=0,S=0;if(e=!1,pas.JS.isNull(t.FData))return e;if(i=null,r=null,rtl.isString(t.FData)&&(u=!0,(h=pas.SysUtils.Trim(""+t.FData)).length>1&&"["!==h.charAt(0)&&"{"!==h.charAt(0)&&(u=!1),!u)){d=pas.Classes.TStringList.$create("Create$1"),(F=pas.Classes.TStringList.$create("Create$1")).SetDelimiter(this.FConnection.FDelimiter),F.FStrictDelimiter=!0,d.SetTextStr(""+t.FData),(r=new Array).length=d.GetCount(),c=0,this.FConnection.FSkipFirstCSVLine&&(c=1);for(var m=c,f=d.GetCount()-1;m<=f;m++){r[(p=m)-c]=new Array,F.SetDelimitedText(d.Get(p)),S=F.GetCount(),i=new Object;for(var y=0,g=F.GetCount()-1;y<=g;y++)C=y,i["column"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return C},set:function(t){C=t}})]=F.Get(C);r[p-c]=i}if(e=null!==r&&r.length>0,null!=r&&r.length>0&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()){for(var T=0,E=S-1;T<=E;T++)p=T,this.FFieldDefs.Add$4("column"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return p},set:function(t){p=t}}),1,255);this.AddToRows(r)}return F=rtl.freeLoc(F),d=rtl.freeLoc(d),e}if(rtl.isString(t.FData)?(n=JSON.parse(""+t.FData),rtl.isArray(n)?r=n:rtl.isObject(n)&&(i=n)):rtl.isArray(t.FData)?r=t.FData:rtl.isObject(t.FData)?i=t.FData:pas.DB.DatabaseError("Cannot handle data packet"),null!=i){for(a=this.FConnection.GetDataNode(),o=this.FConnection.GetMetaDataNode();pas.System.Pos("\\",a)>0;)l=pas.System.Copy(a,1,pas.System.Pos("\\",a)-1),a=pas.System.Copy(a,pas.System.Pos("\\",a)+1,a.length),i=i[l];""===this.FIDField&&(this.FIDField="id"),this.FuseServerMetadata&&i.hasOwnProperty(o)&&rtl.isObject(i[o])&&(s=i[o],this.GetActive()||this.SetMetaData(s),s.hasOwnProperty("root")&&rtl.isString(s.root)&&(a=""+this.FMetaData.root),s.hasOwnProperty("idField")&&rtl.isString(s.idField)&&(this.FIDField=""+s.idField)),""!==a&&i.hasOwnProperty(a)&&rtl.isArray(i[a])&&(r=i[a])}return null!=r&&r.length>0&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()&&this.FieldDefsFromRows(r),(e=null!==r&&r.length>0)&&this.AddToRows(r),e},this.DoOpenResolve=function(t){null!=this.FOpenResolver&&(this.FOpenResolver(t),this.FOpenResolver=null)},this.DoPostResolve=function(t){null!=this.FPostResolver&&this.FPostResolver(t)},this.DoInsertResolve=function(t){null!=this.FInsertResolver&&this.FInsertResolver(t)},this.DoDeleteResolve=function(t){null!=this.FDeleteResolver&&this.FDeleteResolver(t)},this.MetaDataToFieldDefs=function(){var t,e=null,i=0,s=0,n="",r=0,o=void 0;if(this.FFieldDefs.Clear(),this.FConnection.ProcessMetadata(this,this.FFieldDefs,this.FMetaData),!(this.FFieldDefs.GetCount()>0)){if(o=this.FMetaData.fields,!rtl.isArray(o))throw pas.JSONDataset.EJSONDataset.$create("Create$1",["Invalid metadata object"]);for(var a=0,l=(t=o).length-1;a<=l;a++){if(i=a,!rtl.isObject(t[i]))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in metadata is not an object",pas.System.VarRecs(0,i)]);if(o=(e=t[i]).name,!rtl.isString(o))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has no or invalid name property",pas.System.VarRecs(0,i)]);if(n=""+o,o=e.type,pas.JS.isNull(o)||pas.JS.isUndefined(o))r=1;else{if(!rtl.isString(o))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has invalid type property",pas.System.VarRecs(0,i)]);r=this.StringToFieldType(""+o)}s=1===r?this.GetStringFieldLength(e,n,i):0,this.FFieldDefs.Add$4(n,r,s)}}},this.SetConnection=function(t){this.FConnection=t,null!=t&&t.RegisterDataSet(this)},this.CreateFieldMapper=function(){return pas.JSONDataset.TJSONObjectFieldMapper.$create("Create")},this.InitFieldDefs=function(){var t=this;this.FFieldDefs.Clear(),this.GetChildren((function(e){pas.DB.TStringField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TStringField).FFieldName,1,rtl.as(e,pas.DB.TStringField).FSize),pas.DB.TBooleanField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBooleanField).FFieldName,5,0),pas.DB.TAutoIncField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TAutoIncField).FFieldName,14,0):pas.DB.TIntegerField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TIntegerField).FFieldName,3,0):pas.DB.TLargeintField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TLargeintField).FFieldName,25,0):pas.DB.TFloatField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TFloatField).FFieldName,6,0):pas.DB.TNumericField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TNumericField).FFieldName,3,0),pas.DB.TDateField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateField).FFieldName,9,0):pas.DB.TTimeField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TTimeField).FFieldName,9,0):pas.DB.TDateTimeField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateTimeField).FFieldName,11,0),pas.DB.TMemoField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TMemoField).FFieldName,16,0):pas.DB.TBlobField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBlobField).FFieldName,15,0)}),t)},this.InternalInitFieldDefs=function(){0===this.FFieldDefs.GetCount()&&null!=this.FRows&&this.FRows.length>0&&this.FieldDefsFromRows(this.FRows),pas.JSONDataset.TBaseJSONDataSet.InternalInitFieldDefs.call(this)},this.FieldDefsFromRows=function(t){var e=null,i=void 0,s=[],n=0;if(0===this.FFieldDefs.GetCount()&&null!=t&&t.length>0){e=t[0],s=Object.getOwnPropertyNames(e);for(var r=0,o=rtl.length(s)-1;r<=o;r++)i=e[s[n=r]],rtl.isString(i)&&this.FFieldDefs.Add$4(s[n],1,255),rtl.isNumber(i)&&this.FFieldDefs.Add$5(s[n],6),pas.JS.isBoolean(i)&&this.FFieldDefs.Add$5(s[n],5),pas.JS.isDate(i)&&this.FFieldDefs.Add$5(s[n],9),pas.JS.isNull(i)&&this.FFieldDefs.Add$4(s[n],1,255)}},this.DoAfterOpen=function(){pas.DB.TDataSet.DoAfterOpen.call(this),this.DoOpenResolve(!0),null!=this.FConnection&&this.FConnection.FAutoOpen&&this.FConnection.DoAfterConnect()},this.DoAfterPost=function(){pas.DB.TDataSet.DoAfterPost.call(this),this.DoPostResolve(!0)},this.DoAfterInsert=function(){pas.DB.TDataSet.DoAfterInsert.call(this),this.DoInsertResolve(!0)},this.DoAfterDelete=function(){pas.DB.TDataSet.DoAfterDelete.call(this),this.DoDeleteResolve(!0)},this.DoGetDataProxy=function(){return null!=this.FConnection?this.FConnection.GetDataProxy():null},this.SetActive=function(t){0 in this.FComponentState||pas.DB.TDataSet.SetActive.apply(this,arguments)},this.Create$1=function(t){return pas.JSONDataset.TBaseJSONDataSet.Create$1.apply(this,arguments),this.FParams=pas.DB.TParams.$create("Create$1",[pas.DB.TParam]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FParams},set:function(t){this.p.FParams=t}}),pas.JSONDataset.TBaseJSONDataSet.Destroy.call(this)},this.OpenAsync=function(){var t=this;return new Promise((function(e,i){t.FOpenResolver=e,t.Open()}))},this.PostAsync=function(){var t=this;return new Promise((function(e,i){t.FPostResolver=e,t.Post()}))},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.InitFieldDefs()},this.GetChildren=function(t,e){for(var i=0,s=0,n=this.FFieldList.GetCount()-1;s<=n;s++)i=s,this.FFieldList.GetField(i).FOwner!==e&&this.FFieldList.GetField(i).FDataSet!==e&&null!==e||(""===this.FFieldList.GetField(i).FName&&this.FFieldList.GetField(i).SetName(this.FName+this.FFieldList.GetField(i).FFieldName),t(this.FFieldList.GetField(i)))},this.EmptyDataSet=function(){for(this.First();!this.GetEOF();)this.Delete()},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TClientDataSet",this.TCustomClientDataSet,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",3,rtl.boolean,"GetActive","SetActive",{Default:!1}),e.addProperty("Connection",2,t.$rtti.TClientConnection,"FConnection","SetConnection"),e.addProperty("Params",2,pas.DB.$rtti.TParams,"FParams","SetParams"),e.addProperty("BeforeOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeOpen","FBeforeOpen"),e.addProperty("AfterOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterOpen","FAfterOpen"),e.addProperty("BeforeClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeClose","FBeforeClose"),e.addProperty("AfterClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterClose","FAfterClose"),e.addProperty("BeforeInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeInsert","FBeforeInsert"),e.addProperty("AfterInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterInsert","FAfterInsert"),e.addProperty("BeforeEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeEdit","FBeforeEdit"),e.addProperty("AfterEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterEdit","FAfterEdit"),e.addProperty("BeforePost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforePost","FBeforePost"),e.addProperty("AfterPost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterPost","FAfterPost"),e.addProperty("BeforeCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeCancel","FBeforeCancel"),e.addProperty("AfterCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterCancel","FAfterCancel"),e.addProperty("BeforeDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeDelete","FBeforeDelete"),e.addProperty("AfterDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterDelete","FAfterDelete"),e.addProperty("BeforeScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeScroll","FBeforeScroll"),e.addProperty("AfterScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterScroll","FAfterScroll"),e.addProperty("OnCalcFields",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnCalcFields","FOnCalcFields"),e.addProperty("OnDeleteError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnDeleteError","FOnDeleteError"),e.addProperty("OnEditError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnEditError","FOnEditError"),e.addProperty("OnFilterRecord",2,pas.DB.$rtti.TFilterRecordEvent,"FOnFilterRecord","SetOnFilterRecord"),e.addProperty("OnNewRecord",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnNewRecord","FOnNewRecord"),e.addProperty("OnPostError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnPostError","FOnPostError"),e.addProperty("OnUpdateRecord",0,t.$rtti.TUpdateRecordEvent,"FOnUpdateRecord","FOnUpdateRecord")})),t.$implcode=function(){rtl.createClass(e,"TWebClientDataRequest",pas.DB.TDataRequest,(function(){this.$init=function(){pas.DB.TDataRequest.$init.call(this),this.FXHR=null,this.FConnection=null},this.$final=function(){this.FXHR=void 0,this.FConnection=void 0,pas.DB.TDataRequest.$final.call(this)},this.onError=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onAbort=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onLoad=function(t){return 200===this.FXHR.status?(this.FData=this.TransformResult(),this.FSuccess=2):(this.FData=null,2 in this.FLoadOptions&&404===this.FXHR.status?this.FSuccess=1:(this.FSuccess=0,this.FErrorMsg=this.FXHR.statusText),null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status)),this.DoAfterRequest(),!0,!0},this.TransformResult=function(){var t=void 0,e="";return t=this.FXHR.response,null!=this.FConnection&&null!=this.FConnection.FOnDataReceived&&(e=this.FXHR.responseText,this.FConnection.DoDataReceived(this.FXHR,{get:function(){return e},set:function(t){e=t}})),null!=this.FConnection&&null!=this.FConnection.FOnGetDataPayLoad&&this.FConnection.FOnGetDataPayLoad(this.FConnection,this.FDataset,0,{get:function(){return t},set:function(e){t=e}}),t}})),rtl.createClass(e,"TWebClientUpdateRequest",pas.DB.TRecordUpdateDescriptor,(function(){}))}}),["SysUtils","Types","WEBLib.Dialogs"]),rtl.module("libindexeddb",["System","Types","Classes","JS","Web"],(function(){"use strict";rtl.createClass(this,"TMIDBTransactionMode",pas.System.TObject,(function(){this.readwrite="readwrite"})),rtl.recNewT(this,"TMIDBIndexParameters",(function(){this.unique=!1,this.$eq=function(t){return this.unique===t.unique},this.$assign=function(t){return this.unique=t.unique,this}})),rtl.recNewT(this,"TJSCreateObjectStoreOptions",(function(){this.keyPath=void 0,this.autoIncrement=!1,this.$eq=function(t){return this.keyPath===t.keyPath&&this.autoIncrement===t.autoIncrement},this.$assign=function(t){return this.keyPath=t.keyPath,this.autoIncrement=t.autoIncrement,this}}))})),rtl.module("WEBLib.IndexedDb",["System","Classes","JS","Web","SysUtils","WEBLib.CDS","JSONDataset","DB","libindexeddb"],(function(){"use strict";var t=this,e=t.$impl;this.TIndexedDbOpCode={0:"opOpen",opOpen:0,1:"opAdd",opAdd:1,2:"opPut",opPut:2,3:"opDelete",opDelete:3,4:"opGet",opGet:4,5:"opGetAllKeys",opGetAllKeys:5,6:"opGetAllObjs",opGetAllObjs:6,7:"opGetAllIndexKeys",opGetAllIndexKeys:7,8:"opGetAllObjsByIndex",opGetAllObjsByIndex:8},this.$rtti.$Enum("TIndexedDbOpCode",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TIndexedDbOpCode}),rtl.createClass(this,"TIndexedDb",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDb=null,this.FDatabaseName="",this.FObjectStoreName="",this.FKeyFieldName="",this.FAutoIncrement=!1,this.FIndexFields=null,this.FActiveIndex="",this.FIndexDescending=!1,this.FIsOpen=!1,this.FCreatedIndexes=!1,this.FAllResult=null,this.FOnResult=null},this.$final=function(){this.FDb=void 0,this.FIndexFields=void 0,this.FAllResult=void 0,this.FOnResult=void 0,pas.Classes.TComponent.$final.call(this)},this.ObjectStoreExists=function(){var t=!1,e=0;t=!1;for(var i=0,s=rtl.length(this.FDb.objectStoreNames);i<=s;i++)if(e=i,this.FDb.objectStoreNames[e]===this.FObjectStoreName){t=!0;break}return t},this.GetObjectStore=function(t){var e=null,i=0;if(e=null,null===t.transaction)return e;for(var s=0,n=rtl.length(this.FDb.objectStoreNames);s<=n;s++)if(i=s,this.FDb.objectStoreNames[i]===this.FObjectStoreName){e=t.transaction.objectStore(this.FObjectStoreName);break}return e},this.DoUpgradeNeeded=function(t){var e,i=0,s=pas.libindexeddb.TJSCreateObjectStoreOptions.$new(),n=null,r=pas.libindexeddb.TMIDBIndexParameters.$new(),o=null,a="",l=null;if(e=rtl.asExt(t.target,IDBOpenDBRequest),this.FDb=e.result,!(null!==(n=this.GetObjectStore(e)))&&(""!==this.FKeyFieldName?(s.keyPath=this.FKeyFieldName,s.autoIncrement=this.FAutoIncrement,n=this.FDb.createObjectStore(this.FObjectStoreName,pas.libindexeddb.TJSCreateObjectStoreOptions.$clone(s))):n=this.FDb.createObjectStore(this.FObjectStoreName),null!==this.FIndexFields))for(var h=0,u=this.FIndexFields.length-1;h<=u;h++)i=h,o=this.FIndexFields[i],r.unique=!(0==o.isUnique),1===(l=(a=""+o.keypath).split(";")).length?n.createIndex(""+o.name,a,pas.libindexeddb.TMIDBIndexParameters.$clone(r)):n.createIndex(""+o.name,l,pas.libindexeddb.TMIDBIndexParameters.$clone(r)),this.FCreatedIndexes=!0;return!0,!0},this.VersionChangeNeeded=function(){var t=!1;return t=!1,this.ObjectStoreExists()?t:t=!0},this.DoSuccess=function(t){var i,s=!1,n=null,r=null,o=0,a=null,l=null,h="",u="";n=rtl.asExt(t.target,IDBRequest),i=e.GetOpCode({get:function(){return n},set:function(t){n=t}});try{var d=i;if(0===d){if(this.FIsOpen=!0,this.FDb=rtl.asExt(n,IDBOpenDBRequest).result,this.FDb.onversionchange=rtl.createSafeCallback(this,"DoVersionChange"),this.VersionChangeNeeded())return o=this.FDb.version+1,this.FDb.close(),a=window.indexedDB.open(this.FDatabaseName,o),e.SetOpCode({get:function(){return a},set:function(t){a=t}},0),e.SetSeqId({get:function(){return a},set:function(t){a=t}},e.GetSeqId({get:function(){return n},set:function(t){n=t}})),a.onupgradeneeded=rtl.createSafeCallback(this,"DoUpgradeNeeded"),a.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),a.onerror=rtl.createSafeCallback(this,"DoFail"),a.onblocked=rtl.createSafeCallback(this,"DoBlocked"),s;this.FAutoIncrement=this.GetAutoIncrementDynamic(),!this.FCreatedIndexes&&null!==this.FIndexFields&&this.FIndexFields.length>0&&window.console.log("IndexedDB Warning: AddIndex commands ignored for existing database."),null!=this.FOnResult&&this.FOnResult(!0,i,0,e.GetSeqId({get:function(){return n},set:function(t){n=t}}),"","")}else 2===d||3===d?null!=this.FOnResult&&this.FOnResult(!0,i,e.GetKeyId({get:function(){return n},set:function(t){n=t}}),e.GetSeqId({get:function(){return n},set:function(t){n=t}}),"",""):4===d||1===d||5===d||6===d?null!=this.FOnResult&&this.FOnResult(!0,i,n.result,e.GetSeqId({get:function(){return n},set:function(t){n=t}}),"",""):7===d?null!==(r=n.result)?(this.FAllResult.push(r.key),r.continue()):null!=this.FOnResult&&this.FOnResult(!0,i,this.FAllResult,e.GetSeqId({get:function(){return n},set:function(t){n=t}}),"",""):8===d&&(null!==(r=n.result)?(this.FAllResult.push(r.value),r.continue()):null!=this.FOnResult&&this.FOnResult(!0,i,this.FAllResult,e.GetSeqId({get:function(){return n},set:function(t){n=t}}),"",""))}catch(t){if(l=t,!e.GetJSExceptionDetails(l,{get:function(){return h},set:function(t){h=t}},{get:function(){return u},set:function(t){u=t}}))throw l;u=e.FormatErrorMessage(i,h,u),null!=this.FOnResult&&this.FOnResult(!1,i,0,e.GetSeqId({get:function(){return n},set:function(t){n=t}}),h,u)}return s=!0},this.DoFail=function(t){var i,s,n,r=null;return r=rtl.asExt(t.target,IDBRequest),s=e.GetOpCode({get:function(){return r},set:function(t){r=t}}),n=r.error,i=e.FormatErrorMessage(s,""+n.name,""+n.message),window.console.log(i),null!=this.FOnResult&&this.FOnResult(!1,s,0,e.GetSeqId({get:function(){return r},set:function(t){r=t}}),""+n.name,i),!0,!0},this.DoVersionChange=function(t){return window.console.log("IndexedDB Warning: Version change detected for the CDS using objectstore "+this.FObjectStoreName+". If you are using multiple CDS components on the same Database, before making them Active, please call Init, wait for OnInitSuccess then call Init on next CDS and so on."),!0,!0},this.DoBlocked=function(t){return this.FOnResult(!1,0,0,0,"Error CDS Blocked","IndexedDB Error: CDS has been blocked that uses objectstore "+this.FObjectStoreName+". If you are using multiple CDS components on the same Database, before making them Active, please call Init, wait for OnInitSuccess then call Init on next CDS and so on."),!0,!0},this.GetAutoIncrementDynamic=function(){var t=!1;return t=!1,null===this.FDb?t:t=this.FDb.transaction([this.FObjectStoreName],pas.libindexeddb.TMIDBTransactionMode.readwrite).objectStore(this.FObjectStoreName).autoIncrement},this.CorrectPrimaryKey=function(t){this.FAutoIncrement&&pas.JS.JSDelete(t,this.FKeyFieldName)},this.SetIndexFields=function(t){this.FIndexFields=t},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FDb=null,this.FIsOpen=!1,this.FAllResult=new Array,this.FActiveIndex="",this.FIndexDescending=!1,this.FIndexFields=null,this.FCreatedIndexes=!1,this},this.Destroy=function(){this.FIsOpen&&this.FDb.close(),pas.Classes.TComponent.Destroy.call(this)},this.Open=function(t,i,s,n,r){var o=null;this.FDatabaseName=t,this.FObjectStoreName=i,this.FKeyFieldName=s,this.FAutoIncrement=n,o=window.indexedDB.open(t),e.SetOpCode({get:function(){return o},set:function(t){o=t}},0),e.SetSeqId({get:function(){return o},set:function(t){o=t}},r),o.onupgradeneeded=rtl.createSafeCallback(this,"DoUpgradeNeeded"),o.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),o.onerror=rtl.createSafeCallback(this,"DoFail"),o.onblocked=rtl.createSafeCallback(this,"DoBlocked")},this.PutData$1=function(t,i){var s=null,n=null;s=this.FDb.transaction([this.FObjectStoreName],pas.libindexeddb.TMIDBTransactionMode.readwrite).objectStore(this.FObjectStoreName),n=s.put(t),e.SetOpCode({get:function(){return n},set:function(t){n=t}},2),e.SetSeqId({get:function(){return n},set:function(t){n=t}},i),e.SetKeyId({get:function(){return n},set:function(t){n=t}},t[this.FKeyFieldName]),n.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),n.onerror=rtl.createSafeCallback(this,"DoFail")},this.AddData=function(t,i){var s=null,n=null;s=this.FDb.transaction([this.FObjectStoreName],pas.libindexeddb.TMIDBTransactionMode.readwrite).objectStore(this.FObjectStoreName),this.CorrectPrimaryKey(t),n=s.add(t),e.SetOpCode({get:function(){return n},set:function(t){n=t}},1),e.SetSeqId({get:function(){return n},set:function(t){n=t}},i),n.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),n.onerror=rtl.createSafeCallback(this,"DoFail")},this.DeleteData=function(t,i){var s=null,n=null;s=this.FDb.transaction([this.FObjectStoreName],pas.libindexeddb.TMIDBTransactionMode.readwrite).objectStore(this.FObjectStoreName),n=s.delete(t),e.SetOpCode({get:function(){return n},set:function(t){n=t}},3),e.SetSeqId({get:function(){return n},set:function(t){n=t}},i),e.SetKeyId({get:function(){return n},set:function(t){n=t}},t),n.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),n.onerror=rtl.createSafeCallback(this,"DoFail")},this.GetAllObjsByIndex=function(t){var i=null,s=null,n=null,r="";i=this.FDb.transaction([this.FObjectStoreName],pas.libindexeddb.TMIDBTransactionMode.readwrite).objectStore(this.FObjectStoreName),this.FAllResult.length=0,r="next",this.FIndexDescending&&(r="prev"),""===this.FActiveIndex?s=i.openCursor(null,r):(n=i.index(this.FActiveIndex),s=n.openCursor(null,r)),e.SetOpCode({get:function(){return s},set:function(t){s=t}},8),e.SetSeqId({get:function(){return s},set:function(t){s=t}},t),s.onsuccess=rtl.createSafeCallback(this,"DoSuccess"),s.onerror=rtl.createSafeCallback(this,"DoFail")},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TIndexedDbClientDataProxy",pas.DB.TDataProxy,(function(){this.$init=function(){pas.DB.TDataProxy.$init.call(this),this.FIdb=null,this.FDataRequest=null,this.FDataRequestEvent=null},this.$final=function(){this.FIdb=void 0,this.FDataRequest=void 0,this.FDataRequestEvent=void 0,pas.DB.TDataProxy.$final.call(this)},this.GetDataRequest=function(t,e,i){var s;return s=this.GetDataRequestClass().$create("Create$1",[this,rtl.refSet(t),e,i]),this.FDataRequest=s,this.FDataRequestEvent=e,s},this.DoGetData=function(e){var i=!1;if(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBDataLoaded)return e.FSuccess=1,e.FData=new Array,null!=this.FDataRequestEvent&&this.FDataRequestEvent(this.FDataRequest),i;if(null===this.FIdb){if(""===rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBDatabaseName||""===rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBObjectStoreName||""===rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBKeyFieldName)throw pas.SysUtils.Exception.$create("Create$1",["TIndexedDbClientData: DatabaseName, ObjectStoreName and KeyFieldName must be specified."]);if(!rtl.as(this.FOwner,t.TIndexedDbClientDataset).IsKeyFieldValid())throw pas.SysUtils.Exception.$create("Create$1",[pas.SysUtils.Format('TIndexedDbClientData Usage Error: The IDBKeyFieldName "%s" not found in field definitions.',pas.System.VarRecs(18,rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBKeyFieldName))]);!rtl.as(this.FOwner,t.TIndexedDbClientDataset).IsKeyFieldInteger()&&rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBAutoIncrement&&(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBAutoIncrement=!1,window.console.log("IndexedDB Warning: IDBAutoIncrement switched OFF as IDBKeyFieldName is not of type Integer.")),this.FIdb=t.TIndexedDb.$create("Create$1",[this]),this.FIdb.FOnResult=rtl.createCallback(this,"DoOnSuccess"),this.FIdb.SetIndexFields(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBIndexFields),this.FIdb.Open(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBDatabaseName,rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBObjectStoreName,rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBKeyFieldName,rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBAutoIncrement,0),this.FIdb.FActiveIndex=rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBActiveIndex,this.FIdb.FIndexDescending=rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBIndexDescending}else window.console.log("IndexedDB: Internal error, DoGetData entry with these conditions not possible.");return i=!0},this.DoOnError=function(t,i,s){0!==t&&8!==t||null==this.FDataRequestEvent||(this.FDataRequest.FSuccess=0,this.FDataRequest.FErrorMsg=e.FormatErrorMessage(t,i,s),this.FDataRequestEvent(this.FDataRequest)),this.FOwner.DoOnError(t,i,s)},this.DoOnSuccess=function(i,s,n,r,o,a){var l=null,h=pas.DB.TBookmark.$new(),u=null,d="",F="",c=t.TKeyId.$clone({value:0});l=this.FOwner;try{var p=s;if(0===p){if(!i)return void this.DoOnError(s,o,a);rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBAutoIncrement!==this.FIdb.FAutoIncrement&&(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBAutoIncrement=this.FIdb.FAutoIncrement,this.FIdb.FAutoIncrement?window.console.log("IndexedDB Warning: AutoIncrement setting of ClientDataSet switched ON to match that of the existing database."):window.console.log("IndexedDB Warning: AutoIncrement setting of ClientDataSet switched OFF to match that of the existing database.")),this.FIdb.FOnResult=rtl.createCallback(this,"DoOnSuccess"),this.FIdb.GetAllObjsByIndex(0)}else if(8===p){if(!i)return void this.DoOnError(s,o,a);null!=this.FDataRequest&&null!=this.FDataRequest.FDataset&&(this.FDataRequest.FSuccess=1,this.FDataRequest.FData=n,l.GetActive()&&l.Close(),rtl.isArray(n)&&l.SetRows(pas.JS.toArray(n)),l.FIDBDataLoaded=!0,null!=this.FDataRequestEvent&&this.FDataRequestEvent(this.FDataRequest))}else if(2===p||3===p){if(l.UpdateEnds(),!i)return void(null==l.FONIDBAfterUpdate?this.DoOnError(s,o,a):l.FONIDBAfterUpdate(!1,s,t.TKeyId.$clone(c),o,a));null!=l.FONIDBAfterUpdate&&(c.value=n,l.FONIDBAfterUpdate(!0,s,t.TKeyId.$clone(c),"",""))}else if(1===p){if(l.UpdateEnds(),!i)return void(null==l.FONIDBAfterUpdate?this.DoOnError(s,o,a):l.FONIDBAfterUpdate(!1,s,t.TKeyId.$clone(c),o,a));if(i&&this.FIdb.FAutoIncrement){l=this.FOwner,h.Flag=0,h.Data=r,l.GotoBookmark(h),l.Edit(),l.FieldByName(rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBKeyFieldName).SetAsInteger(rtl.trunc(n)),l.FInsertIdUpdated=!0;try{l.Post()}finally{l.FInsertIdUpdated=!1}}null!=l.FONIDBAfterUpdate&&(c.value=n,l.FONIDBAfterUpdate(!0,s,t.TKeyId.$clone(c),"",""))}}catch(t){if(u=t,!e.GetJSExceptionDetails(u,{get:function(){return d},set:function(t){d=t}},{get:function(){return F},set:function(t){F=t}}))throw u;F=e.FormatErrorMessage(s,d,F),this.DoOnError(s,d,F)}},this.ProcessUpdate=function(i){var s=null,n=pas.DB.TBookmark.$new(),r=null,o=0,a=null,l="",h="";r=this.FOwner;try{0===i.FStatus&&(o=2,this.FIdb.FOnResult=rtl.createCallback(this,"DoOnSuccess"),r.UpdateStarts(),this.FIdb.PutData$1(i.FData,0)),1===i.FStatus&&(o=1,this.FIdb.FOnResult=rtl.createCallback(this,"DoOnSuccess"),s=i.FData,n.$assign(r.GetBookmark()),0!==n.Flag&&window.console.log("IndexedDB: Internal Warning, bookmark flag on insert not current as expected."),r.UpdateStarts(),this.FIdb.AddData(i.FData,n.Data)),2===i.FStatus&&(o=3,s=i.FData,this.FIdb.FOnResult=rtl.createCallback(this,"DoOnSuccess"),r.UpdateStarts(),this.FIdb.DeleteData(s[rtl.as(this.FOwner,t.TIndexedDbClientDataset).FIDBKeyFieldName],0))}catch(t){if(a=t,!e.GetJSExceptionDetails(a,{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}))throw a;h=e.FormatErrorMessage(o,l,h),this.DoOnError(o,l,h)}},this.Close=function(){null!==this.FIdb&&rtl.free(this,"FIdb"),this.FIdb=null},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FDataRequest=null,this.FDataRequestEvent=null,this.FIdb=null,this},this.Destroy=function(){null!==this.FIdb&&rtl.free(this,"FIdb"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),this.$rtti.$MethodVar("TIDBErrorEvent",{procsig:rtl.newTIProcSig([["DataSet",pas.DB.$rtti.TDataSet],["opCode",this.$rtti.TIndexedDbOpCode],["errorName",rtl.string],["errorMsg",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TIDBInitSuccessEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),rtl.recNewT(this,"TKeyId",(function(){this.value=void 0,this.$eq=function(t){return this.value===t.value},this.$assign=function(t){return this.value=t.value,this},t.$rtti.$Record("TKeyId",{}).addField("value",rtl.jsvalue)})),this.$rtti.$MethodVar("TIDBAfterUpdateEvent",{procsig:rtl.newTIProcSig([["success",rtl.boolean],["opCode",this.$rtti.TIndexedDbOpCode],["keyId",this.$rtti.TKeyId],["errorName",rtl.string],["errorMsg",rtl.string]]),methodkind:0}),rtl.createClass(this,"TIndexedDbClientDataset",pas["WEBLib.CDS"].TClientDataSet,(function(){this.$init=function(){pas["WEBLib.CDS"].TClientDataSet.$init.call(this),this.FIDBProxy=null,this.FIDBDatabaseName="",this.FIDBObjectStoreName="",this.FIDBKeyFieldName="",this.FIDBActiveIndex="",this.FIDBIndexDescending=!1,this.FIDBIndexFields=null,this.FIDBAutoIncrement=!1,this.FIDBDataLoaded=!1,this.FOpenAfterLoadDFM=!1,this.FRemKeyPos=void 0,this.FOnIDBError=null,this.FONIDBAfterUpdate=null,this.FOnInitSuccess=null,this.FIdbInit=null,this.FInsertIdUpdated=!1,this.FUpdateCount$1=0,this.FRefreshPending=!1},this.$final=function(){this.FIDBProxy=void 0,this.FIDBIndexFields=void 0,this.FOnIDBError=void 0,this.FONIDBAfterUpdate=void 0,this.FOnInitSuccess=void 0,this.FIdbInit=void 0,pas["WEBLib.CDS"].TClientDataSet.$final.call(this)},this.InternalClose=function(){pas.JSONDataset.TBaseJSONDataSet.InternalClose.call(this),this.FIDBProxy.Close(),this.FIDBDataLoaded=!1,this.FOpenAfterLoadDFM=!1},this.AddToChangeList=function(t){var e;return e=this.FIDBProxy.GetUpdateDescriptor(this,pas.DB.TBookmark.$clone(this.GetBookmark()),this.ActiveBuffer().data,t),this.FInsertIdUpdated&&0===e.FStatus||this.FIDBProxy.ProcessUpdate(e),null,null},this.SetActive=function(t){if(0!==this.FFieldDefs.GetCount()||!t||0!==this.FState||this.FIDBDataLoaded||this.FOpenAfterLoadDFM)return t&&0===this.FState&&!this.FIDBDataLoaded?(this.FOpenAfterLoadDFM=!1,void this.Load(rtl.createSet(1),null)):void pas["WEBLib.CDS"].TCustomClientDataSet.SetActive.apply(this,arguments);this.FOpenAfterLoadDFM=!0},this.AfterLoadDFMValues=function(){if(pas["WEBLib.CDS"].TCustomClientDataSet.AfterLoadDFMValues.call(this),this.FOpenAfterLoadDFM){if(0===this.FFieldDefs.GetCount())throw pas.SysUtils.Exception.$create("Create$1",["TIndexedDbClientData Usage Error: Can not Set Active, Field definitions missing."]);this.SetActive(!0)}},this.DoAfterOpen=function(){pas["WEBLib.CDS"].TCustomClientDataSet.DoAfterOpen.call(this),null!=this.FRemKeyPos&&(this.Locate(this.FIDBKeyFieldName,this.FRemKeyPos,{}),this.FRemKeyPos=null)},this.DoOnError=function(t,e,i){if(window.console.log(i),null==this.FOnIDBError)throw pas.SysUtils.Exception.$create("Create$1",[i]);this.FOnIDBError(this,t,e,i)},this.UpdateStarts=function(){this.FUpdateCount$1+=1},this.UpdateEnds=function(){0===this.FUpdateCount$1?window.console.log("IndexedDB Internal Warning: Update count is already zero in UpdateEnds"):this.FUpdateCount$1-=1,this.FRefreshPending&&0===this.FUpdateCount$1&&this.Refresh$2()},this.FixKeyFieldCase=function(){for(var t=0,e=0,i=this.FFieldDefs.GetCount()-1;e<=i;e++)if(t=e,pas.SysUtils.SameText(this.FFieldDefs.GetItem$1(t).FName,this.FIDBKeyFieldName)){this.FIDBKeyFieldName=this.FFieldDefs.GetItem$1(t).FName;break}},this.IsKeyFieldValid=function(){return this.FixKeyFieldCase(),null!==this.FFieldDefs.Find(this.FIDBKeyFieldName)},this.IsKeyFieldInteger=function(){var t;return null!==(t=this.FFieldDefs.Find(this.FIDBKeyFieldName))&&3===t.FDataType},this.Create$1=function(e){return pas["WEBLib.CDS"].TCustomClientDataSet.Create$1.apply(this,arguments),this.FIDBDatabaseName="",this.FIDBObjectStoreName="",this.FIDBKeyFieldName="",this.FIDBActiveIndex="",this.FIDBIndexDescending=!1,this.FIDBAutoIncrement=!1,this.FIDBDataLoaded=!1,this.FOpenAfterLoadDFM=!1,this.FRemKeyPos=null,this.FIDBProxy=null,this.FIDBIndexFields=null,this.FIDBProxy=t.TIndexedDbClientDataProxy.$create("Create$1",[this]),this.SetDataProxy(this.FIDBProxy),this.FInsertIdUpdated=!1,this.FUpdateCount$1=0,this.FRefreshPending=!1,this},this.Destroy=function(){this.GetActive()&&this.Close(),null!==this.FIDBProxy&&rtl.free(this,"FIDBProxy"),null!==this.FIdbInit&&rtl.free(this,"FIdbInit"),pas["WEBLib.CDS"].TCustomClientDataSet.Destroy.call(this)},this.Refresh$2=function(){this.FUpdateCount$1>0?this.FRefreshPending=!0:(this.FRefreshPending=!1,this.FCurrentRecord>-1&&(this.FRemKeyPos=this.FieldByName(this.FIDBKeyFieldName).GetAsJSValue()),this.Close(),this.Load(rtl.createSet(1),null))},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),e.addProperty("Active",3,rtl.boolean,"GetActive","SetActive",{Default:!1}),e.addProperty("IDBDatabaseName",0,rtl.string,"FIDBDatabaseName","FIDBDatabaseName"),e.addProperty("IDBObjectStoreName",0,rtl.string,"FIDBObjectStoreName","FIDBObjectStoreName"),e.addProperty("IDBKeyFieldName",0,rtl.string,"FIDBKeyFieldName","FIDBKeyFieldName"),e.addProperty("IDBAutoIncrement",0,rtl.boolean,"FIDBAutoIncrement","FIDBAutoIncrement"),e.addProperty("OnIDBError",0,t.$rtti.TIDBErrorEvent,"FOnIDBError","FOnIDBError"),e.addProperty("ONIDBAfterUpdate",0,t.$rtti.TIDBAfterUpdateEvent,"FONIDBAfterUpdate","FONIDBAfterUpdate"),e.addProperty("OnInitSuccess",0,t.$rtti.TIDBInitSuccessEvent,"FOnInitSuccess","FOnInitSuccess")})),t.$implcode=function(){e.SetOpCode=function(t,e){t.get().op=e},e.GetOpCode=function(t){return t.get().op},e.SetSeqId=function(t,e){t.get().seqId=e},e.GetSeqId=function(t){return t.get().seqId},e.SetKeyId=function(t,e){t.get().keyId=e},e.GetKeyId=function(t){return t.get().keyId},e.GetJSExceptionDetails=function(t,e,i){var s,n=!1;return n=!1,pas.SysUtils.Exception.isPrototypeOf(t)||(n=!0,s=t,pas.JS.isUndefined(s.name)?e.set("UnknownError"):e.set(s.name),pas.JS.isUndefined(s.message)?i.set("Unknown Error"):i.set(s.message)),n},e.FormatErrorMessage=function(t,e,i){var s="";return s=0===t?"(Open) ":1===t?"(Add) ":2===t?"(Put) ":3===t?"(Delete) ":4===t?"(Get) ":5===t?"(GetAllKeys) ":6===t?"(GetAllObjs) ":7===t?"(GetAllIndexKeys) ":8===t?"(GetAllObjsByIndex) ":"(Unknown) ",pas.SysUtils.Format("IndexedDB Error %s: %s, %s",pas.System.VarRecs(18,s,18,e,18,i))}}}),[]),rtl.module("StrUtils",["System","SysUtils","Types"],(function(){"use strict";var t=this,e=t.$impl;this.AnsiReplaceStr=function(t,e,i){return pas.SysUtils.StringReplace(t,e,i,rtl.createSet(0))},this.IfThen=function(t,e,i){return t?e:i},this.LeftStr=function(t,e){return pas.System.Copy(t,1,e)},this.RightStr=function(t,e){var i,s=0;return(s=e)>(i=t.length)&&(s=i),pas.System.Copy(t,i-s+1,s)},this.ReplaceStr=function(e,i,s){return t.AnsiReplaceStr(e,i,s)},this.Soundex=function(t,i){var s="",n="\0",r="\0",o=0,a=0;if(s="",r="\0",t.length>0)for(s=pas.System.upcase(t.charAt(0)),o=2,a=t.length;o<=a&&s.length<i;)(n=e.SScore.charAt(t.charCodeAt(o-1)-1)).charCodeAt()in rtl.createSet(48,105,r.charCodeAt())||(s+=n),"i"!==n&&(r=n),o+=1;return(a=s.length)<i&&(s+=pas.System.StringOfChar("0",i-a)),s},this.SoundexSimilar=function(e,i,s){return t.Soundex(e,s)===t.Soundex(i,s)},this.SoundexSimilar$1=function(e,i){return t.SoundexSimilar(e,i,4)},this.SoundexProc=function(e,i){return t.SoundexSimilar$1(e,i)},this.AnsiResemblesProc=null,this.ResemblesProc=null,t.$implcode=function(){e.SScore="00000000000000000000000000000000000000000000000000000000000000000123012i02245501262301i2i20000000123012i02245501262301i2i20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},t.$init=function(){t.AnsiResemblesProc=t.SoundexProc,t.ResemblesProc=t.SoundexProc}}),["JS"]),rtl.module("WEBLib.Mask",["System","Classes","SysUtils","StrUtils","WEBLib.Controls","WEBLib.StdCtrls","Web"],(function(){"use strict";var t=this,e=t.$impl;this.TMaskedState$a={0:"mStateMasked",mStateMasked:0,1:"mStateReEnter",mStateReEnter:1,2:"mStateDBSetText",mStateDBSetText:2},this.$rtti.$inherited("TEditMask",rtl.string,{}),rtl.createClass(this,"TCustomMaskEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TEdit.$init.call(this),this.FEditMask="",this.FMaskBlank="\0",this.FMaxChars=0,this.FMaskState={},this.FCaretPos=0,this.FEditText=""},this.$final=function(){this.FMaskState=void 0,pas["WEBLib.StdCtrls"].TEdit.$final.call(this)},this.GetEditText=function(){return this.RemoveEditFormat(this.GetText())},this.SetEditText=function(t){this.FEditText=this.AddEditFormat(t,!0),this.SetText(this.FEditText)},this.AddEditFormat=function(t,i){return i?e.FormatMaskedText(this.FEditMask,t,this.FMaskBlank):e.FormatMaskedText(this.FEditMask,t," ")},this.RemoveEditFormat=function(t){var i="",s=0,n=0,r=0,o=0,a=0;r=1,i=t;for(var l=1,h=this.FEditMask.length;l<=h;l++)o=l,(a=e.GetMaskCharType(this.FEditMask,o))in rtl.createSet(1,2)&&(i=pas.System.Copy(i,1,r-1)+pas.System.Copy(i,r+1,i.length-r)),a in rtl.createSet(4,5)&&(r+=1);if(0 in rtl.refSet(e.GetMaskInstructions(this.FEditMask,1))){r=1;for(var u=1,d=i.length;u<=d&&(s=u,i.charAt(s-1)===this.FMaskBlank);u++)r+=1;1!==r&&(i=pas.System.Copy(i,r,i.length-r+1))}else for(var F=1,c=n=i.length;F<=c&&(s=F,i.charAt(n-s+1-1)===this.FMaskBlank);F++)i=rtl.strSetLength(i,i.length-1);if(" "!==this.FMaskBlank)for(var p=1,C=n=i.length;p<=C&&(s=p,i.charAt(s-1)===this.FMaskBlank&&(i=rtl.setCharAt(i,s-1," ")),!(s>n));p++);return i},this.ArrowKeys=function(t,e){var i=0,s=0;2 in e||(this.GetSel({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0 in e?39===t?(this.FCaretPos+=1,s===i+1&&(this.SetSel(i,s),this.FCaretPos+=1),this.FCaretPos>this.FMaxChars&&(this.FCaretPos=this.FMaxChars)):(this.FCaretPos-=1,s===i+2&&this.FCaretPos>i&&(this.SetSel(i+1,i+1),this.FCaretPos-=1),this.FCaretPos<0&&(this.FCaretPos=0)):s-i>1?(s===this.FCaretPos&&(this.FCaretPos-=1),this.SetCursor(this.FCaretPos)):37===t?this.CursorDec(i):s===i?this.SetCursor(i):this.CursorInc(i,1))},this.CursorInc=function(t,i){var s=0;t<this.GetText().length&&(s=t+i,s=this.GetNextEditChar(s),e.IsLiteralChar(this.FEditMask,s)&&(s=t),this.SetCursor(s))},this.CursorDec=function(t){var e=0,i=0;return e=0,t>0&&(i=t,i-=1,i=this.GetPriorEditChar(i),this.SetCursor(i),e=i),e},this.DeleteKeys=function(t){var e,i=0,s=0,n="";this.GetSel({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s-i<1||(n=this.GetText(),e=this.GetText(),this.DeleteSelection({get:function(){return n},set:function(t){n=t}},i,s-i),n=pas.System.Copy(n,i+1,s-i),n=pas.System.Copy(e,1,i)+n+pas.System.Copy(e,s+1,e.length),this.SetText(n),this.SetCursor(i),this.Change())},this.DeleteSelection=function(t,i,s){var n,r,o=0,a=0,l=0;if(!0,0===s)return!0;if(n=(o=i+1)+s,(r=e.OffsetToMaskOffset(this.FEditMask,i))<0)return!0;for(var h=r,u=this.FEditMask.length;h<=u&&(a=h,(l=e.GetMaskCharType(this.FEditMask,a))in rtl.createSet(1,2)?o+=1:l in rtl.createSet(4,5)&&(t.set(rtl.setCharAt(t.get(),o-1,this.FMaskBlank)),o+=1),!(o>=n));h++);return!0},this.HomeEndKeys=function(t,e){var i=0,s=0;this.GetSel({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),36===t?(0 in e?(i!==this.FCaretPos&&s!==i+1&&(s=i+1),this.SetSel(0,s),this.CheckCursor()):this.SetCursor(0),this.FCaretPos=0):(0 in e?(s!==this.FCaretPos&&s!==i+1&&(i=s-1),this.SetSel(i,this.FMaxChars),this.CheckCursor()):this.SetCursor(this.FMaxChars-1),this.FCaretPos=this.FMaxChars)},this.CharKeys=function(t){var e,i=0,s=0,n="";return!1,this.GetSel({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s-i>1&&(this.DeleteKeys(46),i=this.GetNextEditChar(i),this.SetCursor(i)),(e=this.InputChar(t,i))&&(n=t.get(),this.SetText(pas.System.Copy(this.GetText(),1,i)+n+pas.System.Copy(this.GetText(),s+1,this.GetText().length)),this.CursorInc(i,1)),e},this.InputChar=function(t,i){var s=!1,n=0,r=0,o="\0";return s=!0,""!==this.FEditMask&&(s=!1,i<this.FMaxChars&&(n=e.OffsetToMaskOffset(this.FEditMask,i))>=0&&(r=e.GetMaskCharType(this.FEditMask,n),o=t.get(),!(s=this.DoInputChar(t,n))&&r in rtl.createSet(4,5)&&(n=this.FindLiteralChar(n,o))>0))?(n=e.MaskOffsetToOffset(this.FEditMask,n),this.SetCursor(n),s):(s||"\r"===t.get()||""===t.get()?this.Change():pas["WEBLib.WebTools"].MessageBeep(0),s)},this.DoInputChar=function(t,i){var s=!1,n={},r="";if(s=!0,e.GetMaskCharType(this.FEditMask,i)in rtl.createSet(1,2))t.set(e.GetFormatSettingsChar(this.FEditMask.charAt(i-1)));else{n=rtl.refSet(e.GetMaskInstructions(this.FEditMask,i));var o=this.FEditMask.charAt(i-1);o===e.cMaskNumeric||o===e.cMaskNumericOpt?t.get()>="0"&&t.get()<="9"||(s=!1):o===e.cMaskNumSymOpt?t.get()>="0"&&t.get()<="9"||" "===t.get()||"+"===t.get()||"-"===t.get()||(s=!1):o===e.cMaskAscii||o===e.cMaskAsciiOpt?e.IsCharAlpha(t.get())&&(r=" ",r=rtl.setCharAt(r,0,t.get()),1 in n?r=pas.SysUtils.UpperCase(r):2 in n&&(r=pas.SysUtils.LowerCase(r)),t.set(r.charAt(0))):o!==e.cMaskAlpha&&o!==e.cMaskAlphaOpt&&o!==e.cMaskAlphaNum&&o!==e.cMaskAlphaNumOpt||(r=" ",r=rtl.setCharAt(r,0,t.get()),e.IsCharAlpha(t.get())?1 in n?r=pas.SysUtils.UpperCase(r):2 in n&&(r=pas.SysUtils.LowerCase(r)):(s=!1,this.FEditMask.charAt(i-1)!==e.cMaskAlphaNum&&this.FEditMask.charAt(i-1)!==e.cMaskAlphaNumOpt||!e.IsCharAlphaNumeric(t.get())||(s=!0)),t.set(r.charAt(0)))}return s},this.FindLiteralChar=function(t,i){var s=0,n=0,r="\0";for(s=-1;t<this.FEditMask.length;)if(t+=1,(n=e.GetMaskCharType(this.FEditMask,t))in rtl.createSet(1,2))return r=this.FEditMask.charAt(t-1),2===n&&(r=e.GetFormatSettingsChar(r)),r===i&&(s=t),s;return s},this.SetEditMask=function(t){var e=0,i=0;t!==this.FEditMask&&(4 in this.FComponentState&&""!==t&&!(0 in this.FComponentState)&&this.SetEditText(""),this.HandleAllocated()&&this.GetSel({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.ReformatText(t),this.FMaskState=rtl.excludeSet(this.FMaskState,0),""!==this.FEditMask&&(this.FMaskState=rtl.includeSet(this.FMaskState,0)),this.SetMaxLength(0),this.GetMasked()&&this.FMaxChars>0&&this.SetMaxLength(this.FMaxChars),this.HandleAllocated()&&this.Focused()&&!(4 in this.FComponentState)&&this.SetCursor(e))},this.GetMasked=function(){return""!==this.FEditMask},this.EditCanModify=function(){return!this.FReadOnly},this.ReformatText=function(t){var i;i=this.RemoveEditFormat(this.GetEditText()),this.FEditMask=t,this.FMaxChars=e.MaskOffsetToOffset(this.FEditMask,t.length),this.FMaskBlank=e.GetMaskBlank(t),this.SetEditText(i)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.call(this,t,rtl.refSet(e)),t.get()in rtl.createSet(37,39,36,35)&&(this.PreventDefault(),this.StopPropagation()),this.GetMasked()&&0!==t.get()&&!(1 in e)){if(t.get()in rtl.createSet(37,39,36,35)||this.GetSelLength()>1&&(this.SetSelStart(0),this.SetSelLength(1)),37===t.get()||39===t.get())return this.ArrowKeys(t.get(),rtl.refSet(e)),void(0 in e||2 in e||t.set(0));if(38===t.get()||40===t.get())return void t.set(0);if(36===t.get()||35===t.get())return this.HomeEndKeys(t.get(),rtl.refSet(e)),void t.set(0);if(46===t.get()&&!(0 in e)||8===t.get())return this.EditCanModify()&&this.DeleteKeys(t.get()),void(8!==t.get()&&(t.set(0),this.PreventDefault(),this.StopPropagation()));this.CheckCursor()}},this.KeyUp=function(t,e){pas["WEBLib.Controls"].TControl.KeyUp.call(this,t,rtl.refSet(e)),this.GetMasked()&&0!==t.get()&&(37!==t.get()&&39!==t.get()||!(2 in e)||this.CheckCursor())},this.KeyPress=function(t){pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.call(this,t),this.GetMasked()&&"\0"!==t.get()&&!pas.SysUtils.CharInSet(t.get(),["","","","\b"])&&(this.CharKeys(t),t.set("\0"),this.PreventDefault(),this.StopPropagation())},this.MouseUp=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseUp.apply(this,arguments)},this.CheckCursor=function(){var t=0,e=0;this.HandleAllocated()&&this.GetMasked()&&(this.GetSel({get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),t===e&&this.SetCursor(t))},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.DoEnter=function(){pas["WEBLib.StdCtrls"].TCustomEdit.DoEnter.call(this),this.SetSelStart(0),this.SetSelLength(1)},this.InitCSSLibrary=function(t){1===t&&(this.SetElementClassName("form-control"),this.SetElementFont(1),this.SetHeightStyle(2))},this.CreateInitialize=function(){pas["WEBLib.StdCtrls"].TCustomEdit.CreateInitialize.call(this),this.SetHeight(25)},this.GetSel=function(t,e){t.set(this.GetSelStart()),e.set(this.GetSelStart()+this.GetSelLength())},this.SetSel=function(t,e){this.SetSelStart(t),this.SetSelLength(Math.max(1,e-t))},this.SetCursor=function(t){this.SetSel(t,t+1)},this.GetNextEditChar=function(t){var i=0;for(i=t;i<this.FMaxChars&&e.IsLiteralChar(this.FEditMask,i);)i+=1;return i},this.GetPriorEditChar=function(t){var i=0;for(i=t;i>=0&&e.IsLiteralChar(this.FEditMask,i);)i-=1;return i<0&&(i=this.GetNextEditChar(i)),i},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TMaskEdit",this.TCustomMaskEdit,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("EditMask",2,t.$rtti.TEditMask,"FEditMask","SetEditMask"),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute})})),rtl.createClass(this,"TWebMaskEdit",this.TMaskEdit,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){e.TMaskCharType={0:"mcNone",mcNone:0,1:"mcLiteral",mcLiteral:1,2:"mcIntlLiteral",mcIntlLiteral:2,3:"mcDirective",mcDirective:3,4:"mcMask",mcMask:4,5:"mcMaskOpt",mcMaskOpt:5,6:"mcFieldSeparator",mcFieldSeparator:6,7:"mcField",mcField:7},e.TMaskInstructions$a={0:"miReverseDir",miReverseDir:0,1:"miUpperCase",miUpperCase:1,2:"miLowerCase",miLowerCase:2,3:"miLiteralChar",miLiteralChar:3},e.dMaskReverse="!",e.dMaskUpperCase=">",e.dMaskLowerCase="<",e.dMaskLiteral="\\",e.cMaskAlpha="L",e.cMaskAlphaOpt="l",e.cMaskAlphaNum="A",e.cMaskAlphaNumOpt="a",e.cMaskAscii="C",e.cMaskAsciiOpt="c",e.cMaskNumeric="0",e.cMaskNumericOpt="9",e.cMaskNumSymOpt="#",e.cMaskTimeSeparator=":",e.cMaskDateSeparator="/",e.mskSeparator=";",e.mskBlank="_",e.IsCharAlpha=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"},e.IsCharAlphaNumeric=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"},e.GetMaskCharType=function(t,i){var s=0,n="\0";return s=1,n="\0",i<=t.length&&(n=t.charAt(i-1)),i>t.length?s=0:i>1&&t.charAt(i-1-1)===e.dMaskLiteral&&!(i>2&&t.charAt(i-2-1)===e.dMaskLiteral)?s=1:n===e.mskSeparator&&t.length>=4&&i>t.length-4?s=6:t.length>=4&&i>t.length-4&&t.charAt(i-1-1)===e.mskSeparator&&!(i>2&&t.charAt(i-2-1)===e.dMaskLiteral)?s=7:n.charCodeAt()in rtl.createSet(e.cMaskTimeSeparator.charCodeAt(),e.cMaskDateSeparator.charCodeAt())?s=2:n.charCodeAt()in rtl.createSet(e.dMaskReverse.charCodeAt(),e.dMaskUpperCase.charCodeAt(),e.dMaskLowerCase.charCodeAt(),e.dMaskLiteral.charCodeAt())?s=3:n.charCodeAt()in rtl.createSet(e.cMaskAlphaOpt.charCodeAt(),e.cMaskAlphaNumOpt.charCodeAt(),e.cMaskAsciiOpt.charCodeAt(),e.cMaskNumSymOpt.charCodeAt(),e.cMaskNumericOpt.charCodeAt())?s=5:n.charCodeAt()in rtl.createSet(e.cMaskAlpha.charCodeAt(),e.cMaskAlphaNum.charCodeAt(),e.cMaskAscii.charCodeAt(),e.cMaskNumeric.charCodeAt())&&(s=4),s},e.GetMaskInstructions=function(t,i){var s={},n=0,r="\0";s={};for(var o=0,a=t.length-1;o<=a;o++)n=o,(r=t.charAt(n+1-1))===e.dMaskReverse?s=rtl.unionSet(s,rtl.createSet(0)):r===e.dMaskLowerCase&&n<i-1?s=rtl.unionSet(rtl.diffSet(s,rtl.createSet(1)),rtl.createSet(2)):r===e.dMaskUpperCase&&n<i-1&&(s=rtl.diffSet(s,rtl.createSet(2)),n>0&&t.charAt(n-1)===e.dMaskLowerCase||(s=rtl.unionSet(s,rtl.createSet(1))));return 1===e.GetMaskCharType(t,i)&&(s=rtl.unionSet(s,rtl.createSet(3))),s},e.GetFormatSettingsChar=function(t){var i="\0";i=t;var s=t;return s===e.cMaskTimeSeparator?i=pas.SysUtils.FormatSettings.TimeSeparator:s===e.cMaskDateSeparator&&(i=pas.SysUtils.FormatSettings.DateSeparator),i},e.MaskOffsetToString=function(t,i){var s="",n=0;s="";for(var r=1,o=i;r<=o;r++)n=r,e.GetMaskCharType(t,n)in rtl.createSet(3,7,6)||(s+=t.charAt(n-1));return s},e.MaskOffsetToOffset=function(t,i){return e.MaskOffsetToString(t,i).length},e.OffsetToMaskOffset=function(t,i){var s=0,n=0,r=0;if(i>e.MaskOffsetToOffset(t,t.length))return s=-1;s=0,r=i;for(var o=1,a=t.length;o<=a;o++)if(n=o,s+=1,3!==e.GetMaskCharType(t,n)&&(r-=1)<0)return s;return s},e.FormatMaskedText=function(t,i,s){var n="",r=0,o=0,a=0,l=0;if(n=i,0 in rtl.refSet(e.GetMaskInstructions(t,1))){o=n.length;for(var h=0,u=t.length-1;h<=u;h++)r=h,a=t.length-r,(l=e.GetMaskCharType(t,a))in rtl.createSet(1,2)?n=pas.System.Copy(n,1,o)+e.GetFormatSettingsChar(t.charAt(a-1))+pas.System.Copy(n,o+1,n.length-o):l in rtl.createSet(4,5)&&(o<1?n=s+n:o-=1)}else{o=1;for(var d=1,F=t.length;d<=F;d++)a=d,(l=e.GetMaskCharType(t,a))in rtl.createSet(1,2)?(n=pas.System.Copy(n,1,o-1)+e.GetFormatSettingsChar(t.charAt(a-1))+pas.System.Copy(n,o,n.length-o+1),o+=1):l in rtl.createSet(4,5)&&(o>n.length&&(n+=s),o+=1)}return n},e.IsLiteralChar=function(t,i){var s,n=!1;return n=!1,(s=e.OffsetToMaskOffset(t,i))>=0&&(n=e.GetMaskCharType(t,s)in rtl.createSet(1,2)),n},e.GetMaskBlank=function(t){var i="\0";return i=e.mskBlank,t.length>=4&&6===e.GetMaskCharType(t,t.length-1)&&(6!==e.GetMaskCharType(t,t.length-2)&&6!==e.GetMaskCharType(t,t.length-3)||(i=t.charAt(t.length-1))),i}}}),["Math","WEBLib.WebTools"]),rtl.module("WEBLib.Grids",["System","Classes","JS","WEBLib.Controls","WEBLib.Graphics","Web","DB","WEBLib.Menus","WEBLib.StdCtrls","WEBLib.Mask","Types"],(function(){"use strict";var t=this,e=t.$impl;rtl.recNewT(this,"TGridRect",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this}})),rtl.recNewT(this,"TGridCoord",(function(){this.X=0,this.Y=0,this.$eq=function(t){return this.X===t.X&&this.Y===t.Y},this.$assign=function(t){return this.X=t.X,this.Y=t.Y,this}})),this.TGridOption={0:"goFixedVertLine",goFixedVertLine:0,1:"goFixedHorzLine",goFixedHorzLine:1,2:"goVertLine",goVertLine:2,3:"goHorzLine",goHorzLine:3,4:"goRangeSelect",goRangeSelect:4,5:"goDrawFocusSelected",goDrawFocusSelected:5,6:"goRowSizing",goRowSizing:6,7:"goColSizing",goColSizing:7,8:"goRowMoving",goRowMoving:8,9:"goColMoving",goColMoving:9,10:"goEditing",goEditing:10,11:"goTabs",goTabs:11,12:"goRowSelect",goRowSelect:12,13:"goAlwaysShowEditor",goAlwaysShowEditor:13,14:"goThumbTracking",goThumbTracking:14,15:"goFixedColClick",goFixedColClick:15,16:"goFixedRowClick",goFixedRowClick:16,17:"goFixedHotTrack",goFixedHotTrack:17,18:"goFixedRowDefAlign",goFixedRowDefAlign:18},this.$rtti.$Enum("TGridOption",{minvalue:0,maxvalue:18,ordtype:1,enumtype:this.TGridOption}),this.TGridSortIndicator={0:"siNone",siNone:0,1:"siAscending",siAscending:1,2:"siDescending",siDescending:2},this.$rtti.$Enum("TGridSortIndicator",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TGridSortIndicator}),this.TGridCellEditor={0:"geText",geText:0,1:"geNumber",geNumber:1,2:"geDate",geDate:2,3:"geTime",geTime:3,4:"geRange",geRange:4,5:"geColor",geColor:5,6:"geWeek",geWeek:6,7:"geMonth",geMonth:7,8:"geURL",geURL:8,9:"geEmail",geEmail:9,10:"geTel",geTel:10,11:"geMask",geMask:11,12:"geCombo",geCombo:12,13:"geMemo",geMemo:13,14:"geNone",geNone:14,15:"geCustom",geCustom:15},this.$rtti.$Enum("TGridCellEditor",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TGridCellEditor}),this.$rtti.$Set("TGridOptions",{comptype:this.$rtti.TGridOption}),this.$rtti.$MethodVar("TGridGetCellDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TGridGetCellClassEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string],["AClassName",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TGridGetCellChildrenEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string],["AElement",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord]]),methodkind:0}),this.$rtti.$MethodVar("TGridGetCellEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AEditor",this.$rtti.TGridCellEditor,1]]),methodkind:0}),this.$rtti.$MethodVar("TGridSortClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ASortIndicator",this.$rtti.TGridSortIndicator]]),methodkind:0}),this.$rtti.$MethodVar("TGetEditEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Value",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TSetEditEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Value",rtl.string,2]]),methodkind:0}),this.$rtti.$MethodVar("TSetEditControlValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["Value",rtl.string,2]]),methodkind:0}),this.$rtti.$MethodVar("TGetEditControlValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["Value",rtl.string,1]]),methodkind:0}),rtl.createClass(this,"TCustomGrid",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FRowCount=0,this.FColCount=0},this.GetCells=function(t,e){return"",""},this.SetCells=function(t,e,i){},this.SetColCount=function(t){var e=0;this.FColCount!==t&&t>=0&&(e=t-this.FColCount,this.FColCount=t,null!=this.GetElementHandle()&&(this.ColCountChanged(e),this.GridChanged()))},this.SetRowCount=function(t){var e=0;this.FRowCount!==t&&t>=0&&(e=t-this.FRowCount,this.FRowCount=t,null!=this.GetElementHandle()&&(this.RowCountChanged(e),this.GridChanged()))},this.GridChanged=function(){},this.RowCountChanged=function(t){},this.ColCountChanged=function(t){},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown)})),this.TGridDrawingStyle={0:"gdsClassic",gdsClassic:0,1:"gdsThemed",gdsThemed:1,2:"gdsGradient",gdsGradient:2},this.$rtti.$MethodVar("TCellEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TCellCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Checked",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TCellCanEditEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CanEdit",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TSelectCellEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CanSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TColumnSizedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TGridRange",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMax=0,this.FMin=0,this.FStep=0},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FMin=0,this.FMax=100,this.FStep=1,this},this.Assign=function(e){t.TGridRange.isPrototypeOf(e)&&(this.FMax=rtl.as(e,t.TGridRange).FMax,this.FMin=rtl.as(e,t.TGridRange).FMin,this.FStep=rtl.as(e,t.TGridRange).FStep)};var e=this.$rtti;e.addMethod("Create$1",2,[]),e.addProperty("Min",0,rtl.double,"FMin","FMin",{Default:0}),e.addProperty("Max",0,rtl.double,"FMax","FMax",{Default:100}),e.addProperty("Step",0,rtl.double,"FStep","FStep",{Default:1})})),rtl.createClass(this,"TCustomStringGrid",this.TCustomGrid,(function(){this.$init=function(){t.TCustomGrid.$init.call(this),this.FOrigVal="",this.FGrid=null,this.FFixedColor=0,this.FFixedColRow=null,this.FFixedRow=null,this.FFixedCol=null,this.FNormalCells=null,this.FDefaultColAlignment=0,this.FDefaultRowHeight=0,this.FDefaultColWidth=0,this.FColWidths=null,this.FRowHeights=null,this.FColAlignments=null,this.FSelectedCell=null,this.FEdit=null,this.FFixedCols=0,this.FFixedRows=0,this.FEditMode=!1,this.FBlockFocus=!1,this.FOnSelectCell=null,this.FOnTopLeftChanged=null,this.FOptions={},this.FDelimiter="\0",this.FLoadFixed=!1,this.FSelection=t.TGridRect.$new(),this.FStartCell=t.TGridCoord.$new(),this.FOnHttpRequestError=null,this.FOnHttpRequestSuccess=null,this.FOnGetCellClass=null,this.FOnGetCellData=null,this.FOnGetCellChildren=null,this.FScrollBars=0,this.FSelMouseDown=!1,this.FStyleElements={},this.FEditCol=0,this.FEditRow=0,this.FEditType=0,this.FFixedFont=null,this.FOnGetEditText=null,this.FOnSetEditText=null,this.FOnCheckClick=null,this.FOnFixedCellClick=null,this.FOnValidateEdit=null,this.FHandleEditBlurPtr=null,this.FHandleEditKeypressPtr=null,this.FHandleCheckClickPtr=null,this.FHandleButtonClickPtr=null,this.FHandleMouseDownPtr=null,this.FHandleMouseMovePtr=null,this.FHandleMouseUpPtr=null,this.FHandleFocusPtr=null,this.FHandleBlurPtr=null,this.FHandleFixedClickPtr=null,this.FHandleClickPtr=null,this.FDrawingStyle=0,this.FOnCanEditCell=null,this.FOnColumnSized=null,this.FRows=null,this.FRowsIndex=0,this.FOnGetCellEditor=null,this.FCombo=null,this.FMemo=null,this.FMask=null,this.FEditMask="",this.FComboBoxItems=null,this.FRange=null,this.FShowSelection=!1,this.FOnClickCell=null,this.FElementTableClassName="",this.FGridLineColor=0,this.FSelectionTextColor=0,this.FSelectionColor=0,this.FWordWrap=!1,this.FOnButtonClick=null,this.FSortIndex=0,this.FSortDirection=0,this.FOnSortClick=null,this.FHasMergedCells=!1,this.FObjectRows=null,this.FEditAdvance=!1,this.FEditControl=null,this.FOrigID="",this.FOnSetEditControlValue=null,this.FOnGetEditControlValue=null,this.FOnDblClickCell=null,this.FEditorMode=!1},this.$final=function(){this.FGrid=void 0,this.FFixedColRow=void 0,this.FFixedRow=void 0,this.FFixedCol=void 0,this.FNormalCells=void 0,this.FColWidths=void 0,this.FRowHeights=void 0,this.FColAlignments=void 0,this.FSelectedCell=void 0,this.FEdit=void 0,this.FOnSelectCell=void 0,this.FOnTopLeftChanged=void 0,this.FOptions=void 0,this.FSelection=void 0,this.FStartCell=void 0,this.FOnHttpRequestError=void 0,this.FOnHttpRequestSuccess=void 0,this.FOnGetCellClass=void 0,this.FOnGetCellData=void 0,this.FOnGetCellChildren=void 0,this.FStyleElements=void 0,this.FFixedFont=void 0,this.FOnGetEditText=void 0,this.FOnSetEditText=void 0,this.FOnCheckClick=void 0,this.FOnFixedCellClick=void 0,this.FOnValidateEdit=void 0,this.FOnCanEditCell=void 0,this.FOnColumnSized=void 0,this.FRows=void 0,this.FOnGetCellEditor=void 0,this.FCombo=void 0,this.FMemo=void 0,this.FMask=void 0,this.FComboBoxItems=void 0,this.FRange=void 0,this.FOnClickCell=void 0,this.FOnButtonClick=void 0,this.FOnSortClick=void 0,this.FObjectRows=void 0,this.FEditControl=void 0,this.FOnSetEditControlValue=void 0,this.FOnGetEditControlValue=void 0,this.FOnDblClickCell=void 0,t.TCustomGrid.$final.call(this)},this.GetCells=function(t,e){var i=null;return null==(i=this.CellRealElement(t,e))?"":(this.FWordWrap&&null!=i.firstChild&&(i=i.firstChild),i.textContent)},this.SetCells=function(t,e,i){var s=0,n="",r="",o=null;e<0||t<0||(n=i,pas.System.Pos("\r",i)>0?(n=pas.SysUtils.StringReplace(n,"\r","<BR>",rtl.createSet(0)),n=pas.SysUtils.StringReplace(n,"\n","<BR>",rtl.createSet(0))):pas.System.Pos("\n",i)>0&&(n=pas.SysUtils.StringReplace(n,"\n","<BR>",rtl.createSet(0))),this.FWordWrap&&(s=this.GetRowHeights(e)-2,n='<DIV class="cell" style="height:'+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return s},set:function(t){s=t}})+"px;max-height:"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return s},set:function(t){s=t}})+'px">'+n+"</DIV>"),null!=(o=this.CellRealElement(t,e))&&(o.innerHTML=n,r="",this.GetCellClassName(t,e,null,n,{get:function(){return r},set:function(t){r=t}}),""!==r&&o.setAttribute("class",r)),0===e&&this.EnableColResize())},this.SetFixedCols=function(t){this.FFixedCols!==t&&(this.FFixedCols=t,this.IsUpdating()||this.ReRenderGrid())},this.SetFixedRows=function(t){this.FFixedRows!==t&&(this.FFixedRows=t,this.IsUpdating()||this.ReRenderGrid())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.UpdateElement())},this.GetColWidths=function(t){return t<this.FColWidths.GetCount()?rtl.trunc(this.FColWidths.Get(t)):this.FDefaultColWidth},this.GetRowHeights=function(t){return t<this.FRowHeights.GetCount()?rtl.trunc(this.FRowHeights.Get(t)):this.FDefaultRowHeight},this.SetColWidths=function(t,e){for(var i,s,n,r,o=0;this.FColWidths.GetCount()<=t;)this.FColWidths.Add(this.FDefaultColWidth);if(this.FColWidths.Put(t,e),!this.IsUpdating()&&null!=this.FGrid){if(r=2===this.FWidthStyle,i=this.NormalColWidth(),n=(s=this.GetWidth()-this.FixedColWidth())-pas["WEBLib.Controls"].GetScrollBarWidth(),t<this.FFixedCols){if(o=this.FixedColWidth(),null!=(a=this.FGrid.rows[0]))null!=(l=a.cells[0])&&(l.style.width=o+"px",null!=l.firstChild&&(l.firstChild.style.width=o+"px"));null!=(a=this.FGrid.rows[1])&&(null!=(l=a.cells[0])&&(l.style.width=o+"px",null!=l.firstChild&&(l.firstChild.style.width=o+"px")),null!=(a=this.FFixedColRow.rows[0])&&null!=(l=a.cells[0])&&(l.style.width=o+"px")),null!=(a=this.FFixedCol.rows[0])&&null!=(l=a.cells[0])&&(l.style.width=o+"px")}var a,l;if(t>=this.FFixedCols)if(t-=this.FFixedCols,null!=(a=this.FFixedRow.rows[0]))if((l=a.cells[t]).style.width=e+"px",l.style.maxwidth=e+"px",this.FNormalCells.rows.length>0)(l=this.FNormalCells.rows[0].cells[t]).style.width=e+"px",l.style.maxwidth=e+"px";if(null!=(a=this.FGrid.rows[0]))null==(l=a.cells[1]).firstChild||r||(l.firstChild.style.width=n+"px",l.firstChild.firstChild.style.width=i+"px");null!=(a=this.FGrid.rows[1])&&(null==(l=a.cells[1]).firstChild||r||(l.firstChild.style.width=s+"px",l.firstChild.firstChild.style.width=i+"px")),this.UpdateGridSize()}},this.SetRowHeights=function(t,e){for(var i,s,n,r=0,o=0;this.FRowHeights.GetCount()<=t;)this.FRowHeights.Add(this.FDefaultRowHeight);if(this.FRowHeights.Put(t,e),!this.IsUpdating()&&null!=this.FGrid){if(this.FixedRowHeight(),i=this.NormalRowHeight(),n=(s=this.GetHeight()-this.FixedRowHeight())-pas["WEBLib.Controls"].GetScrollBarHeight(),t<this.FFixedRows){if(r=this.FixedRowHeight(),null!=(l=this.FGrid.rows[0]))if(l.style.height=r+"px",null!=(h=l.cells[0])){var a=h.firstChild;null!=a&&(a.style.height=r+"px"),null!=(a=(h=l.cells[1]).firstChild)&&(a.style.height=r+"px")}null!=(l=this.FFixedColRow.rows[0])&&null!=(l=l.cells[0])&&(l.style.height=e+"px",null!=(l=this.FFixedRow.rows[t].cells[0])&&(l.style.height=e+"px"))}var l,h;if(t>=this.FFixedRows)if(t-=this.FFixedRows,o=e,this.HasHorzScrollBar()&&this.HasVertScrollBar()&&t===this.FRowCount-1&&(o=e+this.FNormalCells.parentElement.scrollHeight),null!=(l=this.FFixedCol.rows[t]))l.style.height=e+"px",null!=(l=this.FNormalCells.rows[t])&&(l.style.height=o+"px");(h=this.FGrid.rows[1].cells[0]).firstChild&&(h.firstChild.style.height=n+"px",h.firstChild.firstChild.style.height=i+"px"),(h=this.FGrid.rows[1].cells[1]).firstChild&&(h.firstChild.style.height=s+"px",h.firstChild.firstChild.style.height=i+"px")}},this.SetDefaultColWidth=function(t){var e=0;this.FDefaultColWidth=t;for(var i=0,s=this.FColCount-1;i<=s;i++)e=i,this.SetColWidths(e,t)},this.SetDefaultRowHeight=function(t){var e=0;this.FDefaultRowHeight=t;for(var i=0,s=this.FRowCount-1;i<=s;i++)e=i,this.SetRowHeights(e,t)},this.GetCol=function(){var t=0;return t=-1,null!=this.FSelectedCell&&(t=this.FSelectedCell.cellIndex,t+=this.FFixedCols),t},this.GetRow=function(){var t=0;return t=-1,null!=this.FSelectedCell&&(t=this.FSelectedCell.parentElement.rowIndex,t+=this.FFixedRows),t},this.SetCol=function(t){var e=0,i=0,s=null;if(t<this.FColCount&&t>=this.FFixedCols){null!=this.FSelectedCell&&this.RemoveSelection(this.FSelectedCell),i=t-this.FFixedCols,(e=this.GetRow()-this.FFixedRows)<0&&(e=0),s=this.FNormalCells.rows[e].cells[i],this.AddSelection(s),this.FSelectedCell=s;var n=this.FNormalCells.parentElement.parentElement;s.offsetLeft<n.scrollLeft&&(n.scrollLeft=s.offsetLeft),s.offsetLeft+s.offsetWidth-n.scrollLeft>n.offsetWidth&&(n.scrollLeft=n.scrollLeft+s.offsetWidth)}},this.SetRow=function(t){var e=0,i=0,s=0,n=!1,r=null,o=null;if(t<this.FRowCount&&t>=this.FFixedRows){n=12 in this.FOptions,null!=this.FSelectedCell&&n&&(r=this.FSelectedCell.parentElement,this.RemoveSelection(r)),null!=this.FSelectedCell&&this.RemoveSelection(this.FSelectedCell),(i=this.GetCol()-this.FFixedCols)<0&&(i=0),e=t-this.FFixedRows,s=this.FixedColWidth()+this.NormalColWidth()<this.GetWidth()?0:pas["WEBLib.Controls"].GetScrollBarHeight(),o=(r=this.FNormalCells.rows[e]).cells[i],n?(pas.JS.isUndefined(this.FSelectedCell)||this.RemoveSelection(this.FSelectedCell),this.AddSelection(r),this.FSelectedCell=o):(this.FSelectedCell=o,this.AddSelection(this.FSelectedCell));var a=this.FNormalCells.parentElement.parentElement,l=0;if(o.offsetTop<a.scrollTop&&(a.scrollTop=o.offsetTop),o.offsetHeight>0)for(;o.offsetTop+o.offsetHeight-a.scrollTop>a.offsetHeight-s&&(l=a.scrollTop,a.scrollTop=a.scrollTop+o.offsetHeight,a.scrollTop!==l););}},this.GetCellElements=function(t,e){return this.CellRealElement(t,e)},this.GetCheckElement=function(t,e){var i=null,s=null;return i=null,t<this.FColCount&&e<this.FRowCount&&null!=(s=this.GetCellElements(t,e).firstChild)&&rtl.isExt(s,Element)&&s.hasAttribute("type")&&"CHECKBOX"===pas.SysUtils.UpperCase(s.getAttribute("type"))&&(i=s),i},this.GetButtonElement=function(t,e){var i=null,s=null;return i=null,t<this.FColCount&&e<this.FRowCount&&null!=(s=this.GetCellElements(t,e).firstChild)&&rtl.isExt(s,Element)&&"BUTTON"===pas.SysUtils.UpperCase(s.tagName)&&(i=s),i},this.GetSelection=function(){var e=t.TGridRect.$new();return e.$assign(this.FSelection),e},this.SetSelection=function(t){var e=0,i=0,s=0,n=0,r=0,o=0,a=0,l=0,h=null,u=null;this.FSelection.$assign(t),r=t.Left,o=t.Right,t.Left>t.Right&&(r=t.Right,o=t.Left),a=t.Top,l=t.Bottom,t.Top>t.Bottom&&(a=t.Bottom,l=t.Top);for(var d=this.FFixedRows,F=this.FRowCount-1;d<=F;d++)if(i=d,12 in this.FOptions)n=i-this.FFixedRows,i>=a&&i<=l?(h=this.FNormalCells.rows[n],this.AddSelection(h)):(h=this.FNormalCells.rows[n],this.RemoveSelection(h));else for(var c=this.FFixedCols,p=this.FColCount-1;c<=p;c++)s=(e=c)-this.FFixedCols,n=i-this.FFixedRows,e>=r&&e<=o&&i>=a&&i<=l?null!=(u=this.FNormalCells.rows[n].cells[s])&&this.AddSelection(u):null!=(u=this.FNormalCells.rows[n].cells[s])&&this.RemoveSelection(u)},this.GetLeftCol=function(){var t=0,e=0,i=0,s=0;if(t=this.FFixedCols,null!=this.FNormalCells){s=this.FNormalCells.parentElement.parentElement.scrollLeft,i=0;for(var n=this.FFixedCols,r=this.FColCount-1;n<=r;n++){if(e=n,s<=i){t=e;break}i=i+this.GetColWidths(e)+1-0}}return t},this.GetTopRow=function(){var t=0,e=0;return t=this.FFixedRows,null!=this.FNormalCells&&e>=0&&(e=this.FNormalCells.parentElement.parentElement.scrollTop,t=this.FFixedRows+rtl.trunc(e/this.FDefaultRowHeight)),t},this.SetLeftCol=function(t){var e=0,i=0;i=0;for(var s=this.FFixedCols,n=t-1;s<=n;s++)e=s,i=i+this.GetColWidths(e)+1-0;null!=this.FNormalCells&&(this.FNormalCells.parentElement.parentElement.scrollLeft=i,this.FFixedCols>0&&(this.FFixedCol.parentElement.parentElement.scrollLeft=i))},this.SetTopRow=function(t){var e;e=(t-this.FFixedRows)*this.FDefaultRowHeight,null!=this.FNormalCells&&e>=0&&(this.FNormalCells.parentElement.parentElement.scrollTop=e,this.FFixedCols>0&&(this.FFixedCol.parentElement.parentElement.scrollTop=e))},this.SetFixedColor=function(t){this.FFixedColor!==t&&(this.FFixedColor=t,this.UpdateElementVisual())},this.GetFixedTextColor=function(){return this.FFixedFont.FColor},this.GetVisibleColCount=function(){var t,e=0;for(e=this.GetLeftCol(),t=this.GetElementHandle().getBoundingClientRect();e<this.FColCount&&!(this.GetCellElements(e,this.FFixedRows).getBoundingClientRect().right>t.right);)e+=1;return e-this.GetLeftCol()},this.GetVisibleRowCount=function(){var t,e=0;for(e=this.GetTopRow(),t=this.GetElementHandle().getBoundingClientRect();e<this.FRowCount&&!(this.GetCellElements(this.FFixedCols,e).getBoundingClientRect().bottom>t.bottom);)e+=1;return e-this.GetTopRow()},this.SetRows=function(t,e){var i=0;if(!(t>=0&&t<this.FRowCount))throw pas.SysUtils.Exception.$create("Create$1",["Invalid row index"]);for(var s=0,n=this.FColCount-1;s<=n;s++)(i=s)<e.GetCount()&&this.SetCells(i,t,e.Get(i))},this.RowsChanged=function(t){this.SetRows(this.FRowsIndex,this.FRows)},this.SetRange=function(t){this.FRange.Assign(t)},this.SetElementTableClassName=function(t){this.FElementTableClassName!==t&&(this.FElementTableClassName=t,this.IsUpdating()||this.ReRenderGrid())},this.SetGridLineColor=function(t){this.FGridLineColor!==t&&(this.FGridLineColor=t,this.UpdateElement())},this.SetSelectionColor=function(t){this.FSelectionColor!==t&&(this.FSelectionColor=t,this.UpdateElement())},this.SetSelectionTextColor=function(t){this.FSelectionTextColor!==t&&(this.FSelectionTextColor=t,this.UpdateElement())},this.GetColAlignments=function(t){return t<this.FColAlignments.GetCount()?this.FColAlignments.Get(t):this.FDefaultColAlignment},this.SetColAlignments=function(t,e){for(;this.FColAlignments.GetCount()<=t;)this.FColAlignments.Add(0);this.FColAlignments.Put(t,e),this.UpdateGridAlignment()},this.SetAlignAttr=function(t,e){var i=t;0===i?e.removeAttribute("align"):2===i?e.setAttribute("align","center"):1===i&&e.setAttribute("align","right")},this.SetDefaultColAlignment=function(t){this.FDefaultColAlignment!==t&&(this.FDefaultColAlignment=t,0 in this.FComponentState||this.ReRenderGrid())},this.SetFixedFont=function(t){this.FFixedFont.Assign(t)},this.FontChanged=function(){pas["WEBLib.Controls"].TControl.FontChanged.call(this),this.UpdateElement()},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FNormalCells&&(this.FNormalCells.removeEventListener("mousedown",this.FHandleMouseDownPtr),this.FNormalCells.removeEventListener("mouseup",this.FHandleMouseUpPtr),this.FNormalCells.removeEventListener("mousemove",this.FHandleMouseMovePtr),this.FNormalCells.removeEventListener("click",this.FHandleClickPtr)),null!=this.FFixedCol&&this.FFixedCol.removeEventListener("click",this.FHandleFixedClickPtr),null!=this.FFixedRow&&this.FFixedRow.removeEventListener("click",this.FHandleFixedClickPtr),null!=this.FFixedColRow&&this.FFixedColRow.removeEventListener("click",this.FHandleFixedClickPtr)},this.FixedFontChanged=function(t){this.$class.AddInstanceStyle$1(this.StylePrefix()+this.FOrigID,this.GetGridCSS(this.FOrigID+"tbl")),this.UpdateElementVisual()},this.StylePrefix=function(){var t,e="";return e="",null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&(e=t.$classname),e},this.CellRealElement=function(t,e){var i=null,s=null,n=0,r=0;if(t<this.FFixedCols&&e<this.FFixedRows?(s=this.FFixedColRow,n=t,r=e):t<this.FFixedCols&&e>=this.FFixedRows?(s=this.FFixedCol,n=t,r=e-this.FFixedRows):t>=this.FFixedCols&&e<this.FFixedRows?(s=this.FFixedRow,n=t-this.FFixedCols,r=e):(s=this.FNormalCells,n=t-this.FFixedCols,r=e-this.FFixedRows),i=null,this.FHasMergedCells){i=function(t,e,i){var s,n,r,o,a,l,h,u=[];for(h=0;h<t.rows.length;h++)for(s=t.rows[h],l=0;l<s.cells.length;l++){for(n=s.cells[l],r=l;u[h]&&u[h][r];++r);for(o=r;o<r+n.colSpan;++o)for(a=h;a<h+n.rowSpan;++a)u[a]||(u[a]=[]),u[a][o]=!0;if(r<=e&&e<r+n.colSpan&&h<=i&&i<h+n.rowSpan)return n}return null}(s,n,r)}else i=s.rows[r].cells[n];return i},this.CellRealCoords=function(t,e,i){var s=[],n=0,r=0;e.set(-1),i.set(-1),s=rtl.arraySetLength(s,null,this.FColCount,this.FRowCount);for(var o=0,a=this.FColCount-1;o<=a;o++){n=o;for(var l=0,h=this.FRowCount-1;l<=h;l++)r=l,s[n][r]=this.CellRealElement(n,r)}for(var u=0,d=this.FColCount-1;u<=d;u++){n=u;for(var F=0,c=this.FRowCount-1;F<=c;F++)if(r=F,s[n][r]===t){e.set(n-this.FFixedCols),i.set(r-this.FFixedRows);break}}},this.GetDirectCellElements=function(t,e){var i=0,s=0,n=null;return n=null,t<this.FFixedCols&&e>=this.FFixedRows&&(s=e-this.FFixedRows,i=t,n=this.FFixedCol.rows[s].cells[i]),e<this.FFixedRows&&t>=this.FFixedCols&&(i=t-this.FFixedCols,s=e,n=this.FFixedRow.rows[s].cells[i]),t<this.FFixedCols&&e<this.FFixedRows&&(s=e,i=t,n=this.FFixedColRow.rows[s].cells[i]),t>=this.FFixedCols&&e>=this.FFixedRows&&e<this.FRowCount&&t<this.FColCount&&(i=t-this.FFixedCols,s=e-this.FFixedRows,n=this.FNormalCells.rows[s].cells[i]),n},this.MouseMove=function(e,i,s){pas["WEBLib.Controls"].TControl.MouseMove.apply(this,arguments),-1!==this.FStartCell.X&&-1!==this.FStartCell.Y&&(s>this.GetHeight()-10&&(this.SetTopRow(this.GetTopRow()+1),this.SetSelection(t.GridRect(this.GetSelection().Left,Math.min(this.GetSelection().Top,this.GetSelection().Bottom),this.GetSelection().Right,Math.max(this.GetSelection().Top,this.GetSelection().Bottom)+1))),this.FFixedRows>0&&s<this.GetRowHeights(0)&&this.GetTopRow()>this.FFixedRows&&(this.SetTopRow(this.GetTopRow()-1),this.SetSelection(t.GridRect(this.GetSelection().Left,Math.min(this.GetSelection().Top,this.GetSelection().Bottom)-1,this.GetSelection().Right,Math.max(this.GetSelection().Top,this.GetSelection().Bottom)))),i>this.GetWidth()-10&&(this.SetLeftCol(this.GetLeftCol()+1),this.SetSelection(t.GridRect(Math.min(this.GetSelection().Left,this.GetSelection().Right),this.GetSelection().Top,Math.max(this.GetSelection().Left,this.GetSelection().Right)+1,this.GetSelection().Bottom))),this.FFixedCols>0&&i<this.GetColWidths(0)&&this.GetLeftCol()>this.FFixedCols&&(this.SetLeftCol(this.GetLeftCol()-1),this.SetSelection(t.GridRect(Math.min(this.GetSelection().Left,this.GetSelection().Right)-1,this.GetSelection().Top,Math.max(this.GetSelection().Left,this.GetSelection().Right),this.GetSelection().Bottom))))},this.HandleClick=function(t){var e,i,s=0,n=0,r=null,o=null,a="";if(!0,!this.FEnabled)return!0;if(e=12 in this.FOptions,s=-1,n=-1,"tr"===(i=(o=t.target).tagName.toLowerCase())||"tbody"===i)return!0;do{"td"!=(a=o.tagName.toLowerCase())&&(o=o.parentElement)}while("td"!==a&&null!==o);if("td"==a){n=o.cellIndex;r=o.parentElement;s=r.rowIndex}if("td"===a&&this.FHasMergedCells&&this.CellRealCoords(o,{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),-1===n||-1===s)return!0;if(!this.CanSelect(n+this.FFixedCols,s+this.FFixedRows))return!0;if(this.SelectCell(n+this.FFixedCols,s+this.FFixedRows),null!=this.FOnClickCell&&this.FEnabled&&this.FOnClickCell(this,n+this.FFixedCols,s+this.FFixedRows),null!=this.FSelectedCell)if(this.FSelMouseDown){if(10 in this.FOptions&&this.CanEditCell(this.GetCol(),this.GetRow()))return this.ShowEdit(),!0}else e?(r=this.FSelectedCell.parentElement,this.RemoveSelection(r)):this.RemoveSelection(this.FSelectedCell);return"td"===a&&(r=o.parentElement,this.FSelectedCell=o,e?this.AddSelection(r):this.AddSelection(o)),!0},this.HandleFixedClick=function(t){var e=0,i=0,s=null,n=0,r=0,o=null,a="",l=0;this.FOptions,e=-1,i=-1,l=0,"SPAN"===(o=t.target).tagName&&("up"===o.getAttribute("sort")?l=1:"dn"===o.getAttribute("sort")&&(l=2));do{"td"!=(a=o.tagName.toLowerCase())&&(o=o.parentElement)}while("td"!==a&&null!==o);if("td"==a){i=o.cellIndex;var h=o.parentElement;e=h.rowIndex,s=(s=h.parentElement).parentElement}return-1===i||-1===e||(n=i,r=e,s===this.FFixedCol&&(r=e+this.FFixedRows),s===this.FFixedRow&&(n=i+this.FFixedCols),1===l?(this.DoSortClick(n,r,2),this.SetSortIndicator(n,r,2)):2===l&&(this.DoSortClick(n,r,1),this.SetSortIndicator(n,r,1)),null!=this.FOnFixedCellClick&&this.FOnFixedCellClick(this,n,r)),!0},this.HandleMouseDown=function(e){var i,s,n=0,r=0,o=0,a=0,l=null;if(!0,!this.FEnabled)return!0;if(0!==(s=this.GetMouseEventButton(e)))return!0;(n=-1,r=-1,l=e.target,this.FWordWrap&&"div"===pas.SysUtils.LowerCase(l.tagName)&&(l=l.parentElement),"td"==l.tagName.toLowerCase())&&(r=l.cellIndex,n=l.parentElement.rowIndex);return this.FSelMouseDown=l===this.FSelectedCell,null==this.FSelectedCell||this.FSelMouseDown||-1===r||-1===n||this.HideEdit(!1),!this.CanSelect(r+this.FFixedCols,n+this.FFixedRows)||(r>=0&&n>=0&&(12 in this.FOptions?this.SetSelection(t.GridRect(this.FFixedCols,n+this.FFixedRows,this.FColCount-1,n+this.FFixedRows)):this.SetSelection(t.GridRect(r+this.FFixedCols,n+this.FFixedRows,r+this.FFixedCols,n+this.FFixedRows)),4 in this.FOptions?(this.FStartCell.X=r+this.FFixedCols,this.FStartCell.Y=n+this.FFixedRows):(this.FStartCell.X=-1,this.FStartCell.Y=-1)),this.XYToClient(e.clientX,e.clientY,{get:function(){return o},set:function(t){o=t}},{get:function(){return a},set:function(t){a=t}}),i=rtl.refSet(this.GetMouseEventShiftState(e)),this.MouseDown(s,rtl.refSet(i),pas.System.Trunc(o),pas.System.Trunc(a)),!0)},this.HandleMouseMove=function(e){var i,s=0,n=0,r=0,o=0;(s=-1,n=-1,"td"==e.target.tagName.toLowerCase())&&(n=e.target.cellIndex,s=e.target.parentElement.rowIndex);return n>=0&&s>=0&&this.FStartCell.X>=0&&this.FStartCell.Y>=0&&this.SetSelection(t.GridRect(this.FStartCell.X,this.FStartCell.Y,n+this.FFixedCols,s+this.FFixedRows)),!0,this.XYToClient(e.clientX,e.clientY,{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}}),i=rtl.refSet(this.GetMouseEventShiftState(e)),this.MouseMove(rtl.refSet(i),pas.System.Trunc(r),pas.System.Trunc(o)),!0},this.HandleMouseUp=function(t){var e,i,s=0,n=0;return TMSStringGridresetResize(),this.FStartCell.X=-1,this.FStartCell.Y=-1,!1,t.stopPropagation(),t.cancelBubble=!0,this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),e=rtl.refSet(this.GetMouseEventShiftState(t)),i=this.GetMouseEventButton(t),this.MouseUp(i,rtl.refSet(e),pas.System.Trunc(s),pas.System.Trunc(n)),!1},this.HandleKeyDown=function(e){var i,s=0,n=0,r=0,o={},a=!1;return!0,!this.FEnabled||(e.cancelBubble=!0,e.stopPropagation(),s=0,a=!1,i=null==e.key,"UNIDENTIFIED"===pas.SysUtils.UpperCase(e.key)||(i||(s=this.GetKeyCode(e.key,!0),a=1===e.key.length,o=rtl.refSet(this.GetKeyBoardEventShiftState(e)),null!=this.FOnKeyDown&&this.FOnKeyDown(this,{get:function(){return s},set:function(t){s=t}},rtl.refSet(o))),r=this.GetRow(),n=this.GetCol(),-1===r&&-1===n&&this.FColCount>this.FFixedCols&&this.FRowCount>this.FFixedRows&&(n=this.FFixedCols,r=this.FFixedRows,this.SetCol(this.FFixedCols),this.SetRow(this.FFixedRows),this.FNormalCells.focus()),s in rtl.createSet(38,40,33,34)&&!a&&(e.preventDefault(),this.HideEdit(!1),this.ChangeRow()),this.FEditMode||!(s in rtl.createSet(35,36,37,39))||a||(e.preventDefault(),this.HideEdit(!1)),27!==s||a||this.CancelEdit(),this.FEditMode||a||!e.shiftKey||s>=48&&s<=122||!(4 in this.FOptions)?(35!==s||a||(r=this.FRowCount-1),36!==s||a||(r=this.FFixedRows),34!==s||a||(r=this.GetRow()+4<=this.FRowCount-1?this.GetRow()+4:this.FRowCount-1),33!==s||a||(r=this.GetRow()-4>this.FFixedRows?this.GetRow()-4:this.FFixedRows),!this.FEditMode&&38===s&&this.GetRow()>this.FFixedRows&&!a&&(r=this.GetRow()-1),!this.FEditMode&&40===s&&this.GetRow()<this.FRowCount-1&&!a&&(r=this.GetRow()+1),!this.FEditMode&&37===s&&this.GetCol()>this.FFixedCols&&!a&&(n=this.GetCol()-1),!this.FEditMode&&39===s&&this.GetCol()<this.FColCount-1&&!a&&(n=this.GetCol()+1),this.FEditMode||!this.CanSelect(n,r)||a||(this.SelectCell(n,r),38===s&&this.GetRow()<this.GetTopRow()&&this.SetTopRow(this.GetTopRow()-1),33===s&&this.GetRow()<this.GetTopRow()&&this.SetTopRow(this.GetRow()),34===s&&this.GetRow()>=this.GetTopRow()+this.GetVisibleRowCount()&&this.SetTopRow(this.GetRow()),40===s&&this.GetRow()>=this.GetTopRow()+this.GetVisibleRowCount()&&this.SetTopRow(this.GetTopRow()+1),37===s&&this.GetCol()<this.GetLeftCol()&&this.SetLeftCol(this.GetLeftCol()-1),39===s&&this.GetCol()>=this.GetLeftCol()+this.GetVisibleColCount()&&this.SetLeftCol(this.GetLeftCol()+1),35===s&&this.SetTopRow(this.GetRow()-this.GetVisibleRowCount()),36===s&&this.SetTopRow(this.FFixedRows)),113===s&&!this.FEditMode&&10 in this.FOptions&&this.CanEditCell(this.GetCol(),this.GetRow())&&this.ShowEdit(),s>=32&&s<=112&&a&&!this.FEditMode&&10 in this.FOptions&&this.CanEditCell(this.GetCol(),this.GetRow())&&this.StartEdit(e.key),13===s&&10 in this.FOptions&&this.CanEditCell(this.GetCol(),this.GetRow())&&(this.FEditMode?this.HideEdit(this.FEditAdvance):this.ShowEdit())):(35===s&&(this.SetRow(this.FRowCount-1),this.SetSelection(t.GridRect(this.GetCol(),r,this.GetCol(),this.GetRow())),this.GetRow()>=this.GetTopRow()+this.GetVisibleRowCount()&&this.SetTopRow(this.GetRow()-this.GetVisibleRowCount())),36===s&&(this.SetRow(this.FFixedRows),this.SetSelection(t.GridRect(this.GetCol(),r,this.GetCol(),this.GetRow())),this.GetRow()<this.GetTopRow()&&this.SetTopRow(this.FFixedRows)),38===s&&this.GetRow()>this.FFixedRows&&(r=this.GetRow()===Math.min(this.GetSelection().Top,this.GetSelection().Bottom)?Math.max(this.GetSelection().Top,this.GetSelection().Bottom):Math.min(this.GetSelection().Top,this.GetSelection().Bottom),this.SetRow(this.GetRow()-1),this.SetSelection(t.GridRect(this.GetSelection().Left,r,this.GetSelection().Right,this.GetRow())),this.GetRow()<this.GetTopRow()&&this.SetTopRow(this.GetTopRow()-1)),40===s&&this.GetRow()<this.FRowCount-1&&(r=this.GetRow()===Math.max(this.GetSelection().Top,this.GetSelection().Bottom)?Math.min(this.GetSelection().Top,this.GetSelection().Bottom):Math.max(this.GetSelection().Top,this.GetSelection().Bottom),this.SetRow(this.GetRow()+1),this.SetSelection(t.GridRect(this.GetSelection().Left,r,this.GetSelection().Right,this.GetRow())),this.GetRow()>this.GetTopRow()+this.GetVisibleRowCount()&&this.SetTopRow(this.GetTopRow()+1)),37===s&&this.GetCol()>this.FFixedCols&&(n=this.GetCol()===Math.min(this.GetSelection().Left,this.GetSelection().Right)?Math.max(this.GetSelection().Left,this.GetSelection().Right):Math.min(this.GetSelection().Left,this.GetSelection().Right),this.SetCol(this.GetCol()-1),this.SetSelection(t.GridRect(n,this.GetSelection().Top,this.GetCol(),this.GetSelection().Bottom)),this.GetCol()<this.GetLeftCol()&&this.SetLeftCol(this.GetLeftCol()-1)),39===s&&this.GetCol()<this.FColCount-1&&(n=this.GetCol()===Math.max(this.GetSelection().Left,this.GetSelection().Right)?Math.min(this.GetSelection().Left,this.GetSelection().Right):Math.max(this.GetSelection().Left,this.GetSelection().Right),this.SetCol(this.GetCol()+1),this.SetSelection(t.GridRect(n,this.GetSelection().Top,this.GetCol(),this.GetSelection().Bottom)),this.GetCol()>=this.GetLeftCol()+this.GetVisibleColCount()&&this.SetLeftCol(this.GetLeftCol()+1)))),!0)},this.HandleTableFocus=function(t){return!0,!this.FEnabled||(null==this.FOnEnter||this.FBlockFocus||this.FOnEnter(this),this.FBlockFocus=!1,-1===this.GetCol()&&-1===this.GetRow()&&!this.HasSelection()&&this.FFixedCols<this.FColCount&&this.FFixedRows<this.FRowCount&&this.CanSelect(this.FFixedCols,this.FFixedRows)&&this.SelectCell(this.FFixedCols,this.FFixedRows),!0)},this.HandleTableBlur=function(t){return!0,null==this.FOnExit||this.FEditMode||this.FOnExit(this),!0},this.HandleScroll=function(t){return this.FFixedCols>0&&(this.FFixedCol.parentElement.scrollTop=this.FNormalCells.parentElement.parentElement.scrollTop),this.FFixedRows>0&&(this.FFixedRow.parentElement.parentElement.scrollLeft=this.FNormalCells.parentElement.parentElement.scrollLeft),this.TopLeftChanged(),!0,!0},this.HandleEditBlur=function(t){return this.FEditMode&&this.HideEdit(!1),!0,!0},this.HandleEditKeyPress=function(t){var e="\0";return t.cancelBubble=!0,t.stopPropagation(),!0,this.IsKeyCharacter(t.key)&&(e=String.fromCharCode(this.GetKeyCode(t.key,!1)),null!=this.FOnKeyPress&&this.FOnKeyPress(this,{get:function(){return e},set:function(t){e=t}})),!0},this.HandleComboExit=function(t){this.FEditMode&&this.HideEdit(!1)},this.HandleComboKeyPress=function(t,e){null!=this.FOnKeyPress&&this.FOnKeyPress(this,e),27===e.get().charCodeAt()&&this.CancelEdit(),13===e.get().charCodeAt()&&this.HideEdit(this.FEditAdvance)},this.HandleMaskExit=function(t){this.FEditMode&&this.HideEdit(!1)},this.HandleMaskKeyPress=function(t,e){null!=this.FOnKeyPress&&this.FOnKeyPress(this,e),27===e.get().charCodeAt()&&this.CancelEdit(),13===e.get().charCodeAt()&&this.HideEdit(this.FEditAdvance)},this.HandleMemoExit=function(t){this.FEditMode&&this.HideEdit(!1)},this.HandleMemoKeyPress=function(t,e){null!=this.FOnKeyPress&&this.FOnKeyPress(this,e),27===e.get().charCodeAt()&&this.CancelEdit()},this.HandleCheckBoxClick=function(t){var e,i=0,s=0;i=-1,s=-1,e=(n=t.target).checked;var n,r=n.parentElement;"td"==r.tagName.toLowerCase()&&(s=r.cellIndex,i=r.parentElement.rowIndex);-1!==i&&-1!==s&&(this.CanEditCell(s+this.FFixedCols,i+this.FFixedRows)?this.DoCheckClick(s+this.FFixedCols,i+this.FFixedRows,e):(n=t.target).checked=!n.checked);return!1},this.HandleButtonClick=function(t){var e=0,i=0;e=-1,i=-1;var s=t.target.parentElement;"td"==s.tagName.toLowerCase()&&(i=s.cellIndex,e=s.parentElement.rowIndex);return-1!==e&&-1!==i&&this.DoButtonClick(i+this.FFixedCols,e+this.FFixedRows),!1},this.HandleDoMouseUp=function(t){var e=0;return pas["WEBLib.Controls"].TControl.HandleDoMouseUp.apply(this,arguments),(e=TMSGridLastColSize)||(e=TMSStringGridisSizing()),TMSStringGridresetResize(),e>=0&&this.DoColumnSized(e),!0},this.HandleDoMouseMove=function(t){var e="",i=!1;return pas["WEBLib.Controls"].TControl.HandleDoMouseMove.apply(this,arguments),e=this.GetID()+"tbl",i=this.FWidthStyle in rtl.createSet(2),TMSStringGridID=e,TMSStringGridautoWidth=i,GridNormalCells=this.FNormalCells,GridFixedCells=this.FFixedRow,GridFixedColCells=this.FFixedCol,GridFixedColRows=this.FFixedColRow,GridColWidths=this.FColWidths,GridFixedCols=this.FFixedCols,TMSStringGridresizeColumn(t),!0},this.HandleDoClick=function(t){var e=!1;return e=pas["WEBLib.Controls"].TControl.HandleDoClick.apply(this,arguments),this.FEditMode||null==this.FNormalCells||this.FNormalCells.focus(),e},this.HandleDoDblClick=function(t){var e=0,i=0,s=0,n=0,r=null,o=null;for(pas["WEBLib.Controls"].TControl.HandleDoDblClick.apply(this,arguments),r=t.target;null!=r&&r!==this.GetElementHandle()&&"TD"!==r.tagName&&"TH"!==r.tagName;)r=r.parentElement;if(null!=r&&("TD"===r.tagName||"TH"===r.tagName)){e=r.cellIndex;var a=r.parentElement;i=a.rowIndex,(o=r.parentElement)&&(o=o.parentElement),o&&(o=o.parentElement),r.classList.contains("fixed")||(s=this.FFixedCols,n=this.FFixedRows),null!=o&&(pas.System.Pos("ResizeRowTable",o.id)>0&&(s=this.FFixedCols),pas.System.Pos("FixedColTable",o.id)>0&&(n=this.FFixedRows)),null!=this.FOnDblClickCell&&this.FOnDblClickCell(this,e+s,i+n)}return!0},this.DoCheckClick=function(t,e,i){null!=this.FOnCheckClick&&this.FOnCheckClick(this,t,e,i)},this.DoButtonClick=function(t,e){null!=this.FOnButtonClick&&this.FOnButtonClick(this,t,e)},this.DoSortClick=function(t,e,i){var s=0;this.FSortIndex=t;for(var n=0,r=this.FColCount-1;n<=r;n++)s=n,this.SelectSortIndicator(s,e,s===t);this.FSortDirection=i,null!=this.FOnSortClick&&this.FOnSortClick(this,t,e,i),this.Sort(t,i)},this.GetEditText=function(t,e){var i="";return i=this.GetCells(t,e),null!=this.FOnGetEditText&&this.FOnGetEditText(this,t,e,{get:function(){return i},set:function(t){i=t}}),i},this.SetEditText=function(t,e,i){null!=this.FOnSetEditText&&this.FOnSetEditText(this,t,e,i)},this.SetEditControlValue=function(t,e,i,s){null!=this.FOnSetEditControlValue&&this.FOnSetEditControlValue(this,t,e,i,s)},this.GetEditControlValue=function(t,e,i,s){null!=this.FOnGetEditControlValue&&this.FOnGetEditControlValue(this,t,e,i,s)},this.DoEditControlExit=function(t){this.HideEdit(!1)},this.GetCellData=function(t,e,i,s){null!=this.FOnGetCellData&&this.FOnGetCellData(this,t,e,i,s)},this.GetCellClassName=function(t,e,i,s,n){null!=this.FOnGetCellClass&&this.FOnGetCellClass(this,t,e,i,s,n)},this.GetCellChildren=function(t,e,i,s,n){var r=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new();null!=this.FOnGetCellChildren&&(r.element=n,this.FOnGetCellChildren(this,t,e,i,s,pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(r)))},this.GetCellEditor=function(t,e,i){null!=this.FOnGetCellEditor&&this.FOnGetCellEditor(this,t,e,i)},this.AddSelection=function(t){this.FShowSelection&&t.classList.add("selected")},this.RemoveSelection=function(t){this.FShowSelection&&t.classList.remove("selected")},this.BindCellChildren=function(t,e,i){var s=null;null!=(s=i.firstChild)&&"INPUT"===s.tagName&&s.hasAttribute("type")&&"checkbox"===pas.SysUtils.LowerCase(s.getAttribute("TYPE"))&&s.addEventListener("click",this.FHandleCheckClickPtr)},this.UnBindCellChildren=function(t,e,i){var s=null;null!=(s=i.firstChild)&&"INPUT"===s.tagName&&s.hasAttribute("type")&&"checkbox"===pas.SysUtils.LowerCase(s.getAttribute("TYPE"))&&s.removeEventListener("click",this.FHandleCheckClickPtr)},this.DoBoundsChange=function(){var t=0,e=0,i=0,s=0;pas["WEBLib.Controls"].TControl.DoBoundsChange.call(this),null!=this.GetElementHandle()&&(this.UpdateGridSize(),t=this.FixedColWidth(),e=this.FixedRowHeight(),i=this.GetWidth()-t,s=this.GetHeight()-e,null!=this.FNormalCells&&(this.FNormalCells.parentElement.parentElement.style.setProperty("width",pas.SysUtils.IntToStr(i)+"px"),this.FNormalCells.parentElement.parentElement.style.setProperty("height",pas.SysUtils.IntToStr(s)+"px")))},this.DoColumnSized=function(t){null!=this.FOnColumnSized&&this.FOnColumnSized(this,t)},this.LoadFromStringList=function(t){var e=null,i=0,s=0,n=0,r=0,o=0,a="",l="",h=null;this.FLoadFixed?this.SetRowCount(t.GetCount()):this.SetRowCount(t.GetCount()+this.FFixedRows),e=pas.Classes.TStringList.$create("Create$1"),o=this.FFixedCols,r=this.FFixedRows,this.FLoadFixed&&(r=0,o=0),n=0;try{for(var u=0,d=t.GetCount()-1;u<=d;u++){i=u,e.FStrictDelimiter=!0,e.SetDelimiter(this.FDelimiter),e.SetDelimitedText(t.Get(i)),e.GetCount()>n&&(n=e.GetCount()),e.GetCount()>this.FColCount-o&&this.SetColCount(e.GetCount()+o);for(var F=0,c=e.GetCount()-1;F<=c;F++)s=F,a=e.Get(s),this.GetCellData(s+o,i+r,null,{get:function(){return a},set:function(t){a=t}}),this.SetCells(s+o,i+r,a),h=this.GetCellElements(s+o,i+r),this.GetCellChildren(s+o,i+r,null,a,h),l="",this.GetCellClassName(s+o,i+r,null,a,{get:function(){return l},set:function(t){l=t}}),""!==l&&h.setAttribute("class",l)}}finally{e=rtl.freeLoc(e)}n<this.FColCount-o&&this.SetColCount(n+o)},this.GetGridCSS=function(t){var e="",i="";return e="",""!==this.FElementTableClassName?e:(2 in this.FOptions||(e="border-left: 0px; border-right: 0px;"),3 in this.FOptions||(e+="border-top: 0px; border-bottom: 0px;"),0===this.FElementFont&&(e+=pas["WEBLib.Graphics"].CSSFont(this.FFont),i=pas["WEBLib.Graphics"].CSSFont(this.FFixedFont)),e="table#"+t+" td { overflow: hidden; text-overflow: ellipsis; white-space:nowrap; border: solid 1px "+pas["WEBLib.Graphics"].ColorToHTML(this.FGridLineColor)+"; padding: 0px;"+e+"} \rtable#"+t+" td.fixed {"+i+"} \rtable#"+t+" td.selected { background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FSelectionColor)+"; color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FSelectionTextColor)+";} \rtable#"+t+" tr.selected { background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FSelectionColor)+"; color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FSelectionTextColor)+";} \rtable#"+t+" DIV.cell {word-wrap: normal; white-space: normal; text-overflow: clip; } ")},this.RenderGrid=function(){for(var t,e,i,s,n,r,o,a,l=null,h=0,u=0,d=0,F=0,c=0,p=0,C=null,S=null,m="",f="";this.FColWidths.GetCount()<=this.FColCount;)this.FColWidths.Add(this.FDefaultColWidth);if(""===this.FOrigID&&(this.FOrigID=this.GetID(),""===this.FOrigID&&(this.FOrigID=this.FName)),null==this.FGrid){(l=this.GetIsLinked()&&null!=this.GetElementHandle().firstElementChild?this.GetElementHandle().firstElementChild:document.createElement("TABLE")).setAttribute("id",this.FOrigID+"tbl"),""===this.FElementTableClassName?(l.setAttribute("class","table."+this.StylePrefix()+this.FName),l.style.setProperty("border-collapse","collapse"),l.style.setProperty("border-spacing","0px"),l.style.setProperty("border","0px")):l.setAttribute("class",this.FElementTableClassName),this.FGrid=l,pas["WEBLib.Controls"].SetHTMLElementFont(l,this.FFont,!(""===this.FElementClassName&&0===this.FElementFont)),this.$class.AddInstanceStyle$1(this.StylePrefix()+this.FOrigID,this.GetGridCSS(this.FOrigID+"tbl")),r=2===this.FWidthStyle,o=2===this.FHeightStyle,a=this.FOrigID+"tbl";C=void 0;var y=void 0,g=(S=void 0,void 0);if(this.FFixedColRow=document.createElement("TABLE"),this.FFixedColRow.setAttribute("id",a+"ResizeFixedRowTable"),this.FFixedColRow.style.setProperty("border-collapse","collapse"),this.FFixedColRow.style.setProperty("border-spacing","0px"),this.FFixedCol=document.createElement("TABLE"),this.FFixedCol.setAttribute("id",a+"ResizeFixedColTable"),this.FFixedCol.style.setProperty("border-collapse","collapse"),this.FFixedCol.style.setProperty("border-spacing","0px"),this.FFixedRow=document.createElement("TABLE"),this.FFixedRow.setAttribute("id",a+"ResizeRowTable"),this.FFixedRow.style.setProperty("border-collapse","collapse"),this.FFixedRow.style.setProperty("border-spacing","0px"),this.FFixedRow.style.setProperty("border","0px"),this.FNormalCells=document.createElement("TABLE"),this.FNormalCells.setAttribute("id",a+"NormalCellTable"),this.FNormalCells.style.setProperty("border-collapse","collapse"),this.FNormalCells.style.setProperty("border-spacing","0px"),this.FNormalCells.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)),this.FNormalCells.style.setProperty("outline","none"),this.FNormalCells.addEventListener("click",this.FHandleClickPtr),this.FNormalCells.addEventListener("mousedown",this.FHandleMouseDownPtr),this.FNormalCells.addEventListener("mousemove",this.FHandleMouseMovePtr),this.FNormalCells.addEventListener("mouseup",this.FHandleMouseUpPtr),this.FFixedCol.addEventListener("click",this.FHandleFixedClickPtr),this.FFixedRow.addEventListener("click",this.FHandleFixedClickPtr),this.FFixedColRow.addEventListener("click",this.FHandleFixedClickPtr),this.GetElementHandle().appendChild(l),this.FixedColWidth(),t=this.FixedRowHeight(),e=this.NormalColWidth(),i=this.NormalRowHeight(),F=this.GetWidth()-this.FixedColWidth(),c=this.GetHeight()-this.FixedRowHeight(),1===this.FBorderStyle&&(F-=2,c-=2),F-pas["WEBLib.Controls"].GetScrollBarWidth(),p=this.FixedColWidth()+this.NormalColWidth()<this.GetWidth()?c:c-pas["WEBLib.Controls"].GetScrollBarHeight(),-1!==this.FFixedColor&&(m=pas["WEBLib.Graphics"].ColorToHTML(this.FFixedColor)),-1!==this.GetFixedTextColor()&&(f=pas["WEBLib.Graphics"].ColorToHTML(this.GetFixedTextColor())),(C=(y=l.insertRow(0)).insertCell(0)).style.border="0px",(C=y.insertCell(1)).style.border="0px",(C=(y=l.insertRow(1)).insertCell(0)).style.border="0px",(C=y.insertCell(1)).style.border="0px",this.FFixedRows>0){if(d=0,this.FFixedCols>0?(d=1,C=l.rows[0].cells[0],(S=document.createElement("DIV")).style.height=t+"px",S.style.overflow="hidden",S.style.backgroundColor=m,S.style.color=f,C.appendChild(S),S.appendChild(this.FFixedColRow)):((C=l.rows[0].cells[0]).style.border="0px",(C=l.rows[1].cells[0]).style.border="0px"),(C=l.rows[0].cells[1]).style.backgroundColor=m,C.style.color=f,(S=document.createElement("DIV")).style.height=t+"px",r||(S.style.width=F+"px"),S.style.overflow="hidden",S.style.backgroundColor=m,S.style.color=f,C.appendChild(S),(g=document.createElement("DIV")).style.height=t+"px",r||(g.style.width=e+"px"),S.appendChild(g),g.appendChild(this.FFixedRow),this.FFixedCols>0)for(var T=0,E=this.FFixedRows-1;T<=E;T++){h=T,y=this.FFixedColRow.insertRow(h);for(var D=0,b=this.FFixedCols-1;D<=b;D++)u=D,(C=y.insertCell(u)).setAttribute("class","fixed"),this.SetAlignAttr(this.GetColAlignments(u),C)}for(var P=0,L=this.FFixedRows-1;P<=L;P++){h=P,y=this.FFixedRow.insertRow(h);for(var v=this.FFixedCols,B=this.FColCount-1;v<=B;v++)d=(u=v)-this.FFixedCols,(C=y.insertCell(d)).setAttribute("class","fixed"),this.SetAlignAttr(this.GetColAlignments(u),C)}}if(d=0,this.FFixedCols>0){d=1,(C=l.rows[1].cells[0]).style.backgroundColor=m,C.style.color=f,C.setAttribute("class","fixed"),(S=document.createElement("DIV")).style.height=p+"px",S.style.overflow="hidden",S.style.backgroundColor=m,S.style.color=f,C.setAttribute("valign","top"),C.appendChild(S),S.appendChild(this.FFixedCol),this.SetAlignAttr(this.GetColAlignments(0),C);for(var $=this.FFixedRows,G=this.FRowCount-1;$<=G;$++){u=(h=$)-this.FFixedRows,y=this.FFixedCol.insertRow(u);for(var A=0,I=this.FFixedCols-1;A<=I;A++)u=A,(C=y.insertCell(u)).setAttribute("class","fixed"),this.SetAlignAttr(this.GetColAlignments(u),C)}}C=(this.FFixedCols,l.rows[1].cells[1]),s=2===this.FScrollBars||3===this.FScrollBars,n=1===this.FScrollBars||3===this.FScrollBars,(S=document.createElement("DIV")).style.overflowY=s?"auto":"hidden",S.style.overflowX=n?"auto":"hidden",r||(S.style.width=F+"px"),o&&(S.style.overflow=""),S.style.height=c+"px",C.appendChild(S),g=document.createElement("DIV"),r||(g.style.width=e+"px"),g.style.height=i+"px",S.parentElement.style.verticalAlign="top",S.appendChild(g),g.appendChild(this.FNormalCells),S.addEventListener("scroll",rtl.createSafeCallback(this,"HandleScroll"));for(var M=this.FFixedRows,O=this.FRowCount-1;M<=O;M++){d=(h=M)-this.FFixedRows,y=this.FNormalCells.insertRow(d);for(var R=this.FFixedCols,W=this.FColCount-1;R<=W;R++)d=(u=R)-this.FFixedCols,C=y.insertCell(d),this.SetAlignAttr(this.GetColAlignments(u),C)}this.FNormalCells.parentElement.parentElement.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown")),this.FNormalCells.addEventListener("focus",this.FHandleFocusPtr),this.FNormalCells.addEventListener("blur",this.FHandleBlurPtr),this.EnableColResize(),1===this.FDragMode&&this.EnableDrag()}},this.ReRenderGrid=function(){this.GetIsLinked()||null==this.FGrid||null==this.FGrid.firstElementChild||this.FGrid.removeChild(this.FGrid.firstChild),this.FGrid=null,this.RenderGrid(),this.UpdateGridSize(),this.UpdateGridAlignment()},this.RenderGridSize=function(){var t,e=0,i=0,s=0;if(null!=this.FGrid){var n,r;if(this.FixedColWidth(),this.FixedRowHeight(),this.NormalColWidth(),this.NormalRowHeight(),e=this.GetWidth()-this.FixedColWidth(),i=this.GetHeight()-this.FixedRowHeight(),1===this.FBorderStyle&&(e-=2,i-=2),t=e-pas["WEBLib.Controls"].GetScrollBarWidth(),s=this.FixedColWidth()+this.NormalColWidth()<this.GetWidth()?i:i-pas["WEBLib.Controls"].GetScrollBarHeight(),this.FFixedRows>0&&1===this.FWidthStyle)if(null!=(n=this.FGrid.rows[0].cells[1]))(r=n.firstChild).style.width=t+"px",r.style.overflow="hidden";if(this.FFixedCols>0&&1===this.FHeightStyle)if(null!=(n=this.FGrid.rows[1].cells[0]))(r=n.firstChild).style.height=s+"px",r.style.overflow="hidden"}},this.RenderGridScript=function(){this.AddControlScriptSource('var TMSStringGridpageX,TMSStringGridcurCol,TMSStringGridnxtCol,TMSStringGridcurColWidth,TMSStringGridnxtColWidth,TMSStringGridautoWidth,GridNormalCells,GridFixedCells,GridFixedColCells,GridFixedColRows,GridColWidths,GridFixedCols,TMSStringGridCurID;var TMSStringGridTable,TMSStringGridcurTableWidth,TMSStringGridID,TMSStringGridFullWidth,TMSGridLastColSize;TMSStringGridautoWidth = false;TMSStringGridCurID = "";ResizeMainGrid = true;function TMSStringGridupdateColSize(Cells, Col) {    if (Cells){     for (i = 0; i < Cells.rows.length; i++){       td = Cells.rows[i].cells[Col.cellIndex];       td.style.position = "relative";       td.style.width = Col.style.width;       td.style.maxWidth = Col.style.width;      }    }}function TMSStringGridresizeColumn(e) {   if ((TMSStringGridcurCol) && (TMSStringGridCurID.indexOf(TMSStringGridID) == 0)) {    var diffX = e.pageX - TMSStringGridpageX;    newColWidth = (TMSStringGridcurColWidth + diffX);    if (newColWidth < 10)      newColWidth = 10;    if (TMSStringGridCurID.indexOf("ResizeRow") > 0) {\t    TMSStringGridcurCol.style.width = newColWidth + "px";\t    TMSStringGridcurCol.style.maxWidth = TMSStringGridcurCol.style.width;     GridColWidths.Put(TMSStringGridcurCol.cellIndex + GridFixedCols, parseInt(TMSStringGridcurCol.style.width));     TMSStringGridupdateColSize(GridFixedCells, TMSStringGridcurCol);     TMSStringGridupdateColSize(GridNormalCells, TMSStringGridcurCol);     TMSStringGridcurTable.style.width = (TMSStringGridcurTableWidth + diffX) + "px";     GridNormalCells.style.width = (TMSStringGridcurTableWidth + diffX) + "px";    } else {     TMSStringGridfullWidth = document.getElementById(TMSStringGridID).offsetWidth;     newCellsWidth = (TMSStringGridfullWidth - (TMSStringGridcurTableWidth + diffX));     if ((newCellsWidth > 10) && (newColWidth > 10)) {\t     TMSStringGridcurCol.style.width = newColWidth + "px";\t     TMSStringGridcurCol.style.maxWidth = TMSStringGridcurCol.style.width;      TMSStringGridupdateColSize(GridFixedColRows, TMSStringGridcurCol);      TMSStringGridupdateColSize(GridFixedColCells, TMSStringGridcurCol);      GridColWidths.Put(TMSStringGridcurCol.cellIndex, parseInt(TMSStringGridcurCol.style.width));      TMSStringGridcurTable.style.width = (TMSStringGridcurTableWidth + diffX) + "px";      GridFixedColCells.style.width = (TMSStringGridcurTableWidth + diffX) + "px";      if ((!TMSStringGridautoWidth) && (newColWidth > 10)){       GridFixedCells.parentElement.style.width = newCellsWidth + "px";       GridFixedCells.parentElement.parentElement.style.width = newCellsWidth + "px";       GridNormalCells.parentElement.style.width = newCellsWidth + "px";       GridNormalCells.parentElement.parentElement.style.width = newCellsWidth + "px";      }     }    }   } }function TMSStringGridisSizing() {   if ((TMSStringGridcurCol) && (TMSStringGridCurID.indexOf(TMSStringGridID) == 0))   {     if (TMSStringGridCurID.indexOf("ResizeRow") > 0)     {       return(TMSStringGridcurCol.cellIndex + GridFixedCols)     }     else     {      return(TMSStringGridcurCol.cellIndex)     }   }  else  { return -1; }   }function TMSStringGridresetResize() {   TMSStringGridID = "";   TMSStringGridFullWidth = undefined;   TMSStringGridCurID = "";   TMSStringGridcurCol = undefined;   TMSStringGridnxtCol = undefined;   TMSStringGridpageX = undefined;   TMSStringGridnxtColWidth = undefined;   TMSStringGridcurColWidth = undefined;   TMSStringGridautoWidth = false;   GridFixedCells = undefined;   GridFixedColCells = undefined;   GridFixedColRows = undefined;   GridNormalCells = undefined;   GridColWidths = undefined;   GridFixedCols = undefined; } function divmousedown(e) {   TMSStringGridCurID = e.target.id;   TMSStringGridcurCol = e.target.parentElement;   TMSStringGridnxtCol = TMSStringGridcurCol.nextElementSibling;   TMSStringGridpageX = e.pageX;   TMSStringGridcurTable = TMSStringGridcurCol.parentElement.parentElement.parentElement;   TMSStringGridcurTableWidth = TMSStringGridcurTable.offsetWidth;   TMSStringGridcurColWidth = TMSStringGridcurCol.offsetWidth;   if (TMSStringGridnxtCol)    TMSStringGridnxtColWidth = TMSStringGridnxtCol.offsetWidth; }\r\n function divmouseover(e) {   e.target.style.borderRight = "2px solid #0000ff";}\r\n function divmouseout(e) {   e.target.style.borderRight = "";}\r\n function divmouseup(e) {   TMSGridLastColSize = TMSStringGridisSizing();\r\n   TMSStringGridresetResize();}\r\nfunction TMSStringGridresizableGrid(tablename, enabled) { var table = document.getElementById(tablename + "Table"); if (!table) return; var row = table.getElementsByTagName("tr")[0], cols = row ? row.children : undefined; if (!cols) return; for (var i=0;i<cols.length;i++){  var coldiv = document.getElementById(tablename + "Div" + i);  if (coldiv) {    coldiv.removeEventListener("mousedown",divmousedown);    coldiv.removeEventListener("mouseover",divmouseover);    coldiv.removeEventListener("mouseout",divmouseout);    coldiv.removeEventListener("mouseup",divmouseup);    coldiv.remove(); coldiv = null; }  if (enabled) {    var div = createDiv();    cols[i].appendChild(div);    cols[i].style.position = "relative";    div.id = tablename + "Div" + i;    setListeners(div);  } } function setListeners(div){  div.addEventListener("mousedown", divmousedown);  div.addEventListener("mouseover", divmouseover);  div.addEventListener("mouseout", divmouseout);  div.addEventListener("mouseup", divmouseup); } function createDiv(){  var div = document.createElement("div");  div.style.top = 0;  div.style.right = 0;  div.style.width = "10px";  div.style.position = "absolute";  div.style.cursor = "col-resize";  div.style.userSelect = "none";  div.style.height = "100%";  div.innerHTML = "&nbsp;";  return div; }};')},this.UpdateGridSize=function(){var t=0,e=0,i=0,s=0,n=0,r=0,o=0;if(null!=this.GetElementHandle()&&null!=this.FParent&&!this.IsUpdating()&&0!==this.FRowCount&&0!==this.FColCount){for(var a=0,l=this.FFixedCols-1;a<=l;a++){if(t=a,n=this.GetColWidths(t)-0,this.FFixedRows>0&&this.FFixedCols>0)for(e=0;e<this.FFixedColRow.rows.length;e++){if(f=this.FFixedColRow.rows[e])(m=f.cells[t])&&(m.style.width=n+"px",m.style.maxWidth=n+"px")}if(this.FFixedCols>0)for(e=0;e<this.FFixedCol.rows.length;e++){if(f=this.FFixedCol.rows[e])(m=f.cells[t])&&(m.style.width=n+"px",m.style.maxWidth=n+"px")}}for(var h=0,u=this.FFixedRows-1;h<=u;h++){if(t=h,r=this.GetRowHeights(t),this.FFixedCols>0)(f=this.FFixedColRow.rows[t])&&(f.style.height=r+"px");(f=this.FFixedRow.rows[t])&&(f.style.height=r+"px")}for(var d=this.FFixedCols,F=this.FColCount-1;d<=F;d++){if(t=d,n=this.GetColWidths(t)-0,i=t-this.FFixedCols,this.FFixedRows>0)for(t=0;t<this.FFixedRow.rows.length;t++){if(f=this.FFixedRow.rows[t])(m=f.cells[i])&&(m.style.width=n+"px",m.style.maxWidth=n+"px")}if(this.FNormalCells.rows.length>0)if(f=this.FNormalCells.rows[0])(m=f.cells[i])&&(m.style.width=n+"px",m.style.maxWidth=n+"px")}for(var c=this.FFixedRows,p=this.FRowCount-1;c<=p;c++){i=(t=c)-this.FFixedRows,r=this.GetRowHeights(t);for(var C=this.FFixedCols,S=this.FColCount-1;C<=S;C++){var m,f;if(s=(e=C)-this.FFixedCols,n=this.GetColWidths(e)-0,o=r,t===this.FRowCount-1&&this.HasHorzScrollBar()&&this.HasVertScrollBar()&&(o=r+20),this.FFixedCols>0)if((f=this.FFixedCol.rows[i])&&(f.style.height=o+"px"),t===this.FRowCount-1&&this.HasHorzScrollBar()&&this.HasVertScrollBar())(m=this.FFixedCol.rows[i].cells[0])&&m.style.setProperty("vertical-align","top");(f=this.FNormalCells.rows[i])&&(f.style.height=r+"px",(m=f.cells[s])&&(m.style.maxWidth=n+"px"))}}}},this.UpdateGridAlignment=function(){var t=0,e=0,i=0,s=0;if(null!=this.GetElementHandle()&&!this.IsUpdating()&&0!==this.FRowCount&&0!==this.FColCount&&0!==this.FColAlignments.GetCount()){for(var n=0,r=this.FFixedCols-1;n<=r;n++){if(t=n,s=this.GetColAlignments(t),e=t,this.FFixedRows>0&&this.FFixedCols>0)for(e=0;e<this.FFixedColRow.rows.length;e++){if(l=this.FFixedColRow.rows[e])(h=l.cells[t])&&this.SetAlignAttr(s,h)}if(this.FFixedCols>0)for(e=0;e<this.FFixedCol.rows.length;e++){if(l=this.FFixedCol.rows[e])(h=l.cells[t])&&this.SetAlignAttr(s,h)}}for(var o=this.FFixedCols,a=this.FColCount-1;o<=a;o++){if(t=o,s=this.GetColAlignments(t),i=t-this.FFixedCols,e=t,this.FFixedRows>0)for(e=0;e<this.FFixedRow.rows.length;e++){if(l=this.FFixedRow.rows[e])(h=l.cells[i])&&this.SetAlignAttr(s,h)}for(e=0;e<this.FNormalCells.rows.length;e++){var l,h;if(l=this.FNormalCells.rows[e])(h=l.cells[i])&&this.SetAlignAttr(s,h)}}}},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),this.RenderGridScript()},this.Resize=function(){pas["WEBLib.Controls"].TCustomControl.Resize.call(this),this.RenderGridSize()},this.DoEnter=function(){},this.DoExit=function(){},this.GridChanged=function(){t.TCustomGrid.GridChanged.call(this),null!=this.FSelectedCell&&this.RemoveSelection(this.FSelectedCell),this.FSelectedCell=null,this.UpdateGridSize(),this.UpdateGridAlignment()},this.CreateElement=function(){var t;return t=document.createElement("SPAN"),this.FGrid=null,t},this.UpdateElement=function(){var t="";if(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),!this.IsUpdating()&&null!=this.GetElementHandle()){if(16711422!==this.FColor&&-1!==this.FColor&&this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)),null!=this.FGrid&&pas["WEBLib.Controls"].SetHTMLElementFont(this.FGrid,this.FFont,!(""===this.FElementClassName&&0===this.FElementFont)),this.GetElementHandle().style.setProperty("overflow","hidden"),1!==this.FBorderStyle||-1===this.FBorderColor||""!==this.FElementClassName||this.GetIsLinked()?this.GetElementHandle().style.setProperty("border",""):this.GetElementHandle().style.setProperty("border","1px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor)),this.RenderGrid(),t=pas["WEBLib.Graphics"].ColorToHTML(this.FColor),16711422!==this.FColor)null!=this.FNormalCells.tBodies[0]&&this.FNormalCells.tBodies[0].style.setProperty("background-color",t),this.FNormalCells.parentElement.parentElement.style.setProperty("background-color",t);""===this.FOrigID&&(this.FOrigID=this.GetID(),""===this.FOrigID&&(this.FOrigID=this.FName)),this.$class.AddInstanceStyle$1(this.StylePrefix()+this.FOrigID,this.GetGridCSS(this.FOrigID+"tbl")),this.UpdateGridSize(),this.UpdateGridAlignment()}},this.UpdateElementVisual=function(){var t="",e="";pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),this.IsUpdating()||null!=this.GetElementHandle()&&null!=this.FGrid&&(t=pas["WEBLib.Graphics"].ColorToHTML(this.FFixedColor),e=pas["WEBLib.Graphics"].ColorToHTML(this.GetFixedTextColor()),this.FFixedCols>0&&this.FFixedRows>0&&(this.FFixedColRow.parentElement.style.setProperty("background-color",t),this.FFixedColRow.parentElement.style.setProperty("color",e)),this.FFixedCols>0&&(this.FFixedCol.parentElement.style.setProperty("background-color",t),this.FFixedCol.parentElement.style.setProperty("color",e),this.FFixedCol.parentElement.parentElement&&(this.FFixedCol.parentElement.parentElement.style.setProperty("background-color",t),this.FFixedCol.parentElement.parentElement.style.setProperty("color",e))),this.FFixedRows>0&&(this.FFixedRow.parentElement.style.setProperty("background-color",t),this.FFixedRow.parentElement.style.setProperty("color",e),this.FFixedRow.parentElement.parentElement.style.setProperty("background-color",t),this.FFixedRow.parentElement.parentElement.style.setProperty("color",e),this.FFixedRow.parentElement.parentElement.parentElement&&(this.FFixedRow.parentElement.parentElement.parentElement.style.setProperty("background-color",t),this.FFixedRow.parentElement.parentElement.parentElement.style.setProperty("color",e))))},this.FixedColWidth=function(){var t=0,e=0;t=0;for(var i=0,s=this.FFixedCols-1;i<=s;i++)e=i,t=t+this.GetColWidths(e)-0;return t},this.FixedRowHeight=function(){var t=0,e=0;t=0;for(var i=0,s=this.FFixedRows-1;i<=s;i++)e=i,t+=this.GetRowHeights(e);return t},this.NormalColWidth=function(){var t=0,e=0;t=1;for(var i=this.FFixedCols,s=this.FColCount-1;i<=s;i++)e=i,t=t+this.GetColWidths(e)+1-0;return t},this.NormalRowHeight=function(){var t=0,e=0;t=0;for(var i=this.FFixedRows,s=this.FRowCount-1;i<=s;i++)e=i,t+=this.GetRowHeights(e);return t},this.CanSelect=function(t,e){var i=!1;return i=!0,null!=this.FOnSelectCell&&this.FOnSelectCell(this,t,e,{get:function(){return i},set:function(t){i=t}}),i},this.CanRowAdvance=function(){return!0,!0},this.HasSelection=function(){return!(0===this.GetSelection().Left&&0===this.GetSelection().Top&&0===this.GetSelection().Right&&0===this.GetSelection().Bottom)},this.UpdateCell=function(t,e,i){},this.ValidateCell=function(t,e,i){null!=this.FOnValidateEdit&&this.FOnValidateEdit(this,t,e,i)},this.TopLeftChanged=function(){null!=this.FOnTopLeftChanged&&this.FOnTopLeftChanged(this)},this.RowCountChanged=function(t){var e,i,s=this,n=0;function r(t,e){s.SetAlignAttr(s.GetColAlignments(t),e)}if(!(this.IsUpdating()&&0 in this.FComponentState||null==this.FNormalCells)){if(this.FFixedRows,e=this.FFixedCols,i=this.NormalRowHeight(),t>0){var o=0,a=0,l=void 0,h=void 0,u=this.FNormalCells.rows.length;for(this.FNormalCells.parentElement.style.setProperty("height",i+"px"),o=0;o<t;o++){for(l=this.FNormalCells.insertRow(u),a=this.FFixedCols;a<this.FColCount;a++)r(a,h=l.insertCell(0));if(e>0)for(l=this.FFixedCol.insertRow(u),a=0;a<this.FFixedCols;a++)(h=l.insertCell(0)).setAttribute("class","fixed"),r(a,h)}this.BeginUpdate();for(var d=1,F=t;d<=F;d++)n=d,this.SetRowHeights(this.FRowCount-n,this.FDefaultRowHeight);1===this.FDragMode&&this.EnableDrag(),this.EndUpdate()}if(t<0){o=0;if((u=this.FNormalCells.rows.length)>0)for(o=0;o<-t;o++)this.FNormalCells.deleteRow(u-o-1),e>0&&this.FFixedCol.deleteRow(u-o-1);this.FRowCount>0&&this.SetRowHeights(this.FRowCount-1,this.GetRowHeights(this.FRowCount-1))}}},this.ColCountChanged=function(t){var e=0;if(!(this.IsUpdating()&&0 in this.FComponentState||null==this.FNormalCells)){if(t>0){var i,s=0,n=0,r=0,o=void 0,a=void 0,l=void 0,h=this.FNormalCells.rows.length;for(n=0;n<h;n++)for(r=(o=this.FNormalCells.rows[n]).cells.length,s=0;s<t;s++)o.insertCell(r);for(n=0;n<this.FFixedRows;n++)for(r=this.FFixedRow.rows[n].cells.length,s=0;s<t;s++)(a=this.FFixedRow.rows[n].insertCell(r)).setAttribute("class","fixed"),(l=document.createElement("DIV")).style="position:relative;height:100%;width:100%",a.appendChild(l),(i=document.createElement("DIV")).style="position:absolute;height:100%;width:5px;margin-right:-5px;left:100%;top:0px;cursor:w-resize;z-index:999;",l.appendChild(i);for(var u=1,d=t;u<=d;u++)e=u,this.SetColWidths(this.FColCount-e,this.FDefaultColWidth);1===this.FDragMode&&this.EnableDrag()}if(t<0){s=0,n=0,r=0,o=void 0,h=this.FNormalCells.rows.length;for(n=0;n<h;n++)for(r=(o=this.FNormalCells.rows[n]).cells.length,s=0;s<-t;s++)o.deleteCell(r-s-1);if(this.FFixedRows>0)for(r=this.FFixedRow.rows[0].cells.length,s=0;s<-t;s++)this.FFixedRow.rows[0].deleteCell(r-s-1);this.FColCount>0&&this.SetColWidths(this.FColCount-1,this.GetColWidths(this.FColCount-1))}}},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleEditBlurPtr=null,this.FHandleEditKeypressPtr=null,this.FHandleCheckClickPtr=null,this.FHandleButtonClickPtr=null,this.FHandleMouseDownPtr=null,this.FHandleMouseUpPtr=null,this.FHandleMouseMovePtr=null,this.FHandleFixedClickPtr=null,this.FHandleBlurPtr=null,this.FHandleFocusPtr=null,this.FHandleClickPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleEditBlurPtr=rtl.createCallback(this,"HandleEditBlur"),this.FHandleEditKeypressPtr=rtl.createCallback(this,"HandleEditKeyPress"),this.FHandleCheckClickPtr=rtl.createCallback(this,"HandleCheckBoxClick"),this.FHandleButtonClickPtr=rtl.createCallback(this,"HandleButtonClick"),this.FHandleMouseDownPtr=rtl.createCallback(this,"HandleMouseDown"),this.FHandleMouseUpPtr=rtl.createCallback(this,"HandleMouseUp"),this.FHandleMouseMovePtr=rtl.createCallback(this,"HandleMouseMove"),this.FHandleFixedClickPtr=rtl.createCallback(this,"HandleFixedClick"),this.FHandleFocusPtr=rtl.createCallback(this,"HandleTableFocus"),this.FHandleBlurPtr=rtl.createCallback(this,"HandleTableBlur"),this.FHandleClickPtr=rtl.createCallback(this,"HandleClick")},this.StartEdit=function(t){var e,i,s,n=!1;if(this.FEditorMode=!0,this.FWordWrap?this.FEditType=13:this.FEditType=0,this.GetCellEditor(this.GetCol(),this.GetRow(),{p:this,get:function(){return this.p.FEditType},set:function(t){this.p.FEditType=t}}),14!==this.FEditType){if(e=this.GetElementHandle(),this.FEditRow=this.GetRow(),this.FEditCol=this.GetCol(),this.FEditMode=!0,i=this.GetEditText(this.GetCol(),this.GetRow()),this.FOrigVal=i,12===this.FEditType)return null==this.FCombo&&(this.FCombo=pas["WEBLib.StdCtrls"].TWebComboBox.$create("Create$1",[this]),this.FCombo.SetElementPosition(1),this.FCombo.SetWidthStyle(0),this.FCombo.SetWidthPercent(100),this.FCombo.SetHeightStyle(0),this.FCombo.SetHeightPercent(100),this.FCombo.SetParent(this),this.FCombo.FOnExit=rtl.createCallback(this,"HandleComboExit"),this.FCombo.FOnKeyPress=rtl.createCallback(this,"HandleComboKeyPress")),this.FCombo.FItems.Assign(this.FComboBoxItems),this.FCombo.SetText(i),this.FSelectedCell.innerHTML="",this.FSelectedCell.appendChild(this.FCombo.GetElementHandle()),this.FCombo.SetFocus(),void this.RemoveSelection(this.FSelectedCell);if(13===this.FEditType)return null==this.FMemo&&(this.FMemo=pas["WEBLib.StdCtrls"].TWebMemo.$create("Create$1",[this]),this.FMemo.SetElementPosition(1),this.FMemo.SetWidthStyle(0),this.FMemo.SetWidthPercent(100),this.FMemo.SetBorderStyle(0),this.FMemo.SetParent(this),this.FMemo.GetElementHandle().style.setProperty("outline","none"),this.FMemo.FOnExit=rtl.createCallback(this,"HandleMemoExit"),this.FMemo.FOnKeyPress=rtl.createCallback(this,"HandleMemoKeyPress")),this.FMemo.SetHeight(this.GetRowHeights(this.FEditRow)-3),this.FMemo.FLines.SetTextStr(i),this.FSelectedCell.innerHTML="",this.FSelectedCell.style.setProperty("justify-content","top"),this.FSelectedCell.style.setProperty("vertical-align","top"),this.FSelectedCell.appendChild(this.FMemo.GetElementHandle()),this.FMemo.SetFocus(),void this.RemoveSelection(this.FSelectedCell);if(15===this.FEditType)return this.FEditControl.SetElementPosition(1),this.FEditControl.SetWidthStyle(0),this.FEditControl.SetWidthPercent(100),this.FEditControl.SetParent(this),this.FEditControl.FOnExit=rtl.createCallback(this,"DoEditControlExit"),this.SetEditControlValue(this.FEditCol,this.FEditRow,this.FEditControl,i),this.FSelectedCell.innerHTML="",this.FSelectedCell.style.setProperty("justify-content","top"),this.FSelectedCell.style.setProperty("vertical-align","top"),this.FSelectedCell.appendChild(this.FEditControl.GetElementHandle()),void this.RemoveSelection(this.FSelectedCell);if(11===this.FEditType)return null==this.FMask&&(this.FMask=pas["WEBLib.Mask"].TWebMaskEdit.$create("Create$1",[this]),this.FMask.SetElementPosition(1),this.FMask.SetWidthStyle(0),this.FMask.SetWidthPercent(100),this.FMask.SetHeightStyle(0),this.FMask.SetHeightPercent(100),this.FMask.SetParent(this),this.FMask.FOnExit=rtl.createCallback(this,"HandleMaskExit"),this.FMask.FOnKeyPress=rtl.createCallback(this,"HandleMaskKeyPress")),this.FMask.SetEditMask(this.FEditMask),this.FMask.SetText(i),this.FSelectedCell.innerHTML="",this.FSelectedCell.appendChild(this.FMask.GetElementHandle()),this.FMask.SetFocus(),this.FMask.SetSelection(0,i.length),void this.RemoveSelection(this.FSelectedCell);n=!1,null==this.FEdit&&(this.FEdit=document.createElement("INPUT"),this.FEdit.style.setProperty("box-sizing","border-box"),this.FEdit.style.setProperty("-webkit-box-sizing","border-box"),this.FEdit.style.setProperty("-moz-box-sizing","border-box"),this.FEdit.style.setProperty("outline","none"),this.FEdit.style.setProperty("border-style","none"),n=!0),this.FEdit.removeAttribute("type");var r=this.FEditType;8===r?this.FEdit.setAttribute("type","URL"):2===r?this.FEdit.setAttribute("type","DATE"):3===r?this.FEdit.setAttribute("type","TIME"):4===r?(this.FEdit.setAttribute("type","RANGE"),this.FEdit.setAttribute("min",pas["WEBLib.WebTools"].NumAttribute(this.FRange.FMin)),this.FEdit.setAttribute("max",pas["WEBLib.WebTools"].NumAttribute(this.FRange.FMax)),this.FEdit.setAttribute("step",pas["WEBLib.WebTools"].NumAttribute(this.FRange.FStep))):9===r?this.FEdit.setAttribute("type","EMAIL"):1===r?this.FEdit.setAttribute("type","NUMBER"):10===r?this.FEdit.setAttribute("type","TEL"):5===r&&this.FEdit.setAttribute("type","COLOR"),s=0===this.FEditType,this.FEdit.removeAttribute("min"),this.FEdit.removeAttribute("max"),this.FEdit.removeAttribute("step"),this.FEdit.value=""!=t?"":i,this.FEdit.style.width="100%",this.FEdit.style.height="100%",this.FEdit.style.fontFamily=e.style.fontFamily,this.FEdit.style.fontSize=e.style.fontSize,s&&this.FEdit.setSelectionRange(0,this.FEdit.value.length),this.FSelectedCell.innerHTML="",this.FSelectedCell.appendChild(this.FEdit),this.FEdit.focus(),this.RemoveSelection(this.FSelectedCell),n&&(this.FEdit.addEventListener("blur",this.FHandleEditBlurPtr),this.FEdit.addEventListener("keypress",this.FHandleEditKeypressPtr))}},this.StopEdit=function(){var t="",e="",i=null;return this.FEditorMode=!1,t="",this.FEditMode&&(this.FEditMode=!1,12===this.FEditType?(e=this.FCombo.GetText(),i=this.FCombo.GetElementHandle()):11===this.FEditType?(e=this.FMask.GetText(),i=this.FMask.GetElementHandle()):(e=rtl.asExt(this.FEdit,HTMLInputElement).value,i=this.FEdit),this.ValidateCell(this.FEditCol,this.FEditRow,{get:function(){return e},set:function(t){e=t}}),this.FSelectedCell.contains(i)&&this.FSelectedCell.removeChild(i),this.FSelectedCell.innerHTML=e,t=e,this.UpdateCell(this.FEditCol,this.FEditRow,{get:function(){return e},set:function(t){e=t}}),12 in this.FOptions||this.AddSelection(this.FSelectedCell)),t},this.CanEditCell=function(t,e){var i=!1;return i=!0,null!=this.FOnCanEditCell&&this.FOnCanEditCell(this,t,e,{get:function(){return i},set:function(t){i=t}}),i},this.ChangeRow=function(){},this.EnableColResize=function(){var t="",e=!1;4 in this.FComponentState||(t=this.GetID()+"tblResizeRow",e=7 in this.FOptions,TMSStringGridresizableGrid(t,e),t=this.GetID()+"tblResizeFixedRow",e=7 in this.FOptions,TMSStringGridresizableGrid(t,e))},this.EnableDrag=function(){null!=this.GetContainer()&&function t(e){for(var i=0,s=0,n=e.children.length-1;s<=n;s++)i=s,"TD"===e.children.item(i).tagName?(e.children.item(i).setAttribute("draggable","true"),t(e.children.item(i))):t(e.children.item(i))}(this.GetContainer())},this.DisableDrag=function(){null!=this.GetContainer()&&function t(e){for(var i=0,s=0,n=e.children.length-1;s<=n;s++)i=s,"TD"===e.children.item(i).tagName?(e.children.item(i).removeAttribute("draggable"),t(e.children.item(i))):t(e.children.item(i))}(this.GetContainer())},this.InitCSSLibrary=function(t){1===t&&this.SetElementFont(1)},this.Create$1=function(t){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FDrawingStyle=1,this},this.Destroy=function(){var t=0,e=null;rtl.free(this,"FRange"),rtl.free(this,"FColWidths"),rtl.free(this,"FColAlignments"),rtl.free(this,"FRowHeights"),rtl.free(this,"FRows"),rtl.free(this,"FFixedFont");for(var i=0,s=this.FObjectRows.GetCount()-1;i<=s;i++)t=i,e=rtl.getObject(this.FObjectRows.Get(t)),e=rtl.freeLoc(e);this.FObjectRows.Clear(),rtl.free(this,"FObjectRows"),rtl.free(this,"FComboBoxItems"),null!=this.FCombo&&rtl.free(this,"FCombo"),null!=this.FMask&&rtl.free(this,"FMask"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FEditAdvance=!1,this.FColWidths=pas.Classes.TList.$create("Create$1"),this.FRowHeights=pas.Classes.TList.$create("Create$1"),this.FColAlignments=pas.Classes.TList.$create("Create$1"),this.FObjectRows=pas.Classes.TList.$create("Create$1"),this.FRows=pas.Classes.TStringList.$create("Create$1"),this.FRows.FOnChange=rtl.createCallback(this,"RowsChanged"),this.FComboBoxItems=pas.Classes.TStringList.$create("Create$1"),this.FRange=t.TGridRange.$create("Create$1"),this.FHasMergedCells=!1,this.FDefaultColAlignment=0,this.FStartCell.X=-1,this.FStartCell.Y=-1,this.FFixedColor=15790320,this.FRowCount=5,this.FColCount=5,this.FColor=16711422,this.FFixedCols=1,this.FFixedRows=1,this.FDefaultColWidth=64,this.FDefaultRowHeight=22,this.FShowSelection=!0,this.SetElementFont(0),this.SetElementPosition(0),this.FScrollBars=3,this.FGridLineColor=12632256,this.FSelectionColor=16748379,this.FSelectionTextColor=16777215,this.FOptions=rtl.createSet(3,2,4),this.FFixedFont=pas["WEBLib.Graphics"].TFont.$create("Create$1"),this.FFixedFont.FOnChange=rtl.createCallback(this,"FixedFontChanged"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.SetFocus=function(){null!=this.FNormalCells&&this.FNormalCells.focus()},this.ShowEdit=function(){this.StartEdit("")},this.HideEdit=function(t){var e="",i="",s=null,n=0;if(this.FEditMode&&(this.FEditMode=!1,12===this.FEditType?(e=this.FCombo.GetText(),s=this.FCombo.GetElementHandle()):13===this.FEditType?(e=this.FMemo.FLines.GetTextStr(),s=this.FMemo.GetElementHandle()):11===this.FEditType?(e=this.FMask.GetText(),s=this.FMask.GetElementHandle()):15===this.FEditType?(this.GetEditControlValue(this.FEditCol,this.FEditRow,this.FEditControl,{get:function(){return e},set:function(t){e=t}}),s=this.FEditControl.GetElementHandle(),this.FSelectedCell.style.removeProperty("vertical-align")):(e=rtl.asExt(this.FEdit,HTMLInputElement).value,s=this.FEdit),this.ValidateCell(this.FEditCol,this.FEditRow,{get:function(){return e},set:function(t){e=t}}),this.FSelectedCell.contains(s)&&this.FSelectedCell.removeChild(s),i=e,this.FWordWrap&&(n=this.GetRowHeights(this.FEditRow)-2,i='<DIV class="cell" style="height:'+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return n},set:function(t){n=t}})+"px;max-height:"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return n},set:function(t){n=t}})+'px">'+i+"</DIV>"),this.FSelectedCell.innerHTML=i,this.UpdateCell(this.FEditCol,this.FEditRow,{get:function(){return e},set:function(t){e=t}}),12 in this.FOptions||this.AddSelection(this.FSelectedCell),this.SetEditText(this.FEditCol,this.FEditRow,e),this.FBlockFocus=!0,this.FNormalCells.focus(),t)){if(this.RemoveSelection(this.FSelectedCell),this.GetCol()<this.FColCount-1)this.SetCol(this.GetCol()+1);else{if(!this.CanRowAdvance())return;this.GetRow()<this.FRowCount-1?(this.SetCol(this.FFixedCols),this.SetRow(this.GetRow()+1)):(this.SetCol(this.FFixedCols),this.SetRow(this.FFixedRows))}this.CanEditCell(this.GetCol(),this.GetRow())&&this.StartEdit("")}},this.CancelEdit=function(){var t=null;this.FEditMode&&(t=12===this.FEditType?this.FCombo.GetElementHandle():13===this.FEditType?this.FMemo.GetElementHandle():11===this.FEditType?this.FMask.GetElementHandle():this.FEdit,this.FEditMode=!1,this.ValidateCell(this.FEditCol,this.FEditRow,{p:this,get:function(){return this.p.FOrigVal},set:function(t){this.p.FOrigVal=t}}),this.FSelectedCell.contains(t)&&this.FSelectedCell.removeChild(t),this.FSelectedCell.innerHTML=this.FOrigVal,this.UpdateCell(this.FEditCol,this.FEditRow,{p:this,get:function(){return this.p.FOrigVal},set:function(t){this.p.FOrigVal=t}}),12 in this.FOptions||this.AddSelection(this.FSelectedCell),this.SetEditText(this.FEditCol,this.FEditRow,this.FOrigVal),this.FBlockFocus=!0,this.FNormalCells.focus())},this.Clear=function(){for(var t=0,e=0,i=0,s=this.FColCount-1;i<=s;i++){t=i;for(var n=0,r=this.FRowCount-1;n<=r;n++)e=n,this.HasButton(t,e)&&this.RemoveButton(t,e),this.HasCheckBox(t,e)&&this.RemoveCheckBox(t,e),this.SetCells(t,e,"")}},this.Sort=function(t,e){var i,s,n;s=this.FNormalCells,n=1===e,i=t-this.FFixedCols;const r=(t,e)=>t.children[e].innerText||t.children[e].textContent,o=s;Array.from(o.querySelectorAll("tr:nth-child(n+1)")).sort(((t,e)=>(i,s)=>{return n=r(e?i:s,t),o=r(e?s:i,t),""===n||""===o||isNaN(n)||isNaN(o)?n.toString().localeCompare(o):n-o;var n,o})(i,n)).forEach(t=>o.appendChild(t))},this.LoadFromStrings=function(t,e,i){this.FDelimiter=e,this.FLoadFixed=i,this.LoadFromStringList(t)},this.SaveToStrings=function(t,e,i){var s=0,n=0,r=0,o=0,a="",l="";r=0,o=0,i||(o=this.FFixedCols),i||(r=this.FFixedRows);for(var h=r,u=this.FRowCount-1;h<=u;h++){s=h,l="";for(var d=o,F=this.FColCount-1;d<=F;d++)n=d,a=this.GetCells(n,s),a=pas.SysUtils.StringReplace(a,'"','""',rtl.createSet(0)),(pas.System.Pos(e,a)>0||pas.System.Pos("\r",a)>0)&&(a='"'+a+'"'),""===a&&(a='""'),l=""===l?a:l+e+a;t.Add(l)}},this.SelectCell=function(e,i){var s,n;if(this.SetSelection(t.GridRect(e,i,e,i)),s=e-this.FFixedCols,n=i-this.FFixedRows,s>=0&&n>=0){if(this.FNormalCells.rows.length<=0)return this.FSelectedCell=null,void this.UpdateIndicator(this.FFixedRows);this.FSelectedCell=this.FNormalCells.rows[n].cells[s]}else this.FSelectedCell=null},this.RemoveRow=function(t){var e;if(t>=this.FRowCount)throw pas.SysUtils.Exception.$create("Create$1",["Invalid row index"]);e=this.FFixedRows,t<this.FFixedRows?(this.FFixedCols>0&&this.FFixedColRow.deleteRow(t),this.FFixedRow.deleteRow(t)):(this.FFixedCols>0&&this.FFixedCol.deleteRow(t-e),this.FNormalCells.deleteRow(t-e)),this.FRowHeights.GetCount()===this.FRowCount&&this.FRowHeights.Delete(t),this.FRowCount=this.FRowCount-1,this.SetRowHeights(0,this.GetRowHeights(0)),this.UpdateGridSize(),this.UpdateGridAlignment()},this.RemoveColumn=function(t){var e,i=0;if(e=this.FFixedCols,t<this.FFixedCols){if(this.FFixedRows>0)for(var s=0,n=this.FFixedRows-1;s<=n;s++)i=s,this.FFixedColRow.rows[i].deleteCell(t);for(var r=0,o=this.FRowCount-1-this.FFixedRows;r<=o;r++)i=r,this.FFixedCol.rows[i].deleteCell(t);this.FFixedCols=this.FFixedCols-1}else{if(this.FFixedRows>0)for(var a=0,l=this.FFixedRows-1;a<=l;a++)i=a,this.FFixedRow.rows[i].deleteCell(t-e);for(var h=0,u=this.FRowCount-1-this.FFixedRows;h<=u;h++)i=h,this.FNormalCells.rows[i].deleteCell(t-e)}this.FColCount=this.FColCount-1;for(var d=t,F=this.FColCount-1;d<=F;d++)i=d,this.SetColWidths(i,this.GetColWidths(i+1))},this.RemoveCheckBox=function(t,e){var i=null;t<this.FColCount&&e<this.FRowCount&&null!=(i=this.GetCheckElement(t,e))&&(i.removeEventListener("click",this.FHandleCheckClickPtr),i.remove())},this.HasCheckBox=function(t,e){var i=!1;return i=!1,t<this.FColCount&&e<this.FRowCount&&(i=null!=this.GetCheckElement(t,e)),i},this.RemoveButton=function(t,e){var i=null;t<this.FColCount&&e<this.FRowCount&&null!=(i=this.GetButtonElement(t,e))&&(i.removeEventListener("click",this.FHandleCheckClickPtr),i.remove())},this.HasButton=function(t,e){var i=!1;return i=!1,t<this.FColCount&&e<this.FRowCount&&(i=null!=this.GetButtonElement(t,e)),i},this.SelectSortIndicator=function(t,e,i){var s,n=null;s=this.FName+"si"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}})+"_"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return e},set:function(t){rtl.raiseE("EPropReadOnly")}}),null!=(n=document.getElementById(s))&&(i?n.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FSelectionColor)):n.style.removeProperty("color"))},this.SetSortIndicator=function(t,i,s){var n,r=null;n=this.FName+"si"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}})+"_"+pas["WEBLib.Utils"].TLongIntHelper.ToString.call({get:function(){return i},set:function(t){rtl.raiseE("EPropReadOnly")}}),null!=(r=document.getElementById(n))&&(1===s?(r.innerHTML=e.GlyphAscending,r.setAttribute("sort","up")):(r.innerHTML=e.GlyphDescending,r.setAttribute("sort","dn")))},this.HasVertScrollBar=function(){var t=!1;return t=!1,null!=this.FNormalCells.parentElement&&(t=this.FNormalCells.parentElement.parentElement.clientHeight<this.FNormalCells.parentElement.scrollHeight),t},this.HasHorzScrollBar=function(){var t=!1;return t=!1,null!=this.FNormalCells.parentElement&&(t=this.FNormalCells.parentElement.parentElement.clientWidth<this.FNormalCells.parentElement.scrollWidth),t},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addMethod("Create$1",2,[["AOwner",pas.Classes.$rtti.TComponent]]),i.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),i.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),i.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),i.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),i.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),i.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),i.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16711422}),i.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),i.addProperty("DefaultColAlignment",2,pas.Classes.$rtti.TAlignment,"FDefaultColAlignment","SetDefaultColAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),i.addProperty("DefaultColWidth",2,rtl.longint,"FDefaultColWidth","SetDefaultColWidth",{Default:64}),i.addProperty("DefaultRowHeight",2,rtl.longint,"FDefaultRowHeight","SetDefaultRowHeight",{Default:24}),i.addProperty("EditAdvance",0,rtl.boolean,"FEditAdvance","FEditAdvance",{Default:!1}),i.addProperty("EditMask",0,pas["WEBLib.Mask"].$rtti.TEditMask,"FEditMask","FEditMask"),i.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),i.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),i.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),i.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),i.addProperty("ElementTableClassName",2,rtl.string,"FElementTableClassName","SetElementTableClassName"),i.addProperty("FixedRows",2,rtl.longint,"FFixedRows","SetFixedRows",{Default:1}),i.addProperty("FixedCols",2,rtl.longint,"FFixedCols","SetFixedCols",{Default:1}),i.addProperty("FixedColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFixedColor","SetFixedColor",{Default:15790320}),i.addProperty("FixedFont",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFixedFont","SetFixedFont"),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("GridLineColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FGridLineColor","SetGridLineColor",{Default:12632256}),i.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),i.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),i.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),i.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),i.addProperty("Options",0,t.$rtti.TGridOptions,"FOptions","FOptions"),i.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),i.addProperty("ParentBiDiMode",0,rtl.boolean,"FParentBiDiMode","FParentBiDiMode",{Default:!0}),i.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),i.addProperty("RangeEdit",2,t.$rtti.TGridRange,"FRange","SetRange"),i.addProperty("Scrollbars",0,pas["WEBLib.Controls"].$rtti.TScrollStyle,"FScrollBars","FScrollBars",{Default:pas["WEBLib.Controls"].TScrollStyle.ssBoth}),i.addProperty("SelectionColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectionColor","SetSelectionColor",{Default:16748379}),i.addProperty("SelectionTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectionTextColor","SetSelectionTextColor",{Default:16777215}),i.addProperty("ShowSelection",0,rtl.boolean,"FShowSelection","FShowSelection",{Default:!0}),i.addProperty("StyleElements",0,pas["WEBLib.Controls"].$rtti.TStyleElements,"FStyleElements","FStyleElements"),i.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),i.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),i.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),i.addProperty("WordWrap",0,rtl.boolean,"FWordWrap","FWordWrap",{Default:!1}),i.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),i.addProperty("OnClickCell",0,t.$rtti.TCellEvent,"FOnClickCell","FOnClickCell"),i.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),i.addProperty("OnDblClickCell",0,t.$rtti.TCellEvent,"FOnDblClickCell","FOnDblClickCell"),i.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),i.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),i.addProperty("OnMouseWheelDown",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown","FOnMouseWheelDown"),i.addProperty("OnMouseWheelUp",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp","FOnMouseWheelUp"),i.addProperty("OnCanEditCell",0,t.$rtti.TCellCanEditEvent,"FOnCanEditCell","FOnCanEditCell"),i.addProperty("OnColumnSized",0,t.$rtti.TColumnSizedEvent,"FOnColumnSized","FOnColumnSized"),i.addProperty("OnGetCellData",0,t.$rtti.TGridGetCellDataEvent,"FOnGetCellData","FOnGetCellData"),i.addProperty("OnGetCellChildren",0,t.$rtti.TGridGetCellChildrenEvent,"FOnGetCellChildren","FOnGetCellChildren"),i.addProperty("OnGetCellClass",0,t.$rtti.TGridGetCellClassEvent,"FOnGetCellClass","FOnGetCellClass"),i.addProperty("OnGetCellEditor",0,t.$rtti.TGridGetCellEditorEvent,"FOnGetCellEditor","FOnGetCellEditor"),i.addProperty("OnButtonClick",0,t.$rtti.TCellEvent,"FOnButtonClick","FOnButtonClick"),i.addProperty("OnCheckClick",0,t.$rtti.TCellCheckEvent,"FOnCheckClick","FOnCheckClick"),i.addProperty("OnFixedCellClick",0,t.$rtti.TCellEvent,"FOnFixedCellClick","FOnFixedCellClick"),i.addProperty("OnGetEditText",0,t.$rtti.TGetEditEvent,"FOnGetEditText","FOnGetEditText"),i.addProperty("OnSetEditText",0,t.$rtti.TSetEditEvent,"FOnSetEditText","FOnSetEditText"),i.addProperty("OnSetEditControlValue",0,t.$rtti.TSetEditControlValueEvent,"FOnSetEditControlValue","FOnSetEditControlValue"),i.addProperty("OnGetEditControlValue",0,t.$rtti.TGetEditControlValueEvent,"FOnGetEditControlValue","FOnGetEditControlValue"),i.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),i.addProperty("OnSelectCell",0,t.$rtti.TSelectCellEvent,"FOnSelectCell","FOnSelectCell"),i.addProperty("OnSortClick",0,t.$rtti.TGridSortClickEvent,"FOnSortClick","FOnSortClick"),i.addProperty("OnTopLeftChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTopLeftChanged","FOnTopLeftChanged"),i.addProperty("OnValidateEdit",0,t.$rtti.TGetEditEvent,"FOnValidateEdit","FOnValidateEdit"),i.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),i.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),i.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),i.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TStringGrid",this.TCustomStringGrid,(function(){rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("ColCount",2,rtl.longint,"FColCount","SetColCount"),t.addProperty("RowCount",2,rtl.longint,"FRowCount","SetRowCount"),t.addProperty("OnHttpRequestError",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHttpRequestError","FOnHttpRequestError"),t.addProperty("OnHttpRequestSuccess",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHttpRequestSuccess","FOnHttpRequestSuccess")})),this.GridRect=function(e,i,s,n){var r=t.TGridRect.$new();return r.Left=e,r.Top=i,r.Right=s,r.Bottom=n,r},t.$implcode=function(){e.GlyphAscending="&#x25B2;",e.GlyphDescending="&#x25BC;",e.CELLPADDING=0}}),["SysUtils","Math","WEBLib.Utils","WEBLib.WebTools","WEBLib.Forms"]),rtl.module("WEBLib.DBCtrls",["System","Classes","DB","SysUtils","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.ExtCtrls","WEBLib.Grids","WEBLib.Mask","Web","WEBLib.REST","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$inherited("TDataField",rtl.string,{}),this.$rtti.$MethodVar("TDataScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Distance",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TDBDataLink",pas.DB.TDataLink,(function(){this.$init=function(){pas.DB.TDataLink.$init.call(this),this.FOnActiveChange=null,this.FOnDataChange=null,this.FOnRecordChange=null,this.FOnUpdateData=null,this.FOnDataScroll=null},this.$final=function(){this.FOnActiveChange=void 0,this.FOnDataChange=void 0,this.FOnRecordChange=void 0,this.FOnUpdateData=void 0,this.FOnDataScroll=void 0,pas.DB.TDataLink.$final.call(this)},this.DataSetChanged=function(){pas.DB.TDataLink.DataSetChanged.call(this),null!=this.FOnDataChange&&this.FOnDataChange(this)},this.ActiveChanged=function(){pas.DB.TDataLink.ActiveChanged.call(this),null!=this.FOnActiveChange&&this.FOnActiveChange(this)},this.RecordChanged=function(t){pas.DB.TDataLink.RecordChanged.apply(this,arguments),null!=this.FOnRecordChange&&this.FOnRecordChange(this)},this.DataSetScrolled=function(t){pas.DB.TDataLink.DataSetScrolled.apply(this,arguments),null!=this.FOnDataScroll&&this.FOnDataScroll(this,t)},this.UpdateData=function(){pas.DB.TDataLink.UpdateData.call(this),null!=this.FOnUpdateData&&this.FOnUpdateData(this)};var e=this.$rtti;e.addProperty("OnRecordChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnRecordChange","FOnRecordChange"),e.addProperty("OnDataChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDataChange","FOnDataChange"),e.addProperty("OnDataScroll",0,t.$rtti.TDataScrollEvent,"FOnDataScroll","FOnDataScroll"),e.addProperty("OnActiveChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnActiveChange","FOnActiveChange"),e.addProperty("OnUpdateData",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnUpdateData","FOnUpdateData")})),this.TColumnDataType={0:"cdText",cdText:0,1:"cdImage",cdImage:1,2:"cdLink",cdLink:2,3:"cdCheck",cdCheck:3,4:"cdRadio",cdRadio:4,5:"cdExternalLink",cdExternalLink:5,6:"cdMemo",cdMemo:6},this.$rtti.$Enum("TColumnDataType",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TColumnDataType}),rtl.createClass(this,"TGridColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FDataField="",this.FTitle="",this.FWidth=0,this.FDataType=0,this.FClassName$1="",this.FTitleClassName="",this.FSortIndicator=0,this.FEditor=0,this.FEditMask="",this.FComboBoxItems=null,this.FTag=0,this.FDBField=null,this.FImageWidth=0,this.FAlignment=0,this.FAutoFormatDateTime=!1},this.$final=function(){this.FComboBoxItems=void 0,this.FDBField=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetDataField=function(e){this.FDataField!==e&&(this.FDataField=e,rtl.as(this.FCollection,t.TGridColumns).Update(this),this.FDBField=null)},this.SetTitle=function(e){this.FTitle!==e&&(this.FTitle=e,rtl.as(this.FCollection,t.TGridColumns).Update(this))},this.SetWidth=function(e){this.FWidth!==e&&(this.FWidth=e,rtl.as(this.FCollection,t.TGridColumns).Update(this))},this.SetComboBoxItems=function(t){this.FComboBoxItems=t},this.SetAlignment=function(e){var i=null;this.FAlignment=e,(i=rtl.as(this.FCollection,t.TGridColumns).Owner()).SetColAlignments(this.GetIndex()+i.FFixedCols,this.FAlignment)},this.GetDBField=function(){var e=null;if(""!==this.FDataField&&null===this.FDBField&&null!=(e=rtl.as(this.FCollection,t.TGridColumns).Owner())&&null!=e.GetDataSource()&&null!=e.GetDataSource().FDataSet)try{this.FDBField=e.GetDataSource().FDataSet.FieldByName(this.FDataField)}catch(t){this.FDBField=null}return this.FDBField},this.Assign=function(e){t.TGridColumn.isPrototypeOf(e)&&(this.FClassName$1=rtl.as(e,t.TGridColumn).FClassName$1,this.FDataField=rtl.as(e,t.TGridColumn).FDataField,this.FTitle=rtl.as(e,t.TGridColumn).FTitle,this.FTitleClassName=rtl.as(e,t.TGridColumn).FTitleClassName,this.FDataType=rtl.as(e,t.TGridColumn).FDataType,this.FWidth=rtl.as(e,t.TGridColumn).FWidth,this.FEditor=rtl.as(e,t.TGridColumn).FEditor,this.FEditMask=rtl.as(e,t.TGridColumn).FEditMask,this.FComboBoxItems.Assign(rtl.as(e,t.TGridColumn).FComboBoxItems),this.FTag=rtl.as(e,t.TGridColumn).FTag,this.FDBField=rtl.as(e,t.TGridColumn).FDBField,this.FImageWidth=rtl.as(e,t.TGridColumn).FImageWidth,this.FAlignment=rtl.as(e,t.TGridColumn).FAlignment,this.FAutoFormatDateTime=rtl.as(e,t.TGridColumn).FAutoFormatDateTime)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FWidth=64,this.FDataType=0,this.FComboBoxItems=pas.Classes.TStringList.$create("Create$1"),this.FAutoFormatDateTime=!0,this},this.Destroy=function(){rtl.free(this,"FComboBoxItems"),pas.Classes.TCollectionItem.Destroy.call(this)};var e=this.$rtti;e.addMethod("Create$1",2,[["Collection",pas.Classes.$rtti.TCollection]]),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("AutoFormatDateTime",0,rtl.boolean,"FAutoFormatDateTime","FAutoFormatDateTime",{Default:!0}),e.addProperty("ComboBoxItems",2,pas.Classes.$rtti.TStrings,"FComboBoxItems","SetComboBoxItems"),e.addProperty("DataField",2,t.$rtti.TDataField,"FDataField","SetDataField"),e.addProperty("DataType",0,t.$rtti.TColumnDataType,"FDataType","FDataType"),e.addProperty("EditMask",0,pas["WEBLib.Mask"].$rtti.TEditMask,"FEditMask","FEditMask"),e.addProperty("Editor",0,pas["WEBLib.Grids"].$rtti.TGridCellEditor,"FEditor","FEditor",{Default:pas["WEBLib.Grids"].TGridCellEditor.geText}),e.addProperty("ElementClassName",0,rtl.string,"FClassName$1","FClassName$1"),e.addProperty("ImageWidth",0,rtl.longint,"FImageWidth","FImageWidth",{Default:0}),e.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default:0}),e.addProperty("Title",2,rtl.string,"FTitle","SetTitle"),e.addProperty("TitleElementClassName",0,rtl.string,"FTitleClassName","FTitleClassName"),e.addProperty("Width",2,rtl.longint,"FWidth","SetWidth",{Default:64})})),rtl.createClass(this,"TGridColumns",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null,this.FOnSortIndicatorChange=null},this.$final=function(){this.FOnChange=void 0,this.FOnSortIndicatorChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Changed$1=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),this.Changed$1()},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TGridColumn),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.$rtti.addMethod("Create$3",2,[["AOwner",pas.Classes.$rtti.TComponent]])})),rtl.createClass(this,"TDBGrid",pas["WEBLib.Grids"].TCustomStringGrid,(function(){this.$init=function(){pas["WEBLib.Grids"].TCustomStringGrid.$init.call(this),this.FDefaultFields=!1,this.FModifying=!1,this.FDataLink=null,this.FColumns=null,this.FDataChanging=!1,this.FOldState=0,this.FOldFiltered=!1,this.FOldIndicator=0,this.FShowIndicator=!1},this.$final=function(){this.FDataLink=void 0,this.FColumns=void 0,pas["WEBLib.Grids"].TCustomStringGrid.$final.call(this)},this.GetDataSource=function(){return this.FDataLink.FDataSource},this.SetColumns=function(t){this.FColumns.Assign(t)},this.SetDataSource=function(t){this.FDataLink.SetDataSource(t)},this.SetShowIndicator=function(t){this.FShowIndicator=t,this.UpdateIndicator(this.GetRow())},this.LoadData=function(){var t,e,i,s=0,n=0,r=0,o=0,a=pas.DB.TBookmark.$new(),l=!1,h="",u="",d="",F=null,c=null,p=null;l=!0,n=0;for(var C=0,S=this.FColumns.GetCount()-1;C<=S;C++)r=C,""!==this.FColumns.GetItem$1(r).FDataField&&(l=!1);if(this.FDefaultFields=l,l&&this.FColumns.GetCount()>0){this.FColumns.BeginUpdate();for(var m=0,f=this.FDataLink.GetDataset().GetfieldCount()-1;m<=f;m++)r=m,0===this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldKind&&0 in this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldDef.FAttributes||this.FDataLink.GetDataset().FFieldList.GetField(r).FVisible&&(r>=this.FColumns.GetCount()&&this.FColumns.Add$1(),this.FColumns.GetItem$1(r).FDataField=this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldName,this.FColumns.GetItem$1(r).FTitle=this.FDataLink.GetDataset().FFieldList.GetField(r).GetDisplayName(),2===this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldKind&&(this.FColumns.GetItem$1(r).FEditor=12,this.LoadComboItems(r,this.FDataLink.GetDataset().FFieldList.GetField(r))),this.FDataLink.GetDataset().FFieldList.GetField(r).FDataType in rtl.createSet(9,11)&&(this.FColumns.GetItem$1(r).FEditor=2),this.FDataLink.GetDataset().FFieldList.GetField(r).FDataType in rtl.createSet(16)&&(this.FColumns.GetItem$1(r).FEditor=13),this.FDataLink.GetDataset().FFieldList.GetField(r).FDataType in rtl.createSet(5)&&(this.FColumns.GetItem$1(r).FDataType=3));for(;this.FColumns.GetCount()>this.FDataLink.GetDataset().GetfieldCount();)this.FColumns.Delete(this.FColumns.GetCount()-1)}if(0===this.FColumns.GetCount()){for(var y=0,g=this.FDataLink.GetDataset().GetfieldCount()-1;y<=g;y++)r=y,0 in this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldDef.FAttributes||((p=this.FColumns.Add$1()).FDataField=this.FDataLink.GetDataset().FFieldList.GetField(r).FFieldName,p.FTitle=this.FDataLink.GetDataset().FFieldList.GetField(r).GetDisplayName());this.FColumns.EndUpdate()}if(this.SetColCount(this.FColumns.GetCount()+this.FFixedCols),this.SetRowCount(this.FDataLink.FDataSource.FDataSet.GetRecordCount()+this.FFixedRows),this.RenderGrid(),t=this.FDataLink.GetDataset().GetBOF(),e=this.FDataLink.GetDataset().GetEOF(),this.FDataLink.FDataSource.FDataSet.DisableControls(),a.$assign(this.FDataLink.GetDataset().GetBookmark()),i=this.FDataLink.GetDataset().FAfterScroll,this.FDataLink.GetDataset().FAfterScroll=null,this.FDataLink.FDataSource.FDataSet.First(),this.FFixedRows>0)for(var T=0,E=this.FColumns.GetCount()-1;T<=E;T++){s=T,h=this.FColumns.GetItem$1(s).FTitle;var D=this.FColumns.GetItem$1(s).FSortIndicator;if(1===D?h+="&nbsp;&#x25B2;":2===D&&(h+="&nbsp;&#x25BC"),this.SetCells(s+this.FFixedCols,n,h),""!==this.FColumns.GetItem$1(s).FTitleClassName&&null!=(c=this.GetDirectCellElements(s+this.FFixedCols,0))){d=this.FColumns.GetItem$1(s).FTitleClassName;do{(o=pas.System.Pos(" ",d))>0?(c.classList.add(pas.System.Copy(d,1,o-1)),pas.System.Delete({get:function(){return d},set:function(t){d=t}},1,o)):c.classList.add(d)}while(0!==o)}F=this.FColumns.GetItem$1(s).GetDBField(),c=this.GetDirectCellElements(s+this.FFixedCols,0),this.GetCellChildren(s+this.FFixedCols,0,F,h,c),this.BindCellChildren(s+this.FFixedCols,0,c),u=this.FColumns.GetItem$1(s).FTitleClassName,this.GetCellClassName(s+this.FFixedCols,0,F,h,{get:function(){return u},set:function(t){u=t}}),null!=c&&""!==u&&c.setAttribute("class",u)}for(n=this.FFixedRows;!this.FDataLink.FDataSource.FDataSet.GetEOF();)this.LoadRow(n),n+=1,this.FDataLink.FDataSource.FDataSet.Next();this.FDataLink.FDataSource.FDataSet.FFiltered&&this.SetRowCount(n),this.GetDataSource().FDataSet.BookmarkValid(pas.DB.TBookmark.$clone(a))&&this.FDataLink.FDataSource.FDataSet.GotoBookmark(a),t&&this.FDataLink.FDataSource.FDataSet.First(),e&&this.FDataLink.FDataSource.FDataSet.Last(),this.FDataLink.GetDataset().FAfterScroll=i,this.FDataLink.FDataSource.FDataSet.EnableControls()},this.LoadRow=function(t){var i,s=0,n=null,r="",o="",a=null;if(!(t<this.FFixedRows)){i=t;for(var l=0,h=this.FColumns.GetCount()-1;l<=h;l++)s=l,this.FEditMode&&s===this.GetCol()-this.FFixedCols&&t===this.GetRow()||(r="",a=this.GetDirectCellElements(s+this.FFixedCols,i),this.UnBindCellChildren(s,i,a),null!=(n=this.FColumns.GetItem$1(s).GetDBField())&&(r=e.FieldToCellData(a,n,this.FColumns.GetItem$1(s),10 in this.FOptions)),this.GetCellData(s,i,n,{get:function(){return r},set:function(t){r=t}}),this.SetCells(s+this.FFixedCols,i,r),o=this.FColumns.GetItem$1(s).FClassName$1,this.GetCellChildren(s,i,n,r,a),this.BindCellChildren(s,i,a),this.GetCellClassName(s,i,n,r,{get:function(){return o},set:function(t){o=t}}),""!==o&&a.setAttribute("class",o))}},this.InsertData=function(t){for(var e=0,i=0,s=this.FRowCount-1,n=t+1;s>=n;s--){e=s;for(var r=0,o=this.FColCount-1;r<=o;r++)0===(i=r)&&this.FFixedCols>0?this.SetCells(i,e,"&nbsp;"):this.SetCells(i,e,this.GetCells(i,e-1))}this.LoadRow(t)},this.DataChange=function(t){var e=0,i=0,s=0,n=!1;if(!this.FDataChanging){if(this.FOldState!==this.FDataLink.FDataSource.FDataSet.FState&&!this.FModifying){if(this.FEditMode&&this.FOldState in rtl.createSet(2,3)&&this.StopEdit(),this.FOldState in rtl.createSet(0)&&1===this.FDataLink.FDataSource.FDataSet.FState)return this.FDataChanging=!0,this.LoadData(),this.FDataChanging=!1,this.FOldState=this.FDataLink.FDataSource.FDataSet.FState,void(this.FOldIndicator=0);if(this.FOldState in rtl.createSet(3))return this.FDataChanging=!0,this.LoadData(),this.FDataChanging=!1,this.FOldState=this.FDataLink.FDataSource.FDataSet.FState,void(this.FOldIndicator=0)}if(this.FOldState in rtl.createSet(1)&&1===this.FDataLink.FDataSource.FDataSet.FState)return this.FDataChanging=!0,this.LoadData(),this.FDataChanging=!1,void(this.FOldState=this.FDataLink.FDataSource.FDataSet.FState);this.FOldState=this.FDataLink.FDataSource.FDataSet.FState,this.FOldState in rtl.createSet(2)||(this.FDataChanging=!0,null==this.FDataLink.FDataSource||null==this.FDataLink.FDataSource.FDataSet||!this.FDataLink.FDataSource.FDataSet.GetActive()||this.FModifying||this.FEditMode||(n=this.FOldFiltered!==this.FDataLink.FDataSource.FDataSet.FFiltered,this.FRowCount!==this.FDataLink.FDataSource.FDataSet.GetRecordCount()+this.FFixedRows||n?(this.FOldFiltered=this.FDataLink.FDataSource.FDataSet.FFiltered,this.FModifying=!0,i=this.GetRow(),s=this.GetCol(),this.FDataChanging=!0,this.LoadData(),this.FDataChanging=!1,n&&(this.FDataLink.FDataSource.FDataSet.First(),this.FRowCount>this.FFixedRows&&this.SetRow(this.FFixedRows)),this.FModifying=!1,this.SelectCell(s,i)):(e=this.FFixedRows+this.FDataLink.FDataSource.FDataSet.GetRecNo()-1,3===this.FOldState?(s=this.GetCol(),this.SetRowCount(this.FRowCount+1),this.SetRow(Math.max(e,this.FFixedRows)),this.SetCol(s),!this.FDataLink.GetBOF()&&this.FDataLink.GetEOF()||this.InsertData(this.GetRow())):(1===this.FOldState&&1===this.FDataLink.FDataSource.FDataSet.FState||this.LoadData(),this.SetRow(e)),this.UpdateIndicator(e))),this.FDataChanging=!1)}},this.DataScroll=function(t,e){null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.FFiltered&&(this.SetRow(this.GetRow()+e),this.UpdateIndicator(this.GetRow()))},this.RecordChange=function(t){var e=0;null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()&&(this.FModifying||this.FEditMode?this.FEditMode&&this.LoadRow(this.GetRow()):(this.FDataLink.FDataSource.FDataSet.FFiltered||(e=this.FFixedRows+this.FDataLink.FDataSource.FDataSet.GetRecNo()-1),this.FOldState=8,3===this.FDataLink.FDataSource.FDataSet.FState||(e<=this.FRowCount-1&&!this.FDataLink.FDataSource.FDataSet.FFiltered?(this.SetRow(e),this.LoadRow(e)):(this.FModifying=!0,this.LoadData(),this.FDataLink.FDataSource.FDataSet.FFiltered||this.SetRow(e),this.FModifying=!1)),this.FDataLink.FDataSource.FDataSet.FFiltered||this.UpdateIndicator(e)))},this.ActiveChange=function(t){var e=0;if(null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive())this.FDataChanging=!0,this.LoadData(),this.FDataChanging=!1;else{this.Clear(),this.SetRowCount(this.FFixedRows),this.FDefaultFields&&this.FColumns.Clear();for(var i=0,s=this.FColumns.GetCount()-1;i<=s;i++)e=i,this.FColumns.GetItem$1(e).FDBField=null;this.FOldIndicator=-1}},this.ColumnsChanged=function(t){var e=0;if(null!=this.GetElementHandle()&&!this.IsUpdating()&&(this.SetColCount(this.FColumns.GetCount()+this.FFixedCols),this.FFixedRows>0&&this.FRowCount>0))for(var i=0,s=this.FColumns.GetCount()-1;i<=s;i++)e=i,this.SetCells(e+this.FFixedCols,0,this.FColumns.GetItem$1(e).FTitle),this.SetColWidths(e+this.FFixedCols,this.FColumns.GetItem$1(e).FWidth)},this.UpdateData=function(t){3===this.FDataLink.FDataSource.FDataSet.FState&&this.HideEdit(!1)},this.UpdateCell=function(t,e,i){var s="",n="",r=!1,o=null;if(pas["WEBLib.Grids"].TCustomStringGrid.UpdateCell.apply(this,arguments),null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()&&(r=this.FDataLink.FDataSource.FDataSet.FState in pas.DB.dsEditModes,""!==(s=this.FColumns.GetItem$1(t-this.FFixedCols).FDataField))){r||this.FDataLink.FDataSource.FDataSet.Edit(),o=null;try{null!=(o=this.FDataLink.FDataSource.FDataSet.FieldByName(s))&&(2===o.FFieldKind?(n=this.GetLookupKey(t-this.FFixedCols,i.get()),this.FDataLink.FDataSource.FDataSet.FieldByName(o.FKeyFields).SetAsString(n)):1!==o.FFieldKind&&(o.FDataType in rtl.createSet(9,11)?o.SetAsDateTime(pas["WEBLib.WebTools"].PickerDateToDate(i.get())):o.GetAsString()!==i.get()&&o.SetAsString(i.get())))}catch(t){o=null}}},this.SelectCell=function(t,e){var i=0;if(i=this.GetRow(),pas["WEBLib.Grids"].TCustomStringGrid.SelectCell.apply(this,arguments),null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()){if(e===i||i<0)return;this.FModifying=!0,0!==this.FDataLink.MoveBy(e-i)?this.UpdateIndicator(e):(this.LoadRow(i),this.UpdateIndicator(i),this.SetRow(i)),this.FModifying=!1}},this.ChangeRow=function(){pas["WEBLib.Grids"].TCustomStringGrid.ChangeRow.call(this)},this.UpdateIndicator=function(t){var e="";0!==this.FFixedCols&&(this.FOldIndicator===t&&this.FShowIndicator||this.FOldIndicator>=0&&this.FOldIndicator<this.FRowCount&&this.SetCells(0,this.FOldIndicator,""),this.FShowIndicator&&null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()&&t>=this.FFixedRows&&(e=this.FEditMode||2===this.FDataLink.FDataSource.FDataSet.FState?"&#x270E;":3===this.FDataLink.FDataSource.FDataSet.FState?"&brvbar":"&#x25B6;",this.SetCells(0,t,"&nbsp;"+e)),this.FOldIndicator=t)},this.DoCheckClick=function(t,e,i){var s=!1,n="",r=null;if(pas["WEBLib.Grids"].TCustomStringGrid.DoCheckClick.apply(this,arguments),this.SelectCell(t,e),null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()&&10 in this.FOptions&&(s=this.FDataLink.FDataSource.FDataSet.FState in pas.DB.dsEditModes,""!==(n=this.FColumns.GetItem$1(t-this.FFixedCols).FDataField))){r=null;try{(r=this.FDataLink.FDataSource.FDataSet.FieldByName(n)).FReadOnly||(s||this.FDataLink.FDataSource.FDataSet.Edit(),r.SetAsBoolean(i))}catch(t){r=null}}},this.DoSortIndicatorChange=function(t,e,i){var s="";s=this.FColumns.GetItem$1(e).FTitle;1===i?s+="&nbsp;&#x25B2;":2===i&&(s+="&nbsp;&#x25BC;"),this.SetCells(e+this.FFixedCols,0,s)},this.StopEdit=function(){var t;return t=pas["WEBLib.Grids"].TCustomStringGrid.StopEdit.call(this),this.UpdateIndicator(this.GetRow()),t},this.CancelEdit=function(){pas["WEBLib.Grids"].TCustomStringGrid.CancelEdit.call(this),null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive()&&this.FDataLink.FDataSource.FDataSet.Cancel()},this.StartEdit=function(t){var e=null;if(!(this.GetCol()>0&&this.GetCol()<=this.FColumns.GetCount()&&this.FColumns.GetItem$1(this.GetCol()-1).FDataType in rtl.createSet(3,4))){if(12===this.FColumns.GetItem$1(this.GetCol()-this.FFixedCols).FEditor&&null!=this.GetDataSource()&&null!=this.GetDataSource().FDataSet&&this.GetDataSource().FDataSet.GetActive()&&""!==this.FColumns.GetItem$1(this.GetCol()-this.FFixedCols).FDataField){try{e=this.GetDataSource().FDataSet.FieldByName(this.FColumns.GetItem$1(this.GetCol()-this.FFixedCols).FDataField)}catch(t){e=null}null!=e&&this.LoadComboItems(this.GetCol()-this.FFixedCols,e)}pas["WEBLib.Grids"].TCustomStringGrid.StartEdit.call(this,t),this.UpdateIndicator(this.GetRow())}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.ColumnsChanged(this)},this.CanEditCell=function(t,e){var i=!1,s=null;return(i=pas["WEBLib.Grids"].TCustomStringGrid.CanEditCell.apply(this,arguments))&&t-this.FFixedCols<this.FColumns.GetCount()&&t>=this.FFixedCols&&null!=(s=this.FColumns.GetItem$1(t-this.FFixedCols).FDBField)&&s.FReadOnly&&(i=!1),i},this.CanRowAdvance=function(){return!1,!1},this.GetCellEditor=function(t,e,i){t-this.FFixedCols<this.FColumns.GetCount()&&t>=this.FFixedCols&&(i.set(this.FColumns.GetItem$1(t-this.FFixedCols).FEditor),this.FComboBoxItems.Assign(this.FColumns.GetItem$1(t-this.FFixedCols).FComboBoxItems),this.FEditMask=this.FColumns.GetItem$1(t-this.FFixedCols).FEditMask),pas["WEBLib.Grids"].TCustomStringGrid.GetCellEditor.apply(this,arguments)},this.LoadComboItems=function(t,e){var i="",s="",n=pas.DB.TBookmark.$new();if(2===e.FFieldKind){for(n.$assign(e.FLookupDataSet.GetBookmark()),e.FLookupDataSet.DisableControls(),e.FLookupDataSet.First(),this.FColumns.GetItem$1(t).FComboBoxItems.Clear();!e.FLookupDataSet.GetEOF();)i=e.FLookupDataSet.FieldByName(e.FLookupresultField).GetAsString(),s=e.FLookupDataSet.FieldByName(e.FLookupKeyfields).GetAsString(),this.FColumns.GetItem$1(t).FComboBoxItems.AddPair(i,s),e.FLookupDataSet.Next();e.FLookupDataSet.GotoBookmark(n),e.FLookupDataSet.EnableControls()}},this.GetLookupKey=function(t,e){var i="",s=0,n="",r="";i="";for(var o=0,a=this.FColumns.GetItem$1(t).FComboBoxItems.GetCount()-1;o<=a;o++)if(s=o,this.FColumns.GetItem$1(t).FComboBoxItems.GetNameValue(s,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n===e){i=r;break}return i},this.CreateInitialize=function(){pas["WEBLib.Grids"].TCustomStringGrid.CreateInitialize.call(this),null==this.FDataLink&&(this.FDataLink=t.TDBDataLink.$create("Create$1"),this.FDataLink.FOnActiveChange=rtl.createCallback(this,"ActiveChange"),this.FDataLink.FOnRecordChange=rtl.createCallback(this,"RecordChange"),this.FDataLink.FOnDataChange=rtl.createCallback(this,"DataChange"),this.FDataLink.FOnUpdateData=rtl.createCallback(this,"UpdateData"),this.FDataLink.FOnDataScroll=rtl.createCallback(this,"DataScroll")),null==this.FColumns&&(this.FColumns=t.TGridColumns.$create("Create$3",[this]),this.FColumns.FOnChange=rtl.createCallback(this,"ColumnsChanged"),this.FColumns.FOnSortIndicatorChange=rtl.createCallback(this,"DoSortIndicatorChange"),this.FColumns.FPropName="Columns"),this.FModifying=!1,this.FDefaultFields=!1,this.FDataChanging=!1,this.FOldIndicator=-1,this.FShowIndicator=!0},this.Destroy=function(){rtl.free(this,"FDataLink"),rtl.free(this,"FColumns"),pas["WEBLib.Grids"].TCustomStringGrid.Destroy.call(this)},this.Refresh=function(){this.LoadData()},this.HideEdit=function(t){pas["WEBLib.Grids"].TCustomStringGrid.HideEdit.apply(this,arguments),this.UpdateIndicator(this.GetRow())},this.ShowEdit=function(){var t="",e=null;if(null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&this.FDataLink.FDataSource.FDataSet.GetActive())if(""!==(t=this.FColumns.GetItem$1(this.GetCol()-this.FFixedCols).FDataField)){e=null;try{e=this.FDataLink.FDataSource.FDataSet.FieldByName(t)}catch(t){e=null}null==e||e.FReadOnly||(this.FDataLink.FDataSource.FDataSet.Edit(),pas["WEBLib.Grids"].TCustomStringGrid.ShowEdit.call(this))}else pas["WEBLib.Grids"].TCustomStringGrid.ShowEdit.call(this)},this.EndUpdate=function(){this.ColumnsChanged(this),pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),i.addProperty("Columns",2,t.$rtti.TGridColumns,"FColumns","SetColumns"),i.addProperty("DataSource",3,pas.DB.$rtti.TDataSource,"GetDataSource","SetDataSource"),i.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),i.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),i.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),i.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),i.addProperty("FixedFont",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFixedFont","SetFixedFont"),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),i.addProperty("ShowIndicator",2,rtl.boolean,"FShowIndicator","SetShowIndicator"),i.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),i.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),i.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),i.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),t.$implcode=function(){e.TableFieldToCellData=function(t,e,i,s,n,r){var o="",a="",l="",h="",u="",d=0;o="";var F=i;if(0===F||6===F)if(15!==e.FDataType&&pas["WEBLib.REST"].TRESTClient.IsIsoDateTime(e.GetAsString())&&n)d=pas["WEBLib.REST"].TRESTClient.IsoToDateTime(e.GetAsString()),o=0===pas.System.Frac(d)?pas.SysUtils.DateToStr(d):0===pas.System.Int(d)?pas.SysUtils.TimeToStr(d):pas.SysUtils.DateToStr(d)+"  "+pas.SysUtils.TimeToStr(d);else if(6===i)try{o=window.atob(""+e.GetAsJSValue())}catch(t){o=e.GetDisplayText()}else e.FDataType in rtl.createSet(9,11)&&""===rtl.as(e,pas.DB.TDateTimeField).FDisplayFormat?(d=e.GetAsDateTime(),o=0===pas.System.Frac(d)?pas.SysUtils.FormatDateTime("YYYY-MM-dd",d):pas.SysUtils.FormatDateTime("YYYY-MM-dd hh:mm:ss",d)):o=e.GetDisplayText();else 1===F?""!==(u=e.GetDisplayText())&&(o=r>0?'<IMG src="'+u+'" width="'+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return r},set:function(t){r=t}})+'">':'<IMG src="'+u+'">'):2===F?o='<A href="'+e.GetDisplayText()+'">'+e.GetDisplayText()+"</A>":5===F?o='<A href="'+e.GetDisplayText()+'" target="_blank">'+e.GetDisplayText()+"</A>":3!==F&&4!==F||(l=3===i?"CHECKBOX":"RADIO",h=s?"":" DISABLED",o=(5===e.FDataType?e.GetAsBoolean():"y"===(a=pas.SysUtils.LowerCase(e.GetAsString()))||"true"===a||"1"===a)?'<INPUT TYPE="'+l+'" CHECKED'+h+">":'<INPUT TYPE="'+l+'"'+h+">");return o},e.FieldToCellData=function(t,i,s,n){return e.TableFieldToCellData(t,i,s.FDataType,n,s.FAutoFormatDateTime,s.FImageWidth)}}}),["WEBLib.WebTools","Math"]),rtl.module("WEBLib.WebCtrls",["System","Classes","WEBLib.Controls","WEBLib.Graphics","SysUtils","Web","JS","WEBLib.Menus"],(function(){"use strict";rtl.createClass(this,"THTMLDiv",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FHTML=null,this.FOldText=""},this.$final=function(){this.FHTML=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetHTML=function(t){this.FHTML.Assign(t)},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementHandle()?(""===this.FOldText&&""===this.FHTML.GetTextStr()||(this.GetElementHandle().innerHTML=this.FHTML.GetTextStr()),this.FOldText=this.FHTML.GetTextStr()):!this.GetIsLinked()&&4 in this.FComponentState&&this.RenderDesigning(this.$classname,this.GetContainer(),this,!0,"")},this.HTMLChanged=function(t){this.UpdateElementData()},this.CreateElement=function(){return document.createElement("DIV")},this.CreateInitialize=function(){this.FHTML=pas.Classes.TStringList.$create("Create$1"),this.FHTML.SetSkipLastLineBreak(!0),rtl.as(this.FHTML,pas.Classes.TStringList).FOnChange=rtl.createCallback(this,"HTMLChanged"),pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetClipChildren(!1),this.SetTabStop(!1),4 in this.FComponentState&&(this.SetWidth(240),this.SetHeight(160))},this.Destroy=function(){rtl.free(this,"FHTML"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("Center",0,pas["WEBLib.Controls"].$rtti.TCenter,"FCenter",""),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("HTML",2,pas.Classes.$rtti.TStrings,"FHTML","SetHTML"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),t.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),t.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),t.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")}))}),["WEBLib.Dialogs","WEBLib.WebTools"]),rtl.module("SchedUnit2",["System","SysUtils","Classes","JS","Web","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.StdCtrls","WEBLib.StdCtrls","WEBLib.Controls","WEBLib.ExtCtrls"],(function(){"use strict";rtl.createClass(this,"TSchedForm",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.EventModeGroup=null,this.pnlDetails=null,this.lblTitle=null,this.mmTitle=null,this.mmSubTitle=null,this.mmDescription=null,this.lblSubTitle=null,this.lblDescription=null,this.lblChannel=null,this.lblChannelValue=null,this.lblStartTime=null,this.lblEndTime=null,this.lblStartDateValue=null,this.btnCancel=null,this.btnOK=null,this.tpStartTime=null,this.tpEndTime=null},this.$final=function(){this.EventModeGroup=void 0,this.pnlDetails=void 0,this.lblTitle=void 0,this.mmTitle=void 0,this.mmSubTitle=void 0,this.mmDescription=void 0,this.lblSubTitle=void 0,this.lblDescription=void 0,this.lblChannel=void 0,this.lblChannelValue=void 0,this.lblStartTime=void 0,this.lblEndTime=void 0,this.lblStartDateValue=void 0,this.btnCancel=void 0,this.btnOK=void 0,this.tpStartTime=void 0,this.tpEndTime=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.WebFormShow=function(t){this.btnCancel.SetFocus()},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this),this.lblChannel=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblChannelValue=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblStartTime=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblEndTime=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblStartDateValue=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.EventModeGroup=pas["WEBLib.StdCtrls"].TRadioGroup.$create("Create$1",[this]),this.pnlDetails=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.lblTitle=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblSubTitle=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblDescription=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.mmTitle=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.mmSubTitle=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.mmDescription=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.btnCancel=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.btnOK=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.tpStartTime=pas["WEBLib.StdCtrls"].TDateTimePicker.$create("Create$1",[this]),this.tpEndTime=pas["WEBLib.StdCtrls"].TDateTimePicker.$create("Create$1",[this]),this.lblChannel.BeforeLoadDFMValues(),this.lblChannelValue.BeforeLoadDFMValues(),this.lblStartTime.BeforeLoadDFMValues(),this.lblEndTime.BeforeLoadDFMValues(),this.lblStartDateValue.BeforeLoadDFMValues(),this.EventModeGroup.BeforeLoadDFMValues(),this.pnlDetails.BeforeLoadDFMValues(),this.lblTitle.BeforeLoadDFMValues(),this.lblSubTitle.BeforeLoadDFMValues(),this.lblDescription.BeforeLoadDFMValues(),this.mmTitle.BeforeLoadDFMValues(),this.mmSubTitle.BeforeLoadDFMValues(),this.mmDescription.BeforeLoadDFMValues(),this.btnCancel.BeforeLoadDFMValues(),this.btnOK.BeforeLoadDFMValues(),this.tpStartTime.BeforeLoadDFMValues(),this.tpEndTime.BeforeLoadDFMValues();try{this.SetName("SchedForm"),this.SetWidth(350),this.SetHeight(480),this.SetColor(8894686),this.SetCSSLibrary(1),this.SetElementFont(1),this.FFont.FCharset=0,this.FFont.SetColor(0),this.FFont.SetHeight(-11),this.FFont.SetName("Arial"),this.FFont.SetStyle({}),this.SetParentFont(!1),this.SetEvent(this,"OnShow","WebFormShow"),this.lblChannel.SetParentComponent(this),this.lblChannel.SetName("lblChannel"),this.lblChannel.SetLeft(83),this.lblChannel.SetTop(293),this.lblChannel.SetWidth(217),this.lblChannel.SetHeight(15),this.lblChannel.SetAlignment(2),this.lblChannel.SetAutoSize(!1),this.lblChannel.SetCaption("On Channel"),this.lblChannel.SetColorEx(8894686),this.lblChannel.SetElementLabelClassName("h6"),this.lblChannel.SetElementFont(1),this.lblChannel.SetHeightPercent(100),this.lblChannel.SetWidthPercent(100),this.lblChannelValue.SetParentComponent(this),this.lblChannelValue.SetName("lblChannelValue"),this.lblChannelValue.SetLeft(83),this.lblChannelValue.SetTop(311),this.lblChannelValue.SetWidth(217),this.lblChannelValue.SetHeight(15),this.lblChannelValue.SetAlignment(2),this.lblChannelValue.SetAutoSize(!1),this.lblChannelValue.SetCaption("PSIP"),this.lblChannelValue.SetColorEx(8894686),this.lblChannelValue.SetElementLabelClassName("h6"),this.lblChannelValue.SetElementFont(1),this.lblChannelValue.SetHeightPercent(100),this.lblChannelValue.SetWidthPercent(100),this.lblStartTime.SetParentComponent(this),this.lblStartTime.SetName("lblStartTime"),this.lblStartTime.SetLeft(145),this.lblStartTime.SetTop(342),this.lblStartTime.SetWidth(70),this.lblStartTime.SetHeight(16),this.lblStartTime.FMargins.SetLeft(11),this.lblStartTime.FMargins.SetTop(11),this.lblStartTime.FMargins.SetRight(11),this.lblStartTime.FMargins.SetBottom(11),this.lblStartTime.SetAlignment(2),this.lblStartTime.SetAutoSize(!1),this.lblStartTime.SetCaption("Start"),this.lblStartTime.SetColorEx(8894686),this.lblStartTime.SetElementFont(1),this.lblStartTime.FFont.FCharset=1,this.lblStartTime.FFont.SetColor(65793),this.lblStartTime.FFont.SetHeight(-12),this.lblStartTime.FFont.SetName("Segoe UI"),this.lblStartTime.FFont.SetStyle({}),this.lblStartTime.SetHeightStyle(2),this.lblStartTime.SetHeightPercent(100),this.lblStartTime.SetLayout(1),this.lblStartTime.SetParentFont(!1),this.lblStartTime.SetTransparent(!1),this.lblStartTime.SetWidthPercent(100),this.lblEndTime.SetParentComponent(this),this.lblEndTime.SetName("lblEndTime"),this.lblEndTime.SetLeft(239),this.lblEndTime.SetTop(342),this.lblEndTime.SetWidth(70),this.lblEndTime.SetHeight(16),this.lblEndTime.FMargins.SetLeft(11),this.lblEndTime.FMargins.SetTop(11),this.lblEndTime.FMargins.SetRight(11),this.lblEndTime.FMargins.SetBottom(11),this.lblEndTime.SetAlignment(2),this.lblEndTime.SetAutoSize(!1),this.lblEndTime.SetCaption("End"),this.lblEndTime.SetColorEx(8894686),this.lblEndTime.SetElementFont(1),this.lblEndTime.FFont.FCharset=1,this.lblEndTime.FFont.SetColor(65793),this.lblEndTime.FFont.SetHeight(-12),this.lblEndTime.FFont.SetName("Segoe UI"),this.lblEndTime.FFont.SetStyle({}),this.lblEndTime.SetHeightStyle(2),this.lblEndTime.SetHeightPercent(100),this.lblEndTime.SetLayout(1),this.lblEndTime.SetParentFont(!1),this.lblEndTime.SetTransparent(!1),this.lblEndTime.SetWidthPercent(100),this.lblStartDateValue.SetParentComponent(this),this.lblStartDateValue.SetName("lblStartDateValue"),this.lblStartDateValue.SetLeft(41),this.lblStartDateValue.SetTop(364),this.lblStartDateValue.SetWidth(100),this.lblStartDateValue.SetHeight(16),this.lblStartDateValue.FMargins.SetLeft(11),this.lblStartDateValue.FMargins.SetTop(11),this.lblStartDateValue.FMargins.SetRight(11),this.lblStartDateValue.FMargins.SetBottom(11),this.lblStartDateValue.SetAlignment(2),this.lblStartDateValue.SetAutoSize(!1),this.lblStartDateValue.SetCaption("Date"),this.lblStartDateValue.SetColorEx(8894686),this.lblStartDateValue.SetElementFont(1),this.lblStartDateValue.FFont.FCharset=1,this.lblStartDateValue.FFont.SetColor(65793),this.lblStartDateValue.FFont.SetHeight(-12),this.lblStartDateValue.FFont.SetName("Segoe UI"),this.lblStartDateValue.FFont.SetStyle({}),this.lblStartDateValue.SetHeightStyle(2),this.lblStartDateValue.SetHeightPercent(100),this.lblStartDateValue.SetLayout(1),this.lblStartDateValue.SetParentFont(!1),this.lblStartDateValue.SetTransparent(!1),this.lblStartDateValue.SetWidthPercent(100),this.EventModeGroup.SetParentComponent(this),this.EventModeGroup.SetName("EventModeGroup"),this.EventModeGroup.SetLeft(15),this.EventModeGroup.SetTop(284),this.EventModeGroup.SetWidth(67),this.EventModeGroup.SetHeight(55),this.EventModeGroup.SetCaption(""),this.EventModeGroup.SetColumns(1),this.EventModeGroup.SetItemIndex(0),this.EventModeGroup.FItems.BeginUpdate();try{this.EventModeGroup.FItems.Clear(),this.EventModeGroup.FItems.Add("Record"),this.EventModeGroup.FItems.Add("Watch")}finally{this.EventModeGroup.FItems.EndUpdate()}this.EventModeGroup.SetRole(""),this.EventModeGroup.SetTabOrder(0),this.EventModeGroup.SetVisible(!1),this.pnlDetails.SetParentComponent(this),this.pnlDetails.SetName("pnlDetails"),this.pnlDetails.SetLeft(0),this.pnlDetails.SetTop(0),this.pnlDetails.SetWidth(350),this.pnlDetails.SetHeight(275),this.pnlDetails.FCenter.SetHorizontal(!0),this.pnlDetails.SetWidthStyle(0),this.pnlDetails.SetCaption("pnlDetails"),this.pnlDetails.SetChildOrderEx(1),this.pnlDetails.SetColor(25600),this.pnlDetails.SetShowCaption(!1),this.pnlDetails.SetTabOrder(1),this.lblTitle.SetParentComponent(this.pnlDetails),this.lblTitle.SetName("lblTitle"),this.lblTitle.SetLeft(0),this.lblTitle.SetTop(0),this.lblTitle.SetWidth(350),this.lblTitle.SetHeight(14),this.lblTitle.SetAlign(1),this.lblTitle.SetCaption("Program Title"),this.lblTitle.SetColorEx(-1),this.lblTitle.FFont.FCharset=0,this.lblTitle.FFont.SetColor(16777215),this.lblTitle.FFont.SetHeight(-11),this.lblTitle.FFont.SetName("Arial"),this.lblTitle.FFont.SetStyle({}),this.lblTitle.SetHeightStyle(2),this.lblTitle.SetHeightPercent(100),this.lblTitle.SetParentFont(!1),this.lblTitle.SetWidthPercent(100),this.lblSubTitle.SetParentComponent(this.pnlDetails),this.lblSubTitle.SetName("lblSubTitle"),this.lblSubTitle.SetLeft(0),this.lblSubTitle.SetTop(72),this.lblSubTitle.SetWidth(350),this.lblSubTitle.SetHeight(14),this.lblSubTitle.SetAlign(1),this.lblSubTitle.SetCaption("Program SubTitle"),this.lblSubTitle.SetColorEx(-1),this.lblSubTitle.FFont.FCharset=0,this.lblSubTitle.FFont.SetColor(16777215),this.lblSubTitle.FFont.SetHeight(-11),this.lblSubTitle.FFont.SetName("Arial"),this.lblSubTitle.FFont.SetStyle({}),this.lblSubTitle.SetHeightStyle(2),this.lblSubTitle.SetHeightPercent(100),this.lblSubTitle.SetParentFont(!1),this.lblSubTitle.SetWidthPercent(100),this.lblDescription.SetParentComponent(this.pnlDetails),this.lblDescription.SetName("lblDescription"),this.lblDescription.SetLeft(0),this.lblDescription.SetTop(135),this.lblDescription.SetWidth(350),this.lblDescription.SetHeight(14),this.lblDescription.SetAlign(1),this.lblDescription.SetCaption("Program Description"),this.lblDescription.SetColorEx(-1),this.lblDescription.FFont.FCharset=0,this.lblDescription.FFont.SetColor(16777215),this.lblDescription.FFont.SetHeight(-11),this.lblDescription.FFont.SetName("Arial"),this.lblDescription.FFont.SetStyle({}),this.lblDescription.SetHeightStyle(2),this.lblDescription.SetHeightPercent(100),this.lblDescription.SetParentFont(!1),this.lblDescription.SetWidthPercent(100),this.mmTitle.SetParentComponent(this.pnlDetails),this.mmTitle.SetName("mmTitle"),this.mmTitle.SetLeft(0),this.mmTitle.SetTop(14),this.mmTitle.SetWidth(350),this.mmTitle.SetHeight(58),this.mmTitle.SetAlign(1),this.mmTitle.SetColor(8894686),this.mmTitle.SetElementClassName("h5"),this.mmTitle.SetElementFont(1),this.mmTitle.SetHeightPercent(100),this.mmTitle.FLines.BeginUpdate();try{this.mmTitle.FLines.Clear(),this.mmTitle.FLines.Add("mmTitle")}finally{this.mmTitle.FLines.EndUpdate()}this.mmTitle.SetSelLength(0),this.mmTitle.SetSelStart(0),this.mmTitle.SetWidthPercent(100),this.mmSubTitle.SetParentComponent(this.pnlDetails),this.mmSubTitle.SetName("mmSubTitle"),this.mmSubTitle.SetLeft(0),this.mmSubTitle.SetTop(86),this.mmSubTitle.SetWidth(350),this.mmSubTitle.SetHeight(49),this.mmSubTitle.SetAlign(1),this.mmSubTitle.SetColor(8894686),this.mmSubTitle.SetElementClassName("h6"),this.mmSubTitle.SetElementFont(1),this.mmSubTitle.SetHeightPercent(100),this.mmSubTitle.FLines.BeginUpdate();try{this.mmSubTitle.FLines.Clear(),this.mmSubTitle.FLines.Add("mmSubTitle")}finally{this.mmSubTitle.FLines.EndUpdate()}this.mmSubTitle.SetSelLength(0),this.mmSubTitle.SetSelStart(10),this.mmSubTitle.SetWidthPercent(100),this.mmDescription.SetParentComponent(this.pnlDetails),this.mmDescription.SetName("mmDescription"),this.mmDescription.SetLeft(0),this.mmDescription.SetTop(158),this.mmDescription.SetWidth(350),this.mmDescription.SetHeight(117),this.mmDescription.SetAlign(2),this.mmDescription.SetColor(8894686),this.mmDescription.SetHeightPercent(100),this.mmDescription.FLines.BeginUpdate();try{this.mmDescription.FLines.Clear(),this.mmDescription.FLines.Add("Description")}finally{this.mmDescription.FLines.EndUpdate()}this.mmDescription.SetSelLength(0),this.mmDescription.SetSelStart(11),this.mmDescription.SetWidthPercent(100),this.btnCancel.SetParentComponent(this),this.btnCancel.SetName("btnCancel"),this.btnCancel.SetLeft(20),this.btnCancel.SetTop(421),this.btnCancel.SetWidth(120),this.btnCancel.SetHeight(40),this.btnCancel.FMargins.SetLeft(8),this.btnCancel.FMargins.SetTop(8),this.btnCancel.FMargins.SetRight(8),this.btnCancel.FMargins.SetBottom(8),this.btnCancel.SetAnchors(rtl.createSet(0,3)),this.btnCancel.FCancel=!0,this.btnCancel.SetCaption("Cancel"),this.btnCancel.SetChildOrderEx(10),this.btnCancel.SetElementClassName("btn btn-warning"),this.btnCancel.SetElementFont(1),this.btnCancel.FFont.FCharset=1,this.btnCancel.FFont.SetColor(65793),this.btnCancel.FFont.SetHeight(-12),this.btnCancel.FFont.SetName("Segoe UI"),this.btnCancel.FFont.SetStyle({}),this.btnCancel.SetHeightPercent(100),this.btnCancel.FModalResult=2,this.btnCancel.SetParentFont(!1),this.btnCancel.SetRole("button"),this.btnCancel.SetTabOrder(3),this.btnCancel.SetWidthPercent(100),this.btnOK.SetParentComponent(this),this.btnOK.SetName("btnOK"),this.btnOK.SetLeft(208),this.btnOK.SetTop(421),this.btnOK.SetWidth(120),this.btnOK.SetHeight(40),this.btnOK.FMargins.SetLeft(8),this.btnOK.FMargins.SetTop(8),this.btnOK.FMargins.SetRight(8),this.btnOK.FMargins.SetBottom(8),this.btnOK.SetAnchors(rtl.createSet(0,3)),this.btnOK.SetCaption("Submit"),this.btnOK.SetChildOrderEx(11),this.btnOK.SetElementClassName("btn btn-primary"),this.btnOK.SetElementFont(1),this.btnOK.FFont.FCharset=1,this.btnOK.FFont.SetColor(65793),this.btnOK.FFont.SetHeight(-12),this.btnOK.FFont.SetName("Segoe UI"),this.btnOK.FFont.SetStyle({}),this.btnOK.SetHeightPercent(100),this.btnOK.FModalResult=1,this.btnOK.SetParentFont(!1),this.btnOK.SetRole("button"),this.btnOK.SetTabOrder(4),this.btnOK.SetWidthPercent(100),this.tpStartTime.SetParentComponent(this),this.tpStartTime.SetName("tpStartTime"),this.tpStartTime.SetLeft(145),this.tpStartTime.SetTop(364),this.tpStartTime.SetWidth(79),this.tpStartTime.SetHeight(24),this.tpStartTime.SetBorderStyle(1),this.tpStartTime.SetChildOrderEx(10),this.tpStartTime.SetColor(16777215),this.tpStartTime.SetDate(.6666666666666666),this.tpStartTime.SetKind(1),this.tpStartTime.SetRole(""),this.tpStartTime.SetShowSeconds(!1),this.tpStartTime.SetText("16:00"),this.tpStartTime.SetTime(.6666666666666666),this.tpEndTime.SetParentComponent(this),this.tpEndTime.SetName("tpEndTime"),this.tpEndTime.SetLeft(239),this.tpEndTime.SetTop(364),this.tpEndTime.SetWidth(79),this.tpEndTime.SetHeight(24),this.tpEndTime.SetBorderStyle(1),this.tpEndTime.SetChildOrderEx(10),this.tpEndTime.SetColor(16777215),this.tpEndTime.SetDate(.7083333333333334),this.tpEndTime.SetKind(1),this.tpEndTime.SetRole(""),this.tpEndTime.SetShowSeconds(!1),this.tpEndTime.SetText("17:00"),this.tpEndTime.SetTime(.7083333333333334)}finally{this.lblChannel.AfterLoadDFMValues(),this.lblChannelValue.AfterLoadDFMValues(),this.lblStartTime.AfterLoadDFMValues(),this.lblEndTime.AfterLoadDFMValues(),this.lblStartDateValue.AfterLoadDFMValues(),this.EventModeGroup.AfterLoadDFMValues(),this.pnlDetails.AfterLoadDFMValues(),this.lblTitle.AfterLoadDFMValues(),this.lblSubTitle.AfterLoadDFMValues(),this.lblDescription.AfterLoadDFMValues(),this.mmTitle.AfterLoadDFMValues(),this.mmSubTitle.AfterLoadDFMValues(),this.mmDescription.AfterLoadDFMValues(),this.btnCancel.AfterLoadDFMValues(),this.btnOK.AfterLoadDFMValues(),this.tpStartTime.AfterLoadDFMValues(),this.tpEndTime.AfterLoadDFMValues()}},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addField("EventModeGroup",pas["WEBLib.StdCtrls"].$rtti.TRadioGroup),t.addField("pnlDetails",pas["WEBLib.ExtCtrls"].$rtti.TPanel),t.addField("lblTitle",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("mmTitle",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("mmSubTitle",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("mmDescription",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("lblSubTitle",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblDescription",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblChannel",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblChannelValue",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblStartTime",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblEndTime",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblStartDateValue",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("btnCancel",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("btnOK",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("tpStartTime",pas["WEBLib.StdCtrls"].$rtti.TDateTimePicker),t.addField("tpEndTime",pas["WEBLib.StdCtrls"].$rtti.TDateTimePicker),t.addMethod("WebFormShow",0,[["Sender",pas.System.$rtti.TObject]])})),this.SchedForm=null})),rtl.module("Details",["System","SysUtils","Classes","JS","Web","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.StdCtrls","WEBLib.ExtCtrls"],(function(){"use strict";rtl.createClass(this,"TDetailsFrm",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.pnlDetails=null,this.lblTitle=null,this.lblSubTitle=null,this.lblDescription=null,this.mmTitle=null,this.mmSubTitle=null,this.mmDescription=null,this.btnAddCap=null,this.btnReturn=null,this.lb02New=null,this.lb03Stereo=null,this.lb04HD=null,this.lb07Dolby=null,this.lb08CC=null,this.lb09OrigDate=null,this.lb10Channel=null,this.lb11Time=null},this.$final=function(){this.pnlDetails=void 0,this.lblTitle=void 0,this.lblSubTitle=void 0,this.lblDescription=void 0,this.mmTitle=void 0,this.mmSubTitle=void 0,this.mmDescription=void 0,this.btnAddCap=void 0,this.btnReturn=void 0,this.lb02New=void 0,this.lb03Stereo=void 0,this.lb04HD=void 0,this.lb07Dolby=void 0,this.lb08CC=void 0,this.lb09OrigDate=void 0,this.lb10Channel=void 0,this.lb11Time=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.WebFormShow=function(t){this.btnReturn.SetFocus()},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this),this.lb02New=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb03Stereo=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb04HD=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb07Dolby=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb08CC=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb09OrigDate=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb10Channel=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lb11Time=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.pnlDetails=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.lblTitle=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblSubTitle=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.lblDescription=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.mmTitle=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.mmSubTitle=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.mmDescription=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.btnAddCap=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.btnReturn=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.lb02New.BeforeLoadDFMValues(),this.lb03Stereo.BeforeLoadDFMValues(),this.lb04HD.BeforeLoadDFMValues(),this.lb07Dolby.BeforeLoadDFMValues(),this.lb08CC.BeforeLoadDFMValues(),this.lb09OrigDate.BeforeLoadDFMValues(),this.lb10Channel.BeforeLoadDFMValues(),this.lb11Time.BeforeLoadDFMValues(),this.pnlDetails.BeforeLoadDFMValues(),this.lblTitle.BeforeLoadDFMValues(),this.lblSubTitle.BeforeLoadDFMValues(),this.lblDescription.BeforeLoadDFMValues(),this.mmTitle.BeforeLoadDFMValues(),this.mmSubTitle.BeforeLoadDFMValues(),this.mmDescription.BeforeLoadDFMValues(),this.btnAddCap.BeforeLoadDFMValues(),this.btnReturn.BeforeLoadDFMValues();try{this.SetName("DetailsFrm"),this.SetWidth(353),this.SetHeight(447),this.SetColor(15794160),this.SetCSSLibrary(1),this.SetElementFont(1),this.FFont.FCharset=1,this.FFont.SetColor(65793),this.FFont.SetHeight(-12),this.FFont.SetName("Segoe UI"),this.FFont.SetStyle({}),this.SetParentFont(!1),this.FShowClose=!1,this.SetVisible(!0),this.lb02New.SetParentComponent(this),this.lb02New.SetName("lb02New"),this.lb02New.SetLeft(200),this.lb02New.SetTop(331),this.lb02New.SetWidth(40),this.lb02New.SetHeight(15),this.lb02New.SetAlignment(2),this.lb02New.SetAutoSize(!1),this.lb02New.SetCaption("New"),this.lb02New.SetColorEx(15794160),this.lb02New.FFont.FCharset=1,this.lb02New.FFont.SetColor(65793),this.lb02New.FFont.SetHeight(-12),this.lb02New.FFont.SetName("Segoe UI"),this.lb02New.FFont.SetStyle({}),this.lb02New.SetHeightStyle(2),this.lb02New.SetHeightPercent(100),this.lb02New.SetHTMLType(1),this.lb02New.SetLayout(1),this.lb02New.SetParentFont(!1),this.lb02New.FShowAccelChar=!1,this.lb02New.SetWidthPercent(100),this.lb03Stereo.SetParentComponent(this),this.lb03Stereo.SetName("lb03Stereo"),this.lb03Stereo.SetLeft(146),this.lb03Stereo.SetTop(331),this.lb03Stereo.SetWidth(50),this.lb03Stereo.SetHeight(15),this.lb03Stereo.SetAlignment(2),this.lb03Stereo.SetAutoSize(!1),this.lb03Stereo.SetCaption("Stereo"),this.lb03Stereo.SetColorEx(15794160),this.lb03Stereo.FFont.FCharset=1,this.lb03Stereo.FFont.SetColor(65793),this.lb03Stereo.FFont.SetHeight(-12),this.lb03Stereo.FFont.SetName("Segoe UI"),this.lb03Stereo.FFont.SetStyle({}),this.lb03Stereo.SetHeightStyle(2),this.lb03Stereo.SetHeightPercent(100),this.lb03Stereo.SetHTMLType(1),this.lb03Stereo.SetLayout(1),this.lb03Stereo.SetParentFont(!1),this.lb03Stereo.FShowAccelChar=!1,this.lb03Stereo.SetWidthPercent(100),this.lb04HD.SetParentComponent(this),this.lb04HD.SetName("lb04HD"),this.lb04HD.SetLeft(6),this.lb04HD.SetTop(331),this.lb04HD.SetWidth(45),this.lb04HD.SetHeight(15),this.lb04HD.SetAlignment(2),this.lb04HD.SetAutoSize(!1),this.lb04HD.SetCaption("HD"),this.lb04HD.SetColorEx(15794160),this.lb04HD.FFont.FCharset=1,this.lb04HD.FFont.SetColor(65793),this.lb04HD.FFont.SetHeight(-12),this.lb04HD.FFont.SetName("Segoe UI"),this.lb04HD.FFont.SetStyle({}),this.lb04HD.SetHeightStyle(2),this.lb04HD.SetHeightPercent(100),this.lb04HD.SetHTMLType(1),this.lb04HD.SetLayout(1),this.lb04HD.SetParentFont(!1),this.lb04HD.FShowAccelChar=!1,this.lb04HD.SetWidthPercent(100),this.lb07Dolby.SetParentComponent(this),this.lb07Dolby.SetName("lb07Dolby"),this.lb07Dolby.SetLeft(84),this.lb07Dolby.SetTop(331),this.lb07Dolby.SetWidth(50),this.lb07Dolby.SetHeight(15),this.lb07Dolby.SetAlignment(2),this.lb07Dolby.SetAutoSize(!1),this.lb07Dolby.SetCaption("Dolby"),this.lb07Dolby.SetColorEx(15794160),this.lb07Dolby.FFont.FCharset=1,this.lb07Dolby.FFont.SetColor(65793),this.lb07Dolby.FFont.SetHeight(-12),this.lb07Dolby.FFont.SetName("Segoe UI"),this.lb07Dolby.FFont.SetStyle({}),this.lb07Dolby.SetHeightStyle(2),this.lb07Dolby.SetHeightPercent(100),this.lb07Dolby.SetHTMLType(2),this.lb07Dolby.SetLayout(1),this.lb07Dolby.SetParentFont(!1),this.lb07Dolby.FShowAccelChar=!1,this.lb07Dolby.SetWidthPercent(100),this.lb08CC.SetParentComponent(this),this.lb08CC.SetName("lb08CC"),this.lb08CC.SetLeft(46),this.lb08CC.SetTop(331),this.lb08CC.SetWidth(40),this.lb08CC.SetHeight(15),this.lb08CC.SetAlignment(2),this.lb08CC.SetAutoSize(!1),this.lb08CC.SetCaption("CC"),this.lb08CC.SetColorEx(15794160),this.lb08CC.FFont.FCharset=1,this.lb08CC.FFont.SetColor(65793),this.lb08CC.FFont.SetHeight(-12),this.lb08CC.FFont.SetName("Segoe UI"),this.lb08CC.FFont.SetStyle({}),this.lb08CC.SetHeightStyle(2),this.lb08CC.SetHeightPercent(100),this.lb08CC.SetHTMLType(1),this.lb08CC.SetLayout(1),this.lb08CC.SetParentFont(!1),this.lb08CC.FShowAccelChar=!1,this.lb08CC.SetWidthPercent(100),this.lb09OrigDate.SetParentComponent(this),this.lb09OrigDate.SetName("lb09OrigDate"),this.lb09OrigDate.SetLeft(243),this.lb09OrigDate.SetTop(331),this.lb09OrigDate.SetWidth(100),this.lb09OrigDate.SetHeight(15),this.lb09OrigDate.SetAlignment(2),this.lb09OrigDate.SetAutoSize(!1),this.lb09OrigDate.SetCaption("OrigDate"),this.lb09OrigDate.SetColorEx(15794160),this.lb09OrigDate.FFont.FCharset=1,this.lb09OrigDate.FFont.SetColor(65793),this.lb09OrigDate.FFont.SetHeight(-12),this.lb09OrigDate.FFont.SetName("Segoe UI"),this.lb09OrigDate.FFont.SetStyle({}),this.lb09OrigDate.SetHeightStyle(2),this.lb09OrigDate.SetHeightPercent(100),this.lb09OrigDate.SetHTMLType(1),this.lb09OrigDate.SetLayout(1),this.lb09OrigDate.SetParentFont(!1),this.lb09OrigDate.FShowAccelChar=!1,this.lb09OrigDate.SetWidthPercent(100),this.lb10Channel.SetParentComponent(this),this.lb10Channel.SetName("lb10Channel"),this.lb10Channel.SetLeft(10),this.lb10Channel.SetTop(303),this.lb10Channel.SetWidth(100),this.lb10Channel.SetHeight(15),this.lb10Channel.SetAlignment(2),this.lb10Channel.SetAutoSize(!1),this.lb10Channel.SetCaption("Channel"),this.lb10Channel.SetColorEx(15794160),this.lb10Channel.SetElementFont(1),this.lb10Channel.FFont.FCharset=1,this.lb10Channel.FFont.SetColor(65793),this.lb10Channel.FFont.SetHeight(-12),this.lb10Channel.FFont.SetName("Segoe UI"),this.lb10Channel.FFont.SetStyle({}),this.lb10Channel.SetHeightStyle(2),this.lb10Channel.SetHeightPercent(100),this.lb10Channel.SetHTMLType(1),this.lb10Channel.SetLayout(1),this.lb10Channel.SetParentFont(!1),this.lb10Channel.FShowAccelChar=!1,this.lb10Channel.SetWidthPercent(100),this.lb11Time.SetParentComponent(this),this.lb11Time.SetName("lb11Time"),this.lb11Time.SetLeft(114),this.lb11Time.SetTop(304),this.lb11Time.SetWidth(160),this.lb11Time.SetHeight(15),this.lb11Time.SetAlignment(2),this.lb11Time.SetAutoSize(!1),this.lb11Time.SetCaption("Time"),this.lb11Time.SetColorEx(15794160),this.lb11Time.SetElementFont(1),this.lb11Time.FFont.FCharset=1,this.lb11Time.FFont.SetColor(65793),this.lb11Time.FFont.SetHeight(-12),this.lb11Time.FFont.SetName("Segoe UI"),this.lb11Time.FFont.SetStyle({}),this.lb11Time.SetHeightStyle(2),this.lb11Time.SetHeightPercent(100),this.lb11Time.SetHTMLType(1),this.lb11Time.SetLayout(1),this.lb11Time.SetParentFont(!1),this.lb11Time.FShowAccelChar=!1,this.lb11Time.SetWidthPercent(100),this.pnlDetails.SetParentComponent(this),this.pnlDetails.SetName("pnlDetails"),this.pnlDetails.SetLeft(1),this.pnlDetails.SetTop(0),this.pnlDetails.SetWidth(350),this.pnlDetails.SetHeight(275),this.pnlDetails.FCenter.SetHorizontal(!0),this.pnlDetails.SetElementClassName("card"),this.pnlDetails.SetWidthStyle(0),this.pnlDetails.SetAnchors(rtl.createSet(0,1,2)),this.pnlDetails.SetBorderStyle(0),this.pnlDetails.SetCaption("pnlDetails"),this.pnlDetails.SetChildOrderEx(1),this.pnlDetails.SetColor(15794160),this.pnlDetails.FElementBodyClassName="card-body",this.pnlDetails.SetElementFont(1),this.pnlDetails.SetShowCaption(!1),this.pnlDetails.SetTabOrder(0),this.lblTitle.SetParentComponent(this.pnlDetails),this.lblTitle.SetName("lblTitle"),this.lblTitle.SetLeft(0),this.lblTitle.SetTop(0),this.lblTitle.SetWidth(350),this.lblTitle.SetHeight(10),this.lblTitle.SetAlign(1),this.lblTitle.SetCaption("Program Title"),this.lblTitle.SetColorEx(-1),this.lblTitle.FFont.FCharset=0,this.lblTitle.FFont.SetColor(0),this.lblTitle.FFont.SetHeight(-8),this.lblTitle.FFont.SetName("Arial"),this.lblTitle.FFont.SetStyle({}),this.lblTitle.SetHeightStyle(2),this.lblTitle.SetHeightPercent(100),this.lblTitle.SetParentFont(!1),this.lblTitle.SetWidthPercent(100),this.lblSubTitle.SetParentComponent(this.pnlDetails),this.lblSubTitle.SetName("lblSubTitle"),this.lblSubTitle.SetLeft(0),this.lblSubTitle.SetTop(80),this.lblSubTitle.SetWidth(350),this.lblSubTitle.SetHeight(10),this.lblSubTitle.SetAlign(1),this.lblSubTitle.SetCaption("Program SubTitle"),this.lblSubTitle.SetColorEx(-1),this.lblSubTitle.FFont.FCharset=0,this.lblSubTitle.FFont.SetColor(0),this.lblSubTitle.FFont.SetHeight(-8),this.lblSubTitle.FFont.SetName("Arial"),this.lblSubTitle.FFont.SetStyle({}),this.lblSubTitle.SetHeightStyle(2),this.lblSubTitle.SetHeightPercent(100),this.lblSubTitle.SetParentFont(!1),this.lblSubTitle.SetWidthPercent(100),this.lblDescription.SetParentComponent(this.pnlDetails),this.lblDescription.SetName("lblDescription"),this.lblDescription.SetLeft(0),this.lblDescription.SetTop(145),this.lblDescription.SetWidth(350),this.lblDescription.SetHeight(10),this.lblDescription.SetAlign(1),this.lblDescription.SetCaption("Program Description"),this.lblDescription.SetColorEx(-1),this.lblDescription.FFont.FCharset=0,this.lblDescription.FFont.SetColor(0),this.lblDescription.FFont.SetHeight(-8),this.lblDescription.FFont.SetName("Arial"),this.lblDescription.FFont.SetStyle({}),this.lblDescription.SetHeightStyle(2),this.lblDescription.SetHeightPercent(100),this.lblDescription.SetParentFont(!1),this.lblDescription.SetWidthPercent(100),this.mmTitle.SetParentComponent(this.pnlDetails),this.mmTitle.SetName("mmTitle"),this.mmTitle.SetLeft(0),this.mmTitle.SetTop(10),this.mmTitle.SetWidth(350),this.mmTitle.SetHeight(70),this.mmTitle.SetAlign(1),this.mmTitle.SetColor(9419919),this.mmTitle.SetElementClassName("form-control-lg"),this.mmTitle.SetElementFont(1),this.mmTitle.SetHeightPercent(100),this.mmTitle.FLines.BeginUpdate();try{this.mmTitle.FLines.Clear(),this.mmTitle.FLines.Add("mmTitle")}finally{this.mmTitle.FLines.EndUpdate()}this.mmTitle.SetScrollBars(0),this.mmTitle.SetSelLength(0),this.mmTitle.SetSelStart(0),this.mmTitle.SetWidthPercent(100),this.mmSubTitle.SetParentComponent(this.pnlDetails),this.mmSubTitle.SetName("mmSubTitle"),this.mmSubTitle.SetLeft(0),this.mmSubTitle.SetTop(90),this.mmSubTitle.SetWidth(350),this.mmSubTitle.SetHeight(55),this.mmSubTitle.SetAlign(1),this.mmSubTitle.SetColor(9419919),this.mmSubTitle.SetElementClassName("form-control"),this.mmSubTitle.SetElementFont(1),this.mmSubTitle.SetHeightPercent(100),this.mmSubTitle.FLines.BeginUpdate();try{this.mmSubTitle.FLines.Clear(),this.mmSubTitle.FLines.Add("mmSubTitle")}finally{this.mmSubTitle.FLines.EndUpdate()}this.mmSubTitle.SetScrollBars(0),this.mmSubTitle.SetSelLength(0),this.mmSubTitle.SetSelStart(10),this.mmSubTitle.SetWidthPercent(100),this.mmDescription.SetParentComponent(this.pnlDetails),this.mmDescription.SetName("mmDescription"),this.mmDescription.SetLeft(0),this.mmDescription.SetTop(155),this.mmDescription.SetWidth(350),this.mmDescription.SetHeight(117),this.mmDescription.SetAlign(1),this.mmDescription.SetColor(9419919),this.mmDescription.SetElementClassName("form-control-sm"),this.mmDescription.SetElementFont(1),this.mmDescription.SetHeightStyle(0),this.mmDescription.SetHeightPercent(100),this.mmDescription.FLines.BeginUpdate();try{this.mmDescription.FLines.Clear(),this.mmDescription.FLines.Add("Description")}finally{this.mmDescription.FLines.EndUpdate()}this.mmDescription.SetReadOnly(!0),this.mmDescription.SetScrollBars(2),this.mmDescription.SetSelLength(0),this.mmDescription.SetSelStart(11),this.mmDescription.SetWidthPercent(100),this.btnAddCap.SetParentComponent(this),this.btnAddCap.SetName("btnAddCap"),this.btnAddCap.SetLeft(210),this.btnAddCap.SetTop(376),this.btnAddCap.SetWidth(120),this.btnAddCap.SetHeight(40),this.btnAddCap.FMargins.SetLeft(8),this.btnAddCap.FMargins.SetTop(8),this.btnAddCap.FMargins.SetRight(8),this.btnAddCap.FMargins.SetBottom(8),this.btnAddCap.SetCaption("Add Capture"),this.btnAddCap.SetChildOrderEx(11),this.btnAddCap.SetElementClassName("btn btn-outline-success"),this.btnAddCap.SetElementFont(1),this.btnAddCap.FFont.FCharset=1,this.btnAddCap.FFont.SetColor(65793),this.btnAddCap.FFont.SetHeight(-12),this.btnAddCap.FFont.SetName("Segoe UI"),this.btnAddCap.FFont.SetStyle({}),this.btnAddCap.SetHeightStyle(2),this.btnAddCap.SetHeightPercent(100),this.btnAddCap.FModalResult=1,this.btnAddCap.SetParentFont(!1),this.btnAddCap.SetRole("button"),this.btnAddCap.SetTabOrder(4),this.btnAddCap.SetWidthPercent(100),this.btnReturn.SetParentComponent(this),this.btnReturn.SetName("btnReturn"),this.btnReturn.SetLeft(20),this.btnReturn.SetTop(376),this.btnReturn.SetWidth(120),this.btnReturn.SetHeight(40),this.btnReturn.FMargins.SetLeft(8),this.btnReturn.FMargins.SetTop(8),this.btnReturn.FMargins.SetRight(8),this.btnReturn.FMargins.SetBottom(8),this.btnReturn.FCancel=!0,this.btnReturn.SetCaption("Return"),this.btnReturn.SetChildOrderEx(10),this.btnReturn.SetElementClassName("btn btn-outline-success"),this.btnReturn.SetElementFont(1),this.btnReturn.FFont.FCharset=1,this.btnReturn.FFont.SetColor(65793),this.btnReturn.FFont.SetHeight(-12),this.btnReturn.FFont.SetName("Segoe UI"),this.btnReturn.FFont.SetStyle({}),this.btnReturn.SetHeightStyle(2),this.btnReturn.SetHeightPercent(100),this.btnReturn.FModalResult=2,this.btnReturn.SetParentFont(!1),this.btnReturn.SetRole("button"),this.btnReturn.SetTabOrder(3),this.btnReturn.SetWidthPercent(100)}finally{this.lb02New.AfterLoadDFMValues(),this.lb03Stereo.AfterLoadDFMValues(),this.lb04HD.AfterLoadDFMValues(),this.lb07Dolby.AfterLoadDFMValues(),this.lb08CC.AfterLoadDFMValues(),this.lb09OrigDate.AfterLoadDFMValues(),this.lb10Channel.AfterLoadDFMValues(),this.lb11Time.AfterLoadDFMValues(),this.pnlDetails.AfterLoadDFMValues(),this.lblTitle.AfterLoadDFMValues(),this.lblSubTitle.AfterLoadDFMValues(),this.lblDescription.AfterLoadDFMValues(),this.mmTitle.AfterLoadDFMValues(),this.mmSubTitle.AfterLoadDFMValues(),this.mmDescription.AfterLoadDFMValues(),this.btnAddCap.AfterLoadDFMValues(),this.btnReturn.AfterLoadDFMValues()}},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addField("pnlDetails",pas["WEBLib.ExtCtrls"].$rtti.TPanel),t.addField("lblTitle",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblSubTitle",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lblDescription",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("mmTitle",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("mmSubTitle",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("mmDescription",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addField("btnAddCap",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("btnReturn",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("lb02New",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb03Stereo",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb04HD",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb07Dolby",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb08CC",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb09OrigDate",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb10Channel",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addField("lb11Time",pas["WEBLib.StdCtrls"].$rtti.TLabel),t.addMethod("WebFormShow",0,[["Sender",pas.System.$rtti.TObject]])})),this.DetailsFrm=null}),["CWRmainForm"]),rtl.module("CWRmainForm",["System","SysUtils","Classes","WEBLib.Graphics","WEBLib.Forms","WEBLib.StdCtrls","WEBLib.StdCtrls","WEBLib.Controls","WEBLib.Dialogs","WEBLib.Imaging.pngImage","WEBLib.ExtCtrls","WEBLib.Controls","Web","JS","WEBLib.IndexedDb","WEBLib.Menus","WEBLib.Menus","WEBLib.Grids","DB","WEBLib.Grids","StrUtils","WEBLib.DBCtrls","WEBLib.WebCtrls","WEBLib.REST","Types","WEBLib.Storage","WEBLib.CDS","WEBLib.JSON","WEBLib.WebTools"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TCWRmainFrm",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.WIDBCDS=null,this.WebMemo2=null,this.AlertLabel=null,this.Captures=null,this.HistoryTable=null,this.BufferGrid=null,this.pnlCaptures=null,this.pnlHistory=null,this.pnlLog=null,this.pnlOptions=null,this.pnlWaitPls=null,this.WebRESTClient1=null,this.pnlListings=null,this.NewCaptures=null,this.pnlMenu=null,this.WebMainMenu1=null,this.Listing=null,this.Scheduled=null,this.History=null,this.Options=null,this.RefreshEPG=null,this.ChangeHTPC1=null,this.ViewLog1=null,this.Settings1=null,this.pnlStatus=null,this.WebGroupBox3=null,this.seNumHistEvents=null,this.WebGroupBox1=null,this.seNumDisplayDays=null,this.EPG=null,this.WebDataSource1=null,this.WebButton1=null,this.WebGridPanel1=null,this.WebLabel1=null,this.WebLabel2=null,this.WebComboBox1=null,this.WebComboBox2=null,this.lblEmptyEPG=null,this.ByAll=null,this.ByChannel=null,this.ByGenre=null,this.ByTitle=null,this.WebComboBox3=null,this.WebHTMLDiv1=null,this.WebHTMLDiv2=null,this.WebHTMLDiv3=null,this.pnlFilterComboBox=null,this.lblFilterSelect=null,this.btnOptOK=null,this.WebHTMLDiv4=null,this.HistoryGrid=null,this.EpgDb=null},this.$final=function(){this.WIDBCDS=void 0,this.WebMemo2=void 0,this.AlertLabel=void 0,this.Captures=void 0,this.HistoryTable=void 0,this.BufferGrid=void 0,this.pnlCaptures=void 0,this.pnlHistory=void 0,this.pnlLog=void 0,this.pnlOptions=void 0,this.pnlWaitPls=void 0,this.WebRESTClient1=void 0,this.pnlListings=void 0,this.NewCaptures=void 0,this.pnlMenu=void 0,this.WebMainMenu1=void 0,this.Listing=void 0,this.Scheduled=void 0,this.History=void 0,this.Options=void 0,this.RefreshEPG=void 0,this.ChangeHTPC1=void 0,this.ViewLog1=void 0,this.Settings1=void 0,this.pnlStatus=void 0,this.WebGroupBox3=void 0,this.seNumHistEvents=void 0,this.WebGroupBox1=void 0,this.seNumDisplayDays=void 0,this.EPG=void 0,this.WebDataSource1=void 0,this.WebButton1=void 0,this.WebGridPanel1=void 0,this.WebLabel1=void 0,this.WebLabel2=void 0,this.WebComboBox1=void 0,this.WebComboBox2=void 0,this.lblEmptyEPG=void 0,this.ByAll=void 0,this.ByChannel=void 0,this.ByGenre=void 0,this.ByTitle=void 0,this.WebComboBox3=void 0,this.WebHTMLDiv1=void 0,this.WebHTMLDiv2=void 0,this.WebHTMLDiv3=void 0,this.pnlFilterComboBox=void 0,this.lblFilterSelect=void 0,this.btnOptOK=void 0,this.WebHTMLDiv4=void 0,this.HistoryGrid=void 0,this.EpgDb=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)};var t=["Ch Name","RecordStart","RecordEnd","Title","SubTitle","StartTime","ProgramID"],i=[75,95,95,150,400,0,0];this.SetNewCapturesFixedRow=function(){for(var e=0,s=0,n=this.NewCaptures.FColCount-1;s<=n;s++)e=s,this.NewCaptures.SetCells(e,0,t[e]),this.NewCaptures.SetColWidths(e,i[e])},this.EPGGetCellClass=function(t,e,i,s,n,r){0!==i&&(this.EPG.GetCells(3,i)===this.EpgDb.FFieldList.GetField(0).GetAsString()?r.set(this.EPG.GetCells(4,i)):r.set("white"))},this.SaveNewCapturesFile=async function(t){var i,s=null;e.SaveLocalStrings(this.NewCaptures,"nc"),(s=pas.Classes.TStringList.$create("Create$1")).SetLineBreak("\r\n"),this.NewCaptures.SaveToStrings(s,",",!0),window.console.log("id: "+t),window.console.log("data.text: ",s.GetTextStr()),i=await this.WebRESTClient1.HttpRequest("PATCH","https://www.googleapis.com/upload/drive/v3/files/"+t,s.GetTextStr(),"",null),window.console.log(i),200===i.status?pas["WEBLib.Dialogs"].ShowMessage("Request successfully updated.\r\rN.B.:  NOT scheduled until CW_EPG's next run."):pas["WEBLib.Dialogs"].ShowMessage("Request submission FAILED.\r\rIf this is the first failure, please retry.")},this.LoadWIDBCDS=async function(){var t=0,i=0,s=0,n="",r="";e.Log("======= Starting LoadWIDBCDS, DB is "+pas.StrUtils.IfThen(!this.WIDBCDS.GetActive(),"not ","")+"Active"),await this.ShowPlsWait("Updating IndexedDB"),this.WIDBCDS.DisableControls(),this.EPG.BeginUpdate(),this.WIDBCDS.SetFiltered(!1),e.Log("WIDBCDS is "+pas.StrUtils.IfThen(!this.WIDBCDS.FFiltered,"UN","")+"filtered");try{if(this.WIDBCDS.GetActive()&&this.BufferGrid.FRowCount>1){e.Log("LoadWIDBCDS, CDS.RecordCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.WIDBCDS.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("LoadWIDBCDS, Buffer Row Count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.BufferGrid,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),this.WIDBCDS.EmptyDataSet(),e.Log("LoadWIDBCDS, After EmptyDataSet CDS.RecordCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.WIDBCDS.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}}));for(var o=1,a=this.BufferGrid.FRowCount-1;o<=a;o++){i=o,this.BufferGrid.SetCells(0,i,pas.StrUtils.ReplaceStr(this.BufferGrid.GetCells(0,i),'"',"")),this.WIDBCDS.Insert$1(),this.WIDBCDS.FFieldList.GetField(0).SetAsJSValue(i);for(var l=1,h=this.BufferGrid.FColCount;l<=h;l++)t=l,1===this.WIDBCDS.FFieldList.GetField(t).FDataType?this.WIDBCDS.FFieldList.GetField(t).SetAsJSValue(this.BufferGrid.GetCells(t-1,i)):pas.SysUtils.TryStrToDateTime(this.BufferGrid.GetCells(t-1,i),{get:function(){return s},set:function(t){s=t}})&&this.WIDBCDS.FFieldList.GetField(t).SetAsJSValue(s);r=this.WIDBCDS.FFieldList.GetField(8).GetAsString(),n=pas.SysUtils.TStringHelper.StartsWith.call({get:function(){return r},set:function(t){r=t}},"MV")?"goldenRod":pas.SysUtils.TStringHelper.StartsWith.call({get:function(){return r},set:function(t){r=t}},"SH")?pas.StrUtils.IfThen(pas.SysUtils.TStringHelper.Contains.call({p:this.WIDBCDS.FFieldList.GetField(14).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},'"News"'),"green","gray"):pas.StrUtils.IfThen(""!==this.WIDBCDS.FFieldList.GetField(10).GetAsString(),"green","rose"),this.WIDBCDS.FFieldList.GetField(15).SetAsJSValue(n),await this.WIDBCDS.PostAsync()}}e.Log("Finished editing WIDBCDS, RecordCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.WIDBCDS.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}}))}finally{e.Log("WIDBCDS is "+pas.StrUtils.IfThen(this.WIDBCDS.GetActive(),"NOT ","")+"closed"),e.Log("calling WIDBCDS.EnableControls"),this.WIDBCDS.EnableControls(),e.Log("WIDBCDS Controls are "+pas.StrUtils.IfThen(this.WIDBCDS.ControlsDisabled(),"NOT ","")+"Enabled"),e.Log("WIDBCDS is "+pas.StrUtils.IfThen(!this.WIDBCDS.GetActive(),"NOT ","")+"Open"),e.Log("calling EPG.EndUpdate"),this.EPG.EndUpdate(),e.Log("EPG update is "+pas.StrUtils.IfThen(this.EPG.IsUpdating(),"NOT ","")+"ended"),e.Log("WIDBCDS RecordCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.WIDBCDS.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("========= Finished LoadWIDBCDS"),this.pnlWaitPls.Hide(),await sleep(10),this.WIDBCDS.Close()}},this.WIDBCDSIDBError=function(t,e,i,s){pas["WEBLib.Dialogs"].ShowMessage(t.FName+" error: "+i+", msg: "+s)},this.UpdateEPG=async function(t){var i="";e.Log('======== "Update EPG" (Refresh Data) clicked'),pas["WEBLib.Storage"].TLocalStorage.Clear(),pas["WEBLib.Storage"].TLocalStorage.SetValue(e.NUMHIST,pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumHistEvents.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),pas["WEBLib.Storage"].TLocalStorage.SetValue(e.NUMDAYS,pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),await this.RefreshCSV(this.BufferGrid,"cwr_epg.csv","EPG",{get:function(){return i},set:function(t){i=t}}),this.BufferGrid.FRowCount>0&&(await this.LoadWIDBCDS(),await this.FetchCapReservations(),await this.FetchNewCapRequests(),await this.FetchHistory(),await this.SetupEpgDb()),3!==e.VisiblePanelNum&&this.ByAllClick(t)},this.WebFormCreate=async function(t){var i;e.Log("FormCreate is called"),console.log("Starting "+ProjectName),window.sleep=async function(t){return new Promise(e=>setTimeout(e,t))},i=ProjectName,e.Log("Running version:  "+i),e.Log("App is "+pas.StrUtils.IfThen(!pas["WEBLib.Forms"].Application.GetIsOnline(),"NOT ","")+"online"),this.WebRESTClient1.ReadTokens(),""!==pas["WEBLib.Storage"].TLocalStorage.GetValue(e.NUMDAYS)&&this.seNumDisplayDays.SetValue(pas.SysUtils.StrToInt(pas["WEBLib.Storage"].TLocalStorage.GetValue(e.NUMDAYS))),""!==pas["WEBLib.Storage"].TLocalStorage.GetValue(e.NUMHIST)&&this.seNumHistEvents.SetValue(pas.SysUtils.StrToInt(pas["WEBLib.Storage"].TLocalStorage.GetValue(e.NUMHIST))),this.WebMainMenu1.FAppearance.FHamburgerMenu.SetCaption("["+pas["WEBLib.Storage"].TWebLocalStorage.GetValue(e.EMAILADDR)+"]"),await this.SetupWIDBCDS(),e.Log("FormCreate, "+this.WIDBCDS.FName+" record count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.WIDBCDS.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),await this.SetupEpgDb(),this.EpgDb.First(),await this.ReFreshListings(),e.Log("FormCreate is finished")},this.tbCapturesShow=async function(){var t=0,i=0,s=0;if(this.ReloadSG(this.Captures,"sl"),this.Captures.FRowCount>1)for(var n=this.Captures.FRowCount-1;n>=1;n--)t=n,this.Captures.GetCells(3,t)>""&&(i=pas.SysUtils.StrToDateTime(this.Captures.GetCells(3,t)+" "+this.Captures.GetCells(4,t)),(s=pas.SysUtils.StrToDateTime(this.Captures.GetCells(3,t)+" "+this.Captures.GetCells(5,t)))<i&&(s+=1),s<pas.SysUtils.Now()&&(window.console.log("Removing stale entry, endtime: "+pas.SysUtils.DateTimeToStr(s,!1)),this.Captures.RemoveRow(t)));if(this.ReloadSG(this.NewCaptures,"nc"),this.SetNewCapturesFixedRow(),this.NewCaptures.FRowCount>1)for(var r=this.NewCaptures.FRowCount-1;r>=1;r--)t=r,this.NewCaptures.GetCells(0,t)>""&&(i=pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(1,t)),(s=pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(2,t)))<pas.SysUtils.Now()&&(window.console.log("Removing stale entry, endtime: "+pas.SysUtils.DateTimeToStr(s,!1)),this.NewCaptures.RemoveRow(t)));for(var o=0,a=this.Captures.FColCount-1;o<=a;o++)t=o,this.Captures.SetColWidths(t,0);for(this.Captures.SetColWidths(1,80),this.Captures.SetColWidths(2,100),this.Captures.SetColWidths(3,65),this.Captures.SetColWidths(4,45),this.Captures.SetColWidths(5,45),this.Captures.SetColWidths(6,70),this.Captures.SetColWidths(8,this.Captures.GetClientWidth()),t=1;t<=6;t++)this.Captures.SetColAlignments(t,2);e.Log("AllCapsGrid.RowCount after stale check: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.Captures,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),2===this.Captures.FRowCount&&"-1"===this.Captures.GetCells(25,1)?(e.Log("No captures listed, prompting for EPG fetch"),6===await pas["WEBLib.Dialogs"].MessageDlgAsync("There were no scheduled items at last fetch.\r\rDo you want to refresh the list?",3,rtl.createSet(0,1))&&await this.UpdateEPG(this)):this.Captures.FRowCount<2&&(e.Log("No fresh captures, prompting for EPG fetch"),6===await pas["WEBLib.Dialogs"].MessageDlgAsync("Scheduled list appears to be stale.\r\rDo you want to refresh it?",3,rtl.createSet(0,1))&&await this.UpdateEPG(this))},this.AllCapsGridGetCellData=function(t,e,i,s,n){if(i>0){var r=e;1===r?n.get().length>10&&n.set(pas.StrUtils.LeftStr(n.get(),4)+"..."+pas.StrUtils.RightStr(n.get(),3)):2===r&&n.set(pas.System.Copy(n.get(),4,10))}},this.HistoryTableFixedCellClick=function(t,i,s){var n=0,r=0;r="^"===pas.StrUtils.RightStr(this.HistoryTable.GetCells(i,0),1)?2:1,e.Log("HistoryTableFixedCellClick, ACol: "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}})+", RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),n=pas.Math.IfThen(0===i,4,i),this.HistoryTable.BeginUpdate(),this.HistoryTable.Sort(n,r),this.HistoryTable.EndUpdate(),e.Log("HistoryTableFixedCellClick, after sort, RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}}));for(var o=0,a=this.HistoryTable.FColCount-1;o<=a;o++)n=o,pas.SysUtils.TStringHelper.Contains.call({get:function(){return"^v"},set:function(t){rtl.raiseE("EPropReadOnly")}},pas.StrUtils.RightStr(this.HistoryTable.GetCells(n,0),1))&&this.HistoryTable.SetCells(n,0,pas.StrUtils.LeftStr(this.HistoryTable.GetCells(n,0),this.HistoryTable.GetCells(n,0).length-2));this.HistoryTable.SetCells(i,0,this.HistoryTable.GetCells(i,0)+pas.StrUtils.IfThen(2===r," v"," ^"))},this.UpdateHistory=async function(t){await this.FetchHistory(),this.SetPage(2)},this.ChangeTargetHTPC=async function(t){e.Log("Server reset requested"),6===await pas["WEBLib.Dialogs"].MessageDlgAsync("Current HTPC account: "+pas["WEBLib.Storage"].TLocalStorage.GetValue(e.EMAILADDR)+"\r\rDo you want to change it?",3,rtl.createSet(0,1))&&(e.ResetPrompt="select_account",this.UpdateEPG(t))},this.ListingClick=function(t){this.SetPage(0)},this.HistoryClick=function(t){this.SetPage(2)},this.ScheduledClick=function(t){this.SetPage(1)},this.ViewLog1Click=function(t){this.SetPage(3)},this.Settings1Click=function(t){this.SetPage(4)},this.EPGClickCell=async function(t,i,s){var n=null,r=null,o=[];this.EPG.BeginUpdate(),await sleep(10),e.Log("========== EPGClickCell() called from RC "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}})+", "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}})),n=pas.Details.TDetailsFrm.$create("Create$1",[this]),this.EpgDb.DisableControls();try{if(this.EpgDb.Locate("id",this.EPG.GetCells(3,s),{}))try{if(n.FPopup=!0,n.SetBorder(1),await n.Load(),n.mmTitle.SetText(this.EpgDb.FFieldList.GetField(3).GetAsString()),n.mmSubTitle.SetText(this.EpgDb.FFieldList.GetField(4).GetAsString()),n.lb11Time.SetCaption(this.EpgDb.FFieldList.GetField(2).GetAsString()),n.lb10Channel.SetCaption(this.EpgDb.FFieldList.GetField(1).GetAsString()),o=pas.SysUtils.TStringHelper.Split$1.call({p:this.EpgDb.FFieldList.GetField(9).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},["-"]),n.lb09OrigDate.SetCaption(pas.StrUtils.IfThen(3===rtl.length(o),"1st Aired "+o[1]+"/"+o[2]+"/"+pas.StrUtils.RightStr(o[0],2),pas.StrUtils.IfThen(this.EpgDb.FFieldList.GetField(13).GetAsString()>"","Movie Yr "+this.EpgDb.FFieldList.GetField(13).GetAsString(),""))),e.SetLabelStyle(n.lb02New,""!==this.EpgDb.FFieldList.GetField(10).GetAsString()),e.SetLabelStyle(n.lb08CC,pas.SysUtils.TStringHelper.Contains.call({p:this.EpgDb.FFieldList.GetField(11).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},"cc")),e.SetLabelStyle(n.lb03Stereo,pas.SysUtils.TStringHelper.Contains.call({p:this.EpgDb.FFieldList.GetField(11).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},"stereo")),e.SetLabelStyle(n.lb07Dolby,pas.SysUtils.TStringHelper.Contains.call({p:this.EpgDb.FFieldList.GetField(11).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},"DD")),n.lb04HD.SetCaption("SD"),this.EpgDb.FFieldList.GetField(12).GetAsString()>""&&n.lb04HD.SetCaption(pas.SysUtils.TStringHelper.Split$8.call({p:this.EpgDb.FFieldList.GetField(12).GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},['["HD ','"'])[1]),e.SetLabelStyle(n.lb04HD,"SD"!==n.lb04HD.FCaption),n.mmDescription.SetText(this.EpgDb.FFieldList.GetField(5).GetAsString()),await n.Execute(),1===n.FModalResult){(r=pas.SchedUnit2.TSchedForm.$create("Create$1",[this])).SetCaption("Schedule Capture Event"),r.FPopup=!0,r.SetBorder(1);try{await r.Load(),r.mmTitle.SetText(n.mmTitle.GetText()),r.mmSubTitle.SetText(n.mmSubTitle.GetText()),r.mmDescription.SetText(n.mmDescription.GetText()),r.lblChannelValue.SetCaption(n.lb10Channel.FCaption),o=pas.SysUtils.TStringHelper.Split$8.call({p:n.lb11Time,get:function(){return this.p.FCaption},set:function(t){this.p.FCaption=t}},[" ","--"]),r.lblStartDateValue.SetCaption(o[0]),r.tpStartTime.SetDateTime(pas.SysUtils.StrToDateTime(o[0]+" "+o[1])),r.tpEndTime.SetDateTime(pas.SysUtils.StrToDateTime(o[0]+" "+o[2])),r.tpEndTime.GetDateTime()<r.tpStartTime.GetDateTime()&&r.tpEndTime.SetDateTime(r.tpEndTime.GetDateTime()+1),e.Log("Finished setting up new form"),await r.Execute(),1===r.FModalResult&&(await this.ShowPlsWait("Saving Capture Request."),await this.UpdateNewCaptures(r.tpStartTime.GetDateTime(),r.tpEndTime.GetDateTime()))}finally{e.Log("Finished with Schedule form"),r=rtl.freeLoc(r)}}}finally{this.pnlWaitPls.Hide(),n=rtl.freeLoc(n),await sleep(100)}}catch(t){e.Log('Locate raised an improper Exception instead of "False"')}this.EpgDb.EnableControls(),this.EPG.EndUpdate()},this.HistoryTableGetCellClass=function(t,e,i,s,n,r){if(i>0&&this.HistoryTable.GetCells(0,i)>""){var o=this.HistoryTable.GetCells(1,i).charAt(0);"E"===o?r.set("green"):"S"===o?r.set("gray"):"M"===o?r.set("goldenRod"):r.set("white")}},this.ByGenreClick=async function(t){e.Log("ByGenreClick called"),0===this.WebComboBox1.FItems.GetCount()&&await this.SetupFilterList(this.WebComboBox1,"genres"),this.pnlFilterComboBox.Show(),this.WebComboBox1.Show(),await sleep(10),this.SetPage(0)},this.WebComboBox1Change=async function(t){this.EPG.FColumns.GetItem$1(2).SetTitle(pas.StrUtils.IfThen("All"===this.WebComboBox1.GetText(),"Title",'Programs in genre "'+this.WebComboBox1.GetText()+'"')),e.Log("WebComboBox1.Text: "+this.WebComboBox1.GetText()),this.SetFilter(pas.StrUtils.IfThen("All"!==this.WebComboBox1.GetText(),"genres like "+pas.SysUtils.QuotedStr('%"'+pas.StrUtils.ReplaceStr(this.WebComboBox1.GetText(),"/","_")+'"%',"'"),"")),this.ByGenre.SetChecked("All"!==this.WebComboBox1.GetText()),this.ByAll.SetChecked(!this.ByGenre.FChecked),this.ByAll.FChecked&&this.WebComboBox1FocusOut(t)},this.ByTitleClick=async function(t){e.Log("byTitleClick called"),0===this.WebComboBox2.FItems.GetCount()&&await this.SetupFilterList(this.WebComboBox2,"Title"),this.pnlFilterComboBox.Show(),this.WebComboBox2.Show(),await sleep(10),this.WebComboBox2.SetItemIndex(this.WebComboBox2.FItems.IndexOf(this.EpgDb.FieldByName("Title").GetAsString())),this.SetPage(0)},this.WebComboBox2Change=async function(t){this.EPG.FColumns.GetItem$1(2).SetTitle("Title"+pas.StrUtils.IfThen("All"!==this.WebComboBox2.GetText(),': "'+this.WebComboBox2.GetText()+'"',"")),e.Log("WebComboBox2.Text: "+this.WebComboBox2.GetText()),this.SetFilter(pas.StrUtils.IfThen("All"!==this.WebComboBox2.GetText(),"Title = "+pas.SysUtils.QuotedStr(this.WebComboBox2.GetText(),"'"),"")),this.ByTitle.SetChecked("All"!==this.WebComboBox2.GetText()),this.ByAll.SetChecked(!this.ByTitle.FChecked),this.ByAll.FChecked&&this.WebComboBox2FocusOut(t)},this.ByAllClick=async function(t){e.Log("ByAllClick called"),this.EPG.FColumns.GetItem$1(2).SetTitle("Title"),this.ByAll.SetChecked(!0),this.SetFilter(""),this.SetPage(0)},this.ByChannelClick=async function(t){e.Log("ByChannelClick called"),0===this.WebComboBox3.FItems.GetCount()&&await this.SetupFilterList(this.WebComboBox3,"PSIP"),this.pnlFilterComboBox.Show(),this.WebComboBox3.Show(),await sleep(10),this.SetPage(0)},this.WebComboBox3Change=async function(t){this.EPG.FColumns.GetItem$1(2).SetTitle(pas.StrUtils.IfThen("All"===this.WebComboBox1.GetText(),"Title",'Programs on channel "'+this.WebComboBox3.GetText()+'"')),e.Log("WebComboBox3.Text: "+this.WebComboBox3.GetText()),this.SetFilter(pas.StrUtils.IfThen("All"!==this.WebComboBox3.GetText(),"PSIP = "+pas.SysUtils.QuotedStr(this.WebComboBox3.GetText(),"'"),"")),this.ByChannel.SetChecked("All"!==this.WebComboBox3.GetText()),this.ByAll.SetChecked(!this.ByChannel.FChecked),this.ByAll.FChecked&&this.WebComboBox3FocusOut(t)},this.NewCapturesClickCell=async function(t,i,s){var n="",r="",o="",a="",l=0,h=0,u=0;if(0!==s&&6===await pas["WEBLib.Dialogs"].MessageDlgAsync("Remove selected program?",3,rtl.createSet(0,1))){if(n=this.NewCaptures.GetCells(0,s),l=pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(1,s)),h=pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(2,s)),r=this.NewCaptures.GetCells(3,s),o=this.NewCaptures.GetCells(6,s),this.NewCaptures.BeginUpdate(),await this.RefreshCSV(this.NewCaptures,"cwr_newcaptures.csv","NewCaptures",{get:function(){return a},set:function(t){a=t}}),e.Log("NewCaptures Rows: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.NewCaptures,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),this.NewCaptures.FRowCount>1)for(var d=1,F=this.NewCaptures.FRowCount-1;d<=F;d++)if(u=d,pas.SysUtils.SameText(n,this.NewCaptures.GetCells(0,u))&&pas.SysUtils.SameText(r,this.NewCaptures.GetCells(3,u))&&pas.SysUtils.SameText(o,this.NewCaptures.GetCells(6,u))&&pas.DateUtils.SameDateTime(l,pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(1,u)))&&pas.DateUtils.SameDateTime(h,pas.SysUtils.StrToDateTime(this.NewCaptures.GetCells(2,u)))){this.NewCaptures.RemoveRow(u),this.SaveNewCapturesFile(a);break}this.NewCaptures.EndUpdate(),this.pnlWaitPls.Hide()}},this.NewCapturesGetCellData=function(t,e,i,s,n){i>0&&e in rtl.createSet(1,2)&&n.set(pas.SysUtils.FormatDateTime("mm/dd HH:nn",pas.SysUtils.StrToDateTime(n.get())))},this.WebComboBox1FocusOut=function(t){this.pnlFilterComboBox.Hide(),this.WebComboBox1.Hide()},this.WebComboBox2FocusOut=function(t){this.pnlFilterComboBox.Hide(),this.WebComboBox2.Hide()},this.WebComboBox3FocusOut=function(t){this.pnlFilterComboBox.Hide(),this.WebComboBox3.Hide()},this.btnOptOKClick=function(t){this.SetPage(0)},this.seNumHistEventsChange=function(t){pas["WEBLib.Storage"].TLocalStorage.SetValue(e.NUMHIST,pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumHistEvents.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("New number History Items: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumHistEvents.GetValue(),get:function(){return this.p},set:function(t){this.p=t}}))},this.seNumDisplayDaysChange=function(t){function i(t){t.SetItemIndex(-1),t.FItems.Clear()}e.LastStartDate-e.FirstEndDate>=this.seNumDisplayDays.GetValue()?(pas["WEBLib.Storage"].TLocalStorage.SetValue(e.NUMDAYS,pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("New number EPG Display Days: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),i(this.WebComboBox1),i(this.WebComboBox2),i(this.WebComboBox3),pas["WEBLib.Forms"].Application.Navigate(pas["WEBLib.Forms"].Application.EXEName(),1)):(pas["WEBLib.Dialogs"].ShowMessage("I currently have less than the requested "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})+" days of listings stored.\rTo display more, please use Options | Refresh Data"),this.seNumDisplayDays.SetValue(pas.SysUtils.TStringHelper.ToInteger$1.call({a:pas["WEBLib.Storage"].TLocalStorage.GetValue(e.NUMDAYS),get:function(){return this.a},set:function(t){this.a=t}})))},this.ReloadSG=function(t,i){var s=0,n=null;if(t.SetRowCount(1),pas["WEBLib.Storage"].TLocalStorage.GetValue(i+"1")>""){for(n=pas.Classes.TStringList.$create("Create$1"),s=0;pas.StrUtils.ReplaceStr(pas.StrUtils.ReplaceStr(pas["WEBLib.Storage"].TLocalStorage.GetValue(i+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}})),'"',""),",","")>"";)n.Add(pas["WEBLib.Storage"].TLocalStorage.GetValue(i+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}}))),s+=1;t.LoadFromStrings(n,",",!0),n=rtl.freeLoc(n)}e.Log(t.FName+" Row Count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:t,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}}))},this.SetPage=async function(t){var i=t;0===i?this.pnlListings.BringToFront():1===i?(this.pnlCaptures.BringToFront(),this.tbCapturesShow()):2===i?(this.pnlHistory.BringToFront(),this.tbHistoryShow()):3===i?this.pnlLog.BringToFront():4===i&&this.pnlOptions.BringToFront(),e.VisiblePanelNum=t},this.FetchCapReservations=async function(){var t="";e.Log(" ====== FetchCapReservations called ========="),this.Captures.FOnGetCellData=null,await this.RefreshCSV(this.Captures,"cwr_captures.csv","Scheduled",{get:function(){return t},set:function(e){t=e}}),e.SaveLocalStrings(this.Captures,"sl"),this.Captures.FOnGetCellData=rtl.createCallback(this,"AllCapsGridGetCellData"),e.Log(" ====== FetchCapReservations finished =========")},this.FetchNewCapRequests=async function(){var t="";e.Log(" ====== FetchNewCapRequests called ========="),this.NewCaptures.FOnGetCellData=null,await this.RefreshCSV(this.NewCaptures,"cwr_newcaptures.csv","NewCAptures",{get:function(){return t},set:function(e){t=e}}),e.SaveLocalStrings(this.NewCaptures,"nc"),this.NewCaptures.FOnGetCellData=rtl.createCallback(this,"NewCapturesGetCellData"),e.Log(" ====== FetchNewCapRequests finished =========")},this.RefreshCSV=async function(t,i,s,n){var r="",o="",a=null,l=[];if(e.Log("ReFreshCSV called for "+i),await this.ShowPlsWait("Refreshing "+s),pas["WEBLib.Forms"].Application.GetIsOnline()){t.BeginUpdate();try{e.Log("Requesting: "+i);try{if(""!==(r=await this.GetGoogleDriveFile(i,n))){e.Log(pas.System.Copy(r,1,500)),a=pas.Classes.TStringList.$create("Create$1"),r=pas.StrUtils.ReplaceStr(r,"\n",""),r=pas.StrUtils.ReplaceStr(r," ",""),l=pas.SysUtils.TStringHelper.Split$5.call({get:function(){return r},set:function(t){r=t}},["\r"],1),e.Log("Begin extract "+pas.SysUtils.IntToStr(rtl.length(l))+" strings");for(var h=l,u=0,d=rtl.length(h)-1;u<=d;u++)o=h[u],a.Add(o);t.LoadFromStrings(a,",",!0),e.Log(t.FName+".RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:t,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),e.Log("Done loading "+t.FName),a=rtl.freeLoc(a)}else t.SetRowCount(0)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var F=t;e.Log("HttpRequest Exception: "+F.FMessage),pas["WEBLib.Dialogs"].ShowMessage("Cannot refresh EPG data while CW_EPG_Remote is offline")}}finally{e.Log("Enter finally section"),t.EndUpdate()}}else pas["WEBLib.Dialogs"].ShowMessage("Cannot refresh EPG data while offline."),e.Log("No LAN connection");e.Log("ReFreshCSV, "+t.FName+" RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:t,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}}))},this.FetchHistory=async function(){var t=0,i="",s=null;e.Log(" ====== FetchHistory called ========="),this.HistoryGrid.BeginUpdate(),this.HistoryGrid.SetColCount(32),await this.RefreshCSV(this.HistoryGrid,"cwr_history.csv","History",{get:function(){return i},set:function(t){i=t}}),e.Log("History Rows: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryGrid,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}}));for(var n=this.HistoryGrid.FRowCount-1;n>=1;n--)t=n,""===this.HistoryGrid.GetCells(0,t)?this.HistoryGrid.RemoveRow(t):this.HistoryGrid.SetCells(0,t,pas.StrUtils.RightStr("000000"+this.HistoryGrid.GetCells(0,t),6));this.HistoryGrid.Sort(0,1),e.Log("History Rows: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryGrid,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),s=pas.Classes.TStringList.$create("Create$1"),this.HistoryGrid.SaveToStrings(s,",",!0),e.Log("sl Count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:s.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})),pas["WEBLib.Storage"].TLocalStorage.SetValue("hl0",s.Get(0));for(var r=1,o=s.GetCount()-1;r<=o;r++)t=r,pas["WEBLib.Storage"].TLocalStorage.SetValue("hl"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return t},set:function(e){t=e}}),s.Get(s.GetCount()-t));s=rtl.freeLoc(s),this.HistoryGrid.EndUpdate(),e.Log(" ====== FetchHistory finished =========")},this.ReFreshListings=async function(){e.Log(" ======== RefreshListings is called."),this.EPG.SetVisible(!1),await sleep(10),this.EpgDb.GetActive()||(await this.ShowPlsWait("Opening EpgDb."),await this.EpgDb.Open()),e.Log("EpgDb.RecordCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.EpgDb.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("Days to Display: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})),this.EPG.BeginUpdate(),await this.ShowPlsWait("Preparing "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.seNumDisplayDays.GetValue(),get:function(){return this.p},set:function(t){this.p=t}})+"-day Listing."),this.EPG.FColumns.GetItem$1(0).SetAlignment(2),this.EPG.FColumns.GetItem$1(2).SetAlignment(0),e.Log("EpgDb Controls are "+pas.StrUtils.IfThen(!this.EpgDb.ControlsDisabled(),"enabled","disabled")),this.EPG.EndUpdate(),e.Log("EPG Update is "+pas.StrUtils.IfThen(this.EPG.IsUpdating(),"not ","")+"finished"),this.EPG.Refresh(),this.EPG.SetVisible(!0),this.pnlListings.BringToFront(),await sleep(10),e.Log(" ======== RefreshListings finished")},this.tbHistoryShow=async function(){this.HistoryTable.SetVisible(!1),await this.FillHistoryDisplay(),e.Log("HistoryTable.RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),this.HistoryTable.FRowCount!==this.seNumHistEvents.GetValue()+1&&(e.Log("The History list is empty/incomplete. Prompt for refresh"),6===await pas["WEBLib.Dialogs"].MessageDlgAsync("The History list "+pas.StrUtils.IfThen(this.HistoryTable.FRowCount<2,"is empty","may be incomplete")+"\r\rDo you want to refresh it now?",3,rtl.createSet(0,1))&&await this.UpdateHistory(this)),this.HistoryTable.SetVisible(!0)},this.FillHistoryDisplay=async function(){var t=null,i=0;e.Log("FillHistoryDisplay called"),this.HistoryTable.FOnGetCellClass=null,t=pas.Classes.TStringList.$create("Create$1");for(var s=0,n=this.seNumHistEvents.GetValue();s<=n;s++)i=s,pas["WEBLib.Storage"].TLocalStorage.GetValue("hl"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}}))>""&&t.Add(pas["WEBLib.Storage"].TLocalStorage.GetValue("hl"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}})));e.Log("sl.Count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:t.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("historyTable.BeginUpdate"),this.HistoryTable.BeginUpdate(),this.HistoryTable.SetRowCount(t.GetCount()),t.GetCount()>1&&(e.Log("historyTable.LoadFromStrings"),this.HistoryTable.LoadFromStrings(t,",",!0),e.Log("historyTable.RowCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),this.HistoryTable.EndUpdate()),e.Log("historyTable.ColCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FColCount},set:function(t){this.p.FColCount=t}})),this.HistoryTable.BeginUpdate();for(var r=this.HistoryTable.FColCount-1;r>=0;r--)(i=r)in rtl.createSet(8,10,12,13,14)||this.HistoryTable.RemoveColumn(i);e.Log("historyTable.ColCount: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.HistoryTable,get:function(){return this.p.FColCount},set:function(t){this.p.FColCount=t}})),t.Clear(),this.HistoryTable.SaveToStrings(t,",",!0),this.HistoryTable.FOnGetCellClass=rtl.createCallback(this,"HistoryTableGetCellClass"),this.HistoryTable.LoadFromStrings(t,",",!0),t=rtl.freeLoc(t),e.SetTableDefaults(this.HistoryTable,120,150,250,300);for(var o=1,a=this.HistoryTable.FRowCount-1;o<=a;o++)i=o,this.HistoryTable.SetCells(4,i,pas.SysUtils.Format("%10.3f",pas.System.VarRecs(3,pas.SysUtils.StrToDateTime(this.HistoryTable.GetCells(0,i))))),this.HistoryTable.SetCells(0,i,pas.SysUtils.FormatDateTime("mm/dd/yy h:nna/p",pas.SysUtils.StrToDateTime(this.HistoryTable.GetCells(0,i))));this.HistoryTable.SetCells(0,0,this.HistoryTable.GetCells(0,0)+" v"),this.HistoryTable.EndUpdate(),e.Log("FillHistoryDisplay finished")},this.UpdateNewCaptures=async function(t,i){var s=0,n="";if(e.Log(" ====== UpdateNewCaptures called ========="),await this.RefreshCSV(this.NewCaptures,"cwr_newcaptures.csv","NewCaptures",{get:function(){return n},set:function(t){n=t}}),e.Log("NewCaptures Rows: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.NewCaptures,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),0===this.NewCaptures.FRowCount)this.NewCaptures.SetRowCount(1),this.NewCaptures.SetColCount(7),await this.CreateGoogleFile("cwr_newcaptures.csv",{get:function(){return n},set:function(t){n=t}});else for(var r=this.NewCaptures.FRowCount-1;r>=1;r--)s=r,""===this.NewCaptures.GetCells(0,s)&&this.NewCaptures.RemoveRow(s);this.SetNewCapturesFixedRow(),this.NewCaptures.SetRowCount(this.NewCaptures.FRowCount+1),this.NewCaptures.SetCells(0,this.NewCaptures.FRowCount-1,this.EpgDb.FieldByName("PSIP").GetAsString()),this.NewCaptures.SetCells(1,this.NewCaptures.FRowCount-1,pas.SysUtils.DateTimeToStr(t,!1)),this.NewCaptures.SetCells(2,this.NewCaptures.FRowCount-1,pas.SysUtils.DateTimeToStr(i,!1)),this.NewCaptures.SetCells(3,this.NewCaptures.FRowCount-1,pas.StrUtils.ReplaceStr(this.EpgDb.FieldByName("Title").GetAsString(),"&","&&")),this.NewCaptures.SetCells(4,this.NewCaptures.FRowCount-1,this.EpgDb.FieldByName("SubTitle").GetAsString()),this.NewCaptures.SetCells(5,this.NewCaptures.FRowCount-1,pas.SysUtils.TStringHelper.Split$8.call({p:this.EpgDb.FieldByName("Time").GetAsString(),get:function(){return this.p},set:function(t){this.p=t}},["--"])[0]),this.NewCaptures.SetCells(6,this.NewCaptures.FRowCount-1,this.EpgDb.FieldByName("ProgramID").GetAsString()),this.SaveNewCapturesFile(n),e.Log("Final NewCaptures Table Rows: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.NewCaptures,get:function(){return this.p.FRowCount},set:function(t){this.p.FRowCount=t}})),e.Log(" ====== UpdateNewCaptures finished =========")},this.GetGoogleDriveFile=async function(t,i){var s=this,n="",r="",o="",a=null,l=null,h=null,u=0;async function d(){return window.console.log("AccessToken: "+s.WebRESTClient1.FAccessToken),""===s.WebRESTClient1.FAccessToken&&(e.ResetPrompt="select_account"),s.WebRESTClient1.FApp.FKey="654508083810-kdj6ob7srm922egkvdmcj36hfa1hitav.apps.googleusercontent.com",s.WebRESTClient1.FApp.FCallbackURL=window.location.href,s.WebRESTClient1.FApp.FAuthURL="https://accounts.google.com/o/oauth2/v2/auth?client_id="+s.WebRESTClient1.FApp.FKey+"&include_granted_scopes&scope=https://www.googleapis.com/auth/drive&state=bf&response_type=token&redirect_uri="+s.WebRESTClient1.FApp.FCallbackURL+"&prompt="+e.ResetPrompt,window.console.log("WEBRESTClient1.App.CallBackURL: "+s.WebRESTClient1.FApp.FCallbackURL),""!==s.WebRESTClient1.FAccessToken&&"none"===e.ResetPrompt||(window.console.log("Performing OAuth"),await s.WebRESTClient1.Authenticate()),200===(a=await s.WebRESTClient1.HttpRequest("GET","https://www.googleapis.com/drive/v3/about/?fields=kind,user","","",null)).status&&(l=(l=pas["WEBLib.JSON"].TJSONObject.ParseJSONValue(a.responseText)).GetValue$1("user"),pas["WEBLib.Storage"].TLocalStorage.SetValue(e.EMAILADDR,l.GetJSONValue("emailAddress")),s.WebMainMenu1.FAppearance.FHamburgerMenu.SetCaption("["+pas["WEBLib.Storage"].TWebLocalStorage.GetValue(e.EMAILADDR)+"]")),e.ResetPrompt="none",r="name = '"+t+"' and trashed = false",await s.WebRESTClient1.HttpRequest("GET","https://www.googleapis.com/drive/v3/files?q="+s.WebRESTClient1.$class.URLEncode(r),"","",null)}if(n="",null!=(a=await d())){if(200!==a.status&&(window.console.log(a.statusText),this.WebRESTClient1.ClearTokens(),window.console.log("Retrying login"),200!==(a=await d()).status))return"";if(o=a.responseText,window.console.log(a.responseText),null!=(l=pas["WEBLib.JSON"].TJSONObject.ParseJSONValue(o))){h=l.GetValue$1("files"),e.Log(pas.SysUtils.TIntegerHelper.ToString$1.call({p:h.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})+" files found");for(var F=0,c=h.GetCount()-1;F<=c;F++)u=F,(l=h.GetItem(u)).GetJSONValue("name")===t&&i.set(l.GetJSONValue("id"));if(l=rtl.freeLoc(l),h=rtl.freeLoc(h),window.console.log(i.get()),""===i.get())return"";null!=(a=await this.WebRESTClient1.HttpRequest("GET","https://www.googleapis.com/drive/v3/files/"+i.get()+"?alt=media","","",null).catch((function(t){window.console.log("error here",t)})))&&(n=a.responseText)}}return n},this.CreateGoogleFile=async function(t,e){var i=null,s=null;i=await this.WebRESTClient1.HttpRequest("POST","https://www.googleapis.com/upload/drive/v3/files","","",null),window.console.log(i),null!=(s=pas["WEBLib.JSON"].TJSONObject.ParseJSONValue(i.responseText))&&(e.set(s.GetJSONValue("id")),window.console.log("file ID"+e.get()),i=await this.WebRESTClient1.HttpRequest("PATCH","https://www.googleapis.com/drive/v3/files/"+e.get(),'{"name":"'+t+'", "description":"New Captures CSV list"}',"",null))};var s=["PSIP","Time","Title","SubTitle","Description","StartTime","EndTime","programID","originalAirDate","new","audioProperties","videoProperties","movieYear","genres","Class"];this.SetupWIDBCDS=async function(){var t=0;for(e.Log("Setting up to (re)open WIDBCDS"),this.WIDBCDS.FFieldDefs.Clear(),this.WIDBCDS.FFieldDefs.Add$3("id",3,0,!1),t=0;t<=14;t++)"StartTime"===s[t]||"EndTime"===s[t]?this.WIDBCDS.FFieldDefs.Add$5(s[t],11):this.WIDBCDS.FFieldDefs.Add$5(s[t],1);await this.WIDBCDS.OpenAsync(),e.Log("WIDBCDS is "+pas.StrUtils.IfThen(!this.WIDBCDS.GetActive(),"not ","")+"Active and "+pas.StrUtils.IfThen(!this.WIDBCDS.IsEmpty(),"not ","")+"Empty"),this.WIDBCDS.First();do{e.FirstEndDate=this.WIDBCDS.FieldByName("EndTime").GetAsDateTime(),this.WIDBCDS.Next()}while(!pas.DateUtils.SameDate(this.WIDBCDS.FieldByName("StartTime").GetAsDateTime(),this.WIDBCDS.FieldByName("EndTime").GetAsDateTime()));e.Log("FirstEndDate: "+pas.SysUtils.DateToStr(e.FirstEndDate)),this.WIDBCDS.Last(),e.LastStartDate=this.WIDBCDS.FieldByName("StartTime").GetAsDateTime(),e.Log("LastStartDate: "+pas.SysUtils.DateToStr(e.LastStartDate)),e.Log("LastStartDate - Now: "+pas.SysUtils.TDoubleHelper.ToString$3.call({a:e.LastStartDate-pas.SysUtils.Now(),get:function(){return this.a},set:function(t){rtl.raiseE("EPropReadOnly")}})),pas.SysUtils.Now()>e.LastStartDate?pas["WEBLib.Dialogs"].ShowMessage("There are no current data!\rPlease make sure that the HTPC\r is connected to Google Drive"):pas.SysUtils.Now()-e.FirstEndDate>3&&pas["WEBLib.Dialogs"].ShowMessage("The current dataset was fetched over 3 days ago\rand there are only about "+pas.SysUtils.TNativeIntHelper.ToString$1.call({a:Math.round(e.LastStartDate-pas.SysUtils.Now()),get:function(){return this.a},set:function(t){this.a=t}})+" days now available.\r\rTo update, please use Options | Refresh Data")},this.SetupEpgDb=async function(){var t,i;for(t=pas.DateUtils.TTimeZone.GetLocal().ToUniversalTime(pas.SysUtils.Now(),!1),i=pas.DateUtils.TTimeZone.GetLocal().ToUniversalTime(pas.SysUtils.Now(),!1)+this.seNumDisplayDays.GetValue(),this.EpgDb=this.WIDBCDS.GetClonedDataSet(!0),e.Log("EpgDb record count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.EpgDb.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),e.Log("EpgDb recno: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.EpgDb.GetRecNo(),get:function(){return this.p},set:function(t){this.p=t}}));!this.EpgDb.GetEOF();)this.EpgDb.FFieldList.GetField(7).GetAsDateTime()<t||this.EpgDb.FFieldList.GetField(6).GetAsDateTime()>i?this.EpgDb.Delete():this.EpgDb.Next();e.Log("EpgDb record count: "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.EpgDb.GetRecordCount(),get:function(){return this.p},set:function(t){this.p=t}})),this.WebDataSource1.SetDataSet(this.EpgDb),this.EPG.SetDataSource(this.WebDataSource1)},this.SetupFilterList=async function(t,i){var s,n,r="",o="",a=null;for(await this.ShowPlsWait("Preparing "+i+" list."),n=this.EpgDb.FFiltered,s=this.EpgDb.FFilterText,this.EpgDb.DisableControls(),this.EpgDb.SetFiltered(!1),(a=pas.Classes.TStringList.$create("Create$1")).SetSorted(!0),a.FDuplicates=0,a.BeginUpdate(),this.EpgDb.First(),e.Log('Looping over EpgDb "'+i+'" field');!this.EpgDb.GetEOF();){if(r=this.EpgDb.FieldByName(i).GetAsString(),"genres"===i){o=pas.StrUtils.ReplaceStr(r,"\\","");for(var l=pas.SysUtils.TStringHelper.Split$5.call({get:function(){return o},set:function(t){o=t}},[";","[","]",'"',","],1),h=0,u=rtl.length(l)-1;h<=u;h++)r=l[h],a.Add(r)}else a.Add(r);this.EpgDb.Next()}this.SetFilter(s),this.EpgDb.SetFiltered(n),a.EndUpdate(),t.BeginUpdate(),t.Clear(),e.Log("Adding first "+t.FName+' Item: "All"'),t.FItems.Add("All"),t.FItems.AddStrings(a),t.EndUpdate(),e.Log("Added "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:t.FItems.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})+" to "+t.FName),a=rtl.freeLoc(a),t.SetItemIndex(-1),this.EpgDb.EnableControls()},this.SetFilter=function(t){this.EPG.BeginUpdate(),this.EpgDb.DisableControls(),this.EpgDb.SetFiltered(!1),e.Log("EpgDb.Filter: "+t),this.EpgDb.SetFilterText(t),t>""&&this.EpgDb.SetFiltered(!0),this.EpgDb.EnableControls(),this.EPG.EndUpdate(),this.EPG.Refresh(),this.EpgDb.First()},this.ShowPlsWait=async function(t){3!==e.VisiblePanelNum?(this.WebLabel1.SetCaption(t),this.pnlWaitPls.BringToFront(),this.pnlWaitPls.Show(),await sleep(10)):e.Log("####### "+t)},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this),this.BufferGrid=pas["WEBLib.Grids"].TStringGrid.$create("Create$1",[this]),this.pnlMenu=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.pnlLog=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.WebMemo2=pas["WEBLib.StdCtrls"].TMemo.$create("Create$2",["content"]),this.pnlStatus=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.AlertLabel=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.pnlWaitPls=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.WebGridPanel1=pas["WEBLib.ExtCtrls"].TGridPanel.$create("Create$1",[this]),this.WebLabel2=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.WebLabel1=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.WebButton1=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.pnlHistory=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.HistoryTable=pas["WEBLib.Grids"].TStringGrid.$create("Create$1",[this]),this.pnlOptions=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.WebGroupBox3=pas["WEBLib.ExtCtrls"].TGroupBox.$create("Create$1",[this]),this.seNumHistEvents=pas["WEBLib.StdCtrls"].TSpinEdit.$create("Create$1",[this]),this.WebGroupBox1=pas["WEBLib.ExtCtrls"].TGroupBox.$create("Create$1",[this]),this.seNumDisplayDays=pas["WEBLib.StdCtrls"].TSpinEdit.$create("Create$1",[this]),this.btnOptOK=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.pnlCaptures=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.WebHTMLDiv1=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.WebHTMLDiv2=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.NewCaptures=pas["WEBLib.Grids"].TStringGrid.$create("Create$1",[this]),this.WebHTMLDiv3=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.Captures=pas["WEBLib.Grids"].TStringGrid.$create("Create$1",[this]),this.WebHTMLDiv4=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.pnlListings=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.lblEmptyEPG=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.EPG=pas["WEBLib.DBCtrls"].TDBGrid.$create("Create$1",[this]),this.pnlFilterComboBox=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.lblFilterSelect=pas["WEBLib.StdCtrls"].TLabel.$create("Create$1",[this]),this.WebComboBox1=pas["WEBLib.StdCtrls"].TComboBox.$create("Create$1",[this]),this.WebComboBox2=pas["WEBLib.StdCtrls"].TComboBox.$create("Create$1",[this]),this.WebComboBox3=pas["WEBLib.StdCtrls"].TComboBox.$create("Create$1",[this]),this.HistoryGrid=pas["WEBLib.Grids"].TStringGrid.$create("Create$1",[this]),this.WebMainMenu1=pas["WEBLib.Menus"].TMainMenu.$create("Create$1",[this]),this.Listing=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ByAll=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ByGenre=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ByTitle=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ByChannel=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.Scheduled=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.History=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.Options=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.RefreshEPG=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ChangeHTPC1=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.ViewLog1=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.Settings1=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this]),this.WIDBCDS=pas["WEBLib.IndexedDb"].TIndexedDbClientDataset.$create("Create$1",[this]),this.WebRESTClient1=pas["WEBLib.REST"].TRESTClient.$create("Create$1",[this]),this.WebDataSource1=pas.DB.TDataSource.$create("Create$1",[this]),this.EpgDb=pas["WEBLib.CDS"].TClientDataSet.$create("Create$1",[this]),this.BufferGrid.BeforeLoadDFMValues(),this.pnlMenu.BeforeLoadDFMValues(),this.pnlLog.BeforeLoadDFMValues(),this.WebMemo2.BeforeLoadDFMValues(),this.pnlStatus.BeforeLoadDFMValues(),this.AlertLabel.BeforeLoadDFMValues(),this.pnlWaitPls.BeforeLoadDFMValues(),this.WebGridPanel1.BeforeLoadDFMValues(),this.WebLabel2.BeforeLoadDFMValues(),this.WebLabel1.BeforeLoadDFMValues(),this.WebButton1.BeforeLoadDFMValues(),this.pnlHistory.BeforeLoadDFMValues(),this.HistoryTable.BeforeLoadDFMValues(),this.pnlOptions.BeforeLoadDFMValues(),this.WebGroupBox3.BeforeLoadDFMValues(),this.seNumHistEvents.BeforeLoadDFMValues(),this.WebGroupBox1.BeforeLoadDFMValues(),this.seNumDisplayDays.BeforeLoadDFMValues(),this.btnOptOK.BeforeLoadDFMValues(),this.pnlCaptures.BeforeLoadDFMValues(),this.WebHTMLDiv1.BeforeLoadDFMValues(),this.WebHTMLDiv2.BeforeLoadDFMValues(),this.NewCaptures.BeforeLoadDFMValues(),this.WebHTMLDiv3.BeforeLoadDFMValues(),this.Captures.BeforeLoadDFMValues(),this.WebHTMLDiv4.BeforeLoadDFMValues(),this.pnlListings.BeforeLoadDFMValues(),this.lblEmptyEPG.BeforeLoadDFMValues(),this.EPG.BeforeLoadDFMValues(),this.pnlFilterComboBox.BeforeLoadDFMValues(),this.lblFilterSelect.BeforeLoadDFMValues(),this.WebComboBox1.BeforeLoadDFMValues(),this.WebComboBox2.BeforeLoadDFMValues(),this.WebComboBox3.BeforeLoadDFMValues(),this.HistoryGrid.BeforeLoadDFMValues(),this.WebMainMenu1.BeforeLoadDFMValues(),this.Listing.BeforeLoadDFMValues(),this.ByAll.BeforeLoadDFMValues(),this.ByGenre.BeforeLoadDFMValues(),this.ByTitle.BeforeLoadDFMValues(),this.ByChannel.BeforeLoadDFMValues(),this.Scheduled.BeforeLoadDFMValues(),this.History.BeforeLoadDFMValues(),this.Options.BeforeLoadDFMValues(),this.RefreshEPG.BeforeLoadDFMValues(),this.ChangeHTPC1.BeforeLoadDFMValues(),this.ViewLog1.BeforeLoadDFMValues(),this.Settings1.BeforeLoadDFMValues(),this.WIDBCDS.BeforeLoadDFMValues(),this.WebRESTClient1.BeforeLoadDFMValues(),this.WebDataSource1.BeforeLoadDFMValues(),this.EpgDb.BeforeLoadDFMValues();try{this.SetName("CWRmainFrm"),this.SetWidth(428),this.SetHeight(817),this.SetCSSLibrary(1),this.SetElementClassName("container-fluid"),this.SetElementFont(1),this.FFont.FCharset=0,this.FFont.SetColor(0),this.FFont.SetHeight(-11),this.FFont.SetName("Arial"),this.FFont.SetStyle({}),this.FMenu=this.WebMainMenu1,this.SetParentFont(!1),this.SetEvent(this,"OnCreate","WebFormCreate"),this.BufferGrid.SetParentComponent(this),this.BufferGrid.SetName("BufferGrid"),this.BufferGrid.SetLeft(96),this.BufferGrid.SetTop(632),this.BufferGrid.SetWidth(257),this.BufferGrid.SetHeight(50),this.BufferGrid.SetColCount(14),this.BufferGrid.SetDefaultColWidth(61),this.BufferGrid.SetDefaultRowHeight(23),this.BufferGrid.SetFixedCols(0),this.BufferGrid.SetRowCount(20),this.BufferGrid.FFont.FCharset=1,this.BufferGrid.FFont.SetColor(65793),this.BufferGrid.FFont.SetHeight(-12),this.BufferGrid.FFont.SetName("Segoe UI"),this.BufferGrid.FFont.SetStyle({}),this.BufferGrid.FOptions={},this.BufferGrid.SetParentFont(!1),this.BufferGrid.SetTabOrder(8),this.BufferGrid.SetVisible(!1),this.BufferGrid.FStyleElements={},this.BufferGrid.FFixedFont.FCharset=1,this.BufferGrid.FFixedFont.SetColor(65793),this.BufferGrid.FFixedFont.SetHeight(-12),this.BufferGrid.FFixedFont.SetName("Segoe UI"),this.BufferGrid.FFixedFont.SetStyle({}),this.BufferGrid.FRange.FMax=100,this.BufferGrid.FRange.FStep=1,this.BufferGrid.SetHeightPercent(100),this.BufferGrid.SetWidthPercent(100),this.pnlMenu.SetParentComponent(this),this.pnlMenu.SetName("pnlMenu"),this.pnlMenu.SetLeft(0),this.pnlMenu.SetTop(0),this.pnlMenu.SetWidth(428),this.pnlMenu.SetHeight(50),this.pnlMenu.SetElementClassName("container"),this.pnlMenu.SetWidthStyle(0),this.pnlMenu.SetAlign(1),this.pnlMenu.SetBorderStyle(0),this.pnlMenu.SetCaption("pnlMenu"),this.pnlMenu.SetChildOrderEx(12),this.pnlMenu.SetTabOrder(7),this.pnlLog.SetParentComponent(this),this.pnlLog.SetName("pnlLog"),this.pnlLog.SetLeft(0),this.pnlLog.SetTop(80),this.pnlLog.SetWidth(428),this.pnlLog.SetHeight(703),this.pnlLog.SetElementClassName("card"),this.pnlLog.SetHeightStyle(0),this.pnlLog.SetWidthStyle(0),this.pnlLog.SetAlign(5),this.pnlLog.SetChildOrderEx(9),this.pnlLog.FElementBodyClassName="card-body",this.pnlLog.SetElementFont(1),this.pnlLog.SetShowCaption(!1),this.pnlLog.SetTabOrder(2),this.WebMemo2.SetParentComponent(this.pnlLog),this.WebMemo2.SetName("WebMemo2"),this.WebMemo2.SetAlignWithMargins(!0),this.WebMemo2.SetLeft(3),this.WebMemo2.SetTop(3),this.WebMemo2.SetWidth(422),this.WebMemo2.SetHeight(697),this.WebMemo2.SetAlign(5),this.WebMemo2.SetColor(0),this.WebMemo2.SetElementClassName("white"),this.WebMemo2.SetElementFont(1),this.WebMemo2.SetHeightStyle(0),this.WebMemo2.SetHeightPercent(100),this.WebMemo2.SetReadOnly(!0),this.WebMemo2.SetSelLength(0),this.WebMemo2.SetSelStart(0),this.WebMemo2.SetWidthStyle(0),this.WebMemo2.SetWidthPercent(100),this.pnlStatus.SetParentComponent(this),this.pnlStatus.SetName("pnlStatus"),this.pnlStatus.SetLeft(0),this.pnlStatus.SetTop(50),this.pnlStatus.SetWidth(428),this.pnlStatus.SetHeight(30),this.pnlStatus.SetElementClassName("container"),this.pnlStatus.SetWidthStyle(2),this.pnlStatus.SetAlign(1),this.pnlStatus.SetBorderStyle(0),this.pnlStatus.SetCaption("pnlStatus"),this.pnlStatus.SetChildOrderEx(12),this.pnlStatus.FElementBodyClassName="card-body",this.pnlStatus.SetElementFont(1),this.pnlStatus.SetTabOrder(0),this.pnlStatus.SetVisible(!1),this.AlertLabel.SetParentComponent(this.pnlStatus),this.AlertLabel.SetName("AlertLabel"),this.AlertLabel.SetLeft(0),this.AlertLabel.SetTop(0),this.AlertLabel.SetWidth(428),this.AlertLabel.SetHeight(30),this.AlertLabel.FMargins.SetLeft(19),this.AlertLabel.FMargins.SetTop(24),this.AlertLabel.FMargins.SetRight(19),this.AlertLabel.FMargins.SetBottom(19),this.AlertLabel.SetAlign(5),this.AlertLabel.SetColor(65535),this.AlertLabel.SetElementClassName("form-control"),this.AlertLabel.SetElementFont(1),this.AlertLabel.FFont.FCharset=1,this.AlertLabel.FFont.SetColor(0),this.AlertLabel.FFont.SetHeight(-11),this.AlertLabel.FFont.SetName("Arial"),this.AlertLabel.FFont.SetStyle({}),this.AlertLabel.SetHeightPercent(100),this.AlertLabel.SetParentFont(!1),this.AlertLabel.SetRole("button"),this.AlertLabel.SetWidthPercent(100),this.pnlWaitPls.SetParentComponent(this),this.pnlWaitPls.SetName("pnlWaitPls"),this.pnlWaitPls.SetLeft(0),this.pnlWaitPls.SetTop(80),this.pnlWaitPls.SetWidth(428),this.pnlWaitPls.SetHeight(703),this.pnlWaitPls.SetElementClassName("container-fluid"),this.pnlWaitPls.SetHeightStyle(0),this.pnlWaitPls.SetWidthStyle(0),this.pnlWaitPls.SetAlign(5),this.pnlWaitPls.SetChildOrderEx(10),this.pnlWaitPls.FElementBodyClassName="card-body",this.pnlWaitPls.SetElementFont(1),this.pnlWaitPls.SetTabOrder(4),this.WebGridPanel1.SetParentComponent(this.pnlWaitPls),this.WebGridPanel1.SetName("WebGridPanel1"),this.WebGridPanel1.SetLeft(0),this.WebGridPanel1.SetTop(0),this.WebGridPanel1.SetWidth(428),this.WebGridPanel1.SetHeight(703),this.WebGridPanel1.SetWidthStyle(0),this.WebGridPanel1.SetAlign(5),this.WebGridPanel1.FColumnCollection.Clear(),this.WebGridPanel1.FColumnCollection.Add$1().SetValue(100),this.WebGridPanel1.FControlCollection.Clear();var t=this.WebGridPanel1.FControlCollection.Add$1();t.FColumn=0,t.FRow=0,t.FControl=this.WebButton1;var e=this.WebGridPanel1.FControlCollection.Add$1();e.FColumn=0,e.FRow=1,e.FControl=this.WebLabel1;var i=this.WebGridPanel1.FControlCollection.Add$1();i.FColumn=0,i.FRow=2,i.FControl=this.WebLabel2,this.WebGridPanel1.SetColor(65535),this.WebGridPanel1.FGridLineColor=0,this.WebGridPanel1.FRowCollection.Clear(),this.WebGridPanel1.FRowCollection.Add$1().SetValue(25),this.WebGridPanel1.FRowCollection.Add$1().SetValue(25),this.WebGridPanel1.FRowCollection.Add$1().SetValue(25),this.WebGridPanel1.FRowCollection.Add$1().SetValue(25),this.WebLabel2.SetParentComponent(this.WebGridPanel1),this.WebLabel2.SetName("WebLabel2"),this.WebLabel2.SetLeft(2),this.WebLabel2.SetTop(354),this.WebLabel2.SetWidth(424),this.WebLabel2.SetHeight(172),this.WebLabel2.SetAlign(5),this.WebLabel2.SetAlignment(2),this.WebLabel2.SetCaption("Please Wait..."),this.WebLabel2.SetChildOrderEx(-1),this.WebLabel2.SetColorEx(65535),this.WebLabel2.SetElementLabelClassName("h1"),this.WebLabel2.SetElementFont(1),this.WebLabel2.SetElementPosition(1),this.WebLabel2.SetHeightStyle(0),this.WebLabel2.SetHeightPercent(100),this.WebLabel2.SetTransparent(!1),this.WebLabel2.SetWidthStyle(0),this.WebLabel2.SetWidthPercent(100),this.WebLabel1.SetParentComponent(this.WebGridPanel1),this.WebLabel1.SetName("WebLabel1"),this.WebLabel1.SetLeft(2),this.WebLabel1.SetTop(178),this.WebLabel1.SetWidth(424),this.WebLabel1.SetHeight(172),this.WebLabel1.SetAlign(5),this.WebLabel1.SetAlignment(2),this.WebLabel1.SetCaption("Preparing EPG Listings."),this.WebLabel1.SetChildOrderEx(-1),this.WebLabel1.SetColorEx(65535),this.WebLabel1.SetElementLabelClassName("h1"),this.WebLabel1.SetElementFont(1),this.WebLabel1.SetElementPosition(1),this.WebLabel1.SetHeightStyle(0),this.WebLabel1.SetHeightPercent(100),this.WebLabel1.SetHTMLType(3),this.WebLabel1.SetTransparent(!1),this.WebLabel1.SetWidthStyle(0),this.WebLabel1.SetWidthPercent(100),this.WebButton1.SetParentComponent(this.WebGridPanel1),this.WebButton1.SetName("WebButton1"),this.WebButton1.SetLeft(2),this.WebButton1.SetTop(2),this.WebButton1.SetWidth(424),this.WebButton1.SetHeight(172),this.WebButton1.SetAlign(5),this.WebButton1.SetCaption('<i class="fa-solid fa-spinner fa-spin"></>'),this.WebButton1.SetColor(65535),this.WebButton1.SetChildOrderEx(-1),this.WebButton1.SetElementClassName("btn btn-lg"),this.WebButton1.SetElementFont(1),this.WebButton1.SetElementPosition(1),this.WebButton1.SetHeightStyle(0),this.WebButton1.SetHeightPercent(100),this.WebButton1.SetRole("button"),this.WebButton1.SetWidthStyle(0),this.WebButton1.SetWidthPercent(100),this.pnlHistory.SetParentComponent(this),this.pnlHistory.SetName("pnlHistory"),this.pnlHistory.SetLeft(0),this.pnlHistory.SetTop(80),this.pnlHistory.SetWidth(428),this.pnlHistory.SetHeight(703),this.pnlHistory.SetElementClassName("card"),this.pnlHistory.SetHeightStyle(0),this.pnlHistory.SetWidthStyle(0),this.pnlHistory.SetAlign(5),this.pnlHistory.SetChildOrderEx(11),this.pnlHistory.FElementBodyClassName="card-body",this.pnlHistory.SetElementFont(1),this.pnlHistory.SetShowCaption(!1),this.pnlHistory.SetTabOrder(1),this.HistoryTable.SetParentComponent(this.pnlHistory),this.HistoryTable.SetName("HistoryTable"),this.HistoryTable.SetLeft(0),this.HistoryTable.SetTop(0),this.HistoryTable.SetWidth(428),this.HistoryTable.SetHeight(703),this.HistoryTable.SetAlign(5),this.HistoryTable.SetColor(3107669),this.HistoryTable.SetColCount(32),this.HistoryTable.SetDefaultColWidth(61),this.HistoryTable.SetDefaultRowHeight(23),this.HistoryTable.SetFixedCols(0),this.HistoryTable.FFont.FCharset=0,this.HistoryTable.FFont.SetColor(8421504),this.HistoryTable.FFont.SetHeight(-11),this.HistoryTable.FFont.SetName("Arial"),this.HistoryTable.FFont.SetStyle({}),this.HistoryTable.FOptions=rtl.createSet(12,16),this.HistoryTable.SetParentFont(!1),this.HistoryTable.SetTabOrder(0),this.HistoryTable.FStyleElements={},this.SetEvent$1(this.HistoryTable,this,"OnFixedCellClick","HistoryTableFixedCellClick"),this.HistoryTable.SetElementFont(1),this.HistoryTable.FFixedFont.FCharset=1,this.HistoryTable.FFixedFont.SetColor(65793),this.HistoryTable.FFixedFont.SetHeight(-12),this.HistoryTable.FFixedFont.SetName("Segoe UI"),this.HistoryTable.FFixedFont.SetStyle({}),this.HistoryTable.FRange.FMax=100,this.HistoryTable.FRange.FStep=1,this.HistoryTable.SetHeightStyle(0),this.HistoryTable.SetHeightPercent(100),this.HistoryTable.SetWidthPercent(100),this.SetEvent$1(this.HistoryTable,this,"OnGetCellClass","HistoryTableGetCellClass"),this.pnlOptions.SetParentComponent(this),this.pnlOptions.SetName("pnlOptions"),this.pnlOptions.SetLeft(0),this.pnlOptions.SetTop(80),this.pnlOptions.SetWidth(428),this.pnlOptions.SetHeight(703),this.pnlOptions.SetElementClassName("card"),this.pnlOptions.SetHeightStyle(0),this.pnlOptions.SetWidthStyle(0),this.pnlOptions.SetAlign(5),this.pnlOptions.SetChildOrderEx(9),this.pnlOptions.FElementBodyClassName="card-body",this.pnlOptions.SetElementFont(1),this.pnlOptions.SetShowCaption(!1),this.pnlOptions.SetTabOrder(5),this.WebGroupBox3.SetParentComponent(this.pnlOptions),this.WebGroupBox3.SetName("WebGroupBox3"),this.WebGroupBox3.SetLeft(15),this.WebGroupBox3.SetTop(115),this.WebGroupBox3.SetWidth(264),this.WebGroupBox3.SetHeight(104),this.WebGroupBox3.SetElementClassName("btn-group"),this.WebGroupBox3.SetWidthPercent(25),this.WebGroupBox3.SetAlign(6),this.WebGroupBox3.SetBorderColor(12632256),this.WebGroupBox3.SetCaption("History Events Displayed"),this.WebGroupBox3.SetColor(16776960),this.WebGroupBox3.SetElementFont(1),this.WebGroupBox3.SetElementLegendClassName("h6"),this.seNumHistEvents.SetParentComponent(this.WebGroupBox3),this.seNumHistEvents.SetName("seNumHistEvents"),this.seNumHistEvents.SetAlignWithMargins(!0),this.seNumHistEvents.SetLeft(57),this.seNumHistEvents.SetTop(35),this.seNumHistEvents.SetWidth(150),this.seNumHistEvents.SetHeight(45),this.seNumHistEvents.FMargins.SetLeft(57),this.seNumHistEvents.FMargins.SetTop(35),this.seNumHistEvents.FMargins.SetRight(57),this.seNumHistEvents.FMargins.SetBottom(24),this.seNumHistEvents.SetElementClassName("form-control"),this.seNumHistEvents.SetHeightStyle(2),this.seNumHistEvents.SetAlign(5),this.seNumHistEvents.FAutoSize=!0,this.seNumHistEvents.SetBorderStyle(0),this.seNumHistEvents.SetColor(15790320),this.seNumHistEvents.SetElementFont(1),this.seNumHistEvents.SetIncrement(100),this.seNumHistEvents.SetMaxValue(1e3),this.seNumHistEvents.SetMinValue(100),this.seNumHistEvents.SetRole(""),this.seNumHistEvents.SetValue(100),this.SetEvent$1(this.seNumHistEvents,this,"OnChange","seNumHistEventsChange"),this.WebGroupBox1.SetParentComponent(this.pnlOptions),this.WebGroupBox1.SetName("WebGroupBox1"),this.WebGroupBox1.SetLeft(15),this.WebGroupBox1.SetTop(0),this.WebGroupBox1.SetWidth(264),this.WebGroupBox1.SetHeight(100),this.WebGroupBox1.SetElementClassName("btn-group"),this.WebGroupBox1.SetWidthPercent(25),this.WebGroupBox1.SetAlign(6),this.WebGroupBox1.SetBorderColor(12632256),this.WebGroupBox1.SetCaption("EPG Days Displayed"),this.WebGroupBox1.SetColor(16776960),this.WebGroupBox1.SetElementFont(1),this.WebGroupBox1.SetElementLegendClassName("h6"),this.seNumDisplayDays.SetParentComponent(this.WebGroupBox1),this.seNumDisplayDays.SetName("seNumDisplayDays"),this.seNumDisplayDays.SetAlignWithMargins(!0),this.seNumDisplayDays.SetLeft(57),this.seNumDisplayDays.SetTop(35),this.seNumDisplayDays.SetWidth(150),this.seNumDisplayDays.SetHeight(41),this.seNumDisplayDays.FMargins.SetLeft(57),this.seNumDisplayDays.FMargins.SetTop(35),this.seNumDisplayDays.FMargins.SetRight(57),this.seNumDisplayDays.FMargins.SetBottom(24),this.seNumDisplayDays.SetElementClassName("form-control"),this.seNumDisplayDays.SetHeightStyle(2),this.seNumDisplayDays.SetAlign(5),this.seNumDisplayDays.FAutoSize=!1,this.seNumDisplayDays.SetBorderStyle(0),this.seNumDisplayDays.SetColor(15790320),this.seNumDisplayDays.SetElementFont(1),this.seNumDisplayDays.SetIncrement(1),this.seNumDisplayDays.SetMaxValue(10),this.seNumDisplayDays.SetMinValue(1),this.seNumDisplayDays.SetRole(""),this.seNumDisplayDays.SetValue(1),this.SetEvent$1(this.seNumDisplayDays,this,"OnChange","seNumDisplayDaysChange"),this.btnOptOK.SetParentComponent(this.pnlOptions),this.btnOptOK.SetName("btnOptOK"),this.btnOptOK.SetLeft(119),this.btnOptOK.SetTop(241),this.btnOptOK.SetWidth(56),this.btnOptOK.SetHeight(25),this.btnOptOK.SetCaption("OK"),this.btnOptOK.SetChildOrderEx(2),this.btnOptOK.SetElementClassName("btn btn-light"),this.btnOptOK.SetElementFont(1),this.btnOptOK.SetHeightStyle(2),this.btnOptOK.SetHeightPercent(100),this.btnOptOK.FModalResult=1,this.btnOptOK.SetWidthPercent(100),this.SetEvent$1(this.btnOptOK,this,"OnClick","btnOptOKClick"),this.pnlCaptures.SetParentComponent(this),this.pnlCaptures.SetName("pnlCaptures"),this.pnlCaptures.SetLeft(0),this.pnlCaptures.SetTop(80),this.pnlCaptures.SetWidth(428),this.pnlCaptures.SetHeight(703),this.pnlCaptures.SetElementClassName("greenBG"),this.pnlCaptures.SetHeightStyle(0),this.pnlCaptures.SetWidthStyle(0),this.pnlCaptures.SetAlign(5),this.pnlCaptures.SetChildOrderEx(9),this.pnlCaptures.SetColor(8421504),this.pnlCaptures.FElementBodyClassName="card-body",this.pnlCaptures.SetElementFont(1),this.pnlCaptures.SetShowCaption(!1),this.pnlCaptures.SetTabOrder(3),this.WebHTMLDiv1.SetParentComponent(this.pnlCaptures),this.WebHTMLDiv1.SetName("WebHTMLDiv1"),this.WebHTMLDiv1.SetLeft(0),this.WebHTMLDiv1.SetTop(266),this.WebHTMLDiv1.SetWidth(428),this.WebHTMLDiv1.SetHeight(35),this.WebHTMLDiv1.SetElementClassName("greenBG"),this.WebHTMLDiv1.SetAlign(1),this.WebHTMLDiv1.SetChildOrderEx(1),this.WebHTMLDiv1.SetElementFont(1),this.WebHTMLDiv1.FHTML.BeginUpdate();try{this.WebHTMLDiv1.FHTML.Clear(),this.WebHTMLDiv1.FHTML.Add('<FONT color="#FFFFFF" ><P align="center">Programs to be Scheduled </FONT><FONT color="#F00000" >on Next CW_EPG Run </P> </FONT>')}finally{this.WebHTMLDiv1.FHTML.EndUpdate()}this.WebHTMLDiv1.SetRole(""),this.WebHTMLDiv2.SetParentComponent(this.pnlCaptures),this.WebHTMLDiv2.SetName("WebHTMLDiv2"),this.WebHTMLDiv2.SetLeft(0),this.WebHTMLDiv2.SetTop(301),this.WebHTMLDiv2.SetWidth(428),this.WebHTMLDiv2.SetHeight(231),this.WebHTMLDiv2.SetAlign(1),this.WebHTMLDiv2.SetChildOrderEx(2),this.WebHTMLDiv2.SetElementFont(1),this.WebHTMLDiv2.SetRole(""),this.NewCaptures.SetParentComponent(this.WebHTMLDiv2),this.NewCaptures.SetName("NewCaptures"),this.NewCaptures.SetLeft(0),this.NewCaptures.SetTop(0),this.NewCaptures.SetWidth(428),this.NewCaptures.SetHeight(231),this.NewCaptures.SetAlign(5),this.NewCaptures.SetColor(212724686),this.NewCaptures.SetColCount(7),this.NewCaptures.SetDefaultRowHeight(22),this.NewCaptures.SetFixedColor(8421376),this.NewCaptures.SetFixedCols(0),this.NewCaptures.FOptions=rtl.createSet(1,3,12),this.NewCaptures.SetTabOrder(0),this.NewCaptures.FStyleElements={},this.NewCaptures.SetElementClassName("greenBG"),this.NewCaptures.SetElementFont(1),this.NewCaptures.FFixedFont.FCharset=0,this.NewCaptures.FFixedFont.SetColor(0),this.NewCaptures.FFixedFont.SetHeight(-11),this.NewCaptures.FFixedFont.SetName("Arial"),this.NewCaptures.FFixedFont.SetStyle({}),this.NewCaptures.FRange.FMax=100,this.NewCaptures.FRange.FStep=1,this.NewCaptures.SetHeightPercent(100),this.NewCaptures.SetWidthPercent(100),this.SetEvent$1(this.NewCaptures,this,"OnClickCell","NewCapturesClickCell"),this.SetEvent$1(this.NewCaptures,this,"OnGetCellData","NewCapturesGetCellData"),this.WebHTMLDiv3.SetParentComponent(this.pnlCaptures),this.WebHTMLDiv3.SetName("WebHTMLDiv3"),this.WebHTMLDiv3.SetLeft(0),this.WebHTMLDiv3.SetTop(35),this.WebHTMLDiv3.SetWidth(428),this.WebHTMLDiv3.SetHeight(231),this.WebHTMLDiv3.SetAlign(1),this.WebHTMLDiv3.SetChildOrderEx(2),this.WebHTMLDiv3.SetElementFont(1),this.WebHTMLDiv3.SetRole(""),this.Captures.SetParentComponent(this.WebHTMLDiv3),this.Captures.SetName("Captures"),this.Captures.SetLeft(0),this.Captures.SetTop(0),this.Captures.SetWidth(428),this.Captures.SetHeight(231),this.Captures.SetAlign(5),this.Captures.SetColor(212724686),this.Captures.SetDefaultRowHeight(22),this.Captures.SetFixedColor(8421376),this.Captures.SetFixedCols(0),this.Captures.FOptions=rtl.createSet(3,12),this.Captures.SetTabOrder(0),this.Captures.FStyleElements={},this.Captures.SetElementClassName("greenBG"),this.Captures.SetElementFont(1),this.Captures.FFixedFont.FCharset=0,this.Captures.FFixedFont.SetColor(0),this.Captures.FFixedFont.SetHeight(-11),this.Captures.FFixedFont.SetName("Arial"),this.Captures.FFixedFont.SetStyle({}),this.Captures.FRange.FMax=100,this.Captures.FRange.FStep=1,this.Captures.SetHeightStyle(0),this.Captures.SetHeightPercent(100),this.Captures.SetWidthPercent(100),this.WebHTMLDiv4.SetParentComponent(this.pnlCaptures),this.WebHTMLDiv4.SetName("WebHTMLDiv4"),this.WebHTMLDiv4.SetLeft(0),this.WebHTMLDiv4.SetTop(0),this.WebHTMLDiv4.SetWidth(428),this.WebHTMLDiv4.SetHeight(35),this.WebHTMLDiv4.SetElementClassName("greenBG"),this.WebHTMLDiv4.SetAlign(1),this.WebHTMLDiv4.SetChildOrderEx(3),this.WebHTMLDiv4.SetElementFont(1),this.WebHTMLDiv4.FHTML.BeginUpdate();try{this.WebHTMLDiv4.FHTML.Clear(),this.WebHTMLDiv4.FHTML.Add('<FONT color="#FFFFFF" ><P align="center">Programs currently Scheduled</P></FONT>')}finally{this.WebHTMLDiv4.FHTML.EndUpdate()}this.WebHTMLDiv4.SetRole(""),this.pnlListings.SetParentComponent(this),this.pnlListings.SetName("pnlListings"),this.pnlListings.SetLeft(0),this.pnlListings.SetTop(80),this.pnlListings.SetWidth(428),this.pnlListings.SetHeight(703),this.pnlListings.SetElementClassName("card"),this.pnlListings.SetHeightStyle(0),this.pnlListings.SetWidthStyle(0),this.pnlListings.SetAlign(5),this.pnlListings.SetCaption("pnlListings"),this.pnlListings.SetChildOrderEx(11),this.pnlListings.FElementBodyClassName="card-body",this.pnlListings.SetElementFont(1),this.pnlListings.SetShowCaption(!1),this.pnlListings.SetTabOrder(6),this.lblEmptyEPG.SetParentComponent(this.pnlListings),this.lblEmptyEPG.SetName("lblEmptyEPG"),this.lblEmptyEPG.SetLeft(96),this.lblEmptyEPG.SetTop(58),this.lblEmptyEPG.SetWidth(195),this.lblEmptyEPG.SetHeight(28),this.lblEmptyEPG.SetAlignment(2),this.lblEmptyEPG.SetAnchors(rtl.createSet(0,1,2)),this.lblEmptyEPG.SetCaption('There are no current listings to see.(Try "Options|Refresh EPG" to update)'),this.lblEmptyEPG.SetColorEx(0),this.lblEmptyEPG.SetElementClassName("white"),this.lblEmptyEPG.SetElementFont(1),this.lblEmptyEPG.FFont.FCharset=0,this.lblEmptyEPG.FFont.SetColor(16777215),this.lblEmptyEPG.FFont.SetHeight(-11),this.lblEmptyEPG.FFont.SetName("Arial"),this.lblEmptyEPG.FFont.SetStyle({}),this.lblEmptyEPG.SetHeightStyle(2),this.lblEmptyEPG.SetHeightPercent(100),this.lblEmptyEPG.SetParentFont(!1),this.lblEmptyEPG.SetTransparent(!1),this.lblEmptyEPG.SetVisible(!1),this.lblEmptyEPG.FWordWrap=!0,this.lblEmptyEPG.SetWidthPercent(100),this.EPG.SetParentComponent(this.pnlListings),this.EPG.SetName("EPG"),this.EPG.SetLeft(0),this.EPG.SetTop(0),this.EPG.SetWidth(428),this.EPG.SetHeight(703),this.EPG.SetAlign(5),this.EPG.SetBorderStyle(0),this.EPG.SetColor(8388608),this.EPG.FColumns.Clear();var s=this.EPG.FColumns.Add$1();s.SetAlignment(2),s.FAutoFormatDateTime=!1,s.SetDataField("PSIP"),s.SetTitle("Channel"),s.SetWidth(75);var n=this.EPG.FColumns.Add$1();n.SetAlignment(2),n.FAutoFormatDateTime=!1,n.SetDataField("Time"),n.SetTitle("HTPC Local Time"),n.FTitleClassName="h6",n.SetWidth(155);var r=this.EPG.FColumns.Add$1();r.FAutoFormatDateTime=!1,r.SetDataField("Title"),r.SetTitle("Title"),r.SetWidth(300);var o=this.EPG.FColumns.Add$1();o.FAutoFormatDateTime=!1,o.SetDataField("id"),o.FEditor=14,o.SetTitle("ID"),o.SetWidth(0);var a=this.EPG.FColumns.Add$1();a.FAutoFormatDateTime=!1,a.FClassName$1="white",a.SetDataField("Class"),a.SetTitle("Class"),a.SetWidth(0),this.EPG.SetDataSource(this.WebDataSource1),this.EPG.SetElementFont(1),this.EPG.FFixedFont.FCharset=0,this.EPG.FFixedFont.SetColor(0),this.EPG.FFixedFont.SetHeight(-11),this.EPG.FFixedFont.SetName("Arial"),this.EPG.FFixedFont.SetStyle({}),this.EPG.SetFixedCols(0),this.EPG.FFont.FCharset=0,this.EPG.FFont.SetColor(65793),this.EPG.FFont.SetHeight(-12),this.EPG.FFont.SetName("Segoe UI"),this.EPG.FFont.SetStyle({}),this.EPG.FOptions=rtl.createSet(12),this.EPG.SetParentFont(!1),this.EPG.SetTabOrder(0),this.EPG.SetHeightPercent(100),this.EPG.FStyleElements={},this.EPG.SetWidthPercent(100),this.SetEvent$1(this.EPG,this,"OnClickCell","EPGClickCell"),this.SetEvent$1(this.EPG,this,"OnGetCellClass","EPGGetCellClass"),this.EPG.SetColWidths(0,75),this.EPG.SetColWidths(1,155),this.EPG.SetColWidths(2,300),this.EPG.SetColWidths(3,0),this.EPG.SetColWidths(4,0),this.pnlFilterComboBox.SetParentComponent(this.pnlListings),this.pnlFilterComboBox.SetName("pnlFilterComboBox"),this.pnlFilterComboBox.SetLeft(88),this.pnlFilterComboBox.SetTop(49),this.pnlFilterComboBox.SetWidth(150),this.pnlFilterComboBox.SetHeight(60),this.pnlFilterComboBox.SetElementClassName("card"),this.pnlFilterComboBox.SetCaption("Choose Filter"),this.pnlFilterComboBox.SetChildOrderEx(5),this.pnlFilterComboBox.FElementBodyClassName="card-body",this.pnlFilterComboBox.SetElementFont(1),this.pnlFilterComboBox.SetTabOrder(1),this.pnlFilterComboBox.SetVisible(!1),this.lblFilterSelect.SetParentComponent(this.pnlFilterComboBox),this.lblFilterSelect.SetName("lblFilterSelect"),this.lblFilterSelect.SetLeft(0),this.lblFilterSelect.SetTop(0),this.lblFilterSelect.SetWidth(150),this.lblFilterSelect.SetHeight(14),this.lblFilterSelect.SetAlign(1),this.lblFilterSelect.SetCaption("Choose Item"),this.lblFilterSelect.SetElementFont(1),this.lblFilterSelect.SetHeightStyle(2),this.lblFilterSelect.SetHeightPercent(100),this.lblFilterSelect.SetWidthPercent(100),this.WebComboBox1.SetParentComponent(this.pnlFilterComboBox),this.WebComboBox1.SetName("WebComboBox1"),this.WebComboBox1.SetLeft(0),this.WebComboBox1.SetTop(38),this.WebComboBox1.SetWidth(150),this.WebComboBox1.SetHeight(22),this.WebComboBox1.SetAlign(2),this.WebComboBox1.SetElementClassName("form-select"),this.WebComboBox1.SetElementFont(1),this.WebComboBox1.SetHeightStyle(2),this.WebComboBox1.SetHeightPercent(100),this.WebComboBox1.SetRole("combobox"),this.WebComboBox1.SetVisible(!1),this.WebComboBox1.SetWidthPercent(100),this.SetEvent$1(this.WebComboBox1,this,"OnChange","WebComboBox1Change"),this.SetEvent$1(this.WebComboBox1,this,"OnDblClick","WebComboBox1Change"),this.SetEvent$1(this.WebComboBox1,this,"OnFocusOut","WebComboBox1FocusOut"),this.WebComboBox1.SetItemIndex(-1),this.WebComboBox2.SetParentComponent(this.pnlFilterComboBox),this.WebComboBox2.SetName("WebComboBox2"),this.WebComboBox2.SetLeft(0),this.WebComboBox2.SetTop(-6),this.WebComboBox2.SetWidth(150),this.WebComboBox2.SetHeight(22),this.WebComboBox2.SetAlign(2),this.WebComboBox2.SetElementClassName("form-select"),this.WebComboBox2.SetElementFont(1),this.WebComboBox2.SetHeightStyle(2),this.WebComboBox2.SetHeightPercent(100),this.WebComboBox2.SetRole("combobox"),this.WebComboBox2.SetVisible(!1),this.WebComboBox2.SetWidthPercent(100),this.SetEvent$1(this.WebComboBox2,this,"OnChange","WebComboBox2Change"),this.SetEvent$1(this.WebComboBox2,this,"OnDblClick","WebComboBox2Change"),this.SetEvent$1(this.WebComboBox2,this,"OnFocusOut","WebComboBox2FocusOut"),this.WebComboBox2.SetItemIndex(-1),this.WebComboBox3.SetParentComponent(this.pnlFilterComboBox),this.WebComboBox3.SetName("WebComboBox3"),this.WebComboBox3.SetLeft(0),this.WebComboBox3.SetTop(16),this.WebComboBox3.SetWidth(150),this.WebComboBox3.SetHeight(22),this.WebComboBox3.SetAlign(2),this.WebComboBox3.SetElementClassName("form-select"),this.WebComboBox3.SetElementFont(1),this.WebComboBox3.SetHeightStyle(2),this.WebComboBox3.SetHeightPercent(100),this.WebComboBox3.SetRole("combobox"),this.WebComboBox3.SetVisible(!1),this.WebComboBox3.SetWidthPercent(100),this.SetEvent$1(this.WebComboBox3,this,"OnChange","WebComboBox3Change"),this.SetEvent$1(this.WebComboBox3,this,"OnDblClick","WebComboBox3Change"),this.SetEvent$1(this.WebComboBox3,this,"OnFocusOut","WebComboBox3FocusOut"),this.WebComboBox3.SetItemIndex(-1),this.HistoryGrid.SetParentComponent(this),this.HistoryGrid.SetName("HistoryGrid"),this.HistoryGrid.SetLeft(56),this.HistoryGrid.SetTop(352),this.HistoryGrid.SetWidth(320),this.HistoryGrid.SetHeight(120),this.HistoryGrid.SetColCount(32),this.HistoryGrid.SetFixedCols(0),this.HistoryGrid.SetTabOrder(9),this.HistoryGrid.SetVisible(!1),this.HistoryGrid.SetElementFont(1),this.HistoryGrid.FFixedFont.FCharset=1,this.HistoryGrid.FFixedFont.SetColor(65793),this.HistoryGrid.FFixedFont.SetHeight(-21),this.HistoryGrid.FFixedFont.SetName("Segoe UI"),this.HistoryGrid.FFixedFont.SetStyle({}),this.HistoryGrid.FRange.FMax=100,this.HistoryGrid.FRange.FStep=1,this.HistoryGrid.SetHeightPercent(100),this.HistoryGrid.SetWidthPercent(100),this.WebMainMenu1.SetParentComponent(this),this.WebMainMenu1.SetName("WebMainMenu1"),this.WebMainMenu1.FAppearance.SetBackgroundColor(12632256),this.WebMainMenu1.FAppearance.FHamburgerMenu.SetCaption("Menu"),this.WebMainMenu1.FAppearance.FHamburgerMenu.SetVisible(0),this.WebMainMenu1.FAppearance.FHamburgerMenu.SetResponsiveMaxWidth(300),this.WebMainMenu1.FAppearance.SetHoverFontColor(16777215),this.WebMainMenu1.FAppearance.SetImageSize(8),this.WebMainMenu1.FAppearance.SetSubmenuIndicator("&#9658;"),this.WebMainMenu1.FContainer$1=this.pnlMenu,this.WebMainMenu1.SetElementFont(1),this.WebMainMenu1.FFont.FCharset=1,this.WebMainMenu1.FFont.SetColor(0),this.WebMainMenu1.FFont.SetHeight(-11),this.WebMainMenu1.FFont.SetName("Arial"),this.WebMainMenu1.FFont.SetStyle({}),this.WebMainMenu1.SetVisible(!1),this.WebMainMenu1.SetWidth(376),this.WebMainMenu1.SetHeight(50),this.Listing.SetParentComponent(this.WebMainMenu1),this.Listing.SetName("Listing"),this.Listing.SetCaption("Listings"),this.Listing.FDefault=!0,this.Listing.FRadioItem=!0,this.SetEvent$1(this.Listing,this,"OnClick","ListingClick"),this.ByAll.SetParentComponent(this.Listing),this.ByAll.SetName("ByAll"),this.ByAll.SetCaption("Unfiltered"),this.ByAll.SetChecked(!0),this.ByAll.FDefault=!0,this.ByAll.FRadioItem=!0,this.SetEvent$1(this.ByAll,this,"OnClick","ByAllClick"),this.ByGenre.SetParentComponent(this.Listing),this.ByGenre.SetName("ByGenre"),this.ByGenre.SetCaption("Filter by Genre"),this.ByGenre.FRadioItem=!0,this.SetEvent$1(this.ByGenre,this,"OnClick","ByGenreClick"),this.ByTitle.SetParentComponent(this.Listing),this.ByTitle.SetName("ByTitle"),this.ByTitle.SetCaption("Filter by Title"),this.ByTitle.FRadioItem=!0,this.SetEvent$1(this.ByTitle,this,"OnClick","ByTitleClick"),this.ByChannel.SetParentComponent(this.Listing),this.ByChannel.SetName("ByChannel"),this.ByChannel.SetCaption("Filter by Channel"),this.ByChannel.FRadioItem=!0,this.SetEvent$1(this.ByChannel,this,"OnClick","ByChannelClick"),this.Scheduled.SetParentComponent(this.WebMainMenu1),this.Scheduled.SetName("Scheduled"),this.Scheduled.SetCaption("Scheduled"),this.Scheduled.FRadioItem=!0,this.SetEvent$1(this.Scheduled,this,"OnClick","ScheduledClick"),this.History.SetParentComponent(this.WebMainMenu1),this.History.SetName("History"),this.History.SetCaption("History"),this.History.FRadioItem=!0,this.SetEvent$1(this.History,this,"OnClick","HistoryClick"),this.Options.SetParentComponent(this.WebMainMenu1),this.Options.SetName("Options"),this.Options.SetCaption("Options"),this.Options.FRadioItem=!0,this.RefreshEPG.SetParentComponent(this.Options),this.RefreshEPG.SetName("RefreshEPG"),this.RefreshEPG.SetCaption("Refresh Data"),this.SetEvent$1(this.RefreshEPG,this,"OnClick","UpdateEPG"),this.ChangeHTPC1.SetParentComponent(this.Options),this.ChangeHTPC1.SetName("ChangeHTPC1"),this.ChangeHTPC1.SetCaption("Change HTPC"),this.SetEvent$1(this.ChangeHTPC1,this,"OnClick","ChangeTargetHTPC"),this.ViewLog1.SetParentComponent(this.Options),this.ViewLog1.SetName("ViewLog1"),this.ViewLog1.SetCaption("View Log"),this.SetEvent$1(this.ViewLog1,this,"OnClick","ViewLog1Click"),this.Settings1.SetParentComponent(this.Options),this.Settings1.SetName("Settings1"),this.Settings1.SetCaption("Settings"),this.SetEvent$1(this.Settings1,this,"OnClick","Settings1Click"),this.WIDBCDS.SetParentComponent(this),this.WIDBCDS.SetName("WIDBCDS"),this.WIDBCDS.FIDBDatabaseName="CWRDB-Manual-id",this.WIDBCDS.FIDBObjectStoreName="epg",this.WIDBCDS.FIDBKeyFieldName="id",this.WIDBCDS.FIDBAutoIncrement=!1,this.SetEvent$1(this.WIDBCDS,this,"OnIDBError","WIDBCDSIDBError"),this.WIDBCDS.SetLeft(296),this.WIDBCDS.SetTop(152),this.WebRESTClient1.SetParentComponent(this),this.WebRESTClient1.SetName("WebRESTClient1"),this.WebRESTClient1.FLoginHeight=480,this.WebRESTClient1.FLoginWidth=400,this.WebRESTClient1.FPersistTokens.FKey="GoogleToken",this.WebRESTClient1.FPersistTokens.FEnabled=!0,this.WebRESTClient1.SetLeft(296),this.WebRESTClient1.SetTop(104),this.WebDataSource1.SetParentComponent(this),this.WebDataSource1.SetName("WebDataSource1"),this.WebDataSource1.SetDataSet(this.EpgDb),this.WebDataSource1.SetLeft(296),this.WebDataSource1.SetTop(216),this.EpgDb.SetParentComponent(this),this.EpgDb.SetName("EpgDb"),this.EpgDb.SetLeft(200),this.EpgDb.SetTop(392)}finally{this.BufferGrid.AfterLoadDFMValues(),this.pnlMenu.AfterLoadDFMValues(),this.pnlLog.AfterLoadDFMValues(),this.WebMemo2.AfterLoadDFMValues(),this.pnlStatus.AfterLoadDFMValues(),this.AlertLabel.AfterLoadDFMValues(),this.pnlWaitPls.AfterLoadDFMValues(),this.WebGridPanel1.AfterLoadDFMValues(),this.WebLabel2.AfterLoadDFMValues(),this.WebLabel1.AfterLoadDFMValues(),this.WebButton1.AfterLoadDFMValues(),this.pnlHistory.AfterLoadDFMValues(),this.HistoryTable.AfterLoadDFMValues(),this.pnlOptions.AfterLoadDFMValues(),this.WebGroupBox3.AfterLoadDFMValues(),this.seNumHistEvents.AfterLoadDFMValues(),this.WebGroupBox1.AfterLoadDFMValues(),this.seNumDisplayDays.AfterLoadDFMValues(),this.btnOptOK.AfterLoadDFMValues(),this.pnlCaptures.AfterLoadDFMValues(),this.WebHTMLDiv1.AfterLoadDFMValues(),this.WebHTMLDiv2.AfterLoadDFMValues(),this.NewCaptures.AfterLoadDFMValues(),this.WebHTMLDiv3.AfterLoadDFMValues(),this.Captures.AfterLoadDFMValues(),this.WebHTMLDiv4.AfterLoadDFMValues(),this.pnlListings.AfterLoadDFMValues(),this.lblEmptyEPG.AfterLoadDFMValues(),this.EPG.AfterLoadDFMValues(),this.pnlFilterComboBox.AfterLoadDFMValues(),this.lblFilterSelect.AfterLoadDFMValues(),this.WebComboBox1.AfterLoadDFMValues(),this.WebComboBox2.AfterLoadDFMValues(),this.WebComboBox3.AfterLoadDFMValues(),this.HistoryGrid.AfterLoadDFMValues(),this.WebMainMenu1.AfterLoadDFMValues(),this.Listing.AfterLoadDFMValues(),this.ByAll.AfterLoadDFMValues(),this.ByGenre.AfterLoadDFMValues(),this.ByTitle.AfterLoadDFMValues(),this.ByChannel.AfterLoadDFMValues(),this.Scheduled.AfterLoadDFMValues(),this.History.AfterLoadDFMValues(),this.Options.AfterLoadDFMValues(),this.RefreshEPG.AfterLoadDFMValues(),this.ChangeHTPC1.AfterLoadDFMValues(),this.ViewLog1.AfterLoadDFMValues(),this.Settings1.AfterLoadDFMValues(),this.WIDBCDS.AfterLoadDFMValues(),this.WebRESTClient1.AfterLoadDFMValues(),this.WebDataSource1.AfterLoadDFMValues(),this.EpgDb.AfterLoadDFMValues()}},rtl.addIntf(this,pas["WEBLib.Controls"].IControl),rtl.addIntf(this,pas.System.IUnknown);var n=this.$rtti;n.addField("WIDBCDS",pas["WEBLib.IndexedDb"].$rtti.TIndexedDbClientDataset),n.addField("WebMemo2",pas["WEBLib.StdCtrls"].$rtti.TMemo),n.addField("AlertLabel",pas["WEBLib.StdCtrls"].$rtti.TButton),n.addField("Captures",pas["WEBLib.Grids"].$rtti.TStringGrid),n.addField("HistoryTable",pas["WEBLib.Grids"].$rtti.TStringGrid),n.addField("BufferGrid",pas["WEBLib.Grids"].$rtti.TStringGrid),n.addField("pnlCaptures",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("pnlHistory",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("pnlLog",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("pnlOptions",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("pnlWaitPls",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("WebRESTClient1",pas["WEBLib.REST"].$rtti.TRESTClient),n.addField("pnlListings",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("NewCaptures",pas["WEBLib.Grids"].$rtti.TStringGrid),n.addField("pnlMenu",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("WebMainMenu1",pas["WEBLib.Menus"].$rtti.TMainMenu),n.addField("Listing",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("Scheduled",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("History",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("Options",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("RefreshEPG",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("ChangeHTPC1",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("ViewLog1",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("Settings1",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("pnlStatus",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("WebGroupBox3",pas["WEBLib.ExtCtrls"].$rtti.TGroupBox),n.addField("seNumHistEvents",pas["WEBLib.StdCtrls"].$rtti.TSpinEdit),n.addField("WebGroupBox1",pas["WEBLib.ExtCtrls"].$rtti.TGroupBox),n.addField("seNumDisplayDays",pas["WEBLib.StdCtrls"].$rtti.TSpinEdit),n.addField("EPG",pas["WEBLib.DBCtrls"].$rtti.TDBGrid),n.addField("WebDataSource1",pas.DB.$rtti.TDataSource),n.addField("WebButton1",pas["WEBLib.StdCtrls"].$rtti.TButton),n.addField("WebGridPanel1",pas["WEBLib.ExtCtrls"].$rtti.TGridPanel),n.addField("WebLabel1",pas["WEBLib.StdCtrls"].$rtti.TLabel),n.addField("WebLabel2",pas["WEBLib.StdCtrls"].$rtti.TLabel),n.addField("WebComboBox1",pas["WEBLib.StdCtrls"].$rtti.TComboBox),n.addField("WebComboBox2",pas["WEBLib.StdCtrls"].$rtti.TComboBox),n.addField("lblEmptyEPG",pas["WEBLib.StdCtrls"].$rtti.TLabel),n.addField("ByAll",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("ByChannel",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("ByGenre",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("ByTitle",pas["WEBLib.Menus"].$rtti.TMenuItem),n.addField("WebComboBox3",pas["WEBLib.StdCtrls"].$rtti.TComboBox),n.addField("WebHTMLDiv1",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),n.addField("WebHTMLDiv2",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),n.addField("WebHTMLDiv3",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),n.addField("pnlFilterComboBox",pas["WEBLib.ExtCtrls"].$rtti.TPanel),n.addField("lblFilterSelect",pas["WEBLib.StdCtrls"].$rtti.TLabel),n.addField("btnOptOK",pas["WEBLib.StdCtrls"].$rtti.TButton),n.addField("WebHTMLDiv4",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),n.addField("HistoryGrid",pas["WEBLib.Grids"].$rtti.TStringGrid),n.addField("EpgDb",pas["WEBLib.CDS"].$rtti.TClientDataSet),n.addMethod("SetNewCapturesFixedRow",0,[]),n.addMethod("EPGGetCellClass",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string],["AClassName",rtl.string,1]]),n.addMethod("SaveNewCapturesFile",0,[["id",rtl.string]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("LoadWIDBCDS",0,[],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("WIDBCDSIDBError",0,[["DataSet",pas.DB.$rtti.TDataSet],["opCode",pas["WEBLib.IndexedDb"].$rtti.TIndexedDbOpCode],["errorName",rtl.string],["errorMsg",rtl.string]]),n.addMethod("UpdateEPG",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("WebFormCreate",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("tbCapturesShow",0,[],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("AllCapsGridGetCellData",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string,1]]),n.addMethod("HistoryTableFixedCellClick",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]]),n.addMethod("UpdateHistory",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("ChangeTargetHTPC",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("ListingClick",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("HistoryClick",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("ScheduledClick",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("ViewLog1Click",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("Settings1Click",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("EPGClickCell",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("HistoryTableGetCellClass",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string],["AClassName",rtl.string,1]]),n.addMethod("ByGenreClick",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("WebComboBox1Change",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("ByTitleClick",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("WebComboBox2Change",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("ByAllClick",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("ByChannelClick",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("WebComboBox3Change",0,[["Sender",pas.System.$rtti.TObject]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("NewCapturesClickCell",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]],null,16,{attr:[pas.JS.AsyncAttribute,"Create"]}),n.addMethod("NewCapturesGetCellData",0,[["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AField",pas.DB.$rtti.TField],["AValue",rtl.string,1]]),n.addMethod("WebComboBox1FocusOut",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("WebComboBox2FocusOut",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("WebComboBox3FocusOut",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("btnOptOKClick",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("seNumHistEventsChange",0,[["Sender",pas.System.$rtti.TObject]]),n.addMethod("seNumDisplayDaysChange",0,[["Sender",pas.System.$rtti.TObject]])})),this.CWRmainFrm=null,t.$implcode=function(){e.ResetPrompt="none",e.VisiblePanelNum=0,e.FirstEndDate=0,e.LastStartDate=0,e.NUMDAYS="NumDisplayDays",e.NUMHIST="NumHistoryItems",e.EMAILADDR="emailAddress",e.Log=function(e){t.CWRmainFrm.WebMemo2.FLines.Add(pas.SysUtils.DateTimeToStr(pas.SysUtils.Now(),!1)+"--"+e),window.console.log(pas.SysUtils.DateTimeToStr(pas.SysUtils.Now(),!1)+"--"+e)},e.SetTableDefaults=function(t,e,i,s,n){var r=0;t.SetColWidths(0,e),t.SetColWidths(1,i),t.SetColWidths(2,s),t.SetColWidths(3,n);for(var o=4,a=t.FColCount-1;o<=a;o++)r=o,t.SetColWidths(r,0);t.SetColAlignments(0,2),t.SetColAlignments(1,2)},e.SetLabelStyle=function(t,e){t.FFont.SetColor(pas.Math.IfThen(e,255,12698049))},e.SaveLocalStrings=function(t,e){var i=null,s=0;i=pas.Classes.TStringList.$create("Create$1"),t.SaveToStrings(i,",",!0);for(var n=0,r=i.GetCount()-1;n<=r;n++)s=n,pas["WEBLib.Storage"].TLocalStorage.SetValue(e+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}}),i.Get(s));for(s=i.GetCount();pas["WEBLib.Storage"].TLocalStorage.GetValue(e+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}}))>"";)pas["WEBLib.Storage"].TLocalStorage.RemoveKey(e+pas.SysUtils.TIntegerHelper.ToString$1.call({p:i.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})),s+=1;i=rtl.freeLoc(i)}}}),["Math","DateUtils","SchedUnit2","Details"]),rtl.module("program",["System","WEBLib.Forms","WEBLib.Forms","CWRmainForm","SchedUnit2","Details"],(function(){"use strict";this.$main=function(){pas["WEBLib.Forms"].Application.Initialize(),pas["WEBLib.Forms"].Application.FMainFormOnTaskBar=!0,pas["WEBLib.Forms"].Application.CreateForm(pas.CWRmainForm.TCWRmainFrm,{p:pas.CWRmainForm,get:function(){return this.p.CWRmainFrm},set:function(t){this.p.CWRmainFrm=t}}),pas["WEBLib.Forms"].Application.CreateForm(pas.SchedUnit2.TSchedForm,{p:pas.SchedUnit2,get:function(){return this.p.SchedForm},set:function(t){this.p.SchedForm=t}}),pas["WEBLib.Forms"].Application.CreateForm(pas.Details.TDetailsFrm,{p:pas.Details,get:function(){return this.p.DetailsFrm},set:function(t){this.p.DetailsFrm=t}}),pas["WEBLib.Forms"].Application.Run()}}));